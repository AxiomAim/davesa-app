{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/action/crop.js","../../src/image-editor/action/draw.js","../../src/image-editor/action/export.js","../../src/image-editor/action/filter.js","../../src/image-editor/action/freehand-draw.js","../../src/image-editor/action/selection.js","../../src/image-editor/action/shape.js","../../src/image-editor/action/transform.js","../../src/image-editor/action/undo-redo.js","../../src/image-editor/base/image-editor.js","../../src/image-editor/base/enum.js","../../src/image-editor/renderer/toolbar.js"],"sourcesContent":["import { Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Crop = /** @class */ (function () {\n    function Crop(parent) {\n        this.croppedDegree = 0; // Specifies the degree when crop is performed\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 }; // To redraw old image when navigate to crop tab\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Crop.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Crop.prototype.addEventListener = function () {\n        this.parent.on('crop', this.cropping, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Crop.prototype.removeEventListener = function () {\n        this.parent.off('crop', this.cropping);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Crop.prototype.cropping = function (args) {\n        this.updateCropPvtVar();\n        switch (args.prop) {\n            case 'cropImg':\n                this.cropImg(args.value['isRotateCrop']);\n                break;\n            case 'cropCircle':\n                this.cropCircle(args.value['context'], args.value['isSave'], args.value['isFlip']);\n                break;\n            case 'setCurrSelPoints':\n                this.setCurrSelPoints(args.value['isSetDimension']);\n                break;\n            case 'updateRotatePan':\n                this.updateRotatePan();\n                break;\n            case 'crop':\n                this.crop(args.value['obj']);\n                break;\n            case 'calcRatio':\n                this.calcRatio(args.value['obj'], args.value['dimension']);\n                break;\n            case 'isObjInImage':\n                this.isObjInImage(args.value['obj'], args.value['object']);\n                break;\n            case 'getCurrFlipState':\n                this.getCurrFlipState(args.value['panObj']);\n                break;\n            case 'getPreviousCropCurrentObj':\n                args.value['obj']['prevObj'] = this.prevCropCurrObj;\n                break;\n            case 'setPreviousCropCurrentObj':\n                this.prevCropCurrObj = args.value['obj'];\n                break;\n            case 'setCropDestPoints':\n                this.cropDestPoints = args.value['point'];\n                break;\n            case 'getTempFlipPanPoint':\n                args.value['obj']['point'] = this.tempFlipPanPoint;\n                break;\n            case 'setTempFlipPanPoint':\n                if (isNullOrUndefined(args.value['isAdd'])) {\n                    this.tempFlipPanPoint = args.value['point'];\n                }\n                else {\n                    this.tempFlipPanPoint.x += args.value['point'].x;\n                    this.tempFlipPanPoint.y += args.value['point'].y;\n                }\n                break;\n            case 'getPreventScaling':\n                args.value['obj']['bool'] = this.isPreventScaling;\n                break;\n            case 'adjustStraightenForShapes':\n                this.adjustStraightenForShapes(args.value['type'], args.value['isInitialRotated']);\n                break;\n            case 'resizeWrapper':\n                this.resizeWrapper();\n                break;\n            case 'setTransformCrop':\n                this.isTransformCrop = args.value['bool'];\n                break;\n            case 'setInitCrop':\n                this.isInitCrop = args.value['bool'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Crop.prototype.getModuleName = function () {\n        return 'crop';\n    };\n    Crop.prototype.updateCropPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Crop.prototype.reset = function () {\n        this.prevCropCurrObj = null;\n        this.croppedDegree = 0;\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n    };\n    Crop.prototype.cropImg = function (isRotateCrop) {\n        var parent = this.parent;\n        var isNullCrop = isNullOrUndefined(isRotateCrop);\n        var resizeIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        var actPoint = parent.activeObj.activePoint;\n        var img = parent.img;\n        var isRotated = false;\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            var currentValue = parent.rotateFlipColl[i];\n            if (currentValue === 90 || currentValue === -90) {\n                isRotated = true;\n            }\n        }\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        if (isNullCrop || resizeIcon) {\n            this.croppedDegree = parent.transform.degree;\n        }\n        if (isNullCrop && (parent.transform.degree !== 0) || isRotated) {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.rotateCrop();\n        }\n        else if (isNullCrop && parent.transform.currFlipState !== '') {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.flipCrop();\n        }\n        else {\n            this.adjustStraightenForShapes('initial', false);\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n            var ratio = this.calcRatio();\n            if (isNullCrop || !isRotateCrop) { // isRotateCrop is NULL or False\n                this.updateCropObj();\n                parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n                parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n                parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n                this.cropDestPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            }\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actPoint.width * ratio.width,\n                    height: actPoint.height * ratio.height, obj: obj, isImgShape: null } });\n            var maxDimension = obj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.img = { srcLeft: (actPoint.startX * ratio.width) - (img.destLeft * ratio.width),\n                srcTop: (actPoint.startY * ratio.height) - (img.destTop * ratio.height),\n                srcWidth: (actPoint.width * ratio.width), srcHeight: (actPoint.height * ratio.height),\n                destLeft: (parent.lowerCanvas.clientWidth - maxDimension.width) / 2,\n                destTop: (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2,\n                destWidth: maxDimension.width, destHeight: maxDimension.height };\n            var temp = this.lowerContext.filter;\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.cropObjColl();\n            parent.transform.straighten = 0;\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            var objColl = extend([], parent.objColl, [], true);\n            for (var i = 0, len = objColl.length; i < len; i++) {\n                if (this.isObjInImage(objColl[i])) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: objColl[i].shape, obj: objColl[i], canvas: null } });\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.activeObj = activeObj;\n            this.cropFreehandDrawColl();\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') {\n                this.cropCircle(this.lowerContext);\n            }\n            else {\n                parent.isCircleCrop = false;\n            }\n            this.lowerContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currObjType.isCustomCrop = false;\n            parent.pan(false);\n            parent.transform.defaultZoomFactor = 0;\n        }\n    };\n    Crop.prototype.adjustStraightenForShapes = function (type, isInitialRotated) {\n        var parent = this.parent;\n        var center = {\n            x: parent.img.destLeft + parent.img.destWidth / 2,\n            y: parent.img.destTop + parent.img.destHeight / 2\n        };\n        for (var _i = 0, _a = parent.objColl; _i < _a.length; _i++) {\n            var obj = _a[_i];\n            if (['rectangle', 'ellipse', 'text', 'image'].indexOf(obj.shape) !== -1) {\n                if (isInitialRotated || obj.rotatedAngle !== 0) {\n                    var _b = obj.activePoint, startX = _b.startX, startY = _b.startY, width = _b.width, height = _b.height;\n                    var angle = type === 'initial' ? obj.rotatedAngle : -obj.rotatedAngle;\n                    var diffX = startX + width / 2 - center.x;\n                    var diffY = startY + height / 2 - center.y;\n                    var cosAngle = Math.cos(angle);\n                    var sinAngle = Math.sin(angle);\n                    var centerX = cosAngle * diffX - sinAngle * diffY + center.x;\n                    var centerY = sinAngle * diffX + cosAngle * diffY + center.y;\n                    var diffXUpdated = centerX - startX - width / 2;\n                    var diffYUpdated = centerY - startY - height / 2;\n                    obj.activePoint.startX += diffXUpdated;\n                    obj.activePoint.startY += diffYUpdated;\n                    obj.activePoint.endX += diffXUpdated;\n                    obj.activePoint.endY += diffYUpdated;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateCropObj = function () {\n        this.parent.afterCropActions = [];\n        var object = { currObj: {} };\n        this.parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var obj = object['currObj'];\n        obj.straighten = this.parent.transform.straighten;\n        this.parent.cropObj = extend({}, obj, {}, true);\n    };\n    Crop.prototype.rotateCrop = function () {\n        var parent = this.parent;\n        var flipState = this.getCurrFlipState();\n        var shape = parent.activeObj.shape || '';\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n        parent.objColl.push(parent.activeObj);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var tempCurrSelObj = extend({}, parent.currSelectionPoint, {}, true);\n        var preventSelObj = { bool: null };\n        parent.notify('transform', { prop: 'getPreventSelect', onPropertyChange: false, value: { obj: preventSelObj } });\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: true } });\n        var coll = extend([], parent.rotateFlipColl, [], true);\n        this.panToSelRangle(true);\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        // For reverse straightening\n        var straighten = parent.transform.straighten;\n        if (straighten !== 0) {\n            parent.transform.straighten = 0;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        this.resetZoom();\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        this.revertTransform('initial', coll);\n        // Perform straighten\n        if (straighten !== 0) {\n            parent.transform.straighten = (flipState === 'horizontal' || flipState === 'vertical') ? -straighten : straighten;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.transform.degree = 0;\n        // Checking for selection inside image\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        var count = 0;\n        while (straighten !== 0 && object['isIntersect']) {\n            count++;\n            if (count === 50) {\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: 0.025, zoomPoint: null }, isResize: null });\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        }\n        this.cropImg(true);\n        this.revertTransform('reverse', coll);\n        parent.afterCropActions = afterCropActions;\n        parent.currSelectionPoint = tempCurrSelObj;\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: preventSelObj['bool'] } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n    };\n    Crop.prototype.revertTransform = function (type, coll) {\n        var parent = this.parent;\n        var obj = { isRotate: false };\n        if (type === 'initial') {\n            for (var i = coll.length - 1; i >= 0; i--) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n        else {\n            this.updateFlipState();\n            for (var i = 0, len = coll.length; i < len; i++) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateFlipState = function () {\n        var parent = this.parent;\n        var objColl = parent.objColl;\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            objColl[i].shapeFlip = '';\n        }\n        // eslint-disable-next-line\n        var pointColl = parent.pointColl;\n        for (var i = 0; i < parent.freehandCounter; i++) {\n            pointColl[i].shapeFlip = '';\n        }\n    };\n    Crop.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var zoomFactor = parent.transform.zoomFactor;\n            var isUndoRedo = parent.isUndoRedo;\n            parent.setProperties({ zoomSettings: { zoomFactor: (zoomFactor * 10) } }, true);\n            parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n            for (var i = 0; i < (zoomFactor * 10); i++) {\n                parent.isUndoRedo = true;\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n            }\n            parent.isUndoRedo = isUndoRedo;\n            parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        }\n    };\n    Crop.prototype.flipCrop = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        parent.panPoint.totalPannedPoint.x += this.tempFlipPanPoint.x;\n        parent.panPoint.totalPannedPoint.y += this.tempFlipPanPoint.y;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        var tempFlipColl = obj['flipColl'];\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: [] } });\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        if (parent.transform.degree === 0) {\n            var panX = -parent.cropObj.totalPannedPoint.x;\n            var panY = -parent.cropObj.totalPannedPoint.y;\n            parent.img.destLeft += panX;\n            parent.img.destTop += panY;\n            parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            parent.objColl.pop();\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n        }\n        this.resetZoom();\n        parent.currSelectionPoint = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        parent.objColl.pop();\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.cropImg(true);\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.transform.currFlipState = tempCurrFlipState;\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: tempFlipColl } });\n        this.lowerContext.filter = 'none';\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n    };\n    Crop.prototype.cropObjColl = function () {\n        var parent = this.parent;\n        var point;\n        var shape;\n        var obj;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                obj = parent.objColl[i];\n                point = obj.activePoint;\n                var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                shape = obj.shape;\n                obj.imageRatio = { startX: ((point.startX - startX) / width),\n                    startY: ((point.startY - startY) / height),\n                    endX: ((point.endX - startX) / width), endY: ((point.endY - startY) / height),\n                    width: width / point.width, height: height / point.height };\n                var degree = void 0;\n                var size = void 0;\n                switch (shape) {\n                    case 'text':\n                        degree = (obj.shapeDegree === 0) ? parent.transform.degree : parent.transform.degree - obj.shapeDegree;\n                        size = (degree === 0 || Math.abs(degree) === 180) ? point.width : point.height;\n                        obj.textSettings.fontRatio = size / obj.textSettings.fontSize;\n                        break;\n                    case 'line':\n                    case 'arrow':\n                        this.cropPointCollection(i);\n                        if (shape === 'arrow') {\n                            parent.notify('shape', { prop: 'updateArrowRatio', onPropertyChange: false, value: { obj: obj } });\n                        }\n                        break;\n                    case 'path':\n                        this.cropPointCollection(i);\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.cropPointCollection = function (i) {\n        var parent = this.parent;\n        var shape = parent.objColl[i].shape;\n        var x;\n        var y;\n        var width;\n        var height;\n        var point = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (shape === 'path') {\n            x = point.startX;\n            y = point.startY;\n            width = point.width;\n            height = point.height;\n        }\n        else {\n            x = destLeft;\n            y = destTop;\n            width = destWidth;\n            height = destHeight;\n        }\n        var pointColl = parent.objColl[i].pointColl;\n        for (var n = 0, len = pointColl.length; n < len; n++) {\n            pointColl[n].ratioX = (pointColl[n].x - x) / width;\n            pointColl[n].ratioY = (pointColl[n].y - y) / height;\n        }\n    };\n    Crop.prototype.cropFreehandDrawColl = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].ratioX = (parent.points[l].x - startX) / width;\n                parent.points[l].ratioY = (parent.points[l].y - startY) / height;\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'updateCropPtsForSel', onPropertyChange: false });\n    };\n    Crop.prototype.resetAnnotations = function () {\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n    };\n    Crop.prototype.setCurrSelPoints = function (isSetDimension) {\n        var parent = this.parent;\n        parent.allowDownScale = false;\n        var destPoint = this.cropDestPoints;\n        var filter = this.lowerContext.filter;\n        var isCropTab = parent.isCropTab;\n        parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n            destLeft: destPoint.startX, destTop: destPoint.startY, destWidth: destPoint.width, destHeight: destPoint.height };\n        var img = parent.img;\n        var currSelPoint = parent.currSelectionPoint;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (isSetDimension) {\n            parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        }\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        if (this.croppedDegree === 0 && parent.transform.degree === 0 && currSelPoint\n            && currSelPoint.shape !== 'crop-circle' && currSelPoint.shape !== 'crop-square') {\n            img.destLeft = destPoint.startX;\n            img.destTop = destPoint.startY;\n            img.destWidth = destPoint.width;\n            img.destHeight = destPoint.height;\n        }\n        if (parent.transform.degree === 0) {\n            img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: true } });\n        var cropObjColl = extend([], parent.objColl, null, true);\n        var cropPointColl = extend([], parent.pointColl, null, true);\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        this.resetAnnotations();\n        if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n            parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n        }\n        this.panToSelRangle();\n        parent.isCropTab = isCropTab;\n        parent.objColl = cropObjColl;\n        parent.pointColl = cropPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                    ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n        }\n        if (parent.cropObj.activeObj.shape) {\n            var destPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            if (currSelPoint && currSelPoint.activePoint) {\n                var _a = currSelPoint.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                img.destLeft = startX;\n                img.destTop = startY;\n                img.destWidth = width;\n                img.destHeight = height;\n            }\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            img.destLeft = destPoints.startX;\n            img.destTop = destPoints.startY;\n            img.destWidth = destPoints.width;\n            img.destHeight = destPoints.height;\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            cropObjColl = extend([], parent.objColl, null, true);\n            cropPointColl = extend([], parent.pointColl, null, true);\n            parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n            this.resetAnnotations();\n            var object = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n            var cropSelPointColl = object['selPointColl'];\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n            parent.cropObj.filter = this.lowerContext.filter;\n            var actObj = extend({}, parent.currSelectionPoint, null, true);\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: null } });\n            parent.activeObj = extend({}, actObj, null, true);\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currSelectionPoint = null;\n            parent.isCircleCrop = false;\n            if (parent.transform.degree !== 0) {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.objColl = cropObjColl;\n            parent.pointColl = cropPointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                        ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n            }\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: cropSelPointColl } } });\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.adjustStraightenForShapes('reverse', false);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'drawPannImage', onPropertyChange: false,\n                    value: { point: { x: 0, y: 0 } } });\n            }\n            else {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.activeObj = activeObj;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: null } });\n            if (!this.isInitCrop && parent.transform.degree === 0 && parent.cropObj.currFlipState !== '' &&\n                parent.cropObj.cropZoom !== 0) {\n                this.isInitCrop = true;\n                var obj = { activeObj: null };\n                parent.notify('draw', { prop: 'getStraightenActObj', onPropertyChange: false, value: { obj: obj } });\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                parent.notify('draw', { prop: 'setStraightenActObj', onPropertyChange: false, value: { activeObj: obj['activeObj'] } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'croptransform',\n                        isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.isInitCrop = false;\n            }\n        }\n        else {\n            this.adjustStraightenForShapes('reverse', true);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            parent.currSelectionPoint = null;\n        }\n        if (document.querySelector('.e-ie-straighten-value-span')) {\n            document.querySelector('.e-ie-straighten-value-span').innerHTML = parent.transform.straighten.toString() + '&#176';\n        }\n    };\n    Crop.prototype.panToSelRangle = function (isReverse) {\n        var parent = this.parent;\n        var pannedPoint = parent.cropObj.totalPannedClientPoint;\n        var panX = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.x : pannedPoint.x : 0;\n        var panY = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.y : pannedPoint.y : 0;\n        if (parent.transform.degree !== 0) {\n            parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n            parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n            parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n        }\n    };\n    Crop.prototype.cropCircle = function (context, isSave, isFlip) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n        var temp = context.filter;\n        context.filter = 'none';\n        context.globalCompositeOperation = 'destination-in';\n        context.beginPath();\n        var centerX = isNullOrUndefined(isSave) ? destLeft + (destWidth / 2) : context.canvas.width / 2;\n        var centerY = isNullOrUndefined(isSave) ? destTop + (destHeight / 2) : context.canvas.height / 2;\n        var radius = isSave ? context.canvas.width / 2 : destWidth / 2;\n        context.arc(centerX, centerY, radius, 0, Math.PI * 2);\n        context.closePath();\n        context.fill();\n        context.restore();\n        context.globalCompositeOperation = 'source-over';\n        parent.currObjType.isActiveObj = parent.isCircleCrop = true;\n        context.filter = temp;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n    };\n    Crop.prototype.getCurrCropState = function (type, isAllowInvert) {\n        var parent = this.parent;\n        var flipState = '';\n        var state = [];\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (type === 'initial') {\n            if (Math.abs(parent.transform.degree) === 180) {\n                flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n            }\n            else {\n                for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                    if (typeof (parent.rotateFlipColl[i]) === 'number') {\n                        state.push('number');\n                    }\n                    else if (typeof (parent.rotateFlipColl[i]) === 'string') {\n                        state.push('string');\n                    }\n                }\n                if (state.length > 1 && state[state.length - 1] === 'string' && state[state.length - 2] === 'number') {\n                    if (parent.transform.currFlipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (parent.transform.currFlipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n                else if (state.length > 1 && state[state.length - 1] === 'number' && state[state.length - 2] === 'string') {\n                    flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n                }\n            }\n        }\n        else {\n            flipState = this.getCurrFlipState();\n            if (isAllowInvert || !this.isInitialRotate()) {\n                if (parent.transform.degree === -90 || parent.transform.degree === -270) {\n                    if (flipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (flipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n            }\n        }\n        if (flipState === '') {\n            flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n        }\n        return flipState;\n    };\n    Crop.prototype.isInitialRotate = function () {\n        var isRotate = false;\n        if (this.parent.rotateFlipColl.length > 0 && typeof (this.parent.rotateFlipColl[0]) === 'number') {\n            isRotate = true;\n        }\n        return isRotate;\n    };\n    Crop.prototype.updateRotatePan = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.panPoint.currentPannedPoint)) {\n            return;\n        }\n        var panRegion = '';\n        var degree = parent.transform.degree;\n        var _a = parent.panPoint.currentPannedPoint, x = _a.x, y = _a.y;\n        if (parent.rotateFlipColl.length > 0 && typeof (parent.rotateFlipColl[0]) === 'number'\n            && degree < 0) {\n            panRegion = this.getCurrCropState('reverse', true);\n        }\n        else {\n            panRegion = this.getCurrFlipState();\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (degree === 90 || (degree === -90 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -270 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === 'horizontal' || panRegion === '') {\n                    parent.img.destLeft += y;\n                }\n                else {\n                    parent.img.destLeft -= y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop -= x;\n                }\n                else {\n                    parent.img.destTop += x;\n                }\n            }\n            else if (degree === 270 || (degree === -270 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -90 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destLeft -= y;\n                }\n                else {\n                    parent.img.destLeft += y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop += x;\n                }\n                else {\n                    parent.img.destTop -= x;\n                }\n            }\n        }\n        else {\n            if (degree === 180 || degree === -180) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destLeft -= x;\n                }\n                else {\n                    parent.img.destLeft += x;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destTop -= y;\n                }\n                else {\n                    parent.img.destTop += y;\n                }\n            }\n        }\n    };\n    Crop.prototype.crop = function (obj) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var object = { isCropToolbar: parent.isCropToolbar };\n            if (parent.currObjType.isUndoAction && !object['isCropToolbar']) {\n                parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n            }\n            var transitionArgs = { cancel: false, startPoint: { x: startX, y: startY },\n                endPoint: { x: endX, y: endY }, preventScaling: false };\n            if (!object['isCropToolbar']) {\n                parent.trigger('cropping', transitionArgs);\n            }\n            this.cropEvent(transitionArgs, obj, object);\n        }\n    };\n    Crop.prototype.cropEvent = function (transitionArgs, obj, object) {\n        var parent = this.parent;\n        var splitWords;\n        if (!transitionArgs.cancel) {\n            splitWords = parent.activeObj.shape ? parent.activeObj.shape.split('-') : [];\n            if (!parent.disabled && parent.activeObj.horTopLine && (parent.currObjType.isCustomCrop || (splitWords.length > 0 &&\n                splitWords[0] === 'crop'))) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                obj.isCrop = true;\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var prevObj = extend({}, this.prevCropCurrObj, {}, true);\n                if (transitionArgs.preventScaling) {\n                    this.isPreventScaling = true;\n                }\n                else {\n                    this.isPreventScaling = false;\n                }\n                this.cropImg();\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                parent.isCropTab = false;\n                parent.transform.zoomFactor = 0;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                if (!Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: parent.cropObj.destPoints.width, height: parent.cropObj.destPoints.height } });\n                var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                if (!object['isCropToolbar'] && (isNullOrUndefined(aspectIcon) && isNullOrUndefined(nonAspectIcon))) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                }\n                this.resizeWrapper();\n                if (Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n            }\n        }\n    };\n    Crop.prototype.updateUndoRedoColl = function (prevObj, prevCropObj, object) {\n        var parent = this.parent;\n        var currSelPtObj = { prevCurrSelectionPoint: parent.prevCurrSelectionPoint };\n        prevObj.currSelectionPoint = extend({}, currSelPtObj['prevCurrSelectionPoint'], {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'crop', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        if (!object['isCropToolbar']) {\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Crop.prototype.resizeWrapper = function () {\n        var parent = this.parent;\n        if (Browser.isDevice) {\n            var elem = parent.element;\n            var ctxToolbar = elem.querySelector('#' + elem.id + '_contextualToolbarArea');\n            if (ctxToolbar && ctxToolbar.style.position === '' && !this.isTransformCrop) {\n                ctxToolbar.style.position = 'absolute';\n                parent.isStraightening = false;\n                parent.update();\n                parent.notify('filter', { prop: 'setAdjustmentValue', value: { adjustmentValue: parent.canvasFilter } });\n            }\n        }\n    };\n    Crop.prototype.calcRatio = function (obj, dimension) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = dimension || parent.baseImgCanvas, width = _b.width, height = _b.height;\n        var widthRatio = (degree === 0 || degree % 180 === 0) ? width / destWidth : height / destWidth;\n        var heightRatio = (degree === 0 || degree % 180 === 0) ? height / destHeight : width / destHeight;\n        if (obj) {\n            obj['width'] = widthRatio;\n            obj['height'] = heightRatio;\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    Crop.prototype.isObjInImage = function (obj, dummyObj) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = obj.activePoint, startX = _b.startX, endX = _b.endX, startY = _b.startY, endY = _b.endY;\n        var isInside = ((startX >= destLeft && endX <= (destLeft + destWidth)) ||\n            (startX <= destLeft && endX >= destLeft) ||\n            (startX <= (destLeft + destWidth) && endX >= (destLeft + destWidth)) ||\n            (startY >= destTop && endY <= (destTop + destHeight)) ||\n            (startY <= destTop && endY >= destTop) ||\n            (startY <= (destTop + destHeight) && endY >= (destTop + destHeight)));\n        if (dummyObj) {\n            dummyObj['isInside'] = isInside;\n        }\n        return isInside;\n    };\n    Crop.prototype.getCurrFlipState = function (panObj) {\n        var parent = this.parent;\n        var obj = { panRegion: '' };\n        var object = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: object } });\n        parent.rotateFlipColl = object['collection'];\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            parent.notify('transform', { prop: 'setCurrPanRegion', onPropertyChange: false,\n                value: { region: obj['panRegion'], type: parent.rotateFlipColl[i], obj: obj } });\n        }\n        if (panObj) {\n            panObj['panRegion'] = obj['panRegion'];\n        }\n        return obj['panRegion'];\n    };\n    return Crop;\n}());\nexport { Crop };\n","import { extend, isNullOrUndefined, Browser, getComponent } from '@syncfusion/ej2-base';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Draw = /** @class */ (function () {\n    function Draw(parent) {\n        this.isInitialLoading = false; // Specifies whether image is loaded for the first time or not (for applying initial filter)\n        this.fileName = '';\n        this.isErrorImage = false;\n        this.isShapeTextInserted = false;\n        this.isRotateZoom = false; // To restore zoomed image on selection crop selection\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null }; // restore stroke settings on cancel\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false }; // restore text settings on cancel\n        this.tempAdjValue = ''; // for temp internal slider value\n        this.tempFilter = ''; // restore filter style on cancel\n        this.tempUndoRedoStep = 0;\n        this.tempFreehandCounter = 0;\n        this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null; // Restore zoom factor on cancel\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.zoomCrop = { width: 0, height: 0 };\n        this.isImageEdited = false;\n        this.isFileChanged = false;\n        this.isNewPath = false;\n        this.isResizeSelect = false;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.origDim = { width: 0, height: 0 };\n        this.isImageApply = false;\n        this.imgCanvasPoints = [];\n        this.isCropSelect = false;\n        this.isDownScale = false;\n        this.preventStraightening = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Draw.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Draw.prototype.addEventListener = function () {\n        this.parent.on('draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Draw.prototype.removeEventListener = function () {\n        this.parent.off('draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Draw.prototype.draw = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'drawObject':\n                this.drawObject(args.value['canvas'], args.value['obj'], args.value['isCropRatio'], args.value['points'], args.value['isPreventDrag'], args.value['saveContext'], args.value['isPreventSelection']);\n                break;\n            case 'updateActiveObject':\n                this.updateActiveObject(args.value['actPoint'], args.value['obj'], args.value['isMouseMove'], args.value['x'], args.value['y']);\n                break;\n            case 'clearOuterCanvas':\n                this.clearOuterCanvas(args.value['context']);\n                break;\n            case 'setDestPoints':\n                this.setDestPoints();\n                break;\n            case 'updateCurrTransState':\n                this.updateCurrTransState(args.value['type'], args.value['isPreventDestination'], args.value['isRotatePan']);\n                break;\n            case 'currTransState':\n                this.currTransState(args.value['type'], args.value['isPreventDestination'], args.value['context'], args.value['isPreventCircleCrop']);\n                break;\n            case 'setTransform':\n                this.setTransform(args.value['context'], args.value['value'], args.value['isReverse']);\n                break;\n            case 'render-image':\n                this.renderImage(args.value['isMouseWheel'], args.value['isPreventClearRect'], args.value['isFrame'], args.value['isStraighten']);\n                break;\n            case 'draw-image-to-canvas':\n                this.drawImgToCanvas(args.value['dimension']);\n                break;\n            case 'update-canvas':\n                this.updateCanvas();\n                break;\n            case 'performCancel':\n                this.performCancel(args.value['isContextualToolbar'], args.value['isUndoRedo']);\n                break;\n            case 'updateFlipPan':\n                this.updateFlipPan(args.value['tempSelectionObj']);\n                break;\n            case 'select':\n                this.select(args.value['type'], args.value['startX'], args.value['startY'], args.value['width'], args.value['height']);\n                break;\n            case 'callUpdateCurrTransState':\n                this.callUpdateCurrTransState();\n                break;\n            case 'resetPanPoints':\n                this.resetPanPoints();\n                break;\n            case 'setClientTransDim':\n                this.setClientTransDim(args.value['isPreventDimension']);\n                break;\n            case 'redrawImgWithObj':\n                this.redrawImgWithObj();\n                break;\n            case 'setCurrentObj':\n                this.setCurrentObj(args.value['obj'], args.value['isUndoRedo']);\n                break;\n            case 'performPointZoom':\n                this.performPointZoom(args.value['x'], args.value['y'], args.value['type'], args.value['isResize']);\n                break;\n            case 'open':\n                this.open(args.value['data']);\n                break;\n            case 'isInitialLoading':\n                this.isInitialLoading = args.value['isInitialLoading'];\n                break;\n            case 'isInitialLoaded':\n                this.getInitialLoaded(args.value['object']);\n                break;\n            case 'fileSelect':\n                this.fileSelect(args.value['inputElement'], args.value['args']);\n                break;\n            case 'getFileName':\n                args.value['obj']['fileName'] = this.fileName;\n                args.value['obj']['fileType'] = this.fileType;\n                break;\n            case 'getErrorImage':\n                args.value['obj']['isErrorImage'] = this.isErrorImage;\n                break;\n            case 'getInitialZoomValue':\n                args.value['obj']['initialZoomValue'] = this.initZoomValue;\n                break;\n            case 'setShapeTextInsert':\n                this.isShapeTextInserted = args.value['bool'];\n                break;\n            case 'resetCurrentSelectionPoint':\n                this.currSelPoint = null;\n                break;\n            case 'setRotateZoom':\n                this.isRotateZoom = args.value['isRotateZoom'];\n                break;\n            case 'setTempStrokeSettings':\n                this.tempStrokeSettings = args.value['tempStrokeSettings'];\n                break;\n            case 'setTempTextSettings':\n                this.tempTextSettings = args.value['tempTextSettings'];\n                break;\n            case 'setTempAdjustmentValue':\n                this.tempAdjValue = args.value['tempAdjustmentValue'];\n                break;\n            case 'getTempAdjustmentValue':\n                args.value['obj']['value'] = this.tempAdjValue;\n                break;\n            case 'setTempFilter':\n                this.tempFilter = args.value['tempFilter'];\n                break;\n            case 'setTempUndoRedoStep':\n                this.tempUndoRedoStep = args.value['tempUndoRedoStep'];\n                break;\n            case 'setTempFreehandCounter':\n                this.tempFreehandCounter = args.value['tempFreehandCounter'];\n                break;\n            case 'setTempCurrentFreehandDrawIndex':\n                this.tempCurrFhdIndex = args.value['tempCurrentFreehandDrawIndex'];\n                break;\n            case 'setTempZoomFactor':\n                this.tempZoomFactor = args.value['tempZoomFactor'];\n                break;\n            case 'setCancelAction':\n                this.isCancelAction = args.value['bool'];\n                break;\n            case 'getRotatedFlipCropSelection':\n                args.value['bool']['isSelected'] = this.rotatedFlipCropSel;\n                break;\n            case 'getPrevActObj':\n                args.value['obj']['prevActObj'] = this.prevActObj;\n                break;\n            case 'setPrevActObj':\n                this.prevActObj = args.value['prevActObj'];\n                break;\n            case 'setZoomCropWidth':\n                this.zoomCrop.width = args.value['width'];\n                this.zoomCrop.height = args.value['height'];\n                break;\n            case 'setImageEdited':\n                this.isImageEdited = true;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'dlgBtnClick':\n                this.dlgBtnClick();\n                break;\n            case 'dlgCloseBtnClick':\n                this.dlgCloseBtnClick();\n                break;\n            case 'setNewPath':\n                this.isNewPath = args.value['bool'];\n                break;\n            case 'getNewPath':\n                args.value['obj']['isNewPath'] = this.isNewPath;\n                break;\n            case 'getArrowDimension':\n                args.value['obj']['arrowDimension'] = this.arrowDimension;\n                break;\n            case 'setArrowDimension':\n                this.arrowDimension = args.value['arrowDimension'];\n                break;\n            case 'moveToSelectionRange':\n                this.moveToSelectionRange(args.value['type'], args.value['activeObj']);\n                break;\n            case 'setResizeSelect':\n                this.isResizeSelect = args.value['bool'];\n                break;\n            case 'applyFrame':\n                this.applyFrame(args.value['ctx'], args.value['frame'], args.value['preventImg']);\n                break;\n            case 'drawImage':\n                this.drawImage();\n                break;\n            case 'downScaleImgCanvas':\n                this.downScaleImgCanvas(args.value['ctx'], args.value['isImgAnnotation'], args.value['isHFlip'], args.value['isVFlip']);\n                break;\n            case 'downScale':\n                this.downScale(args.value['canvas'], args.value['width'], args.value['height']);\n                break;\n            case 'resetFrameZoom':\n                this.resetFrameZoom(args.value['isOk']);\n                break;\n            case 'triggerFrameChange':\n                args.value['obj']['frameChangeEventArgs'] = this.triggerFrameChange(args.value['prevFrameSettings']);\n                break;\n            case 'setImageApply':\n                this.isImageApply = args.value['bool'];\n                break;\n            case 'zoomToSel':\n                this.zoomToSel(args.value['activeObj'], args.value['isToolbar']);\n                break;\n            case 'getStraightenActObj':\n                args.value['obj']['activeObj'] = this.straightenActObj;\n                break;\n            case 'setStraightenActObj':\n                this.straightenActObj = args.value['activeObj'];\n                break;\n            case 'updateImgCanvasPoints':\n                this.updateImgCanvasPoints();\n                break;\n            case 'isLinesIntersect':\n                args.value['obj']['isIntersect'] = this.isLinesIntersect(args.value['obj']);\n                break;\n            case 'getImageCanvasPoints':\n                args.value['obj']['points'] = this.imgCanvasPoints;\n                break;\n            case 'setDestForStraighten':\n                this.setDestForStraighten();\n                break;\n            case 'setTempDestForStraighten':\n                this.tempStraightenDestPoints = extend({}, this.straightenDestPoints, {}, true);\n                break;\n            case 'getStraightenInitZoom':\n                args.value['obj']['zoomFactor'] = this.straightenInitZoom;\n                break;\n            case 'setStraightenInitZoom':\n                this.straightenInitZoom = args.value['zoomFactor'];\n                break;\n            case 'isPointsInsideImg':\n                args.value['obj']['bool'] = this.checkPointPosition(args.value['x'], args.value['y'], this.imgCanvasPoints[0].x, this.imgCanvasPoints[0].y, this.imgCanvasPoints[1].x, this.imgCanvasPoints[1].y, this.imgCanvasPoints[2].x, this.imgCanvasPoints[2].y, this.imgCanvasPoints[3].x, this.imgCanvasPoints[3].y) !== 'inside';\n                break;\n            case 'setIsCropSelect':\n                this.isCropSelect = args.value['bool'];\n                break;\n            case 'updateCropSelection':\n                this.updateCropSelection();\n                break;\n            case 'updateCropSelObj':\n                this.updateCropSelObj();\n                break;\n            case 'redrawDownScale':\n                this.redrawDownScale();\n                break;\n            case 'updateFinetune':\n                this.updateFinetune();\n                break;\n            case 'isSelOutsideImg':\n                args.value['obj']['bool'] = this.isSelOutsideImg();\n                break;\n            case 'resetStraightenDestPoints':\n                this.straightenDestPoints = null;\n                break;\n            case 'checkPointPosition':\n                args.value['obj']['position'] = this.checkPointPosition(args.value['obj']['x'], args.value['obj']['y'], args.value['obj']['x1'], args.value['obj']['y1'], args.value['obj']['x2'], args.value['obj']['y2'], args.value['obj']['x3'], args.value['obj']['y3'], args.value['obj']['x4'], args.value['obj']['y4']);\n                break;\n        }\n    };\n    Draw.prototype.getModuleName = function () {\n        return 'draw';\n    };\n    Draw.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.tempZoomFactor)) {\n            this.tempZoomFactor = parent.transform.zoomFactor;\n        }\n        if (this.tempTextSettings.fontFamily === '') {\n            this.tempTextSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Draw.prototype.reset = function () {\n        this.isInitialLoading = this.isErrorImage = this.isNewPath = this.isResizeSelect = false;\n        this.isShapeTextInserted = false;\n        this.isImageApply = false;\n        this.initZoomValue = null;\n        this.tempFilter = '';\n        this.origDim = { width: 0, height: 0 };\n        this.currSelPoint = null;\n        this.isRotateZoom = false;\n        this.tempAdjValue = '';\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.tempTextSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.tempUndoRedoStep = this.tempFreehandCounter = this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null;\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.prevActObj = null;\n        this.tempStraightenDestPoints = null;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.straightenActObj = null;\n        this.imgCanvasPoints = [];\n        this.straightenInitZoom = null;\n        this.straightenDestPoints = null;\n        this.isCropSelect = this.isDownScale = this.preventStraightening = false;\n    };\n    Draw.prototype.redrawDownScale = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.isDownScale = true;\n            this.renderImage();\n            this.isDownScale = false;\n            if (activeObj.shape) {\n                this.drawObject('duplicate', activeObj);\n            }\n        }\n    };\n    Draw.prototype.updateFinetune = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var filter = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('draw', { prop: 'redrawDownScale' });\n            var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n            var ctx = this.lowerContext;\n            var imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n            parent.inMemoryCanvas.width = imageData.width;\n            parent.inMemoryCanvas.height = imageData.height;\n            inMemoryContext.putImageData(imageData, 0, 0);\n            this.lowerContext.filter = filter;\n            parent.notify('draw', { prop: 'redrawDownScale' });\n        }\n    };\n    Draw.prototype.drawImage = function () {\n        this.applyFrame(this.lowerContext, this.parent.frameObj.type);\n    };\n    Draw.prototype.drawObject = function (canvas, obj, isCropRatio, points, isPreventDrag, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = parent.activeObj.activePoint;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var canvasDraw;\n        canvas = canvas.toLowerCase();\n        if (canvas === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        if (!isPreventDrag && actObj.shape) {\n            this.setDragLimit();\n        }\n        if (parent.currObjType.shape) {\n            var splitWords = parent.currObjType.shape.split('-');\n            if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n                this.drawCropRatio();\n            }\n        }\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actObj.strokeSettings)) {\n            var obj_1 = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n            actObj.strokeSettings = obj_1['strokeSettings'];\n        }\n        if (isNullOrUndefined(actObj.strokeSettings.strokeWidth)) {\n            actObj.strokeSettings.strokeWidth = 2;\n        }\n        if (obj) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n        if (points) {\n            actPoint.startX = points.startX;\n            actPoint.startY = points.startY;\n            actPoint.endX = points.endX;\n            actPoint.endY = points.endY;\n            actPoint.width = points.width;\n            actPoint.height = points.height;\n        }\n        this.updateActiveObject();\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actPoint.startX) && isNullOrUndefined(actPoint.startY)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var obj_2 = { keyHistory: '' };\n            parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: obj_2 } });\n            actObj.keyHistory = obj_2['keyHistory'];\n        }\n        var isCrop = false;\n        if (canvas !== 'original') {\n            var splitWords = void 0;\n            if (actObj.shape) {\n                splitWords = actObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                if (points) {\n                    actPoint.startX = points.startX;\n                    actPoint.startY = points.startY;\n                    actPoint.endX = points.endX;\n                    actPoint.endY = points.endY;\n                    actPoint.width = points.width;\n                    actPoint.height = points.height;\n                }\n                else {\n                    actPoint = actObj.activePoint;\n                }\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n                this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n            }\n            if (isNullOrUndefined(isPreventSelection) && (canvasDraw === this.lowerContext || canvasDraw === this.upperContext)) {\n                this.rotateContext('initial', canvasDraw);\n                this.drawOuterSelection(canvasDraw);\n                this.rotateContext('reverse', canvasDraw);\n            }\n        }\n        parent.currObjType.isActiveObj = true;\n        var object = { keyHistory: '' };\n        parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: object } });\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape, saveContext, isPreventSelection);\n        }\n        else if (object['keyHistory'] !== '' && parent.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text', saveContext, isPreventSelection);\n        }\n        else if (actObj.shape) {\n            this.drawShapeObj(canvas, actObj.shape, saveContext, isPreventSelection);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined, saveContext, isPreventSelection);\n        }\n        if (canvas === 'duplicate' && isCrop && actObj.shape !== 'crop-circle' && parent.frameObj.type !== 'none') {\n            this.applyFrame(this.upperContext, parent.frameObj.type);\n            this.drawCornerCircles(this.upperContext);\n        }\n    };\n    Draw.prototype.rotateContext = function (type, ctx) {\n        var parent = this.parent;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        var _c = parent.activeObj.activePoint, startX = _c.startX, startY = _c.startY, width = _c.width, height = _c.height;\n        if (shape === 'line' || shape === 'arrow') {\n            return;\n        }\n        var rotationAngle = (type === 'initial') ? rotatedAngle : -rotatedAngle;\n        var translateX;\n        var translateY;\n        if (parent.transform.straighten === 0 && !parent.isCropTab) {\n            translateX = startX + (width / 2);\n            translateY = startY + (height / 2);\n        }\n        else {\n            translateX = destLeft + (destWidth / 2);\n            translateY = destTop + (destHeight / 2);\n        }\n        ctx.translate(translateX, translateY);\n        ctx.rotate(rotationAngle);\n        ctx.translate(-translateX, -translateY);\n    };\n    Draw.prototype.setDragLimit = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        if (actPoint && shape !== 'image' && shape !== 'line' && rotatedAngle === 0) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            if (actPoint.startX < destLeft) {\n                actPoint.startX = destLeft;\n                actPoint.endX = Math.min(actPoint.startX + actPoint.width, destLeft + destWidth);\n            }\n            else if (actPoint.endX > destLeft + destWidth) {\n                actPoint.endX = destLeft + destWidth;\n                actPoint.startX = Math.max(actPoint.endX - actPoint.width, destLeft);\n            }\n            if (actPoint.startY < destTop) {\n                actPoint.startY = destTop;\n            }\n            else if (actPoint.endY > destTop + destHeight) {\n                actPoint.endY = destTop + destHeight;\n                actPoint.startY = Math.max(actPoint.endY - actPoint.height, destTop);\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.drawCropRatio = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x;\n        var y;\n        var width;\n        var height;\n        var canvasWidth = parent.lowerCanvas.clientWidth;\n        var canvasHeight = parent.lowerCanvas.clientHeight + 1;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.zoomFactor > 0 && this.currSelPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.drawCustomSelection('crop-custom', null, null, null, null);\n            if (parent.transform.straighten !== 0) {\n                actPoint = parent.activeObj.activePoint;\n            }\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = actPoint.width < actPoint.height ? actPoint.width : actPoint.height;\n                height = width;\n            }\n            else {\n                if (destLeft + destLeft + destWidth <= canvasWidth) {\n                    width = actPoint.width;\n                }\n                else {\n                    width = parent.transform.straighten === 0 ? canvasWidth - destLeft : actPoint.width;\n                }\n                if (destTop + destTop + destHeight <= canvasHeight) {\n                    height = actPoint.height;\n                }\n                else {\n                    height = parent.transform.straighten === 0 ? canvasHeight - destTop : actPoint.height;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.activeObj = activeObj;\n            parent.currObjType.shape = activeObj.shape;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isCustomCrop = false;\n        }\n        else {\n            width = destWidth;\n            height = destHeight;\n            if (destLeft < 0) {\n                width += destLeft;\n            }\n            if (destTop < 0) {\n                height += destTop;\n            }\n            if (destLeft + destWidth > parent.lowerCanvas.width) {\n                width -= (destLeft + destWidth - parent.lowerCanvas.width);\n            }\n            if (destTop + destHeight > parent.lowerCanvas.height) {\n                height -= (destTop + destHeight - parent.lowerCanvas.height);\n            }\n        }\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                parent.notify('selection', { prop: 'setDragDirection', onPropertyChange: false, value: { width: width, height: height } });\n                actPoint = parent.activeObj.activePoint;\n                if (parent.lowerCanvas.width < (actPoint.endX - actPoint.startX)) {\n                    actPoint.startX = 7.5;\n                    actPoint.endX = parent.lowerCanvas.width - 7.5;\n                }\n                if (parent.lowerCanvas.height < (actPoint.endY - actPoint.startY)) {\n                    actPoint.startY = 7.5;\n                    actPoint.endY = parent.lowerCanvas.height - 7.5;\n                }\n                if (width === destWidth && height === destHeight) {\n                    actPoint.startX += destLeft;\n                    actPoint.startY += destTop;\n                    actPoint.endX += destLeft;\n                    actPoint.endY += destTop;\n                }\n                if (parent.lowerCanvas.width > parent.lowerCanvas.height) {\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    actPoint.width = actPoint.height;\n                    actPoint.endX = actPoint.startX + actPoint.width;\n                }\n                else {\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.width;\n                    actPoint.endY = actPoint.startY + actPoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n            case 'crop-2:3':\n                x = 2;\n                y = 3;\n                break;\n            case 'crop-3:4':\n                x = 3;\n                y = 4;\n                break;\n            case 'crop-4:5':\n                x = 4;\n                y = 5;\n                break;\n            case 'crop-5:7':\n                x = 5;\n                y = 7;\n                break;\n            case 'crop-9:16':\n                x = 9;\n                y = 16;\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            parent.notify('selection', { prop: 'calcShapeRatio', onPropertyChange: false,\n                value: { x: x, y: y, imgWidth: width, imgHeight: height } });\n            if (width === destWidth && height === destHeight) {\n                this.updatePoints();\n            }\n            actPoint = parent.activeObj.activePoint;\n        }\n        if (actPoint.startX < destLeft) {\n            var diff = (destLeft - actPoint.startX) + 7.5;\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        if (actPoint.startY < destTop) {\n            var diff = (destTop - actPoint.startY) + 7.5;\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        this.adjToCenter();\n        this.enlargeToImg();\n        if (parent.transform.straighten !== 0) {\n            this.adjToStraighten();\n            this.updateActiveObject(parent.activeObj.activePoint, parent.activeObj);\n        }\n        var object = { isIntersect: null, arr: null };\n        var count = 0;\n        actPoint = parent.activeObj.activePoint;\n        if (parent.transform.straighten !== 0) {\n            while (this.isLinesIntersect(object) && count < 100) {\n                count++;\n                var diff = (actPoint.width * 1) / 100;\n                actPoint.startX += diff;\n                actPoint.endX -= diff;\n                diff = (actPoint.height * 1) / 100;\n                actPoint.startY += diff;\n                actPoint.endY -= diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n        }\n        this.straightenInitZoom = parent.transform.zoomFactor;\n        this.straightenActObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n        parent.notify('draw', { prop: 'setDestForStraighten' });\n    };\n    Draw.prototype.adjToCenter = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var diffX = ((parent.lowerCanvas.width) / 2) - (actPoint.endX - actPoint.width / 2);\n        var diffY = ((parent.lowerCanvas.height) / 2) - (actPoint.endY - actPoint.height / 2);\n        actPoint.startX += diffX;\n        actPoint.endX += diffX;\n        actPoint.startY += diffY;\n        actPoint.endY += diffY;\n        if (actPoint.startX < (destLeft >= 7.5 ? destLeft : 7.5)) {\n            var diff = ((destLeft >= 7.5 ? destLeft : 0) - actPoint.startX);\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        else if (actPoint.endX > destLeft + destWidth) {\n            var diff = (actPoint.endX - (destLeft + destWidth));\n            actPoint.startX -= diff;\n            actPoint.endX -= diff;\n        }\n        if (actPoint.startY < (destTop >= 7.5 ? destTop : 7.5)) {\n            var diff = ((destTop >= 7.5 ? destTop : 0) - actPoint.startY);\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        else if (actPoint.endY > destTop + destHeight) {\n            var diff = (actPoint.endY - (destTop + destHeight));\n            actPoint.startY -= diff;\n            actPoint.endY -= diff;\n        }\n    };\n    Draw.prototype.enlargeToImg = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            var actPoint = parent.activeObj.activePoint;\n            var tempActPoint = extend({}, actPoint, {}, true);\n            var count = 0;\n            while (true) {\n                // Increase width and height by 5% from center to enlarge the crop selection\n                count++;\n                var diff = (actPoint.width * 5) / 100;\n                actPoint.startX -= diff;\n                actPoint.endX += diff;\n                diff = (actPoint.height * 5) / 100;\n                actPoint.startY -= diff;\n                actPoint.endY += diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n                var object = { isIntersect: null, arr: null };\n                this.updateImgCanvasPoints();\n                this.isLinesIntersect(object);\n                if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] ||\n                    actPoint.startX < 7.5 || actPoint.startY < 7.5 || count === 100) {\n                    actPoint = extend({}, tempActPoint, {}, true);\n                    diff = (actPoint.width * 1) / 100;\n                    actPoint.startX += diff;\n                    actPoint.endX -= diff;\n                    diff = (actPoint.height * 1) / 100;\n                    actPoint.startY += diff;\n                    actPoint.endY -= diff;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    this.updateActiveObject(actPoint, parent.activeObj);\n                    break;\n                }\n                tempActPoint = extend({}, actPoint, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateActiveObject = function (actPoint, obj, isMouseMove, x, y) {\n        var parent = this.parent;\n        actPoint = actPoint ? actPoint : extend({}, parent.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, parent.activeObj, {}, true);\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var startX = actPoint.startX, startY = actPoint.startY, endX = actPoint.endX, endY = actPoint.endY, width = actPoint.width, height = actPoint.height;\n        x = x ? x : 0;\n        y = y ? y : 0;\n        var horCircleWidth = width / 2;\n        var verCircleHeight = height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: startX + x, startY: startY - y,\n            endX: endX + x, endY: endY + y };\n        obj.horBottomLine = { startX: startX - x, startY: endY - y,\n            endX: endX - x, endY: endY + y };\n        obj.verLeftLine = { startX: startX + x, startY: startY - y,\n            endX: startX - y, endY: endY - y };\n        obj.verRightLine = { startX: endX + x, startY: startY + y,\n            endX: endX - x, endY: endY + y };\n        obj.topLeftCircle = { startX: startX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topCenterCircle = { startX: startX + horCircleWidth, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topRightCircle = { startX: endX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerLeftCircle = { startX: startX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerRightCircle = { startX: endX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomLeftCircle = { startX: startX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomCenterCircle = { startX: startX + horCircleWidth, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomRightCircle = { startX: endX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        if (obj.rotatedAngle === 0) {\n            obj.rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                y: obj.bottomCenterCircle.startY + 25 };\n            obj.rotationCirclePoint.ratioX = (obj.rotationCirclePoint.x - parent.img.destLeft) / parent.img.destWidth;\n            obj.rotationCirclePoint.ratioY = (obj.rotationCirclePoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    Draw.prototype.drawOuterSelection = function (canvasDraw, isCropCircle) {\n        var splitWords;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth = (0.5);\n        var tempObj = extend({}, actObj, {}, true);\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (((splitWords && splitWords[0] === 'crop') || actObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n            this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n        }\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.fillStyle = parent.themeColl[parent.theme]['secondaryColor'];\n        var degree;\n        if (tempObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - tempObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else if (actObj.shape === 'path') {\n            canvasDraw.beginPath();\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl[0]) {\n                canvasDraw.moveTo(activeObj.pointColl[0].x, activeObj.pointColl[0].y);\n                if (activeObj.pointColl.length > 1) {\n                    for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                        actPoint.endX = activeObj.pointColl[i].x;\n                        actPoint.endY = activeObj.pointColl[i].y;\n                        canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n                    }\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else {\n            this.drawCornerCircles(canvasDraw);\n        }\n        if (parent.selectionSettings.showCircle && (splitWords === undefined || splitWords[0] !== 'crop')) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            if (actObj.shape === 'text') {\n                canvasDraw.lineWidth *= 2;\n                canvasDraw.beginPath();\n                this.drawRotationArcLine(canvasDraw);\n                canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.beginPath();\n                canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.lineWidth /= 2;\n            }\n            else {\n                this.drawCenterCircles(canvasDraw);\n            }\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n        tempObj.rotationCircleLine = actObj.rotationCircleLine;\n        parent.activeObj = extend({}, tempObj, {}, true);\n    };\n    Draw.prototype.drawArrowHead = function (canvasDraw, isStartHead) {\n        var headType = isStartHead ? this.parent.activeObj.start : this.parent.activeObj.end;\n        switch (headType) {\n            case 'arrowSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSolid(canvasDraw, true) : this.arrowSolid(canvasDraw, false);\n                break;\n            case 'arrow':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrow(canvasDraw, true) : this.arrow(canvasDraw, false);\n                break;\n            case 'circleSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircleSolid(canvasDraw, true) : this.arrowCircleSolid(canvasDraw, false);\n                break;\n            case 'circle':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircle(canvasDraw, true) : this.arrowCircle(canvasDraw, false);\n                break;\n            case 'bar':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowBar(canvasDraw, true) : this.arrowBar(canvasDraw, false);\n                break;\n            case 'square':\n            case 'squareSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSquareStart(canvasDraw) : this.arrowSquareEnd(canvasDraw);\n                break;\n        }\n    };\n    Draw.prototype.drawShapeObj = function (canvas, shape, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        var _a = actObj.strokeSettings, strokeColor = _a.strokeColor, fillColor = _a.fillColor, strokeWidth = _a.strokeWidth;\n        var currentShape = shape !== undefined ? shape : parent.currObjType.shape;\n        parent.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        var shapeType = parent.currObjType.shape.toLowerCase();\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image'];\n        if (shapeColl.indexOf(shapeType) !== -1) {\n            actObj.shape = parent.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = fillColor;\n        }\n        var horLineWidth = actPoint.width / 3;\n        var verLineHeight = actPoint.height / 3;\n        var selectionWidth = actPoint.endX - actPoint.startX;\n        var selectionHeight = actPoint.endY - actPoint.startY;\n        this.rotateContext('initial', canvasDraw);\n        var degree;\n        var tempFillStyle = canvasDraw.fillStyle;\n        var activeObj;\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'ellipse':\n                selectionWidth = Math.abs(selectionWidth);\n                selectionHeight = Math.abs(selectionHeight);\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (fillColor !== '') {\n                    canvasDraw.fillStyle = fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), Math.abs((selectionWidth / 2) - (strokeWidth)), Math.abs((selectionHeight / 2) - (strokeWidth)), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'arrow':\n                if (actObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - actObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                canvasDraw.fillStyle = canvasDraw.strokeStyle;\n                if (isNullOrUndefined(actObj.triangleDirection)) {\n                    actObj.triangleDirection = 'right';\n                }\n                if (isNullOrUndefined(actObj.start)) {\n                    actObj.start = 'none';\n                }\n                if (isNullOrUndefined(actObj.end)) {\n                    actObj.end = 'arrowSolid';\n                }\n                this.drawArrowHead(canvasDraw, true);\n                this.drawArrowHead(canvasDraw, false);\n                if (actObj.end === 'none') {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                canvasDraw.fillStyle = tempFillStyle;\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'path':\n                activeObj = extend({}, parent.activeObj, {}, true);\n                if (activeObj.pointColl.length > 1) {\n                    var obj = { shape: null };\n                    parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n                    if (obj['shape'] === 'path') {\n                        var nextPoint = { x: 0, y: 0 };\n                        for (var i = 0, len = activeObj.pointColl.length; i < len; i++) {\n                            if (isNullOrUndefined(activeObj.pointColl[i + 1])) {\n                                nextPoint.x = activeObj.activePoint.endX;\n                                nextPoint.y = activeObj.activePoint.endY;\n                            }\n                            else {\n                                nextPoint.x = activeObj.pointColl[i + 1].x;\n                                nextPoint.y = activeObj.pointColl[i + 1].y;\n                            }\n                            actPoint.startX = activeObj.pointColl[i].x;\n                            actPoint.startY = activeObj.pointColl[i].y;\n                            actPoint.endX = nextPoint.x;\n                            actPoint.endY = nextPoint.y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    else {\n                        for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                            actPoint.startX = activeObj.pointColl[i - 1].x;\n                            actPoint.startY = activeObj.pointColl[i - 1].y;\n                            actPoint.endX = activeObj.pointColl[i].x;\n                            actPoint.endY = activeObj.pointColl[i].y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    parent.activeObj = actObj = activeObj;\n                }\n                else {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'image':\n                this.shapeImage(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.drawSelection(horLineWidth, verLineHeight);\n                parent.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n        this.rotateContext('reverse', canvasDraw);\n    };\n    Draw.prototype.updatePoints = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop;\n        actPoint.startX += destLeft;\n        actPoint.startY += destTop;\n        actPoint.endX += destLeft;\n        actPoint.endY += destTop;\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n    };\n    Draw.prototype.updateWidthHeight = function (obj) {\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        obj.activePoint.width = endX - startX;\n        obj.activePoint.height = endY - startY;\n        return obj;\n    };\n    Draw.prototype.drawCornerCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var tempObj = parent.activeObj;\n        canvasDraw.beginPath();\n        canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        if (parent.selectionSettings.showCircle) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            canvasDraw.lineWidth *= 2;\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n            canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n            canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n            canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n            canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            canvasDraw.lineWidth /= 2;\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n    };\n    Draw.prototype.drawCenterCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else if (actObj.shape === 'path') {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl.length > 1) {\n                for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                    actPoint.startX = activeObj.pointColl[i - 1].x;\n                    actPoint.startY = activeObj.pointColl[i - 1].y;\n                    actPoint.endX = activeObj.pointColl[i].x;\n                    actPoint.endY = activeObj.pointColl[i].y;\n                    canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n                    canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n                    canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n                    canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else {\n            this.drawRotationArcLine(canvasDraw);\n            canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n        }\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        if (actObj.shape !== 'arrow' && actObj.shape !== 'line' && actObj.shape !== 'path') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n            canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth /= 2;\n    };\n    Draw.prototype.drawRotationArcLine = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        if (isNullOrUndefined(actObj.rotationCircleLine)) {\n            actObj.rotationCircleLine = 22.5;\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.flipObjColl) {\n            for (var i = 0, len = actObj.flipObjColl.length; i < len; i++) {\n                var flipStr = actObj.flipObjColl[i].toLowerCase();\n                if (flipStr === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (flipStr === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        switch (degree) {\n            case 0:\n            case 360:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                break;\n            case 90:\n            case -270:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n            case 180:\n            case -180:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                break;\n            case 270:\n            case -90:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n        }\n    };\n    Draw.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var _b = actObj.strokeSettings, fillColor = _b.fillColor, strokeColor = _b.strokeColor, strokeWidth = _b.strokeWidth;\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = strokeColor;\n        }\n        canvasDraw.beginPath();\n        canvasDraw.rect(startX, startY, width, height);\n        if (fillColor !== '') {\n            canvasDraw.fillStyle = fillColor;\n            canvasDraw.fill();\n        }\n        canvasDraw.rect(startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth));\n        canvasDraw.fillStyle = strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        this.upperContext.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        actObj.horTopInnerLine = { startX: startX, startY: startY +\n                verLineHeight, endX: endX, endY: endY + verLineHeight };\n        actObj.horBottomInnerLine = { startX: startX, startY: startY + (2 * verLineHeight), endX: endX, endY: endY + (2 * verLineHeight) };\n        actObj.verLeftInnerLine = { startX: startX + horLineWidth,\n            startY: startY, endX: startX + horLineWidth, endY: endY };\n        actObj.verRightInnerLine = { startX: startX + (2 * horLineWidth),\n            startY: startY, endX: startX + (2 * horLineWidth), endY: endY };\n        this.upperContext.moveTo(actObj.horTopInnerLine.startX, actObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(actObj.horTopInnerLine.endX, actObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(actObj.horBottomInnerLine.startX, actObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(actObj.horBottomInnerLine.endX, actObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(actObj.verLeftInnerLine.startX, actObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(actObj.verLeftInnerLine.endX, actObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(actObj.verRightInnerLine.startX, actObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(actObj.verRightInnerLine.endX, actObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    Draw.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width;\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.25)';\n        canvasDraw.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2);\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(parent.activeObj.horTopLine.startX + (selectionWidth / 2), parent.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((endX - startX) / 2) + startX, ((endY - startY) / 2) + startY, (width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, true);\n        parent.currObjType.shape = '';\n    };\n    Draw.prototype.shapeLine = function (canvasDraw, x1, y1, x2, y2) {\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.parent.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(x1, y1);\n        canvasDraw.lineTo(x2, y2);\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    Draw.prototype.manipulateSaveCtx = function (canvasDraw, x, y) {\n        if (canvasDraw !== this.lowerContext && canvasDraw !== this.upperContext) {\n            var obj = { width: 0, height: 0 };\n            this.parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            var ratio = obj;\n            if (x) {\n                x *= (ratio.width);\n            }\n            if (y) {\n                y *= (ratio.height);\n            }\n        }\n        return { x: x, y: y };\n    };\n    Draw.prototype.arrow = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        canvasDraw.lineWidth = strWidth;\n        var x = this.arrowDimension['arrow']['width'];\n        var y = this.arrowDimension['arrow']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrow = actObj.start === 'arrow';\n        var isEndArrow = actObj.end === 'arrow';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        if ((start && actObj.triangleDirection === 'left' || actObj.triangleDirection === 'right') &&\n            ((isStartArrow && actObj.end === 'none') || (isStartArrow && !isEndCircleOrSquare)) ||\n            (!start && (isEndArrow && actObj.start === 'none' || !isStartArrow && !isEndCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, -x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, -x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n        }\n    };\n    Draw.prototype.arrowSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var x = this.arrowDimension['arrowSolid']['width'];\n        var y = this.arrowDimension['arrowSolid']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrowSolid = actObj.start === 'arrowSolid';\n        var isEndArrowSolid = actObj.end === 'arrowSolid';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        if ((start && (isStartArrowSolid && actObj.end === 'none') || (isStartArrowSolid && !isEndCircleOrSquare)) ||\n            (!start && (isEndArrowSolid && actObj.start === 'none' || !isStartArrowSolid && !isEndCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(strWidth, 0);\n            canvasDraw.lineTo(-x + y / 2, y / 2);\n            canvasDraw.lineTo(-x + y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(0 - strWidth, 0);\n            canvasDraw.lineTo(x - y / 2, y / 2);\n            canvasDraw.lineTo(x - y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowSquareStart = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartSquare = actObj.start === 'square';\n        var isEndCircle = actObj.end === 'circle';\n        var isStartSquareSolid = actObj.start === 'squareSolid';\n        var isEndCircleSolid = actObj.end === 'circleSolid';\n        if ((isStartSquare && actObj.end === 'none') || (isStartSquare && !isEndCircle && actObj.start !== 'square') ||\n            (isStartSquareSolid && isEndCircleSolid)) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        canvasDraw.lineWidth = (strWidth);\n        canvasDraw.beginPath();\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            this.squareStartIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n        }\n        else if (actObj.triangleDirection === 'right') {\n            canvasDraw.lineWidth = (strWidth);\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareStartIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowSquareEnd = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        canvasDraw.lineWidth = (strWidth);\n        if (actObj.triangleDirection === 'right') {\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.end === 'squareSolid' && actObj.start === 'none') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n        else if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowCircle = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') ||\n            (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (startX - endX) + this.dy * (startY - endY));\n            var c = (startX - endX) * (startX - endX) + (startY - endY) *\n                (startY - endY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = startX + this.dx * t2;\n                var intersectionY1 = startY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.startCircleIntersectX1, this.startCircleIntersectY1, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, startX, startY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    canvasDraw.stroke();\n                    canvasDraw.closePath();\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, startX, startY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') ||\n            (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = startX - endX;\n            this.dy = startY - endY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (endX - startX) + this.dy * (endY - startY));\n            var c = (endX - startX) * (endX - startX) + (endY - startY) *\n                (endY - startY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = endX + this.dx * t2;\n                var intersectionY1 = endY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, endX, endY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, endX, endY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowCircleSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartCircleSolid = actObj.start === 'circleSolid';\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                (!start && (actObj.end === 'circleSolid' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                !start && (actObj.end === 'circleSolid' && actObj.start === 'none')) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n    };\n    Draw.prototype.arrowBar = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none') ||\n                (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && ((actObj.end === 'bar' && actObj.start === 'none') ||\n                    (actObj.end === 'bar' && (actObj.start !== 'circle' && actObj.start !== 'square'))))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(-x + y / 4, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none')\n                || (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && (actObj.end === 'bar' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(y / 4 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.shapeImage = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var ctx = actObj.imageCanvas.getContext('2d');\n        if (canvasDraw === this.lowerContext && this.isImageApply) {\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actObj\n                        .imageElement.width, height: actObj.imageElement.height, obj: dimObj, isImgShape: null } });\n            if (width < (dimObj['width'] / 5) || height < (dimObj['height'] / 5)) {\n                ctx.clearRect(0, 0, actObj.imageCanvas.width, actObj.imageCanvas.height);\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: false } });\n                this.isImageApply = false;\n            }\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = width;\n        imgPoint.height = height;\n        if (actObj.flipObjColl.length === 4) {\n            actObj.flipObjColl = [];\n            actObj.shapeFlip = '';\n        }\n        imgPoint.startX = ((width - imgPoint.width) / 2) + startX;\n        imgPoint.startY = ((height - imgPoint.height) / 2) + startY;\n        var temp = canvasDraw.globalAlpha;\n        canvasDraw.globalAlpha = actObj.opacity;\n        if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n            this.rotateImage(canvasDraw);\n        }\n        else {\n            canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        }\n        canvasDraw.globalAlpha = temp;\n        parent.currObjType.isText = false;\n    };\n    Draw.prototype.shapeText = function (canvasDraw) {\n        var parent = this.parent;\n        var filter = canvasDraw.filter;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var rows = actObj.keyHistory.split('\\n');\n        var _b = actObj.textSettings, fontFamily = _b.fontFamily, bold = _b.bold, italic = _b.italic;\n        var fontSize = actObj.textSettings.fontSize;\n        var lHeight = fontSize + fontSize * 0.25;\n        var lineHeight = ((lHeight * rows.length) - (fontSize * rows.length)) / rows.length;\n        canvasDraw.filter = 'none';\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * fontSize * 0.85) + (i * lineHeight);\n            if (parent.transform.degree === -360) {\n                parent.transform.degree = 0;\n            }\n            if (parent.transform.degree === 0 || parent.transform.degree === 180) {\n                if (fontSize > height) {\n                    fontSize = actObj.textSettings.fontSize = height - (height * 0.1);\n                }\n            }\n            else {\n                if (fontSize > width) {\n                    fontSize = actObj.textSettings.fontSize = width - (width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = actObj.strokeSettings.strokeColor;\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            var textStyle = '';\n            if (bold) {\n                textStyle = 'bold ';\n            }\n            if (italic) {\n                textStyle = 'italic ';\n            }\n            if (bold && italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n            if (actObj.flipObjColl.length === 4) {\n                actObj.flipObjColl = [];\n                actObj.shapeFlip = '';\n            }\n            if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.fillText(text, startX + fontSize * 0.1, startY + yPoint);\n            }\n        }\n        canvasDraw.filter = filter;\n        parent.currObjType.isText = false;\n    };\n    Draw.prototype.updateActPoint = function (degree, canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = actObj.activePoint;\n        if (degree.toLowerCase() === 'horizontal') {\n            if (actPoint.startX <= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width / 2 + ((canvasDraw.canvas.width / 2) - actPoint.endX);\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startX >= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width - actPoint.endX;\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (actPoint.startY <= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height / 2 + ((canvasDraw.canvas.height / 2) - actPoint.endY);\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startY >= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height - actPoint.endY;\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        return actPoint;\n    };\n    Draw.prototype.rotateImage = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.width :\n            actObj.activePoint.height;\n        imgPoint.startX = actObj.activePoint.startX;\n        imgPoint.startY = actObj.activePoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                if (actObj.shapeDegree === 0) {\n                    tempDegree = coll;\n                }\n                else {\n                    tempDegree = coll - actObj.shapeDegree;\n                }\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.width :\n                    actObj.activePoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = canvasDraw.canvas.width - (actObj.activePoint.startX + actObj.activePoint.width);\n                    startY += ((actObj.activePoint.width - imgPoint.height) / 2);\n                    startX = imgPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - (actObj.activePoint.startY + actObj.activePoint.height);\n                    startX += ((actObj.activePoint.height - imgPoint.width) / 2);\n                    startY = imgPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actObj.activePoint.startX = startX;\n                actObj.activePoint.startY = startY;\n                actObj.activePoint.endX = actObj.activePoint.startX + imgPoint.width;\n                actObj.activePoint.endY = actObj.activePoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    actObj.activePoint = this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    actObj.activePoint = this.updateActPoint('vertical', canvasDraw);\n                }\n                imgPoint.startX = actObj.activePoint.startX;\n                imgPoint.startY = actObj.activePoint.startY;\n            }\n            imgPoint.startX = actObj.activePoint.startX;\n            imgPoint.startY = actObj.activePoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.rotateText = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        var actPoint = parent.activeObj.activePoint;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.height : actPoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.width : actPoint.height;\n        imgPoint.startX = actPoint.startX;\n        imgPoint.startY = actPoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                if (actObj.shapeDegree === 0) {\n                    tempDegree = coll;\n                }\n                else {\n                    tempDegree = coll - actObj.shapeDegree;\n                }\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.height : actPoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.width : actPoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = (canvasDraw.canvas.width - actPoint.endX);\n                    startX = actPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - actPoint.endY;\n                    startY = actPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actPoint.startX = startX;\n                actPoint.startY = startY;\n                actPoint.endX = actPoint.startX + imgPoint.width;\n                actPoint.endY = actPoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                }\n                actObj.activePoint = actPoint = this.updateActPoint(coll, canvasDraw);\n                imgPoint.startX = actPoint.startX;\n                imgPoint.startY = actPoint.startY;\n            }\n            imgPoint.startX = actPoint.startX;\n            imgPoint.startY = actPoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        startY += actObj.textSettings.fontSize * 0.4;\n        this.textFlipDegree(canvasDraw, startX, startY);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var rows = actObj.keyHistory.split('\\n');\n        var fontSize = actObj.textSettings.fontSize;\n        var lineHeight = ((fontSize * rows.length) - (fontSize * rows.length)) / rows.length;\n        var yPoint = (fontSize * 0.85) + lineHeight;\n        for (var i = 0, len = rows.length; i < len; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (fontSize * 0.85);\n                }\n                yPoint += fontSize + fontSize * 0.15;\n            }\n            canvasDraw.fillText(text, startX + fontSize * 0.15, startY +\n                yPoint + (i > 0 ? fontSize * 0.25 : -fontSize * 0.35));\n        }\n    };\n    Draw.prototype.clearOuterCanvas = function (context) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var left = destLeft > 0 ? destLeft : 0;\n        var top = destTop > 0 ? destTop : 0;\n        context.clearRect(0, 0, left, parent.lowerCanvas.height);\n        context.clearRect(destLeft + destWidth, 0, parent.lowerCanvas.width - (destLeft + destWidth), parent.lowerCanvas.height);\n        context.clearRect(0, 0, parent.lowerCanvas.width, top);\n        context.clearRect(0, destTop + destHeight, parent.lowerCanvas.width, parent.lowerCanvas.height - (destTop + destHeight));\n        if (parent.transform.currFlipState !== '') {\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n        }\n    };\n    Draw.prototype.setDestPoints = function () {\n        var maxDimension;\n        var parent = this.parent;\n        var _a = parent.transform, degree = _a.degree, zoomFactor = _a.zoomFactor;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcHeight, height: parent.img.srcWidth, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.height;\n                parent.img.destHeight = maxDimension.width;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.height) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.width) / 2;\n            parent.img.destWidth = maxDimension.height;\n            parent.img.destHeight = maxDimension.width;\n        }\n        else {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.width;\n                parent.img.destHeight = maxDimension.height;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            if (degree === 0) {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            }\n            else {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            }\n            parent.img.destWidth = maxDimension.width;\n            parent.img.destHeight = maxDimension.height;\n        }\n    };\n    Draw.prototype.updateCurrTransState = function (type, isPreventDestination, isRotatePan, isStraighten) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        if (type === 'initial') {\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            if (isNullOrUndefined(isPreventDestination)) {\n                this.setDestPoints();\n            }\n        }\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            this.currTransState(type, true, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n            if (isRotatePan) {\n                parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop +=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            if (isRotatePan) {\n                parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop -=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n        }\n        else {\n            this.currTransState(type, null, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n        }\n    };\n    Draw.prototype.currTransState = function (type, isPreventDimension, context, isPreventCircleCrop) {\n        var parent = this.parent;\n        context = context ? context : this.lowerContext;\n        if (type === 'initial') {\n            this.setTransformColl(context, type);\n        }\n        else if (type === 'reverse') {\n            this.setTransformColl(context, type);\n            this.setClientTransDim(isPreventDimension);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle'\n                && isNullOrUndefined(isPreventCircleCrop))) {\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n                }\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop -= parent.panPoint.totalPannedClientPoint.y;\n                }\n            }\n        }\n    };\n    Draw.prototype.setTransformColl = function (context, type) {\n        var parent = this.parent;\n        if (type === 'initial') {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                this.setTransform(context, parent.rotateFlipColl[i]);\n            }\n        }\n        else if (type === 'reverse') {\n            for (var i = parent.rotateFlipColl.length - 1; i >= 0; i--) {\n                this.setTransform(context, parent.rotateFlipColl[i], true);\n            }\n        }\n    };\n    Draw.prototype.setTransform = function (context, value, isReverse) {\n        var parent = this.parent;\n        if (isReverse && value === 90) {\n            value = -90;\n        }\n        else if (isReverse && value === -90) {\n            value = 90;\n        }\n        if (value === 'horizontal' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'vertical';\n        }\n        else if (value === 'vertical' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'horizontal';\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        if (isNullOrUndefined(isReverse)) {\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n        switch (value) {\n            case 90:\n            case -90:\n                context.translate(context.canvas.width / 2, context.canvas.height / 2);\n                context.rotate(Math.PI / 180 * value);\n                context.translate(-context.canvas.width / 2, -context.canvas.height / 2);\n                break;\n            case 'horizontal':\n                context.translate(context.canvas.width, 0);\n                context.scale(-1, 1);\n                break;\n            case 'vertical':\n                context.translate(0, context.canvas.height);\n                context.scale(1, -1);\n                break;\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: false } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n    };\n    Draw.prototype.drawImgToCanvas = function (maxDimension) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.img.destWidth = maxDimension.width;\n        parent.img.destHeight = maxDimension.height;\n        if (this.isInitialLoading) {\n            parent.notify('filter', { prop: 'initFilter', onPropertyChange: false });\n            this.isInitialLoading = false;\n        }\n        var temp = this.lowerContext.filter;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.drawImage();\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.renderImage = function (isMouseWheel, isPreventClearRect, isFrame, isStraighten) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        if (isNullOrUndefined(isPreventClearRect)) {\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        }\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        else {\n            if (parent.transform.zoomFactor !== 0) {\n                this.isRotateZoom = true;\n            }\n            this.updateCurrTransState('initial', null, null, isStraighten);\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        else {\n            this.updateCurrTransState('reverse', null, null, isStraighten);\n            this.isRotateZoom = false;\n        }\n        if (isFrame) {\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        else {\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        this.clearOuterCanvas(this.lowerContext);\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        parent.baseImg.src = src;\n        parent.baseImg.onload = function () {\n            parent.notify('filter', { prop: 'update-finetunes', onPropertyChange: false });\n            proxy.lowerContext.drawImage(parent.baseImg, 0, 0, proxy.parent.lowerCanvas.width, proxy.parent.lowerCanvas.height);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            proxy.updateBaseImgCanvas();\n            var fileOpened = { fileName: _this.fileName, fileType: _this.fileType, isValidImage: true };\n            proxy.updateCanvas();\n            if (parent.currObjType.isUndoZoom) {\n                parent.currObjType.isUndoZoom = false;\n                proxy.parent.lowerCanvas.style.display = 'block';\n            }\n            parent.isUndoRedo = _this.isErrorImage = false;\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: Browser.isDevice, isOkBtn: null,\n                    isResize: null, isFrame: null, isMainToolbar: true };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n                parent.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: false, isOkBtn: null };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            if (parent.isImageLoaded && parent.element.style.opacity !== '0.5') {\n                parent.trigger('fileOpened', fileOpened);\n            }\n        };\n        parent.baseImg.onerror = function () {\n            hideSpinner(parent.element);\n            proxy.isErrorImage = true;\n            proxy.errorLoading();\n        };\n    };\n    Draw.prototype.errorLoading = function () {\n        var parent = this.parent;\n        var fileOpened = { fileName: null, fileType: null, isValidImage: false };\n        parent.trigger('fileOpened', fileOpened);\n    };\n    Draw.prototype.updateBaseImgCanvas = function () {\n        var parent = this.parent;\n        parent.baseImgCanvas.width = parent.baseImg.width;\n        parent.baseImgCanvas.height = parent.baseImg.height;\n        parent.baseImgCanvas.getContext('2d').drawImage(parent.baseImg, 0, 0);\n    };\n    Draw.prototype.updateCanvas = function () {\n        var parent = this.parent;\n        parent.img.srcWidth = parent.baseImgCanvas.width;\n        parent.img.srcHeight = parent.baseImgCanvas.height;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        this.drawImgToCanvas(maxDimension);\n        this.origDim.width = parent.img.destWidth;\n        this.origDim.height = parent.img.destHeight;\n        this.zoomCrop.width = parent.img.destWidth;\n        this.zoomCrop.height = parent.img.destHeight;\n        parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n            value: { width: parent.img.destWidth, height: parent.img.destHeight } });\n        var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        parent.notify('crop', { prop: 'setCropDestPoints', onPropertyChange: false, value: { point: point } });\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if (parent.img.destWidth > 0 && parent.img.destHeight > 0) {\n            parent.isImageLoaded = true;\n        }\n        if (parent.isUndoRedo) {\n            if (parent.transform.currFlipState !== '') {\n                parent.notify('transform', { prop: 'flipImage', onPropertyChange: false,\n                    value: { direction: parent.toPascalCase(parent.transform.currFlipState) } });\n            }\n        }\n        if (parent.disabled) {\n            parent.element.setAttribute('class', 'e-disabled');\n        }\n        if (parent.zoomSettings.zoomFactor !== 1 || parent.zoomSettings.zoomPoint) {\n            parent.zoom(parent.zoomSettings.zoomFactor, parent.zoomSettings.zoomPoint);\n        }\n        if (isNullOrUndefined(this.initZoomValue)) {\n            this.initZoomValue = parent.zoomSettings.zoomFactor;\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.resetFrameZoom = function (isOk) {\n        var parent = this.parent;\n        if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n            var temp = parent.tempFrameZoomLevel;\n            parent.tempFrameZoomLevel = null;\n            parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: temp, zoomPoint: null, isResize: true } });\n            var obj = parent.cancelCropSelection;\n            if (isOk && obj) {\n                obj.previousObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.currentObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.previousObj.frame = obj.currentObj.frame = parent.frameObj.type;\n            }\n            this.updateCropSelObj();\n            parent.cancelCropSelection = null;\n        }\n    };\n    Draw.prototype.performCancel = function (isContextualToolbar, isUndoRedo) {\n        var parent = this.parent;\n        var straightenObj = { bool: parent.isStraightening };\n        isContextualToolbar = isContextualToolbar ? isContextualToolbar : false;\n        var obj = { bool: false };\n        parent.allowDownScale = true;\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (isNullOrUndefined(isUndoRedo) && JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            extend(parent.frameObj, parent.tempFrameObj);\n            this.renderImage(null, null, true);\n        }\n        this.resetFrameZoom(false);\n        if (obj['bool']) {\n            parent.notify('freehand-draw', { prop: 'cancelFhd', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            parent.textArea.style.display = 'none';\n            parent.textArea.value = '';\n            parent.textArea.style.transform = '';\n            if (this.prevActObj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.activeObj.strokeSettings = this.tempStrokeSettings;\n                parent.activeObj.textSettings = this.tempTextSettings;\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            if (this.isShapeTextInserted) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        else if (((!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) &&\n            document.querySelector('#' + parent.element.id + '_sliderWrapper')) || parent.currObjType.isFiltered) {\n            this.lowerContext.filter = this.tempAdjValue;\n            parent.canvasFilter = this.tempAdjValue;\n            parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.tempAdjValue } });\n            parent.initialAdjustmentValue = this.tempAdjValue;\n            if (this.lowerContext.filter.split(' ').length > 1 &&\n                this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: false } });\n            }\n            parent.currentFilter = this.tempFilter;\n            parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.redrawImgWithObj();\n            parent.currObjType.isFiltered = false;\n            var obj_3 = { tempAdjustmentLevel: null };\n            parent.notify('filter', { prop: 'getTempAdjustmentLevel', onPropertyChange: false, value: { obj: obj_3 } });\n            parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false,\n                value: { adjustmentLevel: extend({}, obj_3['tempAdjustmentLevel'], {}, true) } });\n            parent.notify('undo-redo', { prop: 'setUndoRedoStep', onPropertyChange: false, value: { step: this.tempUndoRedoStep } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.isCustomCrop = false;\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.clearOuterCanvas(this.lowerContext);\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            if (parent.activeObj.shape && parent.activeObj.shape === 'image') {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            if (isContextualToolbar && (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool']))) {\n                var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            else {\n                this.cancelItems();\n                if (parent.transform.zoomFactor > 0) {\n                    parent.togglePan = true;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                }\n                else {\n                    parent.togglePan = false;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                }\n            }\n        }\n        this.isShapeTextInserted = false;\n        this.isNewPath = false;\n        parent.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n        parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n    };\n    Draw.prototype.cancelItems = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var id = parent.element.id;\n        var ascpectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n        var splitWords;\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image'];\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && parent.isCropTab) {\n            parent.isCropTab = false;\n            parent.transform.zoomFactor = parent.transform.defaultZoomFactor;\n        }\n        if (parent.isResize) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            if (ascpectIcon || nonAspectIcon || parent.currentToolbar === 'resize-toolbar') {\n                var obj = { width: null, height: null };\n                parent.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj } });\n                var point = { x: obj['width'], y: obj['height'] };\n                var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n                if (point && point.x && point.y && !isNullOrUndefined(parent.aspectWidth)) {\n                    if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                        parent.notify('transform', { prop: 'resizeImage', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                    }\n                    else {\n                        var bool = parent.currObjType.isUndoAction;\n                        parent.currObjType.isUndoAction = false;\n                        parent.notify('transform', { prop: 'resizeCrop', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                        parent.currObjType.isUndoAction = bool;\n                    }\n                }\n                var obj1 = { prevCropObj: parent.prevCropObj };\n                var obj2 = { prevObj: parent.prevObj };\n                parent.notify('toolbar', { prop: 'getPrevCropObj', onPropertyChange: false, value: { obj: obj1 } });\n                parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj2 } });\n                if (obj1['prevCropObj'] && obj2['prevObj']) {\n                    parent.objColl = [];\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.cropObj = extend({}, obj1['prevCropObj'], {}, true);\n                    this.setCurrentObj(obj2['prevObj']);\n                    parent.objColl = obj2['prevObj']['objColl'];\n                    parent.pointColl = obj2['prevObj']['pointColl'];\n                    parent.freehandCounter = parent.pointColl.length;\n                    parent.transform.straighten = 0;\n                    parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                    parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                    var currObj = parent.currSelectionPoint ?\n                        extend({}, parent.currSelectionPoint, {}, true) : null;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                    parent.currSelectionPoint = currObj;\n                    if (obj2['prevObj'].zoomFactor) {\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                    }\n                    parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                        value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                }\n                parent.isResize = false;\n                parent.notify('transform', { prop: 'setResizedImgAngle', onPropertyChange: false, value: { angle: null } });\n                var temp = parent.isCropTab;\n                parent.isCropTab = false;\n                this.updateCropSelObj();\n                parent.cancelCropSelection = null;\n                parent.isCropTab = temp;\n            }\n        }\n        switch (true) {\n            case parent.togglePen:\n                this.cancelPen();\n                break;\n            case parent.activeObj.shape === 'text':\n                this.cancelText(isCropSelection);\n                break;\n            case shapes.indexOf(parent.activeObj.shape) !== -1:\n                this.cancelShape();\n                break;\n            case isCropSelection:\n                this.cancelSelection();\n                break;\n            default:\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                break;\n        }\n        parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        parent.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n    };\n    Draw.prototype.cancelPen = function () {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.togglePen = false;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        // eslint-disable-next-line\n        var tempPointsColl = extend([], parent.pointColl, [], true);\n        parent.pointColl = {};\n        for (var i = 0; i < this.tempFreehandCounter; i++) {\n            parent.pointColl[i] = tempPointsColl[i];\n        }\n        parent.freehandCounter = this.tempFreehandCounter;\n        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex', value: { value: this.tempCurrFhdIndex } });\n        parent.activeObj.strokeSettings = this.tempStrokeSettings;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: parent.activeObj.strokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n    };\n    Draw.prototype.cancelText = function (isCropSelection) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n            value: { textSettings: this.tempTextSettings, fontFamily: null, fontSize: null } });\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var len = object['appliedUndoRedoColl'].length;\n            var appliedColl = object['appliedUndoRedoColl'][len - 1];\n            if (this.prevActObj && appliedColl && appliedColl.currentObjColl.length &&\n                appliedColl.currentObjColl[appliedColl.currentObjColl.length - 1].currIndex === this.prevActObj.currIndex) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (parent.activeObj.shape && parent.activeObj.keyHistory === 'Enter Text') {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('shape', { prop: 'draw-shape-text' });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else if (parent.activeObj.shape) {\n                parent.notify('shape', { prop: 'redraw-text' });\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                if (!isCropSelection && parent.activeObj.topLeftCircle !== undefined) {\n                    parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n                }\n                parent.clearSelection();\n            }\n        }\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false,\n            italic: false, underline: false };\n    };\n    Draw.prototype.cancelShape = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else if (this.isNewPath) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.renderImage();\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var obj = void 0;\n            for (var i = 0, iLen = object['appliedUndoRedoColl'].length; i < iLen; i++) {\n                var currObjColl = object['appliedUndoRedoColl'][i].currentObjColl;\n                for (var j = 0, jLen = currObjColl.length; j < jLen; j++) {\n                    if (this.prevActObj && this.prevActObj.currIndex &&\n                        currObjColl[j].currIndex === this.prevActObj.currIndex) {\n                        obj = currObjColl[0];\n                        break;\n                    }\n                }\n            }\n            if (this.prevActObj && obj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        parent.currObjType.isDragging = false;\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n    };\n    Draw.prototype.cancelSelection = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            var obj = { value: parent.tempStraighten };\n            parent.transform.straighten = obj['value'];\n            parent.straightenBaseImageCanvas();\n            parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.activeObj } });\n            parent.notify('crop', { prop: 'resizeWrapper' });\n            this.updateCropSelObj();\n            if (this.tempStraightenDestPoints && JSON.stringify(this.tempStraightenDestPoints) !== JSON.stringify(this.straightenDestPoints)) {\n                this.straightenDestPoints = extend({}, this.tempStraightenDestPoints, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateCropSelObj = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            parent.cropObj = extend({}, parent.cancelCropSelection.previousCropObj, {}, true);\n            parent.afterCropActions = parent.cancelCropSelection.previousObj.afterCropActions;\n            parent.notify('undo-redo', { prop: 'undoDefault', onPropertyChange: false, value: { obj: parent.cancelCropSelection } });\n            parent.currSelectionPoint = extend({}, parent.cancelCropSelection.previousCropObj.activeObj, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n            this.clearOuterCanvas(this.lowerContext);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n    };\n    Draw.prototype.updateCropSelection = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.cancelCropSelection = { operation: 'cropTransform', previousObj: currentObj, currentObj: currentObj,\n            previousObjColl: currentObj.objColl, currentObjColl: currentObj.objColl,\n            previousPointColl: currentObj.pointColl, currentPointColl: currentObj.pointColl,\n            previousSelPointColl: currentObj.selPointColl, currentSelPointColl: currentObj.selPointColl,\n            previousCropObj: extend({}, parent.cropObj, {}, true),\n            currentCropObj: extend({}, parent.cropObj, {}, true),\n            previousText: null, currentText: null, filter: null, isCircleCrop: parent.isCircleCrop };\n    };\n    Draw.prototype.updateFlipPan = function (tempSelectionObj) {\n        var parent = this.parent;\n        if (parent.transform.currFlipState !== '') {\n            var temp = this.lowerContext.filter;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('transform', { prop: 'rotatedFlip', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (tempSelectionObj) {\n                this.drawObject('duplicate', tempSelectionObj);\n            }\n        }\n    };\n    Draw.prototype.select = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.allowDownScale = false;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var previousObj = object['currObj'];\n            previousObj.objColl = extend([], parent.objColl, [], true);\n            previousObj.pointColl = extend([], parent.pointColl, [], true);\n            previousObj.afterCropActions = parent.afterCropActions;\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            previousObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('crop', { prop: 'setPreviousCropCurrentObj', onPropertyChange: false, value: { obj: previousObj } });\n            if (parent.transform.zoomFactor > 0 && parent.activeObj.shape &&\n                parent.activeObj.shape.split('-')[0] === 'crop' && isNullOrUndefined(this.currSelPoint)) {\n                this.currSelPoint = extend({}, parent.activeObj, {}, true);\n            }\n            var isPrevent = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isPrevent = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isPrevent = true;\n            }\n            var obj = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: obj } });\n            var prevObj = obj['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.upperCanvas.style.display = 'block';\n            if (parent.currSelectionPoint || parent.transform.defaultZoomFactor !== 0 ||\n                (parent.transform.degree !== 0 && parent.panPoint.totalPannedInternalPoint.x !== 0 &&\n                    parent.panPoint.totalPannedInternalPoint.y !== 0 && !isPrevent)) {\n                parent.isCircleCrop = false;\n                if (parent.transform.defaultZoomFactor !== 0 && !this.isResizeSelect) {\n                    var isCropTab = parent.isCropTab;\n                    parent.isCropTab = false;\n                    parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n                    parent.isCropTab = isCropTab;\n                    this.resetPanPoints();\n                }\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                parent.isCircleCrop = false;\n                if (!this.isResizeSelect) {\n                    parent.notify('crop', { prop: 'setCurrSelPoints', onPropertyChange: false, value: { isSetDimension: true } });\n                }\n                parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n                if (isNullOrUndefined(parent.cropObj.activeObj.shape)) {\n                    parent.currObjType.shape = 'crop-' + type;\n                    this.drawNewSelection(type, startX, startY, width, height);\n                }\n            }\n            else {\n                if (!this.isCropSelect) {\n                    parent.notify('crop', { prop: 'adjustStraightenForShapes', onPropertyChange: false,\n                        value: { type: 'reverse', isInitialRotated: true } });\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                    this.renderImage();\n                }\n                else {\n                    this.isCropSelect = false;\n                }\n                if (type === 'custom') {\n                    parent.currObjType.shape = '';\n                }\n                this.drawNewSelection(type, startX, startY, width, height);\n            }\n        }\n    };\n    Draw.prototype.drawNewSelection = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        var points;\n        var cropShape = 'crop-' + type.toLowerCase();\n        if (cropShape === 'crop-custom') {\n            if (parent.currObjType.shape === '' || parent.currObjType.shape === 'crop-custom') {\n                this.drawCustomSelection('crop-custom', startX, startY, width, height);\n                this.adjToStraighten();\n                this.updateSelectionInsert();\n                if (parent.isStraightening) {\n                    this.straightenActObj = extend({}, parent.activeObj, {}, true);\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n            }\n        }\n        else if (cropShape === 'crop-canvas') {\n            parent.upperCanvas.style.display = 'block';\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        else {\n            parent.currObjType.isCustomCrop = false;\n            parent.currObjType.shape = cropShape;\n            if (width && height) {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                    width: width, height: height };\n            }\n            else if (width && cropShape === 'crop-circle') {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                    width: width, height: width };\n            }\n            parent.activeObj.shape = cropShape;\n            this.updateSelectionInsert(points);\n        }\n    };\n    Draw.prototype.updateSelectionInsert = function (points) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var selectionSettings = { type: parent.getSelectionType(obj['shapeSettingsObj']['type']), startX: obj['shapeSettingsObj']['startX'],\n            startY: obj['shapeSettingsObj']['startY'], width: obj['shapeSettingsObj']['width'], height: obj['shapeSettingsObj']['height'] };\n        var selectionChangingArgs = { action: 'insert', previousSelectionSettings: selectionSettings,\n            currentSelectionSettings: selectionSettings };\n        parent.trigger('selectionChanging', selectionChangingArgs);\n        parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n            value: { selectionSettings: selectionChangingArgs.currentSelectionSettings } });\n        if (selectionChangingArgs.currentSelectionSettings.type === 'Custom') {\n            this.drawObject('duplicate', parent.activeObj, null, null, true);\n        }\n        else {\n            if (actPoint.startX !== 0 || actPoint.startY !== 0 ||\n                actPoint.width !== 0 || actPoint.height !== 0) {\n                points = { startX: actPoint.startX, startY: actPoint.startY,\n                    endX: actPoint.endX, endY: actPoint.endY,\n                    width: actPoint.width, height: actPoint.height };\n            }\n            this.drawObject('duplicate', null, true, points);\n        }\n    };\n    Draw.prototype.drawCustomSelection = function (cropShape, startX, startY, width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        parent.currObjType.isCustomCrop = true;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.currObjType.shape = parent.activeObj.shape = cropShape.toLowerCase();\n        if (!isNullOrUndefined(startX) && !isNullOrUndefined(startY) && !isNullOrUndefined(width) && !isNullOrUndefined(height)) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = startX + width;\n            actPoint.endY = startY + height;\n            actPoint.width = width;\n            actPoint.height = height;\n        }\n        else {\n            if (isNullOrUndefined(parent.transform.zoomFactor) || parent.transform.zoomFactor === 0) {\n                var _a = parent.img, destLeft_1 = _a.destLeft, destTop_1 = _a.destTop, destWidth_1 = _a.destWidth, destHeight_1 = _a.destHeight;\n                var lowerCanvasWidth_1 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_1 = parent.lowerCanvas.height;\n                var activePoint_1 = actPoint;\n                if (destLeft_1 >= 0 && destTop_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else if (destLeft_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n                else if (destTop_1 >= 0) {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n            }\n            else {\n                var _b = parent.img, destLeft_2 = _b.destLeft, destTop_2 = _b.destTop, destWidth_2 = _b.destWidth, destHeight_2 = _b.destHeight;\n                var lowerCanvasWidth_2 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_2 = parent.lowerCanvas.height;\n                var activePoint_2 = actPoint;\n                activePoint_2.startX = Math.max(destLeft_2 > 0 ? destLeft_2 : 7.5, destLeft_2);\n                activePoint_2.startY = Math.max(destTop_2 > 0 ? destTop_2 : 7.5, destTop_2);\n                activePoint_2.endX = Math.min(destLeft_2 + destWidth_2 + 15 < lowerCanvasWidth_2 ? destLeft_2 + destWidth_2 - 15 :\n                    lowerCanvasWidth_2 - 15, destLeft_2 + destWidth_2);\n                activePoint_2.endY = Math.min(destTop_2 + destHeight_2 + 15 < lowerCanvasHeight_2 ? destTop_2 + destHeight_2 - 15 :\n                    lowerCanvasHeight_2 - 15, destTop_2 + destHeight_2);\n            }\n            var _c = parent.img, destLeft = _c.destLeft, destTop = _c.destTop, destWidth = _c.destWidth, destHeight = _c.destHeight;\n            var lowerCanvasWidth = parent.lowerCanvas.clientWidth;\n            var lowerCanvasHeight = parent.lowerCanvas.clientHeight;\n            var activePoint = actPoint;\n            activePoint.startX = Math.max(activePoint.startX, destLeft);\n            activePoint.startY = Math.max(activePoint.startY, destTop);\n            activePoint.endX = Math.min(activePoint.endX, destLeft + destWidth);\n            activePoint.endY = Math.min(activePoint.endY, destTop + destHeight);\n            if (parent.transform.straighten > 0) {\n                if (this.imgCanvasPoints[0].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[0].x;\n                }\n                if (this.imgCanvasPoints[0].y > activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[0].y;\n                }\n                if (this.imgCanvasPoints[2].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[2].x;\n                }\n                if (this.imgCanvasPoints[2].y < activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[2].x;\n                }\n            }\n            else if (parent.transform.straighten < 0) {\n                if (this.imgCanvasPoints[3].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[3].x;\n                }\n                if (this.imgCanvasPoints[3].y < activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[3].y;\n                }\n                if (this.imgCanvasPoints[1].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[1].x;\n                }\n                if (this.imgCanvasPoints[1].y > activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[1].x;\n                }\n            }\n            if (activePoint.startX === destLeft && destLeft + destWidth > lowerCanvasWidth) {\n                activePoint.endX = lowerCanvasWidth - 15;\n            }\n            if (activePoint.startY === destTop && destTop + destHeight > lowerCanvasHeight) {\n                activePoint.endY = lowerCanvasHeight - 15;\n            }\n            if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                var temp = parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                parent.activeObj.activePoint.endX = temp;\n            }\n            if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                var temp = parent.activeObj.activePoint.startY;\n                parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                parent.activeObj.activePoint.endY = temp;\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n            this.updateActiveObject(actPoint, parent.activeObj);\n            this.adjActObj();\n        }\n        this.updateSelectionInsert();\n    };\n    Draw.prototype.adjToStraighten = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten !== 0 && parent.isStraightening) {\n            var actPoint = parent.activeObj.activePoint;\n            actPoint.startX += 7.5;\n            actPoint.startY += 7.5;\n            actPoint.endX -= 7.5;\n            actPoint.endY -= 7.5;\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.adjActObj = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        var actPoint = parent.activeObj.activePoint;\n        var tempActPoint = extend({}, actPoint, {}, true);\n        var count = 0;\n        while (true) {\n            count++;\n            var object = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] || count === 100) {\n                actPoint = extend({}, tempActPoint, {}, true);\n                break;\n            }\n            tempActPoint = extend({}, actPoint, {}, true);\n            actPoint.startX -= 5;\n            actPoint.endX += 5;\n            actPoint.width = actPoint.endX - actPoint.startX;\n            this.updateActiveObject(actPoint, parent.activeObj);\n        }\n    };\n    Draw.prototype.callUpdateCurrTransState = function () {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.isRotateZoom = true;\n        this.updateCurrTransState('initial');\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        var temp = this.lowerContext.filter;\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        }\n        this.drawImage();\n        this.updateCurrTransState('reverse');\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        this.isRotateZoom = false;\n        parent.objColl = tempObjColl;\n        var tempTogglePen = parent.togglePen;\n        parent.togglePen = false;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        parent.img.destLeft -= parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop -= parent.panPoint.totalPannedInternalPoint.y;\n        parent.togglePen = tempTogglePen;\n        this.lowerContext.filter = temp;\n        parent.activeObj = tempActiveObj;\n    };\n    Draw.prototype.resetPanPoints = function () {\n        this.parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n    };\n    Draw.prototype.setClientTransDim = function (isPreventDimension) {\n        var parent = this.parent;\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destHeight) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destWidth + 1) / 2;\n            var temp = parent.img.destWidth;\n            parent.img.destWidth = parent.img.destHeight;\n            parent.img.destHeight = temp;\n        }\n        else {\n            if (isNullOrUndefined(isPreventDimension)) {\n                parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destWidth) / 2;\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destHeight + 1) / 2;\n            }\n        }\n    };\n    Draw.prototype.redrawImgWithObj = function () {\n        var parent = this.parent;\n        var obj = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = obj['canvasFilter'];\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            this.callUpdateCurrTransState();\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        else {\n            this.callUpdateCurrTransState();\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.setCurrentObj = function (obj, isUndoRedo) {\n        var parent = this.parent;\n        var isObj = obj ? true : false;\n        if (!isObj) {\n            parent.cropObj.aspectWidth = parent.aspectWidth;\n            parent.cropObj.aspectHeight = parent.aspectHeight;\n            parent.cropObj.frame = parent.frameObj.type;\n        }\n        obj = obj ? obj : parent.cropObj;\n        parent.transform.cropZoomFactor = obj.cropZoom;\n        parent.transform.defaultZoomFactor = obj.defaultZoom;\n        this.straightenInitZoom = obj.straightenZoom;\n        if (!isObj) {\n            parent.transform.zoomFactor = obj.cropZoom;\n        }\n        else {\n            if (obj.activeObj.shape && obj.activeObj.shape.split('-')[0] === 'crop') {\n                parent.transform.zoomFactor = obj.cropZoom;\n            }\n            else {\n                parent.transform.zoomFactor = obj.defaultZoom;\n            }\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: obj.zoomFactor } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false, value: { previousZoomValue: obj.previousZoomValue } });\n        parent.panPoint.totalPannedPoint = extend({}, obj.totalPannedPoint, {}, true);\n        parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n        parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        var point = extend({}, obj.tempFlipPanPoint, {}, true);\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: point } });\n        parent.rotateFlipColl = extend([], obj.rotateFlipColl, [], true);\n        parent.transform.degree = obj.degree;\n        parent.frameObj.type = obj.frame;\n        parent.transform.currFlipState = obj.currFlipState;\n        parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.adjustmentLevel } });\n        parent.notify('filter', { prop: 'setTempAdjVal' });\n        parent.currentFilter = obj.currentFilter;\n        parent.notify('filter', { prop: 'setTempFilVal' });\n        if (parent.transform.straighten !== obj.straighten || isUndoRedo) {\n            parent.transform.straighten = obj.straighten;\n            parent.straightenBaseImageCanvas();\n        }\n        parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n            destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n            srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n        parent.aspectWidth = obj.aspectWidth;\n        parent.aspectHeight = obj.aspectHeight;\n        if (obj.afterCropActions) {\n            parent.afterCropActions = obj.afterCropActions;\n        }\n        this.lowerContext.filter = obj.filter;\n        parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: obj.isBrightAdjust } });\n        var isCircleCrop = parent.isCircleCrop;\n        var currSelectionPoint;\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            currSelectionPoint = null;\n        }\n        else {\n            currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            parent.currSelectionPoint = null;\n        }\n        parent.isCircleCrop = false;\n        this.drawCropSelectionImage(obj, false);\n        if (parent.transform.degree !== 0) {\n            if (parent.transform.currFlipState === '') {\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n            }\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n            parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n            parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        }\n        parent.activeObj = extend({}, obj.activeObj, {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate', null, null, null, true);\n        }\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        var isAfterCropAction = false;\n        if (parent.afterCropActions.length > 0) {\n            var object = { collection: parent.afterCropActions };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.afterCropActions, isRotateFlipCollection: null, obj: object } });\n            parent.afterCropActions = object['collection'];\n        }\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        if (!isObj && afterCropActions.length > 0) {\n            isAfterCropAction = true;\n            for (var i = 0, len = afterCropActions.length; i < len; i++) {\n                if (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip') {\n                    parent.activeObj = extend({}, currSelectionPoint, {}, true);\n                    this.rotatedFlipCropSel = true;\n                }\n                parent.notify('transform', { prop: 'updateTransform', onPropertyChange: false, value: { text: afterCropActions[i] } });\n            }\n            activeObj = extend({}, parent.activeObj, {}, true);\n            this.resetPanPoints();\n            parent.activeObj = activeObj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n            if (obj.degree !== parent.transform.degree) {\n                parent.transform.cropZoomFactor = null;\n                parent.transform.zoomFactor = 0;\n            }\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            if (this.rotatedFlipCropSel) {\n                this.rotatedFlipCropSel = false;\n            }\n        }\n        parent.afterCropActions = afterCropActions;\n        if (!this.isCancelAction && !isAfterCropAction) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n        }\n        parent.activeObj = activeObj;\n        parent.isCircleCrop = isCircleCrop;\n        if (isNullOrUndefined(currSelectionPoint)) {\n            parent.currSelectionPoint = null;\n        }\n        else {\n            parent.currSelectionPoint = extend({}, currSelectionPoint, {}, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n        }\n    };\n    Draw.prototype.drawCropSelectionImage = function (obj, isObj) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        if (isObj) {\n            this.updateCurrTransState('initial');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        if (isObj) {\n            this.updateCurrTransState('reverse');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        parent.img.destLeft = parent.cropObj.destPoints.startX;\n        parent.img.destTop = parent.cropObj.destPoints.startY;\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        this.lowerContext.filter = 'none';\n        if (this.isCancelAction) {\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        else {\n            parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n                destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n                srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n            if (obj.activeObj.activePoint.width !== 0 && obj.activeObj.activePoint.height !== 0) {\n                var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                    height: parent.img.destHeight };\n                parent.img.destLeft = obj.activeObj.activePoint.startX;\n                parent.img.destTop = obj.activeObj.activePoint.startY;\n                parent.img.destWidth = obj.activeObj.activePoint.width;\n                parent.img.destHeight = obj.activeObj.activePoint.height;\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                parent.img.destLeft = destPoints.startX;\n                parent.img.destTop = destPoints.startY;\n                parent.img.destWidth = destPoints.width;\n                parent.img.destHeight = destPoints.height;\n            }\n        }\n        parent.activeObj = activeObj;\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.performPointZoom = function (x, y, type, isResize, value) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var ratioX = (x - destLeft) / destWidth;\n        var ratioY = (y - destTop) / destHeight;\n        var isUndoRedo = parent.isUndoRedo;\n        parent.isUndoRedo = true;\n        parent.setProperties({ zoomSettings: { zoomPoint: { x: x, y: y } } }, true);\n        var zoomValue = value ? value : (type === 'zoomIn') ? .1 : -.1;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: zoomValue, zoomPoint: null, isResize: isResize } });\n        parent.isUndoRedo = isUndoRedo;\n        this.panToPoint(x, y, ratioX, ratioY);\n    };\n    Draw.prototype.panToPoint = function (x, y, ratioX, ratioY) {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var destLeft = parent.img.destLeft;\n            var destTop = parent.img.destTop;\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft = x - (ratioX * parent.img.destWidth);\n                parent.img.destTop = y - (ratioY * parent.img.destHeight);\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                var straightenObj = { straightenPoint: null };\n                parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n                    value: { obj: straightenObj } });\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: null, y: null, ratioX: null, ratioY: null } });\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.panPoint.currentPannedPoint = { x: (x - (ratioX * parent.img.destWidth)) - destLeft,\n                    y: (y - (ratioY * parent.img.destHeight)) - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                    parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                        value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                            ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n                }\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n                parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n            this.adjustPanning(activeObj);\n            parent.activeObj = activeObj;\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n        }\n    };\n    Draw.prototype.adjustPanning = function (activeObj) {\n        var parent = this.parent;\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        if (width !== 0 && height !== 0) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            var point = { x: 0, y: 0 };\n            if (destLeft > startX) {\n                point.x = destLeft - startX;\n            }\n            else if (destLeft + destWidth < startX + width) {\n                point.x = (destLeft + destWidth) - (startX + width);\n            }\n            if (destTop > startY) {\n                point.y = destTop - startY;\n            }\n            else if (destTop + destHeight < startY + height) {\n                point.y = (destTop + destHeight) - (startY + height);\n            }\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                parent.panPoint.currentPannedPoint = { x: parent.img.destLeft - destLeft, y: parent.img.destTop - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n                parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n        }\n    };\n    Draw.prototype.panToSel = function () {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        var img = parent.img;\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var panX = (startX + (width / 2)) - straightenObj['straightenPoint']['x'];\n            var panY = (startY + (height / 2)) - straightenObj['straightenPoint']['y'];\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft += panX;\n                parent.img.destTop += panY;\n                parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                parent.notify('transform', { prop: 'setTempPanMove', value: { point: null } });\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n            var _b = parent.img, destLeft_3 = _b.destLeft, destTop_3 = _b.destTop, destWidth_3 = _b.destWidth, destHeight_3 = _b.destHeight;\n            var points = this.imgCanvasPoints;\n            points.forEach(function (point) {\n                point.x = (point.ratioX * destWidth_3) + destLeft_3;\n                point.y = (point.ratioY * destHeight_3) + destTop_3;\n            });\n            this.imgCanvasPoints = points;\n            var count = 0;\n            if (parent.transform.straighten === 3 && !this.preventStraightening) {\n                this.preventStraightening = true;\n                var temp = parent.prevStraightenedDegree;\n                parent.prevStraightenedDegree = parent.transform.straighten;\n                parent.setStraighten(0);\n                parent.setStraighten(3);\n                parent.prevStraightenedDegree = temp;\n                this.preventStraightening = false;\n            }\n            while (this.isLinesIntersect() && parent.transform.straighten !== 0 && parent.transform.straighten !== 360 && count < 100) {\n                count++;\n                this.performPointZoom(parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2), parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2), 'zoomIn', false, 0.025);\n                this.updateImgCanvasPoints();\n            }\n        }\n    };\n    Draw.prototype.drawZoomPanImage = function (x, y) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false, value: { xDiff: x, yDiff: y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false, value: { xDiff: x, yDiff: y, panRegion: '' } });\n        this.renderImage(true);\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.panPoint.totalPannedPoint.x += x;\n        parent.panPoint.totalPannedPoint.y += y;\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: { x: 0, y: 0 } } });\n    };\n    Draw.prototype.openNewImage = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var toolbar = document.querySelector('#' + id + '_currPos');\n        if (toolbar) {\n            toolbar.style.display = 'none';\n        }\n        var obj = { defToolbarItems: null };\n        parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj } });\n        if (obj['defToolbarItems'].length === 0 &&\n            (isNullOrUndefined(document.getElementById(id + '_toolbar'))) &&\n            parent.element.querySelector('#' + id + '_toolbarArea')) {\n            var height = parent.element.querySelector('#' + id + '_toolbarArea').clientHeight;\n            parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: height } });\n        }\n        parent.reset();\n        parent.update();\n        parent.transform.degree = 0;\n        parent.transform.zoomFactor = 0;\n        parent.isImageLoaded = false;\n        parent.currSelectionPoint = null;\n        var type = typeof (this.openURL);\n        if (type === 'string') {\n            var fileName = this.openURL.split('.');\n            if (fileName.length > 1) {\n                fileName = fileName[fileName.length - 2].split('/');\n                this.fileName = fileName[fileName.length - 1];\n            }\n            else {\n                this.fileName = 'ImageEditor';\n            }\n            this.fileType = this.getFileExtensionFromURL(this.openURL);\n            if (this.fileType) {\n                this.fileType = parent.toPascalCase(this.fileType);\n                var fileType = this.fileType.toLowerCase();\n                if (fileType === 'jpg' || fileType === 'jpeg') {\n                    this.fileType = 'Jpeg';\n                    fileType = 'jpeg';\n                }\n                if (fileType !== 'jpeg' && fileType !== 'png' && fileType !== 'svg') {\n                    this.fileType = null;\n                }\n            }\n            this.imageOnLoad(this.openURL);\n        }\n        else {\n            this.fileName = 'ImageEditor';\n            this.fileType = null;\n            parent.lowerCanvas = document.querySelector('#' + id + '_lowerCanvas');\n            parent.upperCanvas = document.querySelector('#' + id + '_upperCanvas');\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n            this.upperContext = parent.upperCanvas.getContext('2d');\n            parent.clearContext(this.lowerContext);\n            parent.clearContext(this.upperContext);\n            parent.clearContext(inMemoryContext);\n            parent.inMemoryCanvas.width = this.openURL.width;\n            parent.inMemoryCanvas.height = this.openURL.height;\n            inMemoryContext.putImageData(this.openURL, 0, 0);\n            parent.baseImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n    };\n    Draw.prototype.dlgBtnClick = function () {\n        this.parent.export();\n        this.applyDialogOption();\n    };\n    Draw.prototype.dlgCloseBtnClick = function () {\n        this.applyDialogOption();\n    };\n    Draw.prototype.applyDialogOption = function () {\n        var parent = this.parent;\n        if (this.isFileChanged) {\n            parent.isImageLoaded = this.isFileChanged = false;\n            parent.reset();\n            this.checkToolbarTemplate(this.inputElem, this.openURL);\n        }\n        else {\n            this.reset();\n            this.openNewImage();\n        }\n        getComponent(document.getElementById(parent.element.id + '_dialog'), 'dialog').destroy();\n        this.isImageEdited = false;\n    };\n    Draw.prototype.showDialogPopup = function () {\n        var parent = this.parent;\n        var headerObj = { key: 'ConfirmDialogHeader' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n        var contentObj = { key: 'ConfirmDialogContent' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n        var yesObj = { key: 'Yes' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: yesObj } });\n        var noObj = { key: 'No' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: noObj } });\n        parent.element.querySelector('#' + parent.element.id + '_dialog').style.display = 'block';\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: '<span>' + contentObj['value'] + '</span>',\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: noObj['value'], iconCss: 'e-icons e-close' }\n                },\n                { click: this.dlgBtnClick.bind(this),\n                    buttonModel: { content: yesObj['value'], isPrimary: true, iconCss: 'e-icons e-check' } }\n            ]\n        });\n        dialog.appendTo('#' + parent.element.id + '_dialog');\n    };\n    Draw.prototype.restoreOldImage = function () {\n        if (this.parent.isImageLoaded) {\n            this.reset();\n            this.openNewImage();\n        }\n        else {\n            this.openNewImage();\n        }\n    };\n    Draw.prototype.open = function (data) {\n        document.getElementById(this.parent.element.id + '_dropArea').style.display = 'none';\n        if (!this.parent.disabled) {\n            this.openURL = data;\n            this.restoreOldImage();\n        }\n    };\n    Draw.prototype.getInitialLoaded = function (object) {\n        object['isInitialLoaded'] = this.isInitialLoading;\n    };\n    Draw.prototype.getFileExtensionFromURL = function (url) {\n        var lastDotIndex = url.lastIndexOf('.');\n        if (lastDotIndex !== -1) {\n            return url.slice(lastDotIndex + 1).toLowerCase();\n        }\n        else if (url.indexOf('base64') !== -1) {\n            return url.slice(url.indexOf('/') + 1, url.indexOf(';')).toLowerCase();\n        }\n        return null;\n    };\n    Draw.prototype.fileSelect = function (inputElement, args) {\n        var parent = this.parent;\n        document.getElementById(parent.element.id + '_dropArea').style.display = 'none';\n        if (!parent.disabled) {\n            var filesData = void 0;\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var fileData = void 0;\n            if (args.target) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = args.target.files[0];\n                fileData = filesData;\n            }\n            else {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = fileData = args.filesData[0].rawFile;\n            }\n            var fileExtension = void 0;\n            if (fileData.name) {\n                var fileExtensionArray = fileData.name.split('.');\n                fileExtension = fileExtensionArray[fileExtensionArray.length - 1].toLowerCase();\n            }\n            if (fileExtension && ['jpg', 'jpeg', 'png', 'svg'].indexOf(fileExtension) === -1) {\n                this.errorLoading();\n                return;\n            }\n            showSpinner(parent.element);\n            parent.element.style.opacity = '0.5';\n            this.inputElem = inputElement;\n            fileExtension = fileData.name && fileData.name.split('.')[1];\n            if (fileExtension) {\n                var fileType = parent.toPascalCase(fileExtension);\n                if (fileType === 'JPG' || fileType === 'Jpg') {\n                    this.fileType = 'Jpeg';\n                }\n                else {\n                    this.fileType = fileType;\n                }\n            }\n            else {\n                this.fileType = null;\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var URL_1 = window.URL;\n            var url = URL_1.createObjectURL(filesData);\n            this.openURL = url;\n            if (parent.isImageLoaded && !parent.isChangesSaved && (this.isImageEdited || parent.pointColl.length > 0 || parent.objColl.length > 0)) {\n                this.isFileChanged = true;\n                this.showDialogPopup();\n            }\n            else {\n                this.checkToolbarTemplate(inputElement, url);\n            }\n        }\n    };\n    Draw.prototype.checkToolbarTemplate = function (inputElement, url) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbarTemplate)) {\n            parent.reset();\n            parent.update();\n        }\n        this.fileName = inputElement.value.split('\\\\')[inputElement.value.split('\\\\').length - 1];\n        this.fileName = this.fileName.split('.')[0];\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    Draw.prototype.moveToSelectionRange = function (type, activeObj) {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            var isRotated = false;\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                var degree = parent.rotateFlipColl[i];\n                if (degree === 90 || degree === -90) {\n                    isRotated = true;\n                    break;\n                }\n            }\n            if (isRotated) {\n                if (parent.transform.degree === 0) {\n                    return;\n                }\n                var zoomFactor = parent.transform.zoomFactor;\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                var currObj = parent.objColl[parent.objColl.length - 1];\n                if (type === 'rotateleft' || type === 'rotateright') {\n                    if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                        if (currObj.activePoint.width < activeObj.activePoint.height) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null, isResize: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                    else {\n                        if (currObj.activePoint.height < activeObj.activePoint.width) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                }\n                var panX = (parent.lowerCanvas.clientWidth / 2) - (currObj.activePoint.startX +\n                    (currObj.activePoint.width / 2));\n                var panY = ((parent.lowerCanvas.clientHeight + 1) / 2) - (currObj.activePoint.startY +\n                    (currObj.activePoint.height / 2));\n                if (isNullOrUndefined(parent.activeObj.shape)) {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                }\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += panX;\n                    parent.img.destTop += panY;\n                    parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                    parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                }\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1]);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n    };\n    Draw.prototype.isSelectionBiggerThanCanvas = function (obj) {\n        var isBigger = false;\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        if (startX <= destLeft || startY <= destTop || endX >= destLeft + destWidth || endY >= destTop + destHeight) {\n            isBigger = true;\n        }\n        return isBigger;\n    };\n    Draw.prototype.isSelectionOutsideCanvas = function (obj) {\n        var isOutside = false;\n        var parent = this.parent;\n        if ((obj.activePoint.height < parent.lowerCanvas.height - parent.toolbarHeight) ||\n            (obj.activePoint.width < parent.lowerCanvas.width)) {\n            isOutside = true;\n        }\n        return isOutside;\n    };\n    Draw.prototype.downScaleImgCanvas = function (ctx, isImgAnnotation, isHFlip, isVFlip) {\n        var parent = this.parent;\n        var canvas = isImgAnnotation ? parent.activeObj.imageCanvas : parent.baseImgCanvas;\n        var img = isImgAnnotation ? parent.activeObj.imageElement : parent.baseImg;\n        var width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.img.destWidth;\n        var height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.img.destHeight;\n        var obj = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.height, height: img.width, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        else {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.width, height: img.height, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        if (isImgAnnotation || (parent.allowDownScale && !parent.isCropTab && !parent.isCropToolbar && img.width !== 0 && img.height !== 0\n            && obj['width'] * 0.75 > width && obj['height'] * 0.75 > height)) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = isImgAnnotation ? img.width : parent.img.srcWidth;\n            tempCanvas.height = isImgAnnotation ? img.height : parent.img.srcHeight;\n            if (isImgAnnotation) {\n                tempCanvas.getContext('2d').drawImage(img, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            else {\n                tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            if (isImgAnnotation || this.isDownScale) {\n                this.downScale(tempCanvas, width, height, isImgAnnotation);\n            }\n            if (isImgAnnotation) {\n                ctx.canvas.width = tempCanvas.width;\n                ctx.canvas.height = tempCanvas.height;\n                if (isHFlip && isVFlip) {\n                    ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                    ctx.scale(-1, 1);\n                    ctx.translate(0, parent.activeObj.imageCanvas.height);\n                    ctx.scale(1, -1);\n                }\n                else {\n                    if (isHFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isHorImageFlip) || !parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = true;\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                        else if (parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = false;\n                        }\n                        if (parent.activeObj.isVerImageFlip) {\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                    }\n                    else if (isVFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isVerImageFlip) || !parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = true;\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                        else if (parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = false;\n                        }\n                        if (parent.activeObj.isHorImageFlip) {\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                    }\n                }\n                ctx.drawImage(tempCanvas, 0, 0);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n            else if (parent.isFinetuning) {\n                ctx.save();\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n                ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                ctx.restore();\n            }\n            else {\n                ctx.drawImage(tempCanvas, 0, 0, tempCanvas.width, tempCanvas.height, parent.img.destLeft, parent.img.destTop, tempCanvas.width, tempCanvas.height);\n            }\n        }\n        else {\n            if ((isNullOrUndefined(isImgAnnotation) || !isImgAnnotation) && parent.baseImgCanvas.width !== 0 &&\n                parent.baseImgCanvas.height !== 0) {\n                ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n            }\n        }\n    };\n    Draw.prototype.downScale = function (canvas, width, height, isImgAnnotation) {\n        var parent = this.parent;\n        if (isImgAnnotation && parent.isStraightening) {\n            return;\n        }\n        var widthSource = canvas.width;\n        var heightSource = canvas.height;\n        width = Math.round(width);\n        height = Math.round(height);\n        var widthRatio = widthSource / width;\n        var heightRatio = heightSource / height;\n        var halfWidthRatio = Math.ceil(widthRatio / 2);\n        var halfHeightRatio = Math.ceil(heightRatio / 2);\n        var ctx = canvas.getContext('2d');\n        var img = ctx.getImageData(0, 0, widthSource, heightSource);\n        var img2 = ctx.createImageData(width, height);\n        var data = img.data;\n        var data2 = img2.data;\n        for (var j = 0; j < height; j++) {\n            for (var i = 0; i < width; i++) {\n                var x2 = (i + j * width) * 4;\n                var weight = 0;\n                var weights = 0;\n                var alphaWeights = 0;\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n                var centerY = (j + 0.5) * heightRatio;\n                var startY = Math.floor(j * heightRatio);\n                var stopY = Math.ceil((j + 1) * heightRatio);\n                for (var y = startY; y < stopY; y++) {\n                    var dy = Math.abs(centerY - (y + 0.5)) / halfHeightRatio;\n                    var centerX = (i + 0.5) * widthRatio;\n                    var w0 = dy * dy; //pre-calc part of w\n                    var startX = Math.floor(i * widthRatio);\n                    var stopX = Math.ceil((i + 1) * widthRatio);\n                    for (var x = startX; x < stopX; x++) {\n                        var dx = Math.abs(centerX - (x + 0.5)) / halfWidthRatio;\n                        var w = Math.sqrt(w0 + dx * dx);\n                        if (w >= 1) {\n                            continue;\n                        }\n                        weight = 2 * w * w * w - 3 * w * w + 1;\n                        var xPos = 4 * (x + y * widthSource);\n                        a += weight * data[xPos + 3];\n                        alphaWeights += weight;\n                        weight = weight * data[xPos + 3] / 250;\n                        r += weight * data[xPos];\n                        g += weight * data[xPos + 1];\n                        b += weight * data[xPos + 2];\n                        weights += weight;\n                    }\n                }\n                data2[x2] = r / weights;\n                data2[x2 + 1] = g / weights;\n                data2[x2 + 2] = b / weights;\n                data2[x2 + 3] = a / alphaWeights;\n            }\n        }\n        canvas.width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.lowerCanvas.width;\n        canvas.height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.lowerCanvas.height;\n        ctx.putImageData(img2, 0, 0);\n    };\n    Draw.prototype.drawImgToCtx = function (ctx, preventImg) {\n        var parent = this.parent;\n        if (ctx.canvas.id !== parent.element.id + '_tempCanvas' && ctx !== this.upperContext && isNullOrUndefined(preventImg)) {\n            this.downScaleImgCanvas(ctx, null, null, null);\n        }\n    };\n    Draw.prototype.getFrameColor = function (frameObj, ctx, points) {\n        var parent = this.parent;\n        var color = parent.frameObj.color;\n        if (frameObj.gradientColor) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var gradient = ctx.createLinearGradient(points.startX, points.startY, points.startX + points.width, points.startY + points.height);\n            gradient.addColorStop(0, frameObj.color);\n            gradient.addColorStop(1, frameObj.gradientColor);\n            color = gradient;\n        }\n        else {\n            color = frameObj.color;\n        }\n        return color;\n    };\n    Draw.prototype.applyFrame = function (ctx, frame, preventImg) {\n        var parent = this.parent;\n        parent.frameObj.type = frame;\n        var tempLineWidth;\n        var ratio = { width: 1, height: 1 };\n        var points = { startX: parent.img.destLeft - ctx.lineWidth, startY: parent.img.destTop - ctx.lineWidth,\n            width: parent.img.destWidth + (2 * ctx.lineWidth), height: parent.img.destHeight + (2 * ctx.lineWidth) };\n        var frameObj = { type: parent.frameObj.type, color: parent.frameObj.color, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset / 2, radius: parent.frameObj.radius,\n            amount: parent.frameObj.amount, border: parent.frameObj.border, gradientColor: parent.frameObj.gradientColor };\n        var zoomFactor = parent.transform.zoomFactor;\n        if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n            var newWidth = ctx.canvas.width;\n            var newHeight = ctx.canvas.height;\n            var obj = { width: 0, height: 0 };\n            parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: newWidth, height: newHeight } } });\n            ratio = obj;\n            frameObj.size *= ((ratio.width + ratio.height) / 2);\n            frameObj.inset *= ((ratio.width + ratio.height) / 2);\n            frameObj.offset *= ((ratio.width + ratio.height) / 2);\n            frameObj.radius *= ((ratio.width + ratio.height) / 2);\n            points = { startX: 0, startY: 0, width: ctx.canvas.width, height: ctx.canvas.height };\n            parent.notify('export', { prop: 'updateSaveContext', onPropertyChange: false, value: { context: ctx } });\n        }\n        else if (ctx === this.upperContext && parent.activeObj.shape) {\n            points = { startX: parent.activeObj.activePoint.startX - ctx.lineWidth, startY: parent.activeObj.activePoint.startY\n                    - ctx.lineWidth, width: parent.activeObj.activePoint.width + (2 * ctx.lineWidth), height: parent.activeObj.activePoint.height + (2 * ctx.lineWidth) };\n        }\n        else if (isNullOrUndefined(preventImg)) {\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        }\n        var valueForty = (40 * ((ratio.width + ratio.height) / 2));\n        var valueFifty = (50 * ((ratio.width + ratio.height) / 2));\n        if (ctx !== this.upperContext) {\n            frameObj.size += (frameObj.size * zoomFactor);\n            frameObj.inset += (frameObj.inset * zoomFactor);\n            frameObj.offset += (frameObj.offset * zoomFactor);\n            frameObj.radius += (frameObj.radius * zoomFactor);\n            valueForty += (valueForty * zoomFactor);\n            valueFifty += (valueFifty * zoomFactor);\n        }\n        if (ctx === this.upperContext && parent.activeObj.shape) {\n            if ((frame === 'mat' && ((points.width - (2 * frameObj.size) < 0) || (points.height - (2 * frameObj.size) < 0))) ||\n                (frame === 'bevel' && (points.width - (2 * frameObj.size) < 40 || points.height - (2 * frameObj.size) < 40)) ||\n                ((frame === 'inset') && (points.startX + points.width - frameObj.offset - (points.startX + frameObj.offset) < 0 ||\n                    points.startY + points.height - frameObj.offset - (points.startY + frameObj.offset) < 0)) ||\n                (frame === 'hook' && (points.width - (2 * frameObj.size) < 50 || points.height - (2 * frameObj.size) < 50))) {\n                return;\n            }\n        }\n        var bevelObj = { bevelFilter: ctx.filter };\n        var filter = ctx.filter;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop ||\n            (ctx === this.lowerContext && parent.isCropTab)) {\n            this.drawImgToCtx(ctx, preventImg);\n        }\n        else {\n            switch (frame) {\n                case 'none':\n                    this.drawImgToCtx(ctx, preventImg);\n                    break;\n                case 'mat':\n                    this.drawImgToCtx(ctx, preventImg);\n                    while (((points.width - (2 * frameObj.size) < 0) ||\n                        (points.height - (2 * frameObj.size) < 0)) && frameObj.size > 0) {\n                        frameObj.size -= 20;\n                    }\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.rect(points.startX, points.startY, points.width, points.height);\n                    ctx.rect(points.startX + frameObj.size, points.startY + frameObj.size, points.width -\n                        (2 * frameObj.size), points.height - (2 * frameObj.size));\n                    ctx.fill('evenodd');\n                    ctx.closePath();\n                    break;\n                case 'bevel':\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.fillRect(points.startX, points.startY, points.width, points.height);\n                    ctx.closePath();\n                    points.startX += frameObj.size;\n                    points.startY += frameObj.size;\n                    points.width -= (2 * frameObj.size);\n                    points.height -= (2 * frameObj.size);\n                    while ((points.width - (2 * frameObj.size) < 40 ||\n                        points.height - (2 * frameObj.size) < 40) && frameObj.size > 0) {\n                        points.startX -= frameObj.size;\n                        points.startY -= frameObj.size;\n                        points.width += (2 * frameObj.size);\n                        points.height += (2 * frameObj.size);\n                        frameObj.size -= 20;\n                        points.startX += frameObj.size;\n                        points.startY += frameObj.size;\n                        points.width -= (2 * frameObj.size);\n                        points.height -= (2 * frameObj.size);\n                    }\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.save();\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + valueForty, points.startY);\n                    ctx.lineTo(points.startX + points.width - valueForty, points.startY);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY, points.startX + points.width, points.startY + valueForty);\n                    ctx.lineTo(points.startX + points.width, points.startY + points.height - valueForty);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY + points.height, points.startX + points.width - valueForty, points.startY + points.height);\n                    ctx.lineTo(points.startX + valueForty, points.startY + points.height);\n                    ctx.quadraticCurveTo(points.startX, points.startY + points.height, points.startX, points.startY + points.height\n                        - valueForty);\n                    ctx.lineTo(points.startX, points.startY + valueForty);\n                    ctx.quadraticCurveTo(points.startX, points.startY, points.startX + valueForty, points.startY);\n                    ctx.closePath();\n                    ctx.clip();\n                    ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n                        preventImg = null;\n                        ctx.filter = 'none';\n                        ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                        ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    }\n                    else {\n                        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n                        if (preventImg) {\n                            preventImg = null;\n                            if (parent.transform.zoomFactor !== 0) {\n                                this.isRotateZoom = true;\n                            }\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.updateCurrTransState('initial');\n                            this.drawImgToCtx(ctx, preventImg);\n                            this.updateCurrTransState('reverse');\n                            this.isRotateZoom = false;\n                            parent.frameObj.type = 'none';\n                            ctx.filter = 'none';\n                            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                                value: { context: ctx, points: null } });\n                            parent.frameObj.type = 'bevel';\n                            ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                        }\n                        else {\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.drawImgToCtx(ctx, preventImg);\n                        }\n                    }\n                    ctx.restore();\n                    break;\n                case 'line':\n                    this.drawImgToCtx(ctx, preventImg);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    for (var i = 0; i < parent.frameObj.amount; i++) {\n                        if (i > 0) {\n                            points.startX += frameObj.offset;\n                            points.startY += frameObj.offset;\n                            points.width -= (2 * frameObj.offset);\n                            points.height -= (2 * frameObj.offset);\n                        }\n                        var arcY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        var lineY = points.startY + frameObj.inset + frameObj.radius;\n                        var arcX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var lineX = points.startX + frameObj.inset + frameObj.radius;\n                        var arcX1 = points.startX + frameObj.inset + frameObj.radius;\n                        var lineX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var arcY1 = points.startY + frameObj.inset + frameObj.radius;\n                        var lineY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        if (arcY2 >= lineY && arcX2 >= lineX && arcX1 <= lineX2 && arcY1 <= lineY2) {\n                            ctx.filter = 'none';\n                            ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                            if (frameObj.border === 'dashed') {\n                                ctx.setLineDash([ctx.lineWidth * 2.5, ctx.lineWidth * 1.5]);\n                            }\n                            else if (frameObj.border === 'dotted') {\n                                ctx.setLineDash([ctx.lineWidth, ctx.lineWidth]);\n                            }\n                            ctx.beginPath();\n                            ctx.moveTo(points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + frameObj.inset);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset, points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset -\n                                frameObj.radius);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + points.height\n                                - frameObj.inset, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset + frameObj.radius, points.startY + points.height - frameObj.inset);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + frameObj.radius);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + frameObj.inset, points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset, frameObj.radius);\n                            ctx.closePath();\n                            ctx.stroke();\n                            ctx.setLineDash([]);\n                        }\n                    }\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'inset':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.offset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.offset, points.startY + frameObj.inset);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.offset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.moveTo(points.startX + points.width - frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.moveTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.offset);\n                    ctx.stroke();\n                    ctx.closePath();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'hook':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.stroke();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n            }\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: ctx, isSave: ctx.canvas.id === parent.element.id + '_tempCanvas' ? true : null, isFlip: null } });\n            }\n            ctx.filter = filter;\n        }\n    };\n    Draw.prototype.triggerFrameChange = function (prevFrameSettings) {\n        var parent = this.parent;\n        var currFrameSettings = { type: parent.toPascalCase(parent.frameObj.type),\n            color: parent.frameObj.color, gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n            frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n        var frameChange = { cancel: false, previousFrameSetting: prevFrameSettings,\n            currentFrameSetting: currFrameSettings };\n        parent.trigger('frameChange', frameChange);\n        if (!frameChange.cancel) {\n            this.setFrameObj(frameChange.currentFrameSetting);\n        }\n        return frameChange;\n    };\n    Draw.prototype.setFrameObj = function (currFrameSettings) {\n        var parent = this.parent;\n        parent.frameObj.type = currFrameSettings.type.toLowerCase();\n        parent.frameObj.color = currFrameSettings.color;\n        parent.frameObj.gradientColor = currFrameSettings.gradientColor;\n        parent.frameObj.size = currFrameSettings.size;\n        parent.frameObj.inset = currFrameSettings.inset;\n        parent.frameObj.offset = currFrameSettings.offset;\n        parent.frameObj.radius = currFrameSettings.borderRadius;\n        parent.frameObj.border = currFrameSettings.frameLineStyle.toLowerCase();\n        parent.frameObj.amount = currFrameSettings.lineCount;\n    };\n    Draw.prototype.zoomToSel = function (activeObj, isToolbar) {\n        var parent = this.parent;\n        if (this.straightenActObj && JSON.stringify(this.straightenActObj.activePoint) === JSON.stringify(activeObj.activePoint)) {\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            if (parent.transform.straighten === 0) {\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.transform.straighten = 360;\n                while (true) {\n                    if (!isNullOrUndefined(this.straightenInitZoom) &&\n                        (Math.round(parent.transform.zoomFactor * Math.pow(10, 3)) / Math.pow(10, 3)) >\n                            (Math.round(this.straightenInitZoom * Math.pow(10, 3)) / Math.pow(10, 3))) {\n                        this.setZoomPan('out');\n                        if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                            this.performDummyZoom();\n                            break;\n                        }\n                        if (parent.transform.degree === 0) {\n                            parent.transform.zoomFactor -= 0.025;\n                            parent.transform.cropZoomFactor -= 0.025;\n                        }\n                    }\n                    else {\n                        this.performDummyZoom();\n                        break;\n                    }\n                }\n                parent.transform.straighten = 0;\n                parent.img = { destLeft: parent.img.destLeft, destTop: parent.img.destTop, destWidth: parent.img.destWidth,\n                    destHeight: parent.img.destHeight, srcLeft: parent.img.srcLeft, srcTop: parent.img.srcTop,\n                    srcWidth: parent.img.srcWidth, srcHeight: parent.img.srcHeight };\n            }\n            else {\n                if (isNullOrUndefined(this.straightenInitZoom)) {\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n                if (this.straightenInitZoom - parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -(this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                else if (this.straightenInitZoom - parent.transform.zoomFactor < 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: (this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                parent.activeObj = extend({}, activeObj, null, true);\n                parent.transform.zoomFactor += 0.001;\n                this.calcStraightenedPoints(isToolbar);\n            }\n        }\n        else {\n            this.straightenActObj = extend({}, activeObj, null, true);\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            this.straightenInitZoom = parent.transform.zoomFactor;\n            this.calcStraightenedPoints(isToolbar);\n        }\n    };\n    Draw.prototype.isDestPointSmall = function () {\n        var parent = this.parent;\n        var img = parent.img;\n        var destPoints = { startX: img.destLeft, startY: img.destTop,\n            width: img.destWidth, height: img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var isSmall = false;\n        if (this.straightenDestPoints.destWidth && this.straightenDestPoints.destHeight &&\n            (img.destWidth < this.straightenDestPoints.destWidth || img.destHeight < this.straightenDestPoints.destHeight)) {\n            isSmall = true;\n        }\n        img.destLeft = destPoints.startX;\n        img.destTop = destPoints.startY;\n        img.destWidth = destPoints.width;\n        img.destHeight = destPoints.height;\n        parent.img = img;\n        return isSmall;\n    };\n    Draw.prototype.calcStraightenedPoints = function (isToolbar) {\n        var parent = this.parent;\n        var destWidth = parent.img.destWidth;\n        var destHeight = parent.img.destHeight;\n        if (isNullOrUndefined(parent.transform.zoomFactor)) {\n            parent.transform.zoomFactor += 0.025;\n        }\n        this.updateImgCanvasPoints();\n        var _loop_1 = function () {\n            if (this_1.isLinesIntersect() || this_1.isSelOutsideImg() || (isToolbar && this_1.isDestPointSmall())) {\n                parent.activeObj = extend({}, this_1.straightenActObj, null, true);\n                this_1.setZoomPan('in');\n                if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                    this_1.performDummyZoom();\n                    return \"break\";\n                }\n                if (parent.transform.degree === 0) {\n                    parent.transform.zoomFactor += 0.025;\n                    parent.transform.cropZoomFactor += 0.025;\n                }\n                var points = this_1.imgCanvasPoints;\n                var left_1 = parent.img.destLeft;\n                var top_1 = parent.img.destTop;\n                var width_1 = parent.img.destWidth;\n                var height_1 = parent.img.destHeight;\n                points.forEach(function (point) {\n                    point.x = (point.ratioX * width_1) + left_1;\n                    point.y = (point.ratioY * height_1) + top_1;\n                });\n                this_1.imgCanvasPoints = points;\n            }\n            else {\n                this_1.performDummyZoom();\n                return \"break\";\n            }\n        };\n        var this_1 = this;\n        while (true) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Draw.prototype.performDummyZoom = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: 0.025, zoomPoint: null, isResize: true } });\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: -0.025, zoomPoint: null, isResize: true } });\n        var zoom = parent.transform.zoomFactor * 10;\n        if (zoom < 1) {\n            zoom = 1 + (zoom / 10);\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: zoom } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n            value: { previousZoomValue: zoom } });\n        this.panToSel();\n    };\n    Draw.prototype.setZoomPan = function (type) {\n        var parent = this.parent;\n        var obj = { maxDimension: null };\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'cropZoom', onPropertyChange: false,\n                value: { value: type === 'in' ? 0.025 : -0.025, selectionObj: parent.activeObj, obj: obj } });\n            parent.img.destWidth = obj['maxDimension']['width'];\n            parent.img.destHeight = obj['maxDimension']['height'];\n        }\n        else {\n            parent.transform.zoomFactor += (type === 'in' ? 0.025 : -0.025);\n            parent.transform.cropZoomFactor += (type === 'in' ? 0.025 : -0.025);\n            this.updateCurrTransState('initial');\n            this.isRotateZoom = true;\n            this.setDestPoints();\n            this.isRotateZoom = false;\n            this.updateCurrTransState('reverse');\n        }\n    };\n    Draw.prototype.updateImgCanvasPoints = function () {\n        var parent = this.parent;\n        var points = this.getImagePoints();\n        var obj = { width: 0, height: 0 };\n        var width = parent.baseImgCanvas.width;\n        var height = parent.baseImgCanvas.height;\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        width = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.height : ratio.width;\n        height = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.width : ratio.height;\n        var p1;\n        var p2;\n        var p3;\n        var p4;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.straighten > 0) {\n            p1 = { x: destLeft + (points[0].x / width), y: destTop };\n            p2 = { x: destLeft + destWidth, y: destTop + (points[1].y / height) };\n            p3 = { x: destLeft + destWidth - (points[0].x / width), y: destTop + destHeight };\n            p4 = { x: destLeft, y: destTop + destHeight - (points[1].y / height) };\n        }\n        else {\n            p1 = { x: destLeft, y: destTop + (points[0].y / height) };\n            p2 = { x: destLeft + (points[1].x / width), y: destTop };\n            p3 = { x: destLeft + destWidth, y: destTop + destHeight - (points[0].y / height) };\n            p4 = { x: destLeft + destWidth - (points[1].x / width), y: destTop + destHeight };\n        }\n        p1.ratioX = (p1.x - destLeft) / destWidth;\n        p1.ratioY = (p1.y - destTop) / destHeight;\n        p2.ratioX = (p2.x - destLeft) / destWidth;\n        p2.ratioY = (p2.y - destTop) / destHeight;\n        p3.ratioX = (p3.x - destLeft) / destWidth;\n        p3.ratioY = (p3.y - destTop) / destHeight;\n        p4.ratioX = (p4.x - destLeft) / destWidth;\n        p4.ratioY = (p4.y - destTop) / destHeight;\n        this.imgCanvasPoints = [p1, p2, p3, p4];\n    };\n    Draw.prototype.isLinesIntersect = function (obj) {\n        var parent = this.parent;\n        var point = parent.activeObj.activePoint;\n        var imgPoints = this.imgCanvasPoints;\n        var isTopIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.endX, y: point.startY }, imgPoints[0], imgPoints[1]);\n        var isRightIntersect = this.doIntersect({ x: point.endX, y: point.startY }, { x: point.endX, y: point.endY }, imgPoints[1], imgPoints[2]);\n        var isBottomIntersect = this.doIntersect({ x: point.startX, y: point.endY }, { x: point.endX, y: point.endY }, imgPoints[2], imgPoints[3]);\n        var isLeftIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.startX, y: point.endY }, imgPoints[3], imgPoints[0]);\n        var isTopLeftInsideRect = this.isInsideRect(imgPoints[0]);\n        var isTopRightInsideRect = this.isInsideRect(imgPoints[1]);\n        var isBottomRightInsideRect = this.isInsideRect(imgPoints[2]);\n        var isBottomLeftInsideRect = this.isInsideRect(imgPoints[3]);\n        if (obj) {\n            obj['arr'] = [isTopIntersect, isRightIntersect, isBottomIntersect, isLeftIntersect];\n        }\n        return isTopIntersect || isRightIntersect || isBottomIntersect || isLeftIntersect ||\n            isTopLeftInsideRect || isTopRightInsideRect || isBottomRightInsideRect || isBottomLeftInsideRect ||\n            (imgPoints[0].x > point.startX && imgPoints[1].x < point.endX &&\n                imgPoints[2].x < point.endX && imgPoints[3].x > point.startX &&\n                imgPoints[0].y < point.startY && imgPoints[1].y < point.startY &&\n                imgPoints[2].y > point.endY && imgPoints[3].y > point.endY) ||\n            (imgPoints[0].x < point.startX && imgPoints[1].x > point.endX &&\n                imgPoints[2].x > point.endX && imgPoints[3].x < point.startX &&\n                imgPoints[0].y > point.startY && imgPoints[1].y > point.startY &&\n                imgPoints[2].y < point.endY && imgPoints[3].y < point.endY);\n    };\n    Draw.prototype.isSelOutsideImg = function () {\n        var parent = this.parent;\n        var points = this.imgCanvasPoints;\n        var actPoint = parent.activeObj.activePoint;\n        return (this.checkPointPosition(actPoint.startX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.startX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside');\n    };\n    Draw.prototype.calcTriangleArea = function (x1, y1, x2, y2, x3, y3) {\n        return Math.abs((x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2)) / 2);\n    };\n    Draw.prototype.checkPointPosition = function (x, y, x1, y1, x2, y2, x3, y3, x4, y4) {\n        var area1 = this.calcTriangleArea(x, y, x1, y1, x4, y4);\n        var area2 = this.calcTriangleArea(x, y, x4, y4, x3, y3);\n        var area3 = this.calcTriangleArea(x, y, x3, y3, x2, y2);\n        var area4 = this.calcTriangleArea(x, y, x2, y2, x1, y1);\n        var areaRectangle = this.calcTriangleArea(x1, y1, x2, y2, x3, y3) + this.calcTriangleArea(x3, y3, x4, y4, x1, y1);\n        if (area1 + area2 + area3 + area4 > areaRectangle) {\n            return 'outside';\n        }\n        else if (area1 + area2 + area3 + area4 === areaRectangle && (area1 === 0 || area2 === 0 || area3 === 0 || area4 === 0)) {\n            return 'on';\n        }\n        else {\n            return 'inside';\n        }\n    };\n    Draw.prototype.getImagePoints = function () {\n        var point = [];\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var width = parent.baseImg.width;\n        var height = parent.baseImg.height;\n        var obj = { dim: null, width: height, height: width, angle: parent.transform.straighten };\n        obj['dim'] = parent.getRotatedCanvasDim(obj['width'], obj['height'], obj['angle']);\n        var baseImgCanvasWidth = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['width'] : parent.baseImgCanvas.width;\n        var baseImgCanvasHeight = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['height'] : parent.baseImgCanvas.height;\n        var baseImgWidth = degree % 90 === 0 && degree % 180 !== 0 ? height : width;\n        var baseImgHeight = degree % 90 === 0 && degree % 180 !== 0 ? width : height;\n        var centerX = baseImgCanvasWidth / 2;\n        var centerY = baseImgCanvasHeight / 2;\n        var startX = centerX - (baseImgWidth / 2);\n        var startY = centerY - (baseImgHeight / 2);\n        var endX = centerX + (baseImgWidth / 2);\n        var endY = centerY + (baseImgHeight / 2);\n        var center = { x: centerX, y: centerY };\n        var radians = parent.transform.straighten * (Math.PI / 180);\n        var p1 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p2 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p3 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        var p4 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        point.push(p1);\n        point.push(p2);\n        point.push(p3);\n        point.push(p4);\n        return point;\n    };\n    Draw.prototype.doIntersect = function (a, b, c, d) {\n        var point1 = this.initiation(a, b, c);\n        var point2 = this.initiation(a, b, d);\n        var point3 = this.initiation(c, d, a);\n        var point4 = this.initiation(c, d, b);\n        if (point1 !== point2 && point3 !== point4) {\n            return true;\n        }\n        if (point1 === 0 && this.onSegment(a, c, b)) {\n            return true;\n        }\n        if (point2 === 0 && this.onSegment(a, d, b)) {\n            return true;\n        }\n        if (point3 === 0 && this.onSegment(c, a, d)) {\n            return true;\n        }\n        if (point4 === 0 && this.onSegment(c, b, d)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.initiation = function (a, b, c) {\n        var value = (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y);\n        if (value === 0) {\n            return 0;\n        }\n        return (value > 0) ? 1 : 2;\n    };\n    Draw.prototype.onSegment = function (a, b, c) {\n        if (b.x <= Math.max(a.x, c.x) && b.x >= Math.min(a.x, c.x) &&\n            b.y <= Math.max(a.y, c.y) && b.y >= Math.min(a.y, c.y)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.isInsideRect = function (point) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var isInside = false;\n        if (point.x >= actPoint.startX && point.x <= actPoint.endX &&\n            point.y >= actPoint.startY && point.y <= actPoint.endY) {\n            isInside = true;\n        }\n        return isInside;\n    };\n    Draw.prototype.setDestForStraighten = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(this.straightenDestPoints)) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            // If straightening performed, then destination points are set in non-straightened state\n            parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n            this.straightenDestPoints = extend({}, parent.img, {}, true);\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n            parent.img.destWidth = destWidth;\n            parent.img.destHeight = destHeight;\n        }\n    };\n    return Draw;\n}());\nexport { Draw };\n","import { extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Export = /** @class */ (function () {\n    function Export(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Export.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Export.prototype.addEventListener = function () {\n        this.parent.on('export', this.export, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Export.prototype.removeEventListener = function () {\n        this.parent.off('export', this.export);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Export.prototype.export = function (args) {\n        this.parent.notify('toolbar', { prop: 'refreshShapeDrawing', onPropertyChange: false });\n        this.updatePvtVar();\n        switch (args.prop) {\n            case 'export':\n                this.exportImg(args.value['type'], args.value['fileName']);\n                break;\n            case 'exportToCanvas':\n                this.exportToCanvas(args.value['object']);\n                break;\n            case 'drawAnnotation':\n                this.drawAnnotation(args.value['context'], args.value['ratio']);\n                break;\n            case 'updateSaveContext':\n                this.updateSaveContext(args.value['context']);\n                break;\n        }\n    };\n    Export.prototype.getModuleName = function () {\n        return 'export';\n    };\n    Export.prototype.updatePvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Export.prototype.exportImg = function (type, fileName) {\n        var parent = this.parent;\n        var obj = { fileName: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var imageName = obj['fileName'];\n        if (!parent.disabled && parent.isImageLoaded) {\n            var dummyObj = { bool: false };\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: dummyObj } });\n            if (dummyObj['bool']) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            }\n            if (parent.togglePen) {\n                parent.currObjType.isZoomed = true;\n                parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            }\n            if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            var obj_1 = { canvasFilter: this.parent.canvasFilter };\n            this.lowerContext.filter = obj_1['canvasFilter'];\n            type = type ? type : 'Png';\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            var beforeSave = { cancel: false, fileName: fileName ? fileName : imageName,\n                fileType: type };\n            parent.trigger('beforeSave', beforeSave);\n            this.beforeSaveEvent(beforeSave, type, fileName, imageName);\n        }\n    };\n    Export.prototype.beforeSaveEvent = function (observableSaveArgs, type, fileName, imageName) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.currObjType.isSave = true;\n            fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n            var lowerCaseType = type.toLowerCase();\n            fileName = fileName || imageName;\n            if (lowerCaseType === 'svg') {\n                this.toSVGImg(fileName);\n            }\n            else {\n                this.toBlobFn(fileName, lowerCaseType);\n            }\n            var saved = { fileName: fileName ? fileName : imageName, fileType: type };\n            parent.trigger('saved', saved);\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.lowerCanvas.style.left = parent.upperCanvas.style.left = '';\n            parent.lowerCanvas.style.top = parent.upperCanvas.style.top = '';\n            parent.lowerCanvas.style.maxWidth = parent.upperCanvas.style.maxWidth = '';\n            parent.lowerCanvas.style.maxHeight = parent.upperCanvas.style.maxHeight = '';\n        }\n    };\n    Export.prototype.toSVGImg = function (fileName) {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        var dataUrl = tempCanvas.toDataURL();\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', tempCanvas.style.maxWidth);\n        svg.setAttribute('height', tempCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', tempCanvas.height.toString());\n        img.setAttributeNS(null, 'width', tempCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + tempCanvas.width + \"\\\"\") + (\" height=\\\"\" + tempCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    Export.prototype.toBlobFn = function (fileName, type) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        var imagetype = (type === 'jpeg') ? 'image/jpeg' : 'image/png';\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        tempCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n        }, imagetype);\n    };\n    Export.prototype.exportToCanvas = function (object) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var tempCropObj = extend({}, parent.cropObj, {}, true);\n        var tempObj = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: tempObj } });\n        var prevObj = tempObj['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        if (this.parent.aspectWidth) {\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n            parent.notify('toolbar', { prop: 'resizeClick', value: { bool: false } });\n            parent.okBtn();\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = this.parent.aspectHeight;\n                height = this.parent.aspectWidth;\n            }\n            else {\n                width = this.parent.aspectWidth;\n                height = this.parent.aspectHeight;\n            }\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n        }\n        else if (parent.currSelectionPoint) {\n            width = parent.img.srcWidth;\n            height = parent.img.srcHeight;\n        }\n        else {\n            width = parent.baseImgCanvas.width;\n            height = parent.baseImgCanvas.height;\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        var tempContextFilter = this.lowerContext.filter;\n        // Manipulating blur value\n        if (this.lowerContext.filter !== 'none') {\n            var splitWords = this.lowerContext.filter.split(' ');\n            var value = parseFloat(splitWords[5].split('(')[1]);\n            value *= ((ratio.width + ratio.height) / 2);\n            splitWords[5] = 'blur(' + value + 'px)';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n        var tempCanvas = parent.createElement('canvas', {\n            id: parent.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n        });\n        var tempContext = tempCanvas.getContext('2d');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: dimObj } });\n        var maxDimension = dimObj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n        var temp = this.lowerContext.filter;\n        tempContext.filter = this.lowerContext.filter;\n        this.downScaleImgCanvas(tempContext, width, height);\n        this.lowerContext.filter = temp;\n        if (parent.transform.degree !== 0 || parent.transform.currFlipState !== '' || parent.transform.straighten !== 0) {\n            this.updateSaveContext(tempContext);\n            this.exportTransformedImage(tempContext);\n        }\n        this.drawAnnotation(tempContext, ratio);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: tempContext, isSave: true, isFlip: null } });\n        }\n        this.updateFrame(tempContext, true);\n        this.lowerContext.filter = tempContextFilter;\n        parent.canvasFilter = tempContextFilter;\n        if (object) {\n            object['canvas'] = tempCanvas;\n        }\n        if (parent.aspectWidth) {\n            parent.objColl = [];\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: [] } } });\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: prevObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: prevObj.selPointColl } } });\n            parent.cropObj = tempCropObj;\n            parent.objColl = extend([], prevObj.objColl, [], true);\n            parent.pointColl = extend([], prevObj.pointColl, [], true);\n            parent.freehandCounter = parent.pointColl.length;\n            parent.transform.straighten = 0;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            this.lowerContext.filter = prevObj.filter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n        return tempCanvas;\n    };\n    Export.prototype.drawAnnotation = function (tempContext, ratio) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            var tempObjColl = extend([], parent.objColl, [], true);\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                var activePoint = currObj.activePoint;\n                // Subtracting destination left and top points\n                activePoint.startX -= parent.img.destLeft;\n                activePoint.startY -= parent.img.destTop;\n                activePoint.endX -= parent.img.destLeft;\n                activePoint.endY -= parent.img.destTop;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n                // Manipulating points\n                activePoint.startX *= ratio.width;\n                activePoint.startY *= ratio.height;\n                activePoint.endX *= ratio.width;\n                activePoint.endY *= ratio.height;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n                currObj.strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / 2);\n                if (currObj.shape === 'text') {\n                    currObj.textSettings.fontSize *= ((ratio.width + ratio.height) / 2);\n                }\n                else if (currObj.shape === 'path') {\n                    for (var l = 0; l < currObj.pointColl.length; l++) {\n                        currObj.pointColl[l].x =\n                            (currObj.pointColl[l].x - parent.img.destLeft) * ratio.width;\n                        currObj.pointColl[l].y =\n                            (currObj.pointColl[l].y - parent.img.destTop) * ratio.height;\n                    }\n                }\n                else if (currObj.shape === 'image') {\n                    parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                    parent.notify('selection', { prop: 'upgradeImageQuality', onPropertyChange: false });\n                    parent.objColl[i] = extend({}, parent.activeObj, {}, true);\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'saveContext', obj: parent.objColl[i], isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: tempContext, isPreventSelection: null } });\n            }\n            tempContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.objColl = tempObjColl;\n        }\n        if (parent.freehandCounter > 0) {\n            var widthObj = { penStrokeWidth: null };\n            parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n            // eslint-disable-next-line\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n                var len = parent.points.length;\n                parent.pointColl[n].strokeWidth *= ((ratio.width + ratio.height) / 2);\n                for (var l = 0; l < len; l++) {\n                    parent.points[l].x = (parent.points[l].x - parent.img.destLeft) * ratio.width;\n                    parent.points[l].y = (parent.points[l].y - parent.img.destTop) * ratio.height;\n                }\n            }\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: tempContext, points: null } });\n            parent.pointColl = tempPointColl;\n            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n        }\n    };\n    Export.prototype.downScaleImgCanvas = function (ctx, width, height) {\n        var parent = this.parent;\n        var canvas = parent.baseImgCanvas;\n        var img = parent.baseImg;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: img.width, height: img.height, obj: obj, isImgShape: null } });\n        if (obj['width'] > width && obj['height'] > height) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = this.parent.img.srcWidth;\n            tempCanvas.height = this.parent.img.srcHeight;\n            tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            parent.notify('draw', { prop: 'downScale', value: { canvas: tempCanvas, width: width, height: height } });\n            ctx.drawImage(tempCanvas, 0, 0);\n        }\n        else {\n            ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, width, height);\n        }\n    };\n    Export.prototype.updateFrame = function (tempContext, isAnnotation) {\n        if (this.parent.frameObj.type !== 'none') {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            this.parent.notify('draw', { prop: 'applyFrame', value: { ctx: tempContext, frame: this.parent.frameObj.type, preventImg: isAnnotation } });\n            tempContext.filter = temp;\n        }\n    };\n    Export.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    Export.prototype.exportTransformedImage = function (tempContext) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        if (parent.rotateFlipColl.length > 0) {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var flip = parent.rotateFlipColl[i];\n                if (typeof flip === 'number') {\n                    this.exportRotate(tempContext, flip);\n                }\n                else if (flip === 'horizontal') {\n                    this.exportFlip(tempContext, true, false);\n                }\n                else if (flip === 'vertical') {\n                    this.exportFlip(tempContext, false, true);\n                }\n            }\n        }\n        parent.transform.degree = degree;\n    };\n    Export.prototype.exportRotate = function (tempContext, degree) {\n        var parent = this.parent;\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.setMaxDim(parent.transform.degree, tempContext.canvas);\n        tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n        tempContext.rotate(Math.PI / 180 * degree);\n        tempContext.drawImage(parent.inMemoryCanvas, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.exportFlip = function (tempContext, flipHorizontal, flipVertical) {\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        if (flipHorizontal) {\n            tempContext.translate(tempContext.canvas.width, 0);\n            tempContext.scale(-1, 1);\n        }\n        if (flipVertical) {\n            tempContext.translate(0, tempContext.canvas.height);\n            tempContext.scale(1, -1);\n        }\n        tempContext.drawImage(this.parent.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.updateSaveContext = function (tempContext) {\n        var inMemoryContext = this.parent.inMemoryCanvas.getContext('2d');\n        tempContext.setTransform(1, 0, 0, 1, 0, 0);\n        var imageData = tempContext.getImageData(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.parent.inMemoryCanvas.width = imageData.width;\n        this.parent.inMemoryCanvas.height = imageData.height;\n        inMemoryContext.putImageData(imageData, 0, 0);\n    };\n    Export.prototype.setMaxDim = function (degree, tempCanvas) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.height;\n                newHeight = this.parent.baseImgCanvas.width;\n            }\n            else {\n                newWidth = this.parent.img.srcHeight;\n                newHeight = this.parent.img.srcWidth;\n            }\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.width;\n                newHeight = this.parent.baseImgCanvas.height;\n            }\n            else {\n                newWidth = this.parent.img.srcWidth;\n                newHeight = this.parent.img.srcHeight;\n            }\n        }\n        if (!isNullOrUndefined(this.parent.aspectWidth)) {\n            newWidth = this.parent.aspectWidth;\n            newHeight = this.parent.aspectHeight;\n        }\n        tempCanvas.width = newWidth;\n        tempCanvas.height = newHeight;\n        var obj = { width: 0, height: 0 };\n        this.parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: newWidth, height: newHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    return Export;\n}());\nexport { Export };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar Filter = /** @class */ (function () {\n    function Filter(parent) {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for toolbar slider value\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for temp toolbar slider value\n        this.adjustmentValue = ''; // for internal slider value\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempFilVal = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Filter.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on('filter', this.filter, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        this.parent.off('filter', this.filter);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Filter.prototype.filter = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'finetuneImage':\n                this.finetuneImage(args.value['option'], args.value['value']);\n                break;\n            case 'applyImageFilter':\n                this.setFilter(args.value['option']);\n                break;\n            case 'update-finetunes':\n                this.updateFinetunes();\n                break;\n            case 'set-adjustment':\n                this.setAdjustment(args.value['operation']);\n                break;\n            case 'update-filter':\n                this.updateFilter(args.value['operation'], args.value['filter']);\n                break;\n            case 'initFilter':\n                this.initFilter();\n                break;\n            case 'setCurrAdjValue':\n                this.setCurrAdjValue(args.value['type'], args.value['value']);\n                break;\n            case 'updateAdj':\n                this.updateAdj(args.value['type'], args.value['value'], args.value['isPreview'], args.value['ctx']);\n                break;\n            case 'getCurrentObj':\n                this.getCurrentObj(args.value['object']);\n                break;\n            case 'getAdjustmentLevel':\n                if (isNullOrUndefined(this.parent.activeObj.opacity)) {\n                    this.adjustmentLevel.transparency = 100;\n                }\n                else {\n                    this.adjustmentLevel.transparency = this.parent.activeObj.opacity * 100;\n                }\n                args.value['obj']['adjustmentLevel'] = this.adjustmentLevel;\n                break;\n            case 'setAdjustmentLevel':\n                this.adjustmentLevel = args.value['adjustmentLevel'];\n                break;\n            case 'getTempAdjustmentLevel':\n                args.value['obj']['tempAdjustmentLevel'] = this.tempAdjustmentLevel;\n                break;\n            case 'setTempAdjustmentLevel':\n                this.tempAdjustmentLevel = args.value['tempAdjustmentLevel'];\n                break;\n            case 'setAdjustmentValue':\n                this.adjustmentValue = args.value['adjustmentValue'];\n                break;\n            case 'getBrightnessAdjusted':\n                args.value['obj']['isBrightnessAdjusted'] = this.isBrightnessAdjusted;\n                break;\n            case 'setBrightnessAdjusted':\n                this.isBrightnessAdjusted = args.value['isBrightnessAdjusted'];\n                if (this.parent.currentFilter.split('_') && this.parent.currentFilter.split('_')[1] === 'cold') {\n                    this.isBrightnessAdjusted = false;\n                }\n                break;\n            case 'getBevelFilter':\n                args.value['obj']['bevelFilter'] = this.bevelFilter;\n                break;\n            case 'setBevelFilter':\n                this.bevelFilter = args.value['bevelFilter'];\n                break;\n            case 'setTempAdjVal':\n                this.tempAdjVal = extend({}, this.adjustmentLevel, {}, true);\n                break;\n            case 'setTempFilVal':\n                this.tempFilVal = this.parent.currentFilter;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Filter.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.reset = function () {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.adjustmentValue = this.parent.getDefaultFilter();\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempFilVal = '';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n    };\n    Filter.prototype.updateFinetunes = function () {\n        var _this = this;\n        var parent = this.parent;\n        var fs = parent.finetuneSettings;\n        if (fs) {\n            var propertiesToSet = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n            propertiesToSet.forEach(function (property) {\n                if (fs[property]) {\n                    _this.adjustmentLevel[property] = fs[property].defaultValue;\n                    _this.tempAdjustmentLevel[property] = fs[property].defaultValue;\n                }\n            });\n            parent.notify('draw', { prop: 'isInitialLoading', onPropertyChange: false, value: { isInitialLoading: true } });\n        }\n    };\n    Filter.prototype.initFilter = function () {\n        this.setFilterAdj('brightness', this.adjustmentLevel.brightness);\n        this.setFilterAdj('contrast', this.adjustmentLevel.contrast);\n        this.setFilterAdj('hue', this.adjustmentLevel.hue);\n        this.setFilterAdj('saturation', this.adjustmentLevel.saturation);\n        this.setFilterAdj('exposure', this.adjustmentLevel.exposure);\n        this.setFilterAdj('opacity', this.adjustmentLevel.opacity);\n        this.setFilterAdj('blur', this.adjustmentLevel.blur);\n    };\n    Filter.prototype.updateAdj = function (type, value, isPreview, ctx) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var splitWords = this.lowerContext.filter.split(' ');\n        var values = [];\n        var brightness = this.getFilterValue(this.adjustmentLevel.brightness);\n        var excludedTypes = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n        if (excludedTypes.indexOf(type) === -1) {\n            if (isNullOrUndefined(isPreview) && (this.adjustmentLevel.sharpen || this.adjustmentLevel.bw)) {\n                parent.isUndoRedo = true;\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                    value: { context: this.lowerContext, points: null } });\n                this.lowerContext.filter = temp;\n                parent.isUndoRedo = false;\n            }\n        }\n        var saturate;\n        var bright;\n        var saturatePercent;\n        var contrast;\n        var saturatePercentage;\n        switch (type) {\n            case 'brightness':\n                value = this.getFilterValue(this.adjustmentLevel.exposure) + (value * 0.005);\n                splitWords[0] = 'brightness(' + value + ')';\n                if (this.adjustmentLevel.brightness !== 0) {\n                    value = (this.adjustmentLevel.opacity / 100) - (this.adjustmentLevel.opacity * 0.3) / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                else {\n                    value = this.adjustmentLevel.opacity / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'contrast':\n                splitWords[1] = 'contrast(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'hue':\n                splitWords[2] = 'hue-rotate(' + value + 'deg)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'saturation':\n                splitWords[3] = 'saturate(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'opacity':\n                if (parseFloat(splitWords[0].split('(')[1]) !== 1) {\n                    value -= 0.2;\n                }\n                if (value < 0) {\n                    value = 0;\n                }\n                splitWords[4] = 'opacity(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'blur':\n                splitWords[5] = 'blur(' + value + 'px)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'exposure':\n                if (value > 1) {\n                    value -= 1;\n                    value += brightness;\n                }\n                else if (value < 1) {\n                    value = 1 - value;\n                    value = brightness - value;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'chrome':\n                saturate = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturate *= 100;\n                value = saturate + (saturate * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'cold':\n                // Adjusting Brightness\n                bright = this.getFilterValue(this.adjustmentLevel.brightness);\n                bright *= 100;\n                value = bright * 0.9;\n                value *= 0.01;\n                splitWords[0] = 'brightness(' + value + ')';\n                // Adjusting Contrast\n                contrast = this.getFilterValue(this.adjustmentLevel.contrast);\n                contrast *= 100;\n                value = contrast + (contrast * 0.5);\n                splitWords[1] = 'contrast(' + value + '%)';\n                // Adjusting Saturation\n                saturatePercentage = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercentage *= 100;\n                value = saturatePercentage;\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'warm':\n                saturatePercent = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercent *= 100;\n                value = saturatePercent + (saturatePercent * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                splitWords[6] = 'sepia(25%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'grayscale':\n                splitWords[7] = 'grayscale(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'sepia':\n                splitWords[6] = 'sepia(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'invert':\n                splitWords[8] = 'invert(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                break;\n        }\n        if (type !== 'sharpen' && type !== 'blackandwhite') {\n            if (isNullOrUndefined(isPreview)) {\n                if (type === 'default') {\n                    splitWords = this.getDefaultCurrentFilter(splitWords);\n                }\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n            var tempFilter = void 0;\n            if (parent.frameObj.type === 'bevel') {\n                tempFilter = this.lowerContext.filter;\n                this.bevelFilter = tempFilter;\n            }\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n            }\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            if (isNullOrUndefined(isPreview)) {\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            parent.initialAdjustmentValue = splitWords.join(' ');\n            tempFilter = this.lowerContext.filter;\n            this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n            this.bevelFilter = tempFilter;\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = tempFilter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            this.isBrightnessAdjusted = brightness !== 1;\n        }\n        var filter = splitWords.join(' ');\n        if (ctx) {\n            ctx.filter = filter;\n        }\n    };\n    Filter.prototype.setTempFilterValue = function (brightness, isPreview, splitWords, type) {\n        if (isPreview) {\n            if (type === 'default') {\n                splitWords = this.getDefaultCurrentFilter(splitWords);\n            }\n            else if (brightness !== 1) {\n                var tempSplitWords = this.lowerContext.filter.split(' ');\n                tempSplitWords[4] = splitWords[4];\n                this.lowerContext.filter = tempSplitWords.join(' ');\n            }\n        }\n        return splitWords;\n    };\n    Filter.prototype.getDefaultCurrentFilter = function (splitWords) {\n        var values = this.adjustmentValue.split(' ');\n        splitWords = [values[0], values[1], values[2], values[3], values[4], values[5], 'sepia(0%)', 'grayscale(0%)', 'invert(0%)'];\n        return splitWords;\n    };\n    Filter.prototype.getFilterValue = function (value) {\n        return (value === 0) ? 1 : 1 + ((value * 0.5) / 100);\n    };\n    Filter.prototype.getSaturationFilterValue = function (value) {\n        return value === 0 ? 1 : 1 + (value / 100);\n    };\n    Filter.prototype.setFilterAdj = function (type, value) {\n        var parent = this.parent;\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        this.adjustmentLevel[\"\" + type] = value;\n        switch (type) {\n            case 'contrast':\n            case 'exposure':\n                value = this.getFilterValue(value);\n                if (type === 'contrast') {\n                    value *= 100;\n                }\n                break;\n            case 'hue':\n                value *= 3;\n                break;\n            case 'saturation':\n                value = this.getSaturationFilterValue(value) * 100;\n                break;\n            case 'opacity':\n                if (value < 10) {\n                    value += 1;\n                }\n                value /= 100;\n                break;\n            case 'blur':\n                if (value !== 0) {\n                    value /= 20;\n                    // Since 0.5 is not working in blur we consider from 1\n                    value += 0.5;\n                }\n                break;\n        }\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, value);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: type, previousObj: prevObj,\n                previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n            } });\n    };\n    Filter.prototype.setFilter = function (type) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        var obj = { currentFilter: this.parent.currentFilter };\n        var prevFilter = obj['currentFilter'];\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, null);\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: type, previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: prevFilter, isCircleCrop: null } });\n    };\n    Filter.prototype.setAdjustment = function (type) {\n        var splitWords = this.lowerContext.filter.split(' ');\n        var value;\n        var valueArr;\n        switch (type) {\n            case 'brightness':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.brightness = this.setFilterValue(value);\n                break;\n            case 'contrast':\n                valueArr = splitWords[1].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.contrast = this.setFilterValue(value);\n                break;\n            case 'hue':\n                valueArr = splitWords[2].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 3;\n                this.adjustmentLevel.hue = value;\n                break;\n            case 'saturation':\n                valueArr = splitWords[3].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.saturation = this.setSaturationFilterValue(value);\n                break;\n            case 'opacity':\n                valueArr = splitWords[4].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                if (value === 0.45) {\n                    value = 40;\n                }\n                else if (value === 0.40) {\n                    value = 30;\n                }\n                else if (value === 0.35) {\n                    value = 20;\n                }\n                else if (value === 0.30) {\n                    value = 10;\n                }\n                else if (value === 0.25) {\n                    value = 0;\n                }\n                else {\n                    value *= 100;\n                }\n                this.adjustmentLevel.opacity = value;\n                break;\n            case 'blur':\n                valueArr = splitWords[5].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value *= 20;\n                this.adjustmentLevel.blur = value;\n                break;\n            case 'exposure':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.exposure = this.setFilterValue(value);\n                break;\n        }\n    };\n    Filter.prototype.setFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : ((value - 1) * 100) / 0.5);\n    };\n    Filter.prototype.setSaturationFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : (value - 1) * 100);\n    };\n    Filter.prototype.updateFilter = function (type, previousFilter) {\n        var parent = this.parent;\n        var validTypes = ['default', 'chrome', 'cold', 'warm', 'grayscale', 'blackandwhite', 'sepia', 'invert', 'sharpen'];\n        if (validTypes.indexOf(type) !== -1) {\n            var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n            if (selEle) {\n                selEle.classList.remove('e-selected');\n            }\n            var filterCanvas = document.getElementById(parent.element.id + '_' + type + 'Canvas');\n            if (filterCanvas) {\n                filterCanvas.parentElement.classList.add('e-selected');\n            }\n            this.parent.currentFilter = previousFilter ? previousFilter : parent.element.id + '_' + type;\n        }\n    };\n    Filter.prototype.finetuneImage = function (finetuneOption, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            switch (finetuneOption.toLowerCase()) {\n                case 'brightness':\n                    this.setFilterAdj('brightness', value);\n                    break;\n                case 'contrast':\n                    this.setFilterAdj('contrast', value);\n                    break;\n                case 'hue':\n                    this.setFilterAdj('hue', value);\n                    break;\n                case 'saturation':\n                    this.setFilterAdj('saturation', value);\n                    break;\n                case 'opacity':\n                    this.setFilterAdj('opacity', value);\n                    break;\n                case 'blur':\n                    this.setFilterAdj('blur', value);\n                    break;\n                case 'exposure':\n                    this.setFilterAdj('exposure', value);\n                    break;\n            }\n            this.parent.canvasFilter = this.lowerContext.filter;\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Filter.prototype.setCurrAdjValue = function (type, value) {\n        var parent = this.parent;\n        this.parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        switch (type) {\n            case 'brightness':\n                this.setFilterAdj('brightness', value);\n                break;\n            case 'contrast':\n                this.setFilterAdj('contrast', value);\n                break;\n            case 'hue':\n                this.setFilterAdj('hue', value);\n                break;\n            case 'saturation':\n                this.setFilterAdj('saturation', value);\n                break;\n            case 'opacity':\n                this.setFilterAdj('opacity', value);\n                break;\n            case 'blur':\n                this.setFilterAdj('blur', value);\n                break;\n            case 'exposure':\n                this.setFilterAdj('exposure', value);\n                break;\n        }\n        parent.isFinetuneBtnClick = true;\n        parent.curFinetuneObjEvent = { finetune: parent.toPascalCase(type), value: value };\n    };\n    Filter.prototype.getCurrentObj = function (dummyObj) {\n        var parent = this.parent;\n        var tempFlipPanPointObj = { point: null };\n        parent.notify('crop', { prop: 'getTempFlipPanPoint', value: { obj: tempFlipPanPointObj } });\n        var zoomObj = { previousZoomValue: null };\n        parent.notify('transform', { prop: 'getPreviousZoomValue', value: { obj: zoomObj } });\n        var straightenObj = { zoomFactor: null };\n        parent.notify('draw', { prop: 'getStraightenInitZoom', value: { obj: straightenObj } });\n        var obj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n            rotateFlipColl: [], degree: 0, currFlipState: '', zoomFactor: 0, previousZoomValue: 0, straighten: 0,\n            destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: this.isBrightnessAdjusted,\n            aspectWidth: null, aspectHeight: null, straightenZoom: 0, adjustmentLevel: extend({}, this.tempAdjVal, {}, true),\n            currentFilter: this.tempFilVal };\n        obj.cropZoom = parent.transform.cropZoomFactor;\n        obj.defaultZoom = parent.transform.defaultZoomFactor;\n        obj.zoomFactor = parent.zoomSettings.zoomFactor;\n        obj.previousZoomValue = zoomObj['previousZoomValue'];\n        obj.straightenZoom = straightenObj['zoomFactor'];\n        obj.totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, {}, true);\n        obj.totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n        obj.totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n        obj.tempFlipPanPoint = extend({}, tempFlipPanPointObj['point'], {}, true);\n        obj.activeObj = extend({}, parent.activeObj, {}, true);\n        obj.rotateFlipColl = extend([], parent.rotateFlipColl, [], true);\n        obj.degree = parent.transform.degree;\n        obj.straighten = parent.cropObj.straighten;\n        obj.currFlipState = parent.transform.currFlipState;\n        obj.destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, endX: 0, endY: 0,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        obj.srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, endX: 0, endY: 0,\n            width: parent.img.srcWidth, height: parent.img.srcHeight };\n        obj.filter = this.lowerContext.filter;\n        obj.aspectWidth = parent.aspectWidth;\n        obj.aspectHeight = parent.aspectHeight;\n        obj.frame = parent.frameObj.type;\n        obj.frameObj = extend({}, parent.frameObj);\n        if (dummyObj) {\n            dummyObj['currObj'] = obj;\n        }\n        return obj;\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar FreehandDrawing = /** @class */ (function () {\n    function FreehandDrawing(parent) {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = false;\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.isFreehandPointMoved = false;\n        this.pointCounter = 0;\n        // eslint-disable-next-line\n        this.selPointColl = {};\n        this.currFHDIdx = 0; // Specifies id for every freehand drawing - uses while deleting\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.straightenPointAngle = 0;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FreehandDrawing.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    FreehandDrawing.prototype.addEventListener = function () {\n        this.parent.on('freehand-draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    FreehandDrawing.prototype.removeEventListener = function () {\n        this.parent.off('freehand-draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    FreehandDrawing.prototype.draw = function (args) {\n        this.updateFhdPvtVar();\n        switch (args.prop) {\n            case 'hoverFhd': {\n                this.hoverFhd(args.value['strokeColor'], args.value['strokeWidth']);\n                break;\n            }\n            case 'freehandDownHandler':\n                this.freehandDownHandler(args.value['e'], args.value['canvas']);\n                break;\n            case 'freehandUpHandler':\n                this.freehandUpHandler(args.value['e'], args.value['canvas'], args.value['context']);\n                break;\n            case 'handle-freehand-draw': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                if (this.isFHDIdx(id)) {\n                    this.deleteFhd(id, true);\n                }\n                break;\n            }\n            case 'freehandRedraw':\n                this.freehandRedraw(args.value['context'], args.value['points']);\n                break;\n            case 'deleteFhd': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                this.deleteFhd(id, true);\n                break;\n            }\n            case 'selectFhd': {\n                var id = null;\n                if (args.value['id']) {\n                    id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                }\n                this.selectFhd(id);\n                break;\n            }\n            case 'applyFhd':\n                this.applyFhd();\n                break;\n            case 'cancelFhd':\n                this.cancelFhd();\n                break;\n            case 'updateFHDCurPts':\n                this.updateFHDCurPts();\n                break;\n            case 'rotateFhdColl':\n                this.rotateFhdColl();\n                break;\n            case 'flipFHDColl':\n                this.flipFHDColl(args.value['value']);\n                break;\n            case 'panFHDColl':\n                this.panFHDColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFHDColl':\n                if (args.value && args.value['isPreventApply']) {\n                    this.updateFHDColl(args.value['isPreventApply']);\n                }\n                else {\n                    this.updateFHDColl();\n                }\n                break;\n            case 'zoomFHDColl':\n                this.zoomFHDColl(args.value['isPreventApply']);\n                break;\n            case 'apply-pen-draw':\n                this.applyPenDraw();\n                break;\n            case 'freeHandDraw':\n                this.freeHandDraw(args.value['value']);\n                break;\n            case 'isFHDIdx':\n                this.isFHDIdx(args.value['index'], args.value['obj']);\n                break;\n            case 'getSqPtFD':\n                this.getSqPtFD(args.value['idx'], args.value['obj']);\n                break;\n            case 'getSelPointColl':\n                args.value['obj']['selPointColl'] = extend([], this.selPointColl);\n                break;\n            case 'setSelPointColl':\n                this.selPointColl = extend([], args.value['obj']['selPointColl']);\n                break;\n            case 'setFreehandDrawHoveredIndex':\n                this.fhdHovIdx = args.value['index'];\n                break;\n            case 'getFreehandDrawHoveredIndex':\n                args.value['obj']['index'] = this.fhdHovIdx;\n                break;\n            case 'setPointCounter':\n                this.pointCounter = args.value['value'];\n                break;\n            case 'getPenStrokeWidth':\n                args.value['obj']['penStrokeWidth'] = this.penStrokeWidth;\n                break;\n            case 'setPenStrokeWidth':\n                this.penStrokeWidth = args.value['value'];\n                break;\n            case 'getCurrentFreehandDrawIndex':\n                args.value['obj']['currentFreehandDrawIndex'] = this.currFHDIdx;\n                break;\n            case 'setCurrentFreehandDrawIndex':\n                this.currFHDIdx = args.value['value'];\n                break;\n            case 'updateCropPtsForSel':\n                this.updateCropPtsForSel();\n                break;\n            case 'getFreehandDrawSelectedId':\n                args.value['obj']['freehandDrawSelectedId'] = this.fhdSelID;\n                break;\n            case 'resetFreehandDrawSelectedId':\n                this.fhdSelID = null;\n                break;\n            case 'getTempFreeHandDrawEditingStyles':\n                args.value['obj']['tempFreeHandDrawEditingStyles'] = this.tempFHDStyles;\n                break;\n            case 'setFreehandSelectedIndex':\n                this.fhdSelIdx = args.value['index'];\n                break;\n            case 'getFreehandSelectedIndex':\n                args.value['obj']['freehandSelectedIndex'] = this.fhdSelIdx;\n                break;\n            case 'setCenterSelPoints':\n                this.setCenterSelPoints();\n                break;\n            case 'getStraightenPoint':\n                args.value['obj']['straightenPoint'] = extend({}, this.straightenPoint, {}, true);\n                break;\n            case 'setStraightenPoint':\n                this.straightenPoint.x = args.value['x'];\n                this.straightenPoint.y = args.value['y'];\n                if (args.value['ratioX'] && args.value['ratioY']) {\n                    this.straightenPoint.ratioX = args.value['ratioX'];\n                    this.straightenPoint.ratioY = args.value['ratioY'];\n                }\n                break;\n            case 'resetStraightenPoint':\n                this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n                this.prevStraightenObj = null;\n                this.straightenPointAngle = 0;\n                break;\n            case 'getStraightenPointAngle':\n                args.value['obj']['angle'] = this.straightenPointAngle;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'triggerShapeChanging':\n                this.triggerShapeChanging(args.value['shapeChangingArgs']);\n                break;\n        }\n    };\n    FreehandDrawing.prototype.updateFhdPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    FreehandDrawing.prototype.reset = function () {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = this.isFreehandPointMoved = false;\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.selPointColl = {};\n        this.straightenPointAngle = 0;\n        this.fhdHovIdx = null;\n        this.pointCounter = 0;\n        this.fhdSelID = null;\n        this.penStrokeWidth = undefined;\n        this.currFHDIdx = 0;\n        this.fhdSelIdx = null;\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.prevStraightenObj = null;\n    };\n    FreehandDrawing.prototype.getModuleName = function () {\n        return 'freehand-draw';\n    };\n    FreehandDrawing.prototype.hoverFhd = function (fillStyle, strokeWidth) {\n        var parent = this.parent;\n        var context = this.upperContext;\n        var idx = -1;\n        if (this.fhdHovIdx > -1) {\n            idx = this.fhdHovIdx;\n        }\n        else {\n            idx = this.fhdSelIdx;\n        }\n        parent.points = extend([], parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = parent.points.length;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        var minStrokeWidth = 0;\n        var maxStrokeWidth = 0;\n        context.fillStyle = fillStyle ? fillStyle : parent.pointColl[idx].strokeColor;\n        context.strokeStyle = context.fillStyle;\n        minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = strokeWidth ?\n            strokeWidth : parent.pointColl[idx].strokeWidth;\n        if (len === 1) {\n            controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n            this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n        }\n        for (var l = 0; l < len - 3; l++) {\n            if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                if (l === 0) {\n                    startPoint = parent.points[l];\n                }\n                else {\n                    startPoint = parent.points[l + 1];\n                }\n                endPoint = parent.points[l + 2];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n        context.closePath();\n        // Outer selection\n        var point = this.getSqPtFD(idx);\n        var tempLineWidth = context.lineWidth;\n        context.lineWidth = 2;\n        context.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        context.beginPath();\n        context.rect(point.startX, point.startY, point.width, point.height);\n        context.stroke();\n        context.closePath();\n        context.lineWidth = tempLineWidth;\n    };\n    FreehandDrawing.prototype.freehandDownHandler = function (e, canvas) {\n        var parent = this.parent;\n        parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        this.lowerContext = parent.lowerCanvas.getContext('2d');\n        parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        this.upperContext = parent.upperCanvas.getContext('2d');\n        this.fhdObj.time = new Date().getTime();\n        this.isFreehandDrawing = true;\n        if (e.type === 'mousedown') {\n            this.freehandDownPoint = { x: e.clientX, y: e.clientY };\n        }\n        else {\n            this.freehandDownPoint = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n        }\n        this.isFreehandPointMoved = false;\n        EventHandler.add(canvas, 'mousemove touchmove', this.freehandMoveHandler, this);\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth, points: null };\n        var shapeChangingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n    };\n    FreehandDrawing.prototype.freehandUpHandler = function (e, canvas, context) {\n        var rect = canvas.getBoundingClientRect();\n        var parent = this.parent;\n        EventHandler.remove(canvas, 'mousemove touchmove', this.freehandMoveHandler);\n        if (parent.points.length === 0) {\n            if (e.type === 'mouseup') {\n                this.processPoint(e.clientX - rect.left, e.clientY - rect.top, true, context);\n            }\n            else if (e.type === 'touchend' && e.changedTouches) {\n                this.processPoint(e.changedTouches[0].clientX - rect.left, e.changedTouches[0].clientY - rect.top, true, context);\n            }\n            else {\n                if (!this.isFreehandPointMoved) {\n                    this.processPoint(this.freehandDownPoint.x - rect.left, this.freehandDownPoint.y - rect.top, true, context);\n                }\n            }\n        }\n        context.closePath();\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var fhCnt = parent.freehandCounter;\n        parent.pointColl[fhCnt] = { points: extend([], parent.points), strokeColor: parent.activeObj.strokeSettings.strokeColor,\n            strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState, id: 'pen_' + (this.currFHDIdx + 1) };\n        parent.points = [];\n        this.dummyPoints = [];\n        this.selPointColl[fhCnt] = { points: extend([], this.selPoints) };\n        this.selPoints = [];\n        this.pointCounter = 0;\n        parent.freehandCounter++;\n        this.isFreehandDrawing = false;\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'freehand-draw', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth,\n            points: parent.pointColl[this.currFHDIdx].points };\n        var shapeChangingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n        this.currFHDIdx++;\n    };\n    FreehandDrawing.prototype.freehandMoveHandler = function (e) {\n        this.isFreehandPointMoved = true;\n        var rect = this.parent.upperCanvas.getBoundingClientRect();\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX - rect.left;\n            y = e.clientY - rect.top;\n        }\n        else {\n            x = e.touches[0].clientX - rect.left;\n            y = e.touches[0].clientY - rect.top;\n        }\n        if (this.isFreehandDrawing) {\n            this.upperContext.fillStyle = this.parent.activeObj.strokeSettings.strokeColor;\n            this.processPoint(x, y, false, this.upperContext);\n        }\n    };\n    FreehandDrawing.prototype.processPoint = function (x, y, mouseDown, context) {\n        var parent = this.parent;\n        var lastPoint = this.point(x, y, new Date().getTime());\n        lastPoint = parent.points.length > 0 && parent.points[parent.points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= 5 : false;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        this.selPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n            ratioY: (y - parent.img.destTop) / parent.img.destHeight, time: this.fhdObj.time });\n        if (!lastPoint || !(lastPoint && isLastPointTooClose) || mouseDown) {\n            this.fhdObj.time = new Date().getTime();\n            parent.points.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            this.dummyPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            if (this.dummyPoints.length > 2) {\n                if (this.dummyPoints.length === 3) {\n                    this.dummyPoints.unshift(this.dummyPoints[0]);\n                }\n                var p0 = this.dummyPoints[0];\n                var p1 = this.dummyPoints[1];\n                var p2 = this.dummyPoints[2];\n                var p3 = this.dummyPoints[3];\n                controlPoint1 = this.calcCurveCP(p0, p1, p2).controlPoint2;\n                controlPoint2 = this.calcCurveCP(p1, p2, p3).controlPoint1;\n                startPoint = this.dummyPoints[1];\n                endPoint = this.dummyPoints[2];\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                this.pointCounter++;\n                this.dummyPoints.shift();\n            }\n            if (mouseDown) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = { x: x, y: y, time: new Date().getTime() };\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n    };\n    FreehandDrawing.prototype.calcCurveCP = function (p1, p2, p3) {\n        if (!p2) {\n            p2 = p1;\n        }\n        if (!p3) {\n            p3 = p2;\n        }\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    FreehandDrawing.prototype.point = function (x, y, time) {\n        this.fhdObj.pointX = x;\n        this.fhdObj.pointY = y;\n        return { x: this.fhdObj.pointX, y: this.fhdObj.pointY, time: time };\n    };\n    FreehandDrawing.prototype.startDraw = function (context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth) {\n        var tempVelocity;\n        tempVelocity = this.pointVelocity(startPoint);\n        tempVelocity = 0.7 * tempVelocity + (1 - 0.7) * this.fhdObj.lastVelocity;\n        var newWidth = Math.max(maxStrokeWidth / (0.7 + 1), minStrokeWidth);\n        this.drawCurve(this.fhdObj.time, newWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth);\n        this.fhdObj.lastVelocity = tempVelocity;\n        this.fhdObj.time = newWidth;\n    };\n    FreehandDrawing.prototype.pointVelocity = function (startPoint) {\n        return (this.fhdObj.time !== startPoint.time) ? this.distanceTo(startPoint) /\n            (this.fhdObj.time - startPoint.time) : 0;\n    };\n    FreehandDrawing.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.fhdObj.pointX - start.x, 2) + Math.pow(this.fhdObj.pointY - start.y, 2));\n    };\n    FreehandDrawing.prototype.drawCurve = function (startWidth, endWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth) {\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLength(controlPoint1, controlPoint2, startPoint, endPoint);\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * startPoint.x;\n            x += 3 * u2 * t1 * controlPoint1.x;\n            x += 3 * u1 * t2 * controlPoint2.x;\n            x += t3 * endPoint.x;\n            y = u3 * startPoint.y;\n            y += 3 * u2 * t1 * controlPoint1.y;\n            y += 3 * u1 * t2 * controlPoint2.y;\n            y += t3 * endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, maxStrokeWidth);\n            this.drawArc(x, y, width, context);\n        }\n        context.closePath();\n        context.fill();\n    };\n    FreehandDrawing.prototype.bezierLength = function (controlPoint1, controlPoint2, startPoint, endPoint) {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointX1;\n        var pointY1;\n        var pointX2;\n        var pointY2;\n        var pointX3;\n        var pointY3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointX1 = this.bezierPoint(t, startPoint.x, controlPoint1.x, controlPoint2.x, endPoint.x);\n            pointY1 = this.bezierPoint(t, startPoint.y, controlPoint1.y, controlPoint2.y, endPoint.y);\n            if (i > 0) {\n                pointX3 = pointX1 - pointX2;\n                pointY3 = pointY1 - pointY2;\n                length += Math.sqrt(pointX3 * pointX3 + pointY3 * pointY3);\n            }\n            pointX2 = pointX1;\n            pointY2 = pointY1;\n        }\n        return length;\n    };\n    FreehandDrawing.prototype.bezierPoint = function (t, startPoint, cp1, cp2, endPoint) {\n        return startPoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endPoint * t * t * t;\n    };\n    FreehandDrawing.prototype.drawArc = function (x, y, size, context) {\n        var img = this.parent.img;\n        if ((x > img.destLeft && y > img.destTop && x < (img.destLeft + img.destWidth) &&\n            y < (img.destTop + img.destHeight) ||\n            (context !== this.lowerContext && context !== this.upperContext))) {\n            context.moveTo(x, y);\n            context.arc(x, y, size, 0, 2 * Math.PI, false);\n        }\n    };\n    FreehandDrawing.prototype.freehandRedraw = function (context, points) {\n        var parent = this.parent;\n        var temp = context.filter;\n        context.filter = 'none';\n        if (points) {\n            parent.pointColl[parent.freehandCounter] = { points: points, strokeColor: parent.activeObj.strokeSettings.strokeColor,\n                strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState };\n            parent.freehandCounter++;\n        }\n        if (parent.freehandCounter > 0) {\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                var controlPoint1 = void 0;\n                var controlPoint2 = void 0;\n                var startPoint = void 0;\n                var endPoint = void 0;\n                var minStrokeWidth = void 0;\n                var maxStrokeWidth = void 0;\n                if (len > 0) {\n                    context.fillStyle = parent.pointColl[n].strokeColor;\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = parent.pointColl[n].strokeWidth;\n                }\n                if (len === 1) {\n                    controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n                    this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                }\n                for (var l = 0; l < len - 3; l++) {\n                    if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                        controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                        controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                        if (l === 0) {\n                            startPoint = parent.points[l];\n                        }\n                        else {\n                            startPoint = parent.points[l + 1];\n                        }\n                        endPoint = parent.points[l + 2];\n                        this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                    }\n                }\n                context.closePath();\n            }\n            if (context === this.lowerContext) {\n                parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        context.filter = temp;\n    };\n    FreehandDrawing.prototype.getSqPtFD = function (idx, obj) {\n        var activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var sPoints = extend([], this.selPointColl[idx].points, []);\n        this.parent.points = extend([], this.parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = sPoints.length;\n        for (var l = 0; l < len; l++) {\n            if (activePoint.startX === 0 && activePoint.startY === 0 && activePoint.endX === 0 && activePoint.endY === 0) {\n                activePoint.startX = sPoints[l].x;\n                activePoint.startY = sPoints[l].y;\n                activePoint.endX = sPoints[l].x;\n                activePoint.endY = sPoints[l].y;\n            }\n            else {\n                activePoint.startX = Math.min(activePoint.startX, sPoints[l].x);\n                activePoint.startY = Math.min(activePoint.startY, sPoints[l].y);\n                activePoint.endX = Math.max(activePoint.endX, sPoints[l].x);\n                activePoint.endY = Math.max(activePoint.endY, sPoints[l].y);\n            }\n        }\n        activePoint.startX -= this.penStrokeWidth;\n        activePoint.startY -= this.penStrokeWidth;\n        activePoint.endX += this.penStrokeWidth;\n        activePoint.endY += this.penStrokeWidth;\n        activePoint.width = activePoint.endX - activePoint.startX;\n        activePoint.height = activePoint.endY - activePoint.startY;\n        if (obj) {\n            obj['activePoint'] = activePoint;\n        }\n        return activePoint;\n    };\n    FreehandDrawing.prototype.applyPenDraw = function () {\n        var parent = this.parent;\n        if (parent.currObjType.shape === 'freehanddraw') {\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.shape = '';\n        }\n        parent.notify('shape', { prop: 'clearActObj' });\n    };\n    FreehandDrawing.prototype.applyFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        if (selectedPoint.strokeColor === '#42a5f5') {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n        }\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        if (selectedPoint) {\n            selectedPoint.isSelected = false;\n        }\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        this.fhdHovIdx = this.fhdSelIdx = null;\n    };\n    FreehandDrawing.prototype.cancelFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.pointCounter = 0;\n        if (selectedPoint) {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n            selectedPoint.strokeWidth = this.tempFHDStyles.strokeWidth;\n            selectedPoint.isSelected = false;\n        }\n        this.fhdHovIdx = this.fhdSelIdx = this.fhdSelID = null;\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor;\n        parent.activeObj.strokeSettings.strokeWidth = this.penStrokeWidth = this.tempFHDStyles.strokeWidth;\n        this.tempFHDStyles = { strokeColor: null, strokeWidth: null, fillColor: null };\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n    };\n    FreehandDrawing.prototype.selectFhd = function (index) {\n        var parent = this.parent;\n        parent.notify('selection', { prop: 'setFreehandDrawEditing', onPropertyChange: false, value: { bool: true } });\n        if (index || index === 0) {\n            if (this.isFHDIdx(index)) {\n                this.fhdSelIdx = this.fhdHovIdx = index;\n                this.hoverFhd();\n                parent.upperCanvas.style.cursor = parent.cursor = 'pointer';\n            }\n            else {\n                return;\n            }\n        }\n        this.fhdSelIdx = this.fhdHovIdx;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var point = parent.pointColl[this.fhdSelIdx];\n        point.isSelected = true;\n        this.fhdSelID = point.id;\n        if (point.strokeColor !== '#42a5f5') {\n            parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor = point.strokeColor;\n        }\n        parent.activeObj.strokeSettings.strokeWidth = this.tempFHDStyles.strokeWidth =\n            parent.pointColl[this.fhdHovIdx].strokeWidth;\n        var obj = { bool: false };\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var shapeSettings = { id: 'pen_' + (this.fhdSelIdx + 1), type: ShapeType.FreehandDraw,\n                startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity };\n            var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.triggerShapeChanging(shapeChangingArgs);\n        }\n        else {\n            parent.okBtn();\n        }\n    };\n    FreehandDrawing.prototype.deleteFhd = function (index, isId) {\n        var parent = this.parent;\n        if (this.isFHDIdx(index)) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempSelPointColl = extend({}, this.selPointColl, {}, true);\n            parent.pointColl = {};\n            this.selPointColl = {};\n            var count = 0;\n            if (isNullOrUndefined(isId)) {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (i !== index) {\n                        parent.pointColl[count] = tempPointColl[i];\n                        this.selPointColl[count] = tempSelPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            else {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (parseInt(tempPointColl[i].id.split('_')[1], 10) - 1 !== index) {\n                        parent.pointColl[count] = tempPointColl[i];\n                        this.selPointColl[count] = tempSelPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            parent.freehandCounter -= 1;\n            this.fhdHovIdx = this.fhdSelIdx = null;\n            parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    FreehandDrawing.prototype.zoomX = function (x) {\n        return (x * this.parent.img.destWidth) + this.parent.img.destLeft;\n    };\n    FreehandDrawing.prototype.zoomY = function (y) {\n        return (y * this.parent.img.destHeight) + this.parent.img.destTop;\n    };\n    FreehandDrawing.prototype.zoomFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.x = this.zoomX(point.ratioX);\n                point.y = this.zoomY(point.ratioY);\n            }\n        }\n        this.updateFHDCurPts();\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.x = this.zoomX(this.straightenPoint.ratioX);\n            this.straightenPoint.y = this.zoomY(this.straightenPoint.ratioY);\n        }\n        if (parent.transform.straighten !== 0) {\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        if (isNullOrUndefined(isPreventApply)) {\n            this.freehandRedraw(this.lowerContext, null);\n        }\n    };\n    FreehandDrawing.prototype.updateFHDCurPts = function () {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.x = this.zoomX(point.ratioX);\n                    point.y = this.zoomY(point.ratioY);\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.rotateFhdColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.y = destTop + (destHeight * point.ratioX);\n                point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.y = destTop + (destHeight * point.ratioX);\n                    point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.flipFHDColl = function (value) {\n        var lowercaseValue = value.toLowerCase();\n        if (lowercaseValue === 'horizontal') {\n            this.pointsHorizontalFlip();\n        }\n        else if (lowercaseValue === 'vertical') {\n            this.pointsVerticalFlip();\n        }\n        else {\n            this.pointsHorizontalFlip();\n            for (var i = 0; i < this.parent.freehandCounter; i++) {\n                this.parent.pointColl[i].shapeFlip = '';\n            }\n            this.pointsVerticalFlip();\n        }\n    };\n    FreehandDrawing.prototype.pointsHorizontalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.x <= destLeft + (destWidth / 2)) {\n                        point.x = (destLeft + destWidth) - (point.x - destLeft);\n                    }\n                    else if (point.x >= destLeft + (destWidth / 2)) {\n                        point.x = destLeft + (destLeft + destWidth - point.x);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.x <= destLeft + (destWidth / 2)) {\n                            point.x = (destLeft + destWidth) - (point.x - destLeft);\n                        }\n                        else if (point.x >= destLeft + (destWidth / 2)) {\n                            point.x = destLeft + (destLeft + destWidth - point.x);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.pointsVerticalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.y <= destTop + (destHeight / 2)) {\n                        point.y = (destTop + destHeight) - (point.y - destTop);\n                    }\n                    else if (point.y >= destTop + (destHeight / 2)) {\n                        point.y = destTop + (destTop + destHeight - point.y);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.y <= destTop + (destHeight / 2)) {\n                            point.y = (destTop + destHeight) - (point.y - destTop);\n                        }\n                        else if (point.y >= destTop + (destHeight / 2)) {\n                            point.y = destTop + (destTop + destHeight - point.y);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.updateFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n            var currObj = parent.objColl[i];\n            if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                parent.notify('shape', { prop: 'straightenShapePoints', value: { obj: currObj, isReverse: true } });\n            }\n            else if (currObj.shape === 'path') {\n                var temp = parent.transform.straighten;\n                parent.transform.straighten = -parent.transform.straighten;\n                parent.notify('shape', { prop: 'straightenPath', onPropertyChange: false, value: { obj: currObj } });\n                parent.transform.straighten = temp;\n            }\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) /\n                    destWidth), startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width, height: destHeight /\n                    currObj.activePoint.height };\n            if (currObj.shape === 'path') {\n                for (var j = 0, jLen = currObj.pointColl.length; j < jLen; j++) {\n                    currObj.pointColl[j].ratioX =\n                        (currObj.pointColl[j].x - destLeft) / destWidth;\n                    currObj.pointColl[j].ratioY =\n                        (currObj.pointColl[j].y - destTop) / destHeight;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (parent.freehandCounter > 0 && parent.transform.straighten !== 0) {\n            var temp = parent.transform.straighten;\n            parent.transform.straighten = -parent.transform.straighten;\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n            parent.transform.straighten = temp;\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.ratioX = (this.straightenPoint.x - destLeft) / destWidth;\n            this.straightenPoint.ratioY = (this.straightenPoint.y - destTop) / destHeight;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n    };\n    FreehandDrawing.prototype.panFHDColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                if (panRegion === '' || panRegion === 'vertical') {\n                    point.x += xDiff;\n                }\n                else {\n                    point.x -= xDiff;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    point.y += yDiff;\n                }\n                else {\n                    point.y -= yDiff;\n                }\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    if (panRegion === '' || panRegion === 'vertical') {\n                        point.x += xDiff;\n                    }\n                    else {\n                        point.x -= xDiff;\n                    }\n                    if (panRegion === '' || panRegion === 'horizontal') {\n                        point.y += yDiff;\n                    }\n                    else {\n                        point.y -= yDiff;\n                    }\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            if (panRegion === '' || panRegion === 'vertical') {\n                this.straightenPoint.x += xDiff;\n            }\n            else {\n                this.straightenPoint.x -= xDiff;\n            }\n            if (panRegion === '' || panRegion === 'horizontal') {\n                this.straightenPoint.y += yDiff;\n            }\n            else {\n                this.straightenPoint.y -= yDiff;\n            }\n        }\n        this.freehandRedraw(this.lowerContext, null);\n    };\n    FreehandDrawing.prototype.freeHandDraw = function (value) {\n        var parent = this.parent;\n        if (value) {\n            parent.points = [];\n            this.dummyPoints = [];\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.togglePen = true;\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            parent.upperCanvas.style.display = 'block';\n            if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                var obj = { strokeSettings: {} };\n                parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                    value: { obj: obj } });\n                parent.activeObj.strokeSettings = obj['strokeSettings'];\n            }\n            if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                parent.activeObj.strokeSettings.strokeWidth = 2;\n            }\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        }\n        else {\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n            parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n        }\n    };\n    FreehandDrawing.prototype.isFHDIdx = function (index, obj) {\n        var isIndex = false;\n        for (var i = 0; i < this.parent.freehandCounter; i++) {\n            if (this.parent.pointColl[i].id &&\n                parseInt(this.parent.pointColl[i].id.split('_')[1], 10) - 1 === index) {\n                isIndex = true;\n                break;\n            }\n        }\n        if (obj) {\n            obj['isIndex'] = isIndex;\n        }\n        return isIndex;\n    };\n    FreehandDrawing.prototype.updateCropPtsForSel = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: extend([], this.selPointColl) };\n            if (obj['selPointColl'][n]) {\n                this.selPoints = extend([], obj['selPointColl'][n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - actPoint.startX) / actPoint.width;\n                    point.ratioY = (point.y - actPoint.startY) / actPoint.height;\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.triggerShapeChanging = function (shapeChangingArgs) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var parent = this.parent;\n        var point = parent.pointColl[this.fhdSelIdx];\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        this.penStrokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n        if (parent.activeObj.strokeSettings.strokeColor !== shapeChangingArgs.currentShapeSettings.strokeColor) {\n            parent.activeObj.strokeSettings.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        if (this.fhdSelID && point && shapeChangingArgs.currentShapeSettings) {\n            point.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            point.strokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n            point.points = shapeChangingArgs.currentShapeSettings.points;\n            point.opacity = shapeChangingArgs.currentShapeSettings.opacity;\n        }\n        if (shapeChangingArgs.action === 'select') {\n            this.freehandRedraw(this.upperContext);\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        }\n    };\n    FreehandDrawing.prototype.setCenterSelPoints = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(this.prevStraightenObj) ||\n            (JSON.stringify(this.prevStraightenObj.activePoint) !== JSON.stringify(actPoint))) {\n            this.straightenPoint = { x: actPoint.startX + (actPoint.width / 2),\n                y: actPoint.startY + (actPoint.height / 2),\n                ratioX: (actPoint.startX + (actPoint.width / 2) - destLeft) / destWidth,\n                ratioY: (actPoint.startY + (actPoint.height / 2) - destTop) / destHeight };\n            this.prevStraightenObj = extend({}, parent.activeObj, {}, true);\n            this.straightenPointAngle = parent.transform.straighten;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    return FreehandDrawing;\n}());\nexport { FreehandDrawing };\n","import { Browser, EventHandler, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType, ZoomTrigger } from '../index';\nvar Selection = /** @class */ (function () {\n    function Selection(parent) {\n        this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        this.oldPoint = {};\n        this.isTouch = false;\n        this.isObjSelected = false;\n        this.isFhdPoint = false; // Specifies whether mouse cursor is on freehand drawing point or not\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        this.isShapeInserted = false;\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] }; // for undo redo\n        this.isFirstMove = false; // for pinch zoom\n        this.startTouches = []; // for pinch zoom\n        this.tempTouches = []; // for pinch zoom\n        this.currMousePoint = { x: 0, y: 0 }; // To prevent mouse move event on pinch zoom\n        this.cursorTargetId = '';\n        this.isPreventDragging = false; // Shapes dragging is prevented when crop region is inside shape points\n        this.dragElement = '';\n        this.textRow = 1; // text area row count\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.isFhdEditing = false; // Specifies whether freehand drawing is in editing mode or not\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.touchTime = 0;\n        this.resizedElement = '';\n        this.isImageClarity = true;\n        this.isPinching = false;\n        this.isSliding = false;\n        this.mouseDown = '';\n        this.isSliderActive = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Selection.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Selection.prototype.addEventListener = function () {\n        this.parent.on('selection', this.selection, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        this.parent.off('selection', this.selection);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Selection.prototype.selection = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'mouse-up':\n                this.selMouseUpEvent();\n                break;\n            case 'setCursor':\n                this.setCursor(args.value['x'], args.value['y']);\n                break;\n            case 'updateActivePoint':\n                this.updateActivePoint(args.value['x'], args.value['y'], args.value['isCropSelection']);\n                break;\n            case 'updateCursorStyles':\n                this.updateCursorStyles(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'setTextSelection':\n                this.setTextSelection(args.value['width'], args.value['height']);\n                break;\n            case 'setActivePoint':\n                this.setActivePoint(args.value['startX'], args.value['startY']);\n                break;\n            case 'clearSelection':\n                this.clearSelection(args.value['resetCrop']);\n                break;\n            case 'calcShapeRatio':\n                this.calcShapeRatio(args.value['x'], args.value['y'], args.value['imgWidth'], args.value['imgHeight']);\n                break;\n            case 'applyCurrShape':\n                this.applyCurrShape(args.value['isShapeClick']);\n                break;\n            case 'tab':\n                this.performTabAction();\n                break;\n            case 'setDragDirection':\n                this.setDragDirection(args.value['width'], args.value['height']);\n                break;\n            case 'clearUpperCanvas':\n                if (this.isTouch) {\n                    setTimeout(function () {\n                        parent.upperCanvas.getContext('2d').clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }, 550);\n                }\n                break;\n            case 'resetFreehandDrawVariables':\n                this.isFhdEditing = this.isFhdPoint = false;\n                break;\n            case 'isShapeInserted':\n                this.isShapeInserted = args.value['bool'];\n                break;\n            case 'redrawShape':\n                this.redrawShape(args.value['obj']);\n                break;\n            case 'setTextBoxStylesToActObj':\n                this.setTextBoxStylesToActObj();\n                break;\n            case 'mouseDownEventHandler':\n                this.mouseDownEventHandler(args.value['e']);\n                break;\n            case 'mouseMoveEventHandler':\n                this.mouseMoveEventHandler(args.value['e']);\n                break;\n            case 'mouseUpEventHandler':\n                this.mouseUpEventHandler(args.value['e']);\n                break;\n            case 'canvasMouseDownHandler':\n                this.canvasMouseDownHandler(args.value['e']);\n                break;\n            case 'canvasMouseMoveHandler':\n                this.canvasMouseMoveHandler(args.value['e']);\n                break;\n            case 'canvasMouseUpHandler':\n                this.canvasMouseUpHandler(args.value['e']);\n                break;\n            case 'touchStartHandler':\n                this.touchStartHandler(args.value['e']);\n                break;\n            case 'keyDownEventHandler':\n                this.keyDownEventHandler(args.value['e']);\n                break;\n            case 'handleScroll':\n                this.handleScroll(args.value['e']);\n                break;\n            case 'textKeyDown':\n                setTimeout(this.textKeyDown.bind(this), 1, args.value['e']);\n                break;\n            case 'deleteItem':\n                this.deleteItem();\n                break;\n            case 'updatePrevShapeSettings':\n                this.updatePrevShapeSettings(args.value['obj']);\n                break;\n            case 'getZoomType':\n                args.value['obj']['zoomType'] = this.zoomType;\n                break;\n            case 'setZoomType':\n                this.zoomType = args.value['zoomType'];\n                break;\n            case 'setInitialTextEdit':\n                this.isInitialTextEdited = args.value['bool'];\n                break;\n            case 'setDragCanvas':\n                this.dragCanvas = args.value['bool'];\n                break;\n            case 'setFreehandDrawCustomized':\n                this.isFhdCustomized = args.value['isFreehandDrawCustomized'];\n                break;\n            case 'setTouchEndPoint':\n                this.touchEndPoint.x = args.value['x'];\n                this.touchEndPoint.y = args.value['y'];\n                break;\n            case 'getPanDown':\n                args.value['obj']['panDown'] = this.panDown;\n                break;\n            case 'setPanDown':\n                this.panDown = args.value['panDown'];\n                break;\n            case 'getFreehandDrawEditing':\n                args.value['obj']['bool'] = this.isFhdEditing;\n                break;\n            case 'setFreehandDrawEditing':\n                this.isFhdEditing = args.value['bool'];\n                break;\n            case 'getTempActObj':\n                args.value['obj']['tempObj'] = this.tempActiveObj;\n                break;\n            case 'setTempActObj':\n                this.tempActiveObj = args.value['obj'];\n                break;\n            case 'isInside':\n                this.isInside(args.value['x'], args.value['y'], args.value['z1'], args.value['z2'], args.value['z3'], args.value['z4']);\n                break;\n            case 'setDragElement':\n                this.dragElement = args.value['value'];\n                break;\n            case 'setObjSelected':\n                this.isObjSelected = args.value['bool'];\n                break;\n            case 'adjustActObjForLineArrow':\n                this.adjustActObjForLineArrow(args.value['obj']);\n                break;\n            case 'findTarget':\n                this.findTarget(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'getCurrentFlipState':\n                this.getCurrentFlipState();\n                break;\n            case 'setDragWidth':\n                this.setDragWidth(args.value['width']);\n                break;\n            case 'setDragHeight':\n                this.setDragHeight(args.value['setDragHeight']);\n                break;\n            case 'annotate':\n                this.currentDrawingShape = args.value['shape'];\n                if (args.value['shape'] === 'text') {\n                    parent.activeObj.textSettings.fontSize = 100;\n                    parent.activeObj.keyHistory = 'Enter Text';\n                    parent.notify('shape', { prop: 'initializeTextShape', onPropertyChange: false,\n                        value: { text: null, fontFamily: null, fontSize: null, bold: null, italic: null, strokeColor: null } });\n                }\n                else if (args.value['shape'] === 'path') {\n                    parent.activeObj.pointColl = [];\n                }\n                break;\n            case 'getCurrentDrawingShape':\n                args.value['obj']['shape'] = this.currentDrawingShape;\n                break;\n            case 'setCurrentDrawingShape':\n                this.currentDrawingShape = args.value['value'];\n                break;\n            case 'getTransRotationPoint':\n                this.getTransRotationPoint(args.value['obj'], args.value['object']);\n                break;\n            case 'adjustNEPoints':\n                this.adjustNEPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'adjustRotationPoints':\n                this.adjustRotationPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle'], args.value['type'], args.value['elem']);\n                break;\n            case 'getResizeDirection':\n                this.getResizeDirection(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'setResizedElement':\n                this.resizedElement = args.value['value'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'unWireEvent':\n                this.unwireEvent();\n                break;\n            case 'updPtCollForShpRot':\n                this.updPtCollForShpRot(args.value['obj']);\n                break;\n            case 'findImageRatio':\n                this.findImageRatio(args.value['width'], args.value['height'], args.value['obj']);\n                break;\n            case 'getNumTextValue':\n                this.getNumTextValue(args.value['obj']);\n                break;\n            case 'setImageClarity':\n                this.isImageClarity = args.value['bool'];\n                break;\n            case 'upgradeImageQuality':\n                this.upgradeImageQuality();\n                break;\n            case 'getScaleRatio':\n                args.value['obj']['newScale'] = this.getScaleRatio(args.value['scale']);\n                break;\n            case 'triggerShapeChange':\n                this.triggerShapeChange(args.value['shapeResizingArgs'], args.value['shapeMovingArgs'], args.value['type']);\n                break;\n            case 'limitDrag':\n                args.value['bool'] = this.limitDrag(args.value['isStart']);\n                break;\n            case 'applyTransformToImg':\n                this.applyTransformToImg(args.value['ctx']);\n                break;\n            case 'findTargetObj':\n                args.value['obj']['bool'] = this.findTargetObj(args.value['x'], args.value['y'], args.value['isCrop']);\n                break;\n            case 'setSliding':\n                this.isSliding = args.value['bool'];\n                break;\n            case 'setSliderActive':\n                this.isSliderActive = args.value['bool'];\n                break;\n            case 'getArrowType':\n                args.value['obj']['type'] = this.getArrowType(args.value['type']);\n                break;\n        }\n    };\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Selection.prototype.reset = function () {\n        this.diffPoint = { x: 0, y: 0 };\n        this.oldPoint = {};\n        this.isTouch = this.isObjSelected = this.isFhdPoint = this.isShapeInserted = false;\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 };\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] };\n        this.isFirstMove = false;\n        this.cursorTargetId = this.dragElement = '';\n        this.startTouches = [];\n        this.tempTouches = [];\n        this.currMousePoint = { x: 0, y: 0 };\n        this.isPreventDragging = false;\n        this.timer = undefined;\n        this.tempObjColl = undefined;\n        this.textRow = 1;\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 };\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = this.isPinching = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.panDown = null;\n        this.isSliding = false;\n        this.isFhdEditing = false;\n        this.pathAdjustedIndex = null;\n        this.touchTime = 0;\n        this.isImageClarity = true;\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.resizedElement = '';\n        this.mouseDown = '';\n        this.isSliderActive = false;\n    };\n    Selection.prototype.performTabAction = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var allowUndoRedoPush = this.applyCurrShape(false);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n    };\n    Selection.prototype.selMouseUpEvent = function () {\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    Selection.prototype.getMouseCursor = function (actObj, x, y, isCropSelection, isApply) {\n        var rotationCirclePoint = this.getTransRotationPoint(actObj);\n        var radius = actObj.bottomCenterCircle.radius;\n        var cursor = 'default';\n        var ratio = isApply ? 0 : ((actObj.topLeftCircle.radius * 2));\n        if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.topLeftCircle.startY + ratio)) {\n            cursor = 'nw-resize';\n        }\n        else if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX - ratio) &&\n            y >= (actObj.topCenterCircle.startY - ratio) &&\n            y <= (actObj.topCenterCircle.startY + ratio)) {\n            cursor = 'n-resize';\n        }\n        else if (x >= (actObj.topRightCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.topRightCircle.startY + ratio)) {\n            cursor = 'ne-resize';\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - ratio) &&\n            x <= (actObj.centerLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY - ratio)) {\n            cursor = 'w-resize';\n        }\n        else if (x >= (actObj.centerRightCircle.startX - ratio) &&\n            x <= (actObj.centerRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY - ratio)) {\n            cursor = 'e-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomLeftCircle.startX + ratio) &&\n            y >= (actObj.bottomLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY + ratio)) {\n            cursor = 'sw-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX - ratio) &&\n            y >= (actObj.bottomCenterCircle.startY - ratio) &&\n            y <= (actObj.bottomCenterCircle.startY + ratio)) {\n            cursor = 's-resize';\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX + ratio) &&\n            y >= (actObj.bottomRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY + ratio)) {\n            cursor = 'se-resize';\n        }\n        else if ((x >= actObj.activePoint.startX &&\n            x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n            y <= actObj.activePoint.endY)) {\n            if (isCropSelection) {\n                cursor = 'grab';\n            }\n            else {\n                cursor = 'move';\n            }\n        }\n        else if (rotationCirclePoint && !isApply &&\n            x >= (rotationCirclePoint.x - (radius + 2)) &&\n            x <= rotationCirclePoint.x + (radius + 2) &&\n            y >= rotationCirclePoint.y - (radius + 2) &&\n            y <= rotationCirclePoint.y + (radius + 2)) {\n            cursor = 'grabbing';\n        }\n        else {\n            cursor = 'default';\n        }\n        return cursor;\n    };\n    Selection.prototype.setCursor = function (x, y) {\n        var parent = this.parent;\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || this.isSliding || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        var isCropSelection = false;\n        var splitWords;\n        if (this.currentDrawingShape !== '') {\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            return;\n        }\n        if (parent.currObjType.isDragging) {\n            if (this.dragElement === '') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.dragElement;\n            }\n            return;\n        }\n        if (parent.activeObj.horTopLine !== undefined) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isCropSelection && parent.togglePan) {\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            var cursor = parent.upperCanvas.style.cursor;\n            var actObj = extend({}, parent.activeObj, {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            var degree = void 0;\n            if (actObj.shapeDegree === 0) {\n                degree = parent.transform.degree;\n            }\n            else {\n                degree = parent.transform.degree - actObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, false);\n                var cursorColl = ['n-resize', 's-resize', 'e-resize', 'w-resize'];\n                if ((actObj.shape === 'text') && cursorColl.indexOf(parent.cursor) > -1) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n            }\n            if (cursor === 'default' && parent.cursor === 'default' && isCropSelection) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        else if (parent.togglePan && !parent.togglePen) {\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n        }\n        else {\n            if (parent.currObjType.isCustomCrop || parent.togglePen) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n        if (parent.cursor === 'default' || parent.cursor === 'grab') {\n            var cursor = parent.upperCanvas.style.cursor;\n            if (parent.objColl.length > 0 && (parent.cursor !== 'grab' || !isCropSelection)) {\n                this.setCursorFromObj(x, y, parent.objColl, parent.upperCanvas, isCropSelection);\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        if ((parent.cursor === 'default' || parent.cursor === 'grab')\n            && parent.pointColl[0] && (parent.cursor !== 'grab' || !isCropSelection)\n            && !parent.currObjType.isDragging && !parent.currObjType.isResize) {\n            this.setCursorForFreehandDrawing(x, y, parent.upperCanvas);\n        }\n    };\n    Selection.prototype.setCursorForPath = function (actObj, x, y, upperCanvas) {\n        this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n        var parent = this.parent;\n        if (parent.cursor === 'default') {\n            var obj = extend({}, actObj, null, true);\n            var isMove = false;\n            for (var i = 1, len = actObj.pointColl.length; i < len; i++) {\n                if (isMove) {\n                    break;\n                }\n                obj.activePoint.startX = actObj.pointColl[i - 1].x;\n                obj.activePoint.startY = actObj.pointColl[i - 1].y;\n                obj.activePoint.endX = actObj.pointColl[i].x;\n                obj.activePoint.endY = actObj.pointColl[i].y;\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                var radius = actObj.topLeftCircle.radius;\n                for (var j = 0, jLen = obj.pointColl.length; j < jLen; j++) {\n                    var point = obj.pointColl[j];\n                    if (!isNullOrUndefined(point.x - (radius * 2)) &&\n                        !isNullOrUndefined(point.x + (radius * 2)) &&\n                        !isNullOrUndefined(point.y - (radius * 2)) &&\n                        !isNullOrUndefined(point.y + (radius * 2)) &&\n                        x >= (point.x - (radius * 2)) &&\n                        x <= (point.x + (radius * 2)) &&\n                        y >= (point.y - (radius * 2)) &&\n                        y <= (point.y + (radius * 2))) {\n                        upperCanvas.style.cursor = parent.cursor = 'move';\n                        isMove = true;\n                        break;\n                    }\n                    else {\n                        upperCanvas.style.cursor = parent.cursor = 'default';\n                    }\n                }\n            }\n        }\n        return parent.cursor;\n    };\n    Selection.prototype.setCursorForLineArrow = function (actObj, x, y, upperCanvas) {\n        var index;\n        var radius = actObj.topLeftCircle.radius;\n        for (var i = 0, len = actObj.pointColl.length; i < len; i++) {\n            var point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                upperCanvas.style.cursor = this.parent.cursor = 'move';\n                index = i;\n                break;\n            }\n            else {\n                upperCanvas.style.cursor = this.parent.cursor = 'default';\n            }\n        }\n        return index;\n    };\n    Selection.prototype.setCursorForRotatedObject = function (actObj, x, y, upperCanvas) {\n        this.resizedElement = '';\n        var parent = this.parent;\n        var radius = actObj.bottomCenterCircle.radius;\n        var horTP = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)];\n        var horTP1 = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)];\n        var verLP = actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)];\n        var verRP = actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)];\n        var horBP = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)];\n        var horBP1 = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)];\n        var rotCP = actObj.rotationCirclePointColl;\n        var horTP0 = actObj.horTopLinePointColl[0];\n        var horBP0 = actObj.horBottomLinePointColl[0];\n        if (x >= (horTP0.x - (radius + 2)) && x <= (horTP0.x + (radius + 2)) && y >= (horTP0.y - (radius + 2)) &&\n            y <= (horTP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n        }\n        else if (x >= (horTP.x - 5) && x <= (horTP.x + 5) && y >= (horTP.y - 5) && y <= (horTP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n        }\n        else if (x >= (horTP1.x - (radius + 2)) && x <= (horTP1.x + (radius + 2)) && y >= (horTP1.y - (radius + 2)) &&\n            y <= (horTP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        else if (x >= (verLP.x - 5) && x <= (verLP.x + 5) && y >= (verLP.y - 5) && y <= (verLP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n        }\n        else if (x >= (verRP.x - 5) && x <= (verRP.x + 5) && y >= (verRP.y - 5) && y <= (verRP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n        }\n        else if (x >= (horBP0.x - (radius + 2)) && x <= (horBP0.x + (radius + 2)) && y >= (horBP0.y - (radius + 2)) &&\n            y <= (horBP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        else if (x >= (horBP.x - 5) && x <= (horBP.x + 5) && y >= (horBP.y - 5) && y <= (horBP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n        }\n        else if (x >= (horBP1.x - (radius + 2)) && x <= (horBP1.x + (radius + 2)) && y >= (horBP1.y - (radius + 2)) &&\n            y <= (horBP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'se-resize';\n        }\n        else if (rotCP && x >= (rotCP.x - (radius + 2)) && x <= rotCP.x + (radius + 2) && y >= rotCP.y - (radius + 2) &&\n            y <= rotCP.y + (radius + 2)) {\n            upperCanvas.style.cursor = parent.cursor = 'grabbing';\n        }\n        else {\n            upperCanvas.style.cursor = parent.cursor = 'default';\n            var isPointsInsideRectangle = this.getRectanglePoints(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height, actObj.rotatedAngle * (180 / Math.PI), x, y);\n            if (isPointsInsideRectangle) {\n                upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horTopLinePointColl.length; i < len; i++) {\n                var horTP_1 = actObj.horTopLinePointColl[i];\n                if (x >= (horTP_1.x - 5) && x <= (horTP_1.x + 5) && y >= (horTP_1.y - 5) && y <= (horTP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horBottomLinePointColl.length; i < len; i++) {\n                var horBP_1 = actObj.horBottomLinePointColl[i];\n                if (x >= (horBP_1.x - 5) && x <= (horBP_1.x + 5) && y >= (horBP_1.y - 5) && y <= (horBP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verLeftLinePointColl.length; i < len; i++) {\n                var verLP_1 = actObj.verLeftLinePointColl[i];\n                if (x >= (verLP_1.x - 5) && x <= (verLP_1.x + 5) && y >= (verLP_1.y - 5) && y <= (verLP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verRightLinePointColl.length; i < len; i++) {\n                var verRP_1 = actObj.verRightLinePointColl[i];\n                if (x >= (verRP_1.x - 5) && x <= (verRP_1.x + 5) && y >= (verRP_1.y - 5) && y <= (verRP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n                    break;\n                }\n            }\n        }\n        this.adjustCursorStylesForRotatedState(actObj);\n        return parent.cursor;\n    };\n    Selection.prototype.adjustCursorStylesForRotatedState = function (actObj) {\n        var parent = this.parent;\n        var length = actObj.rotatedAngle * (180 / Math.PI);\n        length = length > 0 ? Math.floor(length) : Math.ceil(length);\n        if ((length >= 92 && length <= 182) || (length >= -178 && length <= -88)) {\n            var cursorMap = { 'nw-resize': 'ne-resize', 'n-resize': 's-resize',\n                'ne-resize': 'nw-resize', 'w-resize': 'e-resize', 'e-resize': 'w-resize',\n                'sw-resize': 'se-resize', 's-resize': 'n-resize', 'se-resize': 'sw-resize'\n            };\n            if (parent.cursor in cursorMap) {\n                parent.cursor = cursorMap[parent.cursor];\n            }\n        }\n        parent.upperCanvas.style.cursor = this.getResizeElement((actObj.rotatedAngle * (180 / Math.PI)), parent.cursor);\n        return parent.cursor;\n    };\n    Selection.prototype.getResizeElement = function (degree, element) {\n        var resizeMappings = [];\n        switch (element) {\n            case 'nw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'nw-resize'], [22.5, 67.5, 'n-resize'], [67.5, 112.5, 'ne-resize'],\n                    [112.5, 157.5, 'e-resize'], [157.5, 202.5, 'se-resize'],\n                    [202.5, 247.5, 's-resize'], [247.5, 292.5, 'sw-resize'],\n                    [292.5, 337.5, 'w-resize']\n                ];\n                break;\n            case 'n-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'n-resize'], [22.5, 67.5, 'ne-resize'], [67.5, 112.5, 'e-resize'],\n                    [112.5, 157.5, 'se-resize'], [157.5, 202.5, 's-resize'], [202.5, 247.5, 'sw-resize'],\n                    [247.5, 292.5, 'w-resize'], [292.5, 337.5, 'nw-resize']\n                ];\n                break;\n            case 'ne-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'ne-resize'], [22.5, 67.5, 'e-resize'],\n                    [67.5, 112.5, 'se-resize'], [112.5, 157.5, 's-resize'], [157.5, 202.5, 'sw-resize'],\n                    [202.5, 247.5, 'w-resize'], [247.5, 292.5, 'nw-resize'], [292.5, 337.5, 'n-resize']\n                ];\n                break;\n            case 'e-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'e-resize'], [22.5, 67.5, 'se-resize'], [67.5, 112.5, 's-resize'],\n                    [112.5, 157.5, 'sw-resize'], [157.5, 202.5, 'w-resize'], [202.5, 247.5, 'nw-resize'],\n                    [247.5, 292.5, 'n-resize'], [292.5, 337.5, 'ne-resize']\n                ];\n                break;\n            case 'se-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'se-resize'], [22.5, 67.5, 's-resize'], [67.5, 112.5, 'sw-resize'],\n                    [112.5, 157.5, 'w-resize'], [157.5, 202.5, 'nw-resize'], [202.5, 247.5, 'n-resize'],\n                    [247.5, 292.5, 'ne-resize'], [292.5, 337.5, 'e-resize']\n                ];\n                break;\n            case 's-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 's-resize'], [22.5, 67.5, 'sw-resize'], [67.5, 112.5, 'w-resize'],\n                    [112.5, 157.5, 'nw-resize'], [157.5, 202.5, 'n-resize'], [202.5, 247.5, 'ne-resize'],\n                    [247.5, 292.5, 'e-resize'], [292.5, 337.5, 'se-resize']\n                ];\n                break;\n            case 'sw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'sw-resize'], [22.5, 67.5, 'w-resize'], [67.5, 112.5, 'nw-resize'],\n                    [112.5, 157.5, 'n-resize'], [157.5, 202.5, 'ne-resize'], [202.5, 247.5, 'e-resize'],\n                    [247.5, 292.5, 'se-resize'], [292.5, 337.5, 's-resize']\n                ];\n                break;\n            case 'w-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'w-resize'], [22.5, 67.5, 'nw-resize'], [67.5, 112.5, 'n-resize'],\n                    [112.5, 157.5, 'ne-resize'], [157.5, 202.5, 'e-resize'], [202.5, 247.5, 'se-resize'],\n                    [247.5, 292.5, 's-resize'], [292.5, 337.5, 'sw-resize']\n                ];\n                break;\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_1 = resizeMappings; _i < resizeMappings_1.length; _i++) {\n            var _a = resizeMappings_1[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.setCursorForFreehandDrawing = function (x, y, upperCanvas) {\n        var upperContext = upperCanvas.getContext('2d');\n        var parent = this.parent;\n        var textArea = document.querySelector('#' + parent.element.id + '_textArea');\n        var isEntered = false;\n        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n            value: { index: -1 } });\n        var sPoints;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: {} };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: obj } });\n            sPoints = extend([], obj['selPointColl'][n].points, []);\n            parent.points = extend([], parent.pointColl[n].points, []);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var ptc = parent.pointColl[n];\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = sPoints.length;\n            for (var l = 0; l < len; l++) {\n                if (l !== 0) {\n                    var isInside = false;\n                    if (sPoints[l - 1] && sPoints[l]) {\n                        isInside = this.isInside(x, y, sPoints[l - 1].x, sPoints[l - 1].y, sPoints[l].x, sPoints[l].y);\n                    }\n                    if (isInside) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                            value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var strokeColor = ptc.strokeColor;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: ptc.strokeWidth } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                                value: { index: null } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n                else {\n                    var pt = parent.points[l];\n                    if (x > pt.x - ptc.strokeWidth && x < pt.x + ptc.strokeWidth && y > pt.y - ptc.strokeWidth &&\n                        y < pt.y + ptc.strokeWidth) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false, value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false, value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var strokeColor = ptc.strokeColor;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: ptc.strokeWidth } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n            }\n            if (isEntered) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.setCursorFromObj = function (x, y, obj, upperCanvas, isCropSelection) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.length; i < len; i++) {\n            if (parent.cursor === 'move') {\n                return;\n            }\n            var actObj = extend({}, obj[i], {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, upperCanvas);\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, true);\n            }\n        }\n    };\n    Selection.prototype.isInside = function (x, y, z1, z2, z3, z4) {\n        var x1 = Math.min(z1, z3);\n        var x2 = Math.max(z1, z3);\n        var y1 = Math.min(z2, z4);\n        var y2 = Math.max(z2, z4);\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.updateActivePoint = function (x, y, isCropSelection) {\n        var parent = this.parent;\n        var obj = { width: 0, height: 0 };\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = parent.activeObj.activePoint, width = _b.width, height = _b.height;\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        var previousShapeSettings = this.updatePrevShapeSettings();\n        var shapeResizingArgs = { cancel: false, action: 'resize', previousShapeSettings: previousShapeSettings };\n        var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings };\n        this.shapeResizingArgs = shapeResizingArgs;\n        this.shapeMovingArgs = shapeMovingArgs;\n        if (parent.activeObj.shape === 'text' && this.dragElement !== '') {\n            parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: parent.activeObj, isTextArea: null } });\n        }\n        if (this.currentDrawingShape !== '' && (this.dragElement === '' || this.dragElement === 'move')) {\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                this.dragElement = 'e-resize';\n            }\n            else {\n                if (x > startX && y > startY) {\n                    this.dragElement = 'se-resize';\n                }\n                else if (x < startX && y > startY) {\n                    this.dragElement = 'sw-resize';\n                }\n                else if (x > startX && y < startY) {\n                    this.dragElement = 'ne-resize';\n                }\n                else if (x < startX && y < startY) {\n                    this.dragElement = 'nw-resize';\n                }\n            }\n        }\n        if (parent.activeObj.shape === 'arrow') {\n            if (Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2) > 0) {\n                parent.activeObj.rotatedAngle = -Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2);\n            }\n            else {\n                parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2));\n            }\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (isCropSelection && parent.transform.straighten !== 0 && this.isMouseOutsideImg(x, y)) {\n            return;\n        }\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'grabbing':\n                if (Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))) > 0) {\n                    parent.activeObj.rotatedAngle = -Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2)));\n                }\n                else {\n                    parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))));\n                }\n                if (parent.activeObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - parent.activeObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        isHorizontalflip = true;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        isVerticalflip = true;\n                    }\n                }\n                parent.activeObj.rotatedAngle -= (degree * (Math.PI / 180));\n                if (degree === 0 || degree === 360) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 90 || degree === -270) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 180 || degree === -180) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 270 || degree === -90) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                break;\n            case 'pathdrag':\n                if (!isNullOrUndefined(this.pathAdjustedIndex)) {\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].x = x;\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].y = y;\n                }\n                break;\n            default:\n                if (!isCropSelection && !parent.currObjType.isCustomCrop) {\n                    var activePoint = parent.activeObj.activePoint;\n                    if (this.dragPoint.startX) {\n                        var width_1 = (this.dragPoint.endX - this.previousPoint.x);\n                        var height_1 = (this.dragPoint.endY - this.previousPoint.y);\n                        activePoint.startX += width_1;\n                        activePoint.endX += width_1;\n                        activePoint.startY += height_1;\n                        activePoint.endY += height_1;\n                        startX = activePoint.startX;\n                        startY = activePoint.startY;\n                        endX = activePoint.endX;\n                        endY = activePoint.endY;\n                        if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                            parent.activeObj.rotationCirclePointColl) {\n                            parent.activeObj.rotationCirclePointColl.x += width_1;\n                            parent.activeObj.rotationCirclePointColl.y += height_1;\n                            parent.activeObj.rotationCirclePoint.x += width_1;\n                            parent.activeObj.rotationCirclePoint.y += height_1;\n                        }\n                        if (parent.activeObj.shape === 'path') {\n                            for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                                parent.activeObj.pointColl[i].x += width_1;\n                                parent.activeObj.pointColl[i].y += height_1;\n                            }\n                        }\n                        if (!this.isPreventDragging && parent.activeObj.shape !== 'line' && (parent.activeObj.rotatedAngle === 0 && (startX < parent.img.destLeft ||\n                            startY < parent.img.destTop || endX >\n                            parent.img.destLeft + parent.img.destWidth || endY > parent.img.destTop\n                            + parent.img.destHeight))) {\n                            activePoint.startX -= width_1;\n                            activePoint.endX -= width_1;\n                            activePoint.startY -= height_1;\n                            activePoint.endY -= height_1;\n                            if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                                parent.activeObj.rotationCirclePointColl) {\n                                parent.activeObj.rotationCirclePointColl.x -= width_1;\n                                parent.activeObj.rotationCirclePointColl.y -= height_1;\n                                parent.activeObj.rotationCirclePoint.x -= width_1;\n                                parent.activeObj.rotationCirclePoint.y -= height_1;\n                            }\n                            this.setDragWidth(width_1);\n                            this.setDragHeight(height_1);\n                        }\n                    }\n                    else {\n                        activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                        activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                        x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                        y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                        activePoint.endX = x;\n                        activePoint.endY = y;\n                    }\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'move');\n                }\n                break;\n        }\n    };\n    Selection.prototype.triggerShapeChange = function (shapeResizingArgs, shapeMovingArgs, type) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var currentShapeSettings = this.updatePrevShapeSettings();\n        if (!isNullOrUndefined(this.shapeResizingArgs) && !isNullOrUndefined(this.shapeMovingArgs)) {\n            shapeResizingArgs.currentShapeSettings = this.shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = this.shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        else {\n            shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        if (type === 'resize') {\n            this.isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.isCropSelection = true;\n            }\n            if (!this.isCropSelection) {\n                if (this.currentDrawingShape !== '') {\n                    shapeResizingArgs.action = 'drawing';\n                }\n                parent.trigger('shapeChanging', shapeResizingArgs);\n                parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: shapeResizingArgs.currentShapeSettings } });\n            }\n            else {\n                var selectionResizingArgs = { action: shapeResizingArgs.action,\n                    previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.previousShapeSettings.startX,\n                        startY: shapeResizingArgs.previousShapeSettings.startY,\n                        width: shapeResizingArgs.previousShapeSettings.width,\n                        height: shapeResizingArgs.previousShapeSettings.height },\n                    currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.currentShapeSettings.startX,\n                        startY: shapeResizingArgs.currentShapeSettings.startY,\n                        width: shapeResizingArgs.currentShapeSettings.width,\n                        height: shapeResizingArgs.currentShapeSettings.height } };\n                this.selectionResizingArgs = selectionResizingArgs;\n                parent.trigger('selectionChanging', selectionResizingArgs);\n                parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                    value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n            }\n        }\n        else if (type === 'mouse-down' || type === 'mouse-up') {\n            parent.trigger('shapeChanging', shapeResizingArgs);\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeResizingArgs.currentShapeSettings } });\n        }\n        else {\n            parent.trigger('shapeChanging', shapeMovingArgs);\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeMovingArgs.currentShapeSettings } });\n        }\n        parent.eventType = type;\n    };\n    Selection.prototype.setDragWidth = function (width) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destWidth = _a.destWidth;\n        var tempWidth = width;\n        if (tempWidth >= 0) {\n            for (var i = 0; i < tempWidth; i++) {\n                width = tempWidth - i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if (actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n        else {\n            for (var i = 1; i < Math.abs(tempWidth); i++) {\n                width = tempWidth + i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if (actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n    };\n    Selection.prototype.setDragHeight = function (height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destTop = _a.destTop, destHeight = _a.destHeight;\n        var tempHeight = height;\n        if (tempHeight >= 0) {\n            for (var i = 1; i < tempHeight; i++) {\n                height = tempHeight - i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if (actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < Math.abs(tempHeight); i++) {\n                height = tempHeight + i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if (actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n    };\n    Selection.prototype.limitDrag = function (isStart) {\n        var isLimiting = false;\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        var startX = isStart ? actPoint.startX : actPoint.endX;\n        var startY = isStart ? actPoint.startY : actPoint.endY;\n        var endX = isStart ? actPoint.endX : actPoint.startX;\n        var endY = isStart ? actPoint.endY : actPoint.startY;\n        if (startX < destLeft) {\n            startX = destLeft;\n        }\n        if (startY < destTop) {\n            startY = destTop;\n        }\n        if (endX > destLeft + destWidth) {\n            endX = destLeft + destWidth;\n        }\n        if (endY > destTop + destHeight) {\n            endY = destTop + destHeight;\n        }\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            if (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                isLimiting = true;\n            }\n        }\n        if (isStart) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = endX;\n            actPoint.endY = endY;\n        }\n        else {\n            actPoint.startX = endX;\n            actPoint.startY = endY;\n            actPoint.endX = startX;\n            actPoint.endY = startY;\n        }\n        return isLimiting;\n    };\n    Selection.prototype.isMouseOutsideImg = function (x, y) {\n        var obj = { bool: false };\n        this.parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        this.parent.notify('draw', { prop: 'isPointsInsideImg', value: { obj: obj, x: x, y: y } });\n        return obj['bool'];\n    };\n    Selection.prototype.preventDraggingInvertly = function () {\n        var isLimiting = false;\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'image') {\n            return isLimiting;\n        }\n        if (!this.isPreventDragging && parent.activeObj.rotatedAngle === 0) {\n            isLimiting = this.limitDrag(true);\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                isLimiting = this.limitDrag(false);\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventTextDraggingInvertly = function () {\n        var parent = this.parent;\n        var isLimiting = false;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (!this.isPreventDragging) {\n            if (actPoint.startX < destLeft ||\n                actPoint.startY < destTop ||\n                actPoint.endX > destLeft + destWidth ||\n                actPoint.endY > destTop + destHeight) {\n                isLimiting = true;\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventInverseResize = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (actPoint.width < 0) {\n            actPoint.width = 0;\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n        }\n        if (actPoint.height < 0) {\n            actPoint.height = 0;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.getScaleRatio = function (scale) {\n        var parent = this.parent;\n        var point = { x: scale, y: scale };\n        if (parent.activeObj.shape && parent.activeObj.shape !== 'crop-custom' &&\n            parent.activeObj.shape !== 'crop-circle' && parent.activeObj.shape !== 'crop-square') {\n            var ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ?\n                this.findImageRatio(parent.activeObj.activePoint.width, parent.activeObj.activePoint.height).split('-') :\n                parent.activeObj.shape.split('-');\n            if (ratio.length > 1 || parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text') {\n                ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ? ratio[0].split(':') : ratio[1].split(':');\n                var newScale = scale / (parseInt(ratio[1], 10));\n                point.x = newScale * (parseInt(ratio[0], 10));\n                point.y = newScale * (parseInt(ratio[1], 10));\n            }\n        }\n        return point;\n    };\n    Selection.prototype.findImageRatio = function (width, height, obj) {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        var gcd = function (a, b) {\n            if (b === 0) {\n                return a;\n            }\n            return gcd(b, a % b);\n        };\n        var divisor = gcd(width, height);\n        var ratio = width / divisor + \":\" + height / divisor;\n        if (obj) {\n            obj['ratio'] = ratio;\n        }\n        return ratio;\n    };\n    Selection.prototype.revertResizing = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (this.preventDraggingInvertly()) {\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.updateNWPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape === 'image') {\n                    this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.startX < x && actPoint.startY < y) {\n                    width = x - actPoint.startX;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.startY += newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_1 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_1) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_2 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_2) {\n                        actPoint.startX += newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateNPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = this.resizedElement = 's-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateNEPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape === 'image') {\n                    this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'e-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = this.resizedElement = 'e-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'w-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = this.resizedElement = 'w-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSWPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape === 'image') {\n                    this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateSPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = this.resizedElement = 'n-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.x;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSEPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'se-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            var newScale = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape === 'image') {\n                    this.resizeImg(x, y, 'se-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ?\n                        destTop + destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ? destLeft +\n                        destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.resizeImg = function (x, y, elem, tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var newScale;\n        if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n            switch (parent.upperCanvas.style.cursor) {\n                case 'se-resize':\n                case 's-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'sw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y > y) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'w-resize':\n                case 'nw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y < y) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'n-resize':\n                case 'ne-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y < y) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'e-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            if ((actPoint.width < 10 || actPoint.height < 10) ||\n                (parent.activeObj.shape === 'text' && parent.activeObj.rotatedAngle === 0 && this.preventTextDraggingInvertly())) {\n                parent.activeObj = extend({}, tempActiveObj, null, true);\n            }\n        }\n        this.previousPoint = { x: x, y: y };\n    };\n    Selection.prototype.adjustNWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedC[0] + x) / 2, (rotatedC[1] + y) / 2];\n        var newBottomRight = this.rotatePoints(rotatedC[0], rotatedC[1], newCenter[0], newCenter[1], -angle);\n        var newTopLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newBottomRight[0];\n        rectangle.endY = newBottomRight[1];\n        rectangle.startY = newTopLeft[1];\n        rectangle.startX = newTopLeft[0];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustNEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedD[0] + x) / 2, (rotatedD[1] + y) / 2];\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = newTopRight[0] - newBottomLeft[0];\n        rectangle.height = newBottomLeft[1] - newTopRight[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.startY = rectangle.endY - rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustSWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedB[0] + x) / 2, (rotatedB[1] + y) / 2];\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newTopRight[0];\n        rectangle.startY = newTopRight[1];\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustSEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + x) / 2, (rotatedA[1] + y) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.width = newBottomRight[0] - newTopLeft[0];\n        rectangle.height = newBottomRight[1] - newTopLeft[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.endY = rectangle.startY + rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustRotationPoints = function (rectangle, x, y, angle, type, elem) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        this.getResizeDirection(rectangle, x, y, angle, type, elem);\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + rotatedC[0]) / 2, (rotatedA[1] + rotatedC[1]) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.endX = newTopRight[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.rotatePoints = function (x, y, cx, cy, angle) {\n        return [\n            (x - cx) * Math.cos(angle) - (y - cy) * Math.sin(angle) + cx,\n            (x - cx) * Math.sin(angle) + (y - cy) * Math.cos(angle) + cy\n        ];\n    };\n    Selection.prototype.setResizedValue = function (element, value, x, y) {\n        switch (element) {\n            case 'x':\n                value += x;\n                break;\n            case 'y':\n                value += y;\n                break;\n            case 'abs-x':\n                value += (x > 0 ? -x : Math.abs(x));\n                break;\n            case 'abs-y':\n                value += (y > 0 ? -y : Math.abs(y));\n                break;\n            case 'y-abs-x':\n                value += (y + ((x > 0 ? -x : Math.abs(x)) / 2));\n                break;\n            case 'abs-x-abs-y':\n                value += ((x > 0 ? -x : Math.abs(x)) + ((y > 0 ? -y : Math.abs(y)) / 2));\n                break;\n            case 'abs-y-x':\n                value += ((y > 0 ? -y : Math.abs(y)) + (x / 2));\n                break;\n            case 'x-y':\n                value += (x + (y / 2));\n                break;\n            case 'y-x':\n                value += (y + (x / 2));\n                break;\n            case 'img-resize-x':\n                value += x;\n                break;\n            case 'img-resize-y':\n                value += y;\n                break;\n        }\n        return value;\n    };\n    Selection.prototype.getResizeDirection = function (rectangle, x, y, angle, type, elem) {\n        var rotatedAngle = angle * (180 / Math.PI);\n        var element = this.getResizedElement(rotatedAngle, this.resizedElement);\n        if (this.resizedElement === 'e-resize') {\n            rectangle.width = this.setResizedValue(element, rectangle.width, x, y);\n            rectangle.endX = rectangle.width + rectangle.startX;\n        }\n        else if (this.resizedElement === 'n-resize') {\n            rectangle.startY = this.setResizedValue(element, rectangle.startY, x, y);\n            rectangle.height = rectangle.endY - rectangle.startY;\n        }\n        else if (this.resizedElement === 'w-resize') {\n            rectangle.startX = this.setResizedValue(element, rectangle.startX, x, y);\n            rectangle.width = rectangle.startX + rectangle.endX;\n        }\n        else if (this.resizedElement === 's-resize') {\n            rectangle.height = this.setResizedValue(element, rectangle.height, x, y);\n            rectangle.endY = rectangle.height + rectangle.startY;\n        }\n        else if (type && type === 'img-resize') {\n            rectangle.width = this.setResizedValue('img-resize-x', rectangle.width, x, y);\n            rectangle.height = this.setResizedValue('img-resize-y', rectangle.height, x, y);\n            if (elem === 'se-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'sw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'ne-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n            else if (elem === 'nw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n        }\n        else if (type && type === 'text') {\n            if (elem === 'widthHeight') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.height = this.setResizedValue('y-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'width') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n            }\n            else if (elem === 'height') {\n                rectangle.height = this.setResizedValue('y-abs-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n        }\n    };\n    Selection.prototype.getResizedElement = function (degree, element) {\n        var resizeMappings = [];\n        if (element === 'n-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'e-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        else if (element === 's-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'w-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_2 = resizeMappings; _i < resizeMappings_2.length; _i++) {\n            var _a = resizeMappings_2[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.updateCursorStyles = function (x, y, type) {\n        var parent = this.parent;\n        var isResize = false;\n        if (parent.activeObj.keyHistory !== '' && parent.activeObj.shape === undefined && !parent.currObjType.isCustomCrop &&\n            !parent.currObjType.isLine && parent.currObjType.isText) {\n            parent.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        var degree;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (this.isObjSelected) {\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                isResize = this.updateCursorStylesForLineArrow(x, y, actObj);\n            }\n            else if (actObj.shape === 'path') {\n                isResize = this.updateCursorStylesForPath(x, y, actObj);\n            }\n            else if (actObj.rotatedAngle) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.cursor;\n                }\n                else if (parent.cursor === 'move') {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                else if (parent.cursor !== 'default') {\n                    isResize = true;\n                    this.dragElement = parent.cursor;\n                    parent.currObjType.isResize = true;\n                }\n            }\n            else {\n                var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                var radius = actObj.topLeftCircle.radius;\n                if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topLeftCircle.startY + (radius * 2)) && this.dragElement !== 'nw-resize') {\n                    actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.topCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topCenterCircle.startY + (radius * 2)) && this.dragElement !== 'n-resize') {\n                    actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'n-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topRightCircle.startY + (radius * 2)) && this.dragElement !== 'ne-resize') {\n                    actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY - (radius * 2)) && this.dragElement !== 'w-resize') {\n                    actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'w-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY - (radius * 2)) && this.dragElement !== 'e-resize') {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'e-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (radius * 2)) && this.dragElement !== 'sw-resize') {\n                    actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (radius * 2)) && this.dragElement !== 's-resize') {\n                    actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 's-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY + (radius * 2)) && this.dragElement !== 'se-resize') {\n                    actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (rotationCirclePoint &&\n                    x >= rotationCirclePoint.x - (radius * 2) &&\n                    x <= rotationCirclePoint.x + (radius * 2) &&\n                    y >= rotationCirclePoint.y - (radius * 2) &&\n                    y <= rotationCirclePoint.y + (radius * 2) && this.dragElement !== 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                if ((actObj.shape === 'text') && (parent.cursor === 'n-resize' ||\n                    parent.cursor === 's-resize' || parent.cursor === 'e-resize' ||\n                    parent.cursor === 'w-resize')) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n            }\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY) || this.dragElement === 'grabbing') {\n                parent.currObjType.isDragging = true;\n            }\n            else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n        }\n        else {\n            parent.currObjType.isDragging = true;\n        }\n        if (actObj.rotatedAngle !== 0 && (this.dragElement === 'e-resize' ||\n            this.dragElement === 'w-resize' || this.dragElement === 'n-resize' ||\n            this.dragElement === 's-resize')) {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n    };\n    Selection.prototype.updateCursorStylesForLineArrow = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        var point;\n        var radius = actObj.topLeftCircle.radius;\n        for (var i = 0; i < 5; i++) {\n            point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                this.dragElement = 'w-resize';\n                isResize = true;\n                break;\n            }\n        }\n        if (!isResize) {\n            for (var i = 1; i < 6; i++) {\n                point = actObj.pointColl[actObj.pointColl.length - i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    this.dragElement = 'e-resize';\n                    isResize = true;\n                    break;\n                }\n            }\n        }\n        if (!isResize) {\n            for (var i = 0; i < actObj.pointColl.length; i++) {\n                point = actObj.pointColl[i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                    break;\n                }\n                else {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                }\n            }\n        }\n        return isResize;\n    };\n    Selection.prototype.updateCursorStylesForPath = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        this.pathAdjustedIndex = this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n        if (parent.cursor === 'move') {\n            isResize = true;\n            this.dragElement = 'pathDrag';\n        }\n        if (!isResize) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        return isResize;\n    };\n    Selection.prototype.setTextSelection = function (width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var degree = parent.transform.degree;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n            var flip = parent.activeObj.flipObjColl[i].toLowerCase();\n            switch (degree) {\n                case 0:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint = { startX: actPoint.endX - width, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (height ? height : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                                endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint = { startX: actPoint.startX,\n                                startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)), endY: actPoint.startY +\n                                    (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 90:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - width, endX: (actPoint.endX), endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                    }\n                    break;\n                case 180:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + width),\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint.endY = actPoint.startY + height;\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.startY };\n                            break;\n                        default:\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.endY - (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 270:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + height),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        default:\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                    }\n                    break;\n            }\n        }\n        if (parent.activeObj.flipObjColl.length === 0) {\n            switch (degree) {\n                case 0:\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                        endY: actPoint.startY + (height ? height : 0) };\n                    break;\n                case 90:\n                    actPoint.startX = actPoint.endX - height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                        endY: actPoint.startY + (width ? width : 0) };\n                    break;\n                case 180:\n                    actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                        startY: actPoint.endY - (height ? height : 0) };\n                    break;\n                case 270:\n                    actPoint.endX = actPoint.startX + height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                        endY: actPoint.endY };\n                    break;\n            }\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        parent.activeObj.activePoint = actPoint;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Selection.prototype.setActivePoint = function (startX, startY) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(activePoint)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : parent.activeObj.textSettings.fontSize;\n            if (parent.activeObj.textSettings.fontSize === undefined) {\n                parent.activeObj.textSettings.fontSize = (Math.abs(parent.baseImgCanvas.width - parent.baseImgCanvas.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = activePoint.endX;\n            this.mouseDownPoint.y = activePoint.endY;\n            if (parent.activeObj.horTopLine !== undefined) {\n                parent.activeObj.activePoint = extend({}, activePoint, {}, true);\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n        else if (startX && startY) {\n            activePoint.startX = this.mouseDownPoint.x = startX;\n            activePoint.startY = this.mouseDownPoint.y = startY;\n            parent.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = parent.activeObj;\n            activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            activePoint.width = activePoint.endX - activePoint.startX;\n            activePoint.height = activePoint.endY - activePoint.startY;\n        }\n    };\n    Selection.prototype.mouseDownEventHandler = function (e) {\n        var parent = this.parent;\n        this.mouseDown = e.currentTarget === parent.lowerCanvas || e.currentTarget === parent.upperCanvas ?\n            'canvas' : '';\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n        }\n        else {\n            this.isTouch = false;\n        }\n        if (e.type === 'touchstart' && e.currentTarget === parent.lowerCanvas && !parent.isImageLoaded) {\n            return;\n        }\n        this.isCropSelection = false;\n        this.isPan = true;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            this.isCropSelection = true;\n        }\n        if (this.isCropSelection) {\n            this.dragCanvas = parent.togglePan = true;\n        }\n        var imageEditorClickEventArgs = { point: this.setXYPoints(e) };\n        parent.trigger('click', imageEditorClickEventArgs);\n        this.clickEvent(imageEditorClickEventArgs, e);\n    };\n    Selection.prototype.getImagePoints = function (x, y) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (x < destLeft) {\n            x = destLeft;\n        }\n        else if (x > destLeft + destWidth) {\n            x = destLeft + destWidth;\n        }\n        if (y < destTop) {\n            y = destTop;\n        }\n        else if (y > destTop + destHeight) {\n            y = destTop + destHeight;\n        }\n        return { x: x, y: y };\n    };\n    Selection.prototype.clickEvent = function (imageEditorClickEventArgs, e) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        var x = imageEditorClickEventArgs.point.x;\n        var y = imageEditorClickEventArgs.point.y;\n        var cursor = parent.activeObj.shape && parent.activeObj.shape === 'text' ?\n            parent.cursor : 'default';\n        if (parent.isResize) {\n            this.performEnterAction();\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        else if (JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            parent.okBtn();\n        }\n        else if (this.currentDrawingShape !== '') {\n            var object_1 = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_1 } });\n            this.initialPrevObj = object_1['currObj'];\n            this.initialPrevObj.objColl = extend([], parent.objColl, [], true);\n            this.initialPrevObj.pointColl = extend([], parent.pointColl, [], true);\n            this.initialPrevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.initialPrevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.setActivePoint(x, y);\n            if (this.currentDrawingShape === 'path') {\n                var point = this.getImagePoints(x, y);\n                parent.activeObj.pointColl.push({ x: point.x, y: point.y });\n                if (activePoint.width !== 0 && activePoint.height !== 0) {\n                    activePoint.width = 0;\n                    activePoint.height = 0;\n                    activePoint.startX = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].x;\n                    activePoint.startY = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].y;\n                }\n            }\n            activePoint.endX = activePoint.startX;\n            activePoint.endY = activePoint.startY;\n            parent.currObjType.isDragging = true;\n            var previousShapeSettings = this.updatePrevShapeSettings();\n            var shapeResizingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: previousShapeSettings };\n            var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings };\n            this.shapeResizingArgs = shapeResizingArgs;\n            this.shapeMovingArgs = shapeMovingArgs;\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n            return;\n        }\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        if (this.isCropSelection && this.dragCanvas) {\n            this.setCursor(x, y);\n            if (parent.cursor !== 'move' && parent.cursor !== 'crosshair' &&\n                parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                this.isPan = false;\n            }\n        }\n        if (parent.activeObj.shape) {\n            this.isObjSelected = true;\n        }\n        else {\n            this.isObjSelected = false;\n        }\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var isShape = this.isShapeTouch(e, this.isCropSelection);\n        var isFreehandDraw = this.isFreehandDrawTouch(e, this.isCropSelection);\n        var isShapeClick = isShape ? isShape : this.isShapeClick(e, this.isCropSelection);\n        var allowUndoRedoPush = this.applyCurrShape(isShapeClick);\n        var isTextArea = parent.textArea.style.display !== 'none' ? true : false;\n        if (this.isTouch && !isShape && activeObj.shape && !this.isCropSelection) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        if (!isShape && !parent.togglePen && !this.isCropSelection) {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        if (this.dragCanvas && this.isPan && (parent.cursor === 'grab' || this.isTouch)\n            && !isShape && !isFreehandDraw && !parent.togglePen) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_1 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_1;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            if (this.isFhdEditing) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.isFhdCustomized = false;\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            var shape = parent.activeObj.shape;\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n            if (shape && shapeColl.indexOf(shape) > -1) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            var isLineArrow = false;\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'line' ||\n                parent.activeObj.shape === 'arrow')) {\n                isLineArrow = true;\n            }\n            var points = this.setXYPoints(e);\n            var x_1 = points.x;\n            var y_1 = points.y;\n            if (this.applyObj(x_1, y_1)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_2 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_2;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: x_1, y: y_1, isMouseDown: true } });\n            var obj = { index: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawHoveredIndex', onPropertyChange: false, value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (this.isFhdPoint || (this.isFhdCustomized && !parent.togglePen)) {\n                if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) &&\n                    indexObj['freehandSelectedIndex'] !== obj['index']) {\n                    var tempHoveredIndex = obj['index'];\n                    parent.okBtn();\n                    this.isFhdCustomized = false;\n                    parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                        value: { index: tempHoveredIndex } });\n                    if (obj['index'] > -1) {\n                        var strokeColor = parent.pointColl[obj['index']].strokeColor;\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[obj['index']].strokeWidth } });\n                    }\n                }\n                indexObj['freehandSelectedIndex'] = null;\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                var objColl = extend([], parent.objColl, [], true);\n                if (!isNullOrUndefined(obj['index']) && obj['index'] > -1) {\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { type: 'ok' } });\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: null, strokeWidth: null } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                }\n                else if (indexObj['freehandSelectedIndex']) {\n                    parent.okBtn();\n                    var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth } });\n                }\n                else if (this.findTargetObj(x_1, y_1, false)) {\n                    parent.objColl = objColl;\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n            else {\n                if (this.isFhdEditing) {\n                    parent.notify('freehand-draw', { prop: 'cancelFhd', value: { type: 'ok' } });\n                    var qbArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n                    if (qbArea) {\n                        qbArea.style.display = 'none';\n                    }\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var point = parent.pointColl[indexObj['freehandSelectedIndex']];\n                    var shapeSettings = { id: 'pen_' + (indexObj['freehandSelectedIndex'] + 1), type: ShapeType.FreehandDraw,\n                        startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                        strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity };\n                    var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n                    parent.trigger('shapeChange', shapeChangedArgs);\n                }\n                var isPenDraw = parent.togglePen;\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n                if (isPenDraw) {\n                    parent.freehandDraw(true);\n                }\n                this.isFhdEditing = false;\n                if (isLineArrow) {\n                    this.setCursor(x_1, y_1);\n                }\n                else if (cursor !== 'default') {\n                    parent.upperCanvas.style.cursor = parent.cursor = cursor;\n                }\n                if (parent.cursor === 'crosshair' || (Browser.isDevice && parent.togglePen)) {\n                    if (parent.togglePen) {\n                        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                            var obj_1 = { strokeSettings: {} };\n                            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                            parent.activeObj.strokeSettings = obj_1['strokeSettings'];\n                        }\n                        var obj_2 = { penStrokeWidth: null };\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_2 } });\n                        if (isNullOrUndefined(obj_2['penStrokeWidth'])) {\n                            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n                        }\n                        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n                        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                        parent.notify('freehand-draw', { prop: 'freehandDownHandler', onPropertyChange: false,\n                            value: { e: e, canvas: parent.upperCanvas } });\n                    }\n                    else {\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    parent.currObjType.isActiveObj = false;\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                }\n                if ((parent.cursor !== 'crosshair' && e.type.toLowerCase() === 'touchstart') ||\n                    (parent.currObjType.isActiveObj && parent.cursor !== 'default' && !parent.togglePen)) {\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                else if ((parent.currObjType.shape === '' || parent.currObjType.isCustomCrop) && !parent.togglePen && parent.cursor !== 'default') {\n                    this.setActivePoint(x_1, y_1);\n                }\n                if (isTextArea) {\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                }\n            }\n        }\n        this.isShapeInserted = false;\n        this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n    };\n    Selection.prototype.mouseMoveEventHandler = function (e) {\n        var parent = this.parent;\n        var cursor = parent.cursor;\n        var canvasCursor = parent.upperCanvas.style.cursor;\n        e.preventDefault();\n        if (this.timer && this.timer > 0) {\n            this.timer = 0;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        if (e.type === 'touchmove' && e.touches.length === 2) {\n            if (this.isFirstMove) {\n                this.startTouches = this.targetTouches(e.touches);\n                this.tempTouches = [];\n                this.tempTouches.push({ x: (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft) - bbox.left),\n                    y: (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n                this.tempTouches.push({ x: (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left,\n                    y: (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n            }\n            else {\n                var firstFingerX = (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var firstFingerY = (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var secondFingerX = (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var secondFingerY = (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var center = { x: firstFingerX < secondFingerX ? secondFingerX - ((secondFingerX - firstFingerX) / 2) :\n                        firstFingerX - ((firstFingerX - secondFingerX) / 2), y: firstFingerY < secondFingerY ?\n                        secondFingerY - ((secondFingerY - firstFingerY) / 2) : firstFingerY - ((firstFingerY - secondFingerY) / 2) };\n                if (this.currMousePoint.x !== center.x && this.currMousePoint.y !== center.y) {\n                    var type = '';\n                    if (e.type === 'touchmove' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Pinch) === ZoomTrigger.Pinch) {\n                        this.zoomType = 'Pinch';\n                        var scale = this.calculateScale(this.startTouches, this.targetTouches(e.touches));\n                        this.startTouches = this.targetTouches(e.touches);\n                        if (scale > 1) {\n                            type = 'zoomIn';\n                        }\n                        else if (scale < 1) {\n                            type = 'zoomOut';\n                        }\n                    }\n                    if (type !== '') {\n                        parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                            value: { x: center.x, y: center.y, type: type, isResize: null } });\n                    }\n                    this.tempTouches = [];\n                    this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop) });\n                    this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop) });\n                    this.currMousePoint.x = center.x;\n                    this.currMousePoint.y = center.y;\n                    this.isPinching = true;\n                }\n            }\n            this.isFirstMove = false;\n            return;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        x -= bbox.left;\n        y -= bbox.top;\n        this.canvasMouseMoveHandler(e);\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        }\n        parent.upperCanvas.style.cursor = canvasCursor;\n        parent.cursor = cursor;\n        if (parent.currObjType.isActiveObj && (parent.activeObj.activePoint !== undefined || parent.objColl.length > 0) &&\n            !this.dragCanvas || parent.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                if ((parent.activeObj.activePoint &&\n                    (parent.activeObj.activePoint.width === 0 || (!isNullOrUndefined(parent.activeObj.currIndex) &&\n                        this.cursorTargetId !== parent.activeObj.currIndex)))\n                    && parent.cursor !== 'default' &&\n                    parent.cursor !== 'move' && parent.cursor !== 'crosshair'\n                    && parent.cursor !== 'grab' && parent.cursor !== 'pointer') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n                this.findTarget(x, y, e.type);\n            }\n        }\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.currObjType.isDragging) {\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.updateActivePoint(x, y, isCropSelection);\n            parent.notify('shape', { prop: 'updateTrianglePoints', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (this.isPreventDragging) {\n                if ((parent.activeObj.activePoint.startX > destLeft) &&\n                    (parent.activeObj.activePoint.endX < destLeft + destWidth) &&\n                    (parent.activeObj.activePoint.startY > destTop)\n                    && (parent.activeObj.activePoint.endY < destTop + destHeight)) {\n                    this.isPreventDragging = false;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: null, saveContext: null, isPreventSelection: null } });\n            }\n            if (isCropSelection) {\n                this.dragCanvas = parent.togglePan = true;\n            }\n        }\n    };\n    Selection.prototype.mouseUpEventHandler = function (e) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!Browser.isDevice && ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n            !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (parent.element.querySelector('#' + id + '_headWrapper')\n                && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide')))) {\n            return;\n        }\n        if (this.mouseDown === 'canvas' || this.isSliderActive ||\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            e.target.closest('.e-image-editor') || e.target.closest('.e-ie-ddb-popup')) {\n            if (e.type === 'touchstart') {\n                this.isTouch = false;\n            }\n            else if (e.type === 'touchend') {\n                e.stopImmediatePropagation();\n            }\n            e.preventDefault();\n            if (parent.togglePan) {\n                this.canvasMouseUpHandler(e);\n            }\n            var x = void 0;\n            var y = void 0;\n            if (e.type === 'mouseup') {\n                x = e.clientX;\n                y = e.clientY;\n            }\n            else {\n                x = this.touchEndPoint.x;\n                y = this.touchEndPoint.y;\n            }\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            if (e.type === 'touchend') {\n                this.startTouches = this.tempTouches = [];\n                this.isFirstMove = false;\n                if (parent.textArea.style.display === 'none') {\n                    this.timer = 0;\n                }\n                if (this.isPinching) {\n                    this.isPinching = false;\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    return;\n                }\n            }\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (this.currentDrawingShape === 'path') {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var elem = e.srcElement;\n                var elemId = elem.parentElement.id;\n                var id_1 = parent.element.id;\n                if (e.currentTarget !== parent.upperCanvas && e.currentTarget !== parent.lowerCanvas && parent.activeObj.pointColl.length > 0 &&\n                    (elem.classList.contains('e-upload-icon') || elemId === id_1 + '_zoomIn' ||\n                        elemId === id_1 + '_zoomOut' || elemId === id_1 + '_annotationBtn' ||\n                        elemId === id_1 + '_borderColorBtn' || elemId === id_1 + '_borderWidthBtn' || elemId === id_1 + '_saveBtn')) {\n                    parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: true } });\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                            points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n                }\n                return;\n            }\n            if (e.currentTarget === parent.upperCanvas && !parent.isResize) {\n                this.pathAdjustedIndex = null;\n                if (this.currentDrawingShape !== '') {\n                    if (this.currentDrawingShape === 'text') {\n                        var prevCropObj_1 = extend({}, parent.cropObj, {}, true);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeInsert', previousObj: this.initialPrevObj, previousObjColl: this.initialPrevObj.objColl,\n                                previousPointColl: this.initialPrevObj.pointColl, previousSelPointColl: this.initialPrevObj.selPointColl,\n                                previousCropObj: prevCropObj_1, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    else {\n                        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: this.initialPrevObj.objColl, operation: 'shapeInsert' } });\n                    }\n                    this.isShapeInserted = true;\n                    this.currentDrawingShape = '';\n                    if (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) {\n                        parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                    }\n                    var previousShapeSettings = this.updatePrevShapeSettings();\n                    var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: previousShapeSettings };\n                    var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings };\n                    this.shapeResizingArgs = shapeResizingArgs;\n                    this.shapeMovingArgs = shapeMovingArgs;\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-up');\n                }\n                this.adjustActObjForLineArrow();\n                this.updPtCollForShpRot();\n                parent.currObjType.shape = parent.currObjType.shape.toLowerCase();\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                if (!parent.togglePen && !isCropSelection) {\n                    if (this.tempObjColl && parent.activeObj.activePoint.width !== 0) {\n                        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        parent.objColl.push(parent.activeObj);\n                        if (JSON.stringify(parent.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                    previousCropObj: prevCropObj, previousText: null,\n                                    currentText: null, previousFilter: null, isCircleCrop: null } });\n                        }\n                        this.redrawShape(parent.objColl[parent.objColl.length - 1], true);\n                        this.tempObjColl = undefined;\n                    }\n                    if (!this.isFhdEditing) {\n                        this.applyCurrActObj(x, y);\n                        parent.currObjType.isResize = false;\n                        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                }\n                if (parent.activeObj) {\n                    var isCropSelection_1 = false;\n                    var splitWords_1;\n                    if (parent.activeObj.shape !== undefined) {\n                        splitWords_1 = parent.activeObj.shape.split('-');\n                    }\n                    if (splitWords_1 === undefined && (parent.currObjType.isCustomCrop || parent.togglePen)) {\n                        isCropSelection_1 = true;\n                    }\n                    else if (splitWords_1 !== undefined && splitWords_1[0] === 'crop') {\n                        isCropSelection_1 = true;\n                    }\n                    var shape = parent.activeObj.shape;\n                    var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path'];\n                    if (shapeColl.indexOf(shape) > -1) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (shape === 'text') {\n                        if (parent.textArea.style.display === 'none') {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                    }\n                    else if (this.isFhdEditing) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (!isCropSelection_1) {\n                        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n            }\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && e.currentTarget === parent.upperCanvas &&\n                parent.textArea.style.display === 'none') {\n                if (parent.activeObj.shape === 'text') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            if (parent.togglePen && e.currentTarget === parent.upperCanvas) {\n                parent.notify('freehand-draw', { prop: 'freehandUpHandler', onPropertyChange: false,\n                    value: { e: e, canvas: parent.upperCanvas, context: this.upperContext } });\n            }\n            else {\n                parent.currObjType.shape = '';\n            }\n            this.dragElement = '';\n            this.mouseDown = '';\n            this.isSliderActive = false;\n            parent.currObjType.isInitialLine = parent.currObjType.isDragging = false;\n            this.selMouseUpEvent();\n        }\n    };\n    Selection.prototype.adjustActObjForLineArrow = function (obj) {\n        var isAdjusted = false;\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && (obj.shape === 'line' || parent.activeObj.shape === 'arrow')) {\n            var temp = void 0;\n            if ((this.dragElement === 'e-resize' && obj.activePoint.endX < obj.activePoint.startX) ||\n                (this.dragElement === 'w-resize' && obj.activePoint.startX > obj.activePoint.endX)) {\n                isAdjusted = true;\n                temp = obj.activePoint.startX;\n                obj.activePoint.startX = obj.activePoint.endX;\n                obj.activePoint.endX = temp;\n                temp = obj.activePoint.startY;\n                obj.activePoint.startY = obj.activePoint.endY;\n                obj.activePoint.endY = temp;\n            }\n            obj.activePoint.width = Math.abs(obj.activePoint.endX - obj.activePoint.startX);\n            obj.activePoint.height = Math.abs(obj.activePoint.endY - obj.activePoint.startY);\n            if (parent.activeObj.shape !== 'path') {\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                for (var i = 0; i < obj.pointColl.length; i++) {\n                    obj.pointColl[i].ratioX = (obj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    obj.pointColl[i].ratioY = (obj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n        return isAdjusted;\n    };\n    Selection.prototype.updPtCollForShpRot = function (obj) {\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && obj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: obj } });\n            var _a = parent.img, destLeft_1 = _a.destLeft, destTop_1 = _a.destTop, destWidth_1 = _a.destWidth, destHeight_1 = _a.destHeight;\n            var horTopLinePointColl = obj.horTopLinePointColl, horBottomLinePointColl = obj.horBottomLinePointColl, verLeftLinePointColl = obj.verLeftLinePointColl, verRightLinePointColl = obj.verRightLinePointColl;\n            var setRatio = function (point) {\n                point.ratioX = (point.x - destLeft_1) / destWidth_1;\n                point.ratioY = (point.y - destTop_1) / destHeight_1;\n            };\n            horTopLinePointColl.forEach(setRatio);\n            horBottomLinePointColl.forEach(setRatio);\n            verLeftLinePointColl.forEach(setRatio);\n            verRightLinePointColl.forEach(setRatio);\n        }\n    };\n    Selection.prototype.setXYPoints = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        return { x: x, y: y };\n    };\n    Selection.prototype.getCurrentIndex = function () {\n        var index;\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.activeObj.currIndex === parent.objColl[i].currIndex) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    };\n    Selection.prototype.isShapeClick = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.togglePen) {\n            return isShape;\n        }\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' && this.isShapeInserted) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                if (isShape) {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: true } });\n                }\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if ((!isNullOrUndefined(index) &&\n                    JSON.stringify(parent.activeObj.activePoint) === JSON.stringify(parent.objColl[index].activePoint))) {\n                    parent.objColl.splice(index, 1);\n                }\n                else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                    parent.objColl.pop();\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isShapeTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (e.type === 'touchstart' && !parent.togglePen) {\n            if (parent.activeObj && parent.activeObj.shape === 'text') {\n                this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n            }\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isFreehandDrawTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isFreehandDraw = false;\n        if (e.type === 'touchstart' && !isCropSelection && !parent.togglePen) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.isFhdPoint) {\n                isFreehandDraw = true;\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isFreehandDraw;\n    };\n    Selection.prototype.applyObj = function (x, y) {\n        var parent = this.parent;\n        var isApply = false;\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'text'];\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (parent.activeObj.shape && shapeColl.indexOf(parent.activeObj.shape) > -1) {\n            var radius = parent.activeObj.topLeftCircle.radius;\n            if (x >= (startX - (radius * 2)) && x <= (endX + (radius * 2)) && y >= (startY - (radius * 2)) &&\n                y <= (endY + (radius * 2))) {\n                isApply = false;\n            }\n            else if (parent.upperCanvas.style.cursor !== 'default' && parent.upperCanvas.style.cursor !== 'grab' &&\n                parent.upperCanvas.style.cursor !== 'crosshair' && parent.upperCanvas.style.cursor !== 'pointer' &&\n                parent.upperCanvas.style.cursor !== 'move') {\n                isApply = false;\n            }\n            else {\n                isApply = true;\n            }\n        }\n        return isApply;\n    };\n    Selection.prototype.applyCurrShape = function (isShapeClick) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.togglePen) {\n            return isApply;\n        }\n        var obj = extend({}, parent.activeObj, null, true);\n        if (this.isShapeInserted && parent.activeObj.shape === 'text' && isShapeClick) {\n            this.isInitialTextEdited = true;\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            obj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n            parent.objColl.pop();\n            parent.activeObj = extend({}, activeObj, null, true);\n            parent.textArea.value = obj.keyHistory;\n            parent.textArea.style.display = 'block';\n            var strokeColor = obj.strokeSettings && obj.strokeSettings.strokeColor ? obj.strokeSettings.strokeColor.split('(')[0] === 'rgb' ?\n                this.rgbToHex(parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[0]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[1]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[2]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[3])) :\n                obj.strokeSettings.strokeColor : null;\n            if (strokeColor && strokeColor === '#ffffff') {\n                strokeColor = '#fff';\n            }\n            if (this.tempActiveObj.strokeSettings && this.tempActiveObj.strokeSettings.strokeColor &&\n                this.tempActiveObj.strokeSettings.strokeColor === '#ffffff') {\n                this.tempActiveObj.strokeSettings.strokeColor = '#fff';\n            }\n            if (obj.keyHistory !== this.tempActiveObj.keyHistory ||\n                (strokeColor && (strokeColor !== this.tempActiveObj.strokeSettings.strokeColor)) ||\n                (obj.textSettings && obj.textSettings.fontFamily !== this.tempActiveObj.textSettings.fontFamily) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontSize) !== Math.round(this.tempActiveObj.textSettings.fontSize)) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontRatio) !== Math.round(this.tempActiveObj.textSettings.fontRatio)) ||\n                (obj.textSettings && obj.textSettings.bold !== this.tempActiveObj.textSettings.bold) ||\n                (obj.textSettings && obj.textSettings.italic !== this.tempActiveObj.textSettings.italic) ||\n                (obj.textSettings && obj.textSettings.underline !== this.tempActiveObj.textSettings.underline)) {\n                isApply = true;\n            }\n            if (this.isInitialTextEdited && !isApply) {\n                isApply = true;\n                this.isInitialTextEdited = false;\n            }\n        }\n        else {\n            this.tempActiveObj.activePoint.height = Math.abs(this.tempActiveObj.activePoint.height);\n            isApply = JSON.stringify(obj) !== JSON.stringify(this.tempActiveObj);\n        }\n        return isApply;\n    };\n    Selection.prototype.canvasMouseDownHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.offsetX || (e.pageX - parent.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - parent.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panDown = { x: x, y: y };\n        var tempPanMoveObj = { tempPanMove: null };\n        parent.notify('transform', { prop: 'getTempPanMove', onPropertyChange: false,\n            value: { obj: tempPanMoveObj } });\n        if (isNullOrUndefined(tempPanMoveObj['tempPanMove'])) {\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: { x: x, y: y } } });\n        }\n    };\n    Selection.prototype.canvasMouseMoveHandler = function (e) {\n        var parent = this.parent;\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        if (this.dragCanvas) {\n            parent.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = parent.togglePan = false;\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.offsetX;\n            y = e.offsetY;\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        var panMove = { x: x, y: y };\n        parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n            value: { point: { x: x, y: y } } });\n        if (this.panDown && panMove && parent.togglePan && this.dragCanvas) {\n            if (parent.isCropTab || parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            }\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: null, yDiff: null } });\n        }\n    };\n    Selection.prototype.canvasMouseUpHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var panMoveObj = { panMove: null };\n        parent.notify('transform', { prop: 'getPanMove', onPropertyChange: false,\n            value: { obj: panMoveObj } });\n        if (parent.togglePan) {\n            if (this.panDown && panMoveObj['panMove'] && parent.togglePan && this.dragCanvas) {\n                this.panDown = null;\n                parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n            }\n        }\n        if (this.currentDrawingShape !== 'path') {\n            parent.currObjType.isDragging = false;\n        }\n    };\n    Selection.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        var parent = this.parent;\n        if (this.touchTime === 0) {\n            this.touchTime = new Date().getTime();\n        }\n        else {\n            if (((new Date().getTime()) - this.touchTime) < 400) {\n                parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: null } });\n                this.touchTime = 0;\n            }\n            else {\n                this.touchTime = new Date().getTime();\n            }\n        }\n        if (e.touches.length === 2) {\n            this.isFirstMove = true;\n        }\n        else {\n            this.mouseDownEventHandler(e);\n        }\n        EventHandler.add(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n    };\n    Selection.prototype.unwireEvent = function () {\n        var parent = this.parent;\n        EventHandler.remove(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler);\n    };\n    Selection.prototype.keyDownEventHandler = function (e) {\n        var parent = this.parent;\n        if (e.ctrlKey && (e.key === '+' || e.key === '-')) {\n            e.preventDefault();\n        }\n        var obj = { fileName: '', fileType: null };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var beforeSave = { fileName: obj['fileName'], fileType: obj['fileType'], cancel: false };\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                parent.trigger('beforeSave', beforeSave);\n                this.beforeSaveEvent(beforeSave, e);\n                break;\n            case (e.ctrlKey && 'z'):\n                if (parent.allowUndoRedo) {\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                }\n                break;\n            case (e.ctrlKey && 'y'):\n                if (parent.allowUndoRedo) {\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                }\n                break;\n            case (e.ctrlKey && '+'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: .1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case (e.ctrlKey && '-'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -.1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case 'Delete':\n                this.deleteItem();\n                break;\n            case 'Escape':\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                break;\n            case 'Enter':\n                this.performEnterAction(e);\n                break;\n            case 'Tab':\n                this.performTabAction();\n                break;\n            default:\n                if (Browser.isDevice && (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    Selection.prototype.performEnterAction = function (e) {\n        var parent = this.parent;\n        if (parent.isResize) {\n            var isValue = this.isValueUpdated();\n            if (!isValue) {\n                return;\n            }\n            var point = this.getNumTextValue();\n            var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n            var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n            if (point && point.x && point.y) {\n                if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n            }\n            var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n            var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n            if (isNullOrUndefined(aspectRatioElement)) {\n                if (aspectRatioHeight) {\n                    var elem = getComponent(aspectRatioHeight, 'numerictextbox');\n                    if (aspectRatioHeight && aspectRatioHeight.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioHeight.value = elem.placeholder + 'px';\n                    }\n                }\n                if (aspectRatioWidth) {\n                    var elem = getComponent(aspectRatioWidth, 'numerictextbox');\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioWidth.value = elem.placeholder + 'px';\n                    }\n                }\n            }\n            parent.notify('draw', { prop: 'redrawDownScale' });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (e && this.isKeyBoardCrop(e) &&\n                parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] === 'crop')) {\n                parent.crop();\n            }\n        }\n    };\n    Selection.prototype.isKeyBoardCrop = function (e) {\n        var bool = false;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var target = e.target;\n        if (target.id === this.parent.element.id + '_ok' || target.id === '') {\n            bool = true;\n        }\n        return bool;\n    };\n    Selection.prototype.beforeSaveEvent = function (observableSaveArgs, e) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.notify('export', { prop: 'export', onPropertyChange: false,\n                value: { type: observableSaveArgs.fileType, fileName: observableSaveArgs.fileName } });\n        }\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    };\n    Selection.prototype.handleScroll = function (e) {\n        var parent = this.parent;\n        var x;\n        var y;\n        var isInsideCanvas = false;\n        if (e.type === 'mousewheel') {\n            // eslint-disable-next-line\n            x = e.clientX;\n            y = e.clientY;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (x > parent.img.destLeft && x < parent.img.destLeft + parent.img.destWidth && y > parent.img.destTop &&\n            y < parent.img.destTop + parent.img.destHeight) {\n            isInsideCanvas = true;\n        }\n        e.stopPropagation();\n        if (e.ctrlKey === true && isInsideCanvas) {\n            e.preventDefault();\n            if (!parent.isCropTab && (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] !== 'crop')) {\n                parent.okBtn();\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n            }\n            var type = '';\n            if (e.type === 'mousewheel' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.MouseWheel) === ZoomTrigger.MouseWheel) {\n                this.zoomType = 'MouseWheel';\n                // eslint-disable-next-line\n                if (e.wheelDelta > 0) {\n                    type = 'zoomIn';\n                }\n                else {\n                    type = 'zoomOut';\n                }\n            }\n            if (type !== '') {\n                parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                    value: { x: x, y: y, type: type, isResize: null } });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                if (parent.isCropTab || parent.activeObj.shape) {\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent.isStraightening) {\n                    parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent.notify('draw', { prop: 'setDestForStraighten' });\n                }\n            }\n        }\n    };\n    Selection.prototype.textKeyDown = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            return;\n        }\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        parent.textArea.style.height = 'auto';\n        parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n        parent.notify('shape', { prop: 'setTextBoxWidth', onPropertyChange: false, value: { e: e } });\n        if (Browser.isDevice) {\n            parent.textArea.style.width = parseFloat(parent.textArea.style.width) + parent.textArea.style.fontSize + 'px';\n        }\n        var rows = parent.textArea.value.split('\\n');\n        this.textRow = rows.length;\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        this.isInitialTextEdited = false;\n    };\n    Selection.prototype.clearSelection = function (resetCrop) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (resetCrop) {\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                parent.togglePen = false;\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.dragElement = '';\n                this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                parent.currObjType.shape = '';\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.currObjType.isActiveObj = true;\n                parent.currObjType.isCustomCrop = false;\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Selection.prototype.setDragDirection = function (width, height) {\n        var arcRadius = (7.5);\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (parent.img.destWidth > parent.img.destHeight) {\n            actPoint.startX = this.dragPoint.startX = ((width / 2) - (height / 2)) + arcRadius;\n            actPoint.startY = this.dragPoint.startY = ((height / 2) - (height / 2)) + arcRadius;\n            actPoint.endX = ((width / 2) + (height / 2)) - arcRadius;\n            actPoint.endY = ((height / 2) + (height / 2)) - arcRadius;\n        }\n        else {\n            actPoint.startY = this.dragPoint.startX = ((height / 2) - (width) / 2) + arcRadius;\n            actPoint.endY = ((height / 2) + (width) / 2) - arcRadius;\n            actPoint.startX = this.dragPoint.startX = arcRadius;\n            actPoint.endX = width - arcRadius;\n        }\n    };\n    Selection.prototype.calcShapeRatio = function (x, y, imgWidth, imgHeight) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var arcRadius = (7.5);\n        var presetRatio = x / y;\n        var originalWidth = imgWidth;\n        var originalHeight = imgHeight;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        actPoint.width = width;\n        actPoint.height = height;\n        actPoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        actPoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        actPoint.endX = actPoint.startX + actPoint.width;\n        actPoint.endY = actPoint.startY + actPoint.height;\n        if (actPoint.startX < destLeft && destLeft + destWidth > parent.lowerCanvas.clientWidth) {\n            actPoint.startX = destLeft;\n            actPoint.endX = actPoint.startX + width - arcRadius;\n        }\n        if (actPoint.startY < destTop && destTop + destHeight > parent.lowerCanvas.clientHeight) {\n            actPoint.startY = destTop;\n            actPoint.endY = actPoint.startY + height - arcRadius;\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n    };\n    Selection.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    Selection.prototype.findTarget = function (x, y, type) {\n        var parent = this.parent;\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, isCrop);\n            this.updateCursorStyles(x, y, type);\n        }\n        else {\n            var _a = parent.activeObj, topLeftCircle = _a.topLeftCircle, topCenterCircle = _a.topCenterCircle, topRightCircle = _a.topRightCircle, centerLeftCircle = _a.centerLeftCircle, centerRightCircle = _a.centerRightCircle, bottomLeftCircle = _a.bottomLeftCircle, bottomCenterCircle = _a.bottomCenterCircle, bottomRightCircle = _a.bottomRightCircle;\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    topLeftCircle.startX = x;\n                    topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    topCenterCircle.startX = x;\n                    topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    topRightCircle.startX = x;\n                    topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    centerLeftCircle.startX = x;\n                    centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    centerRightCircle.startX = x;\n                    centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    bottomLeftCircle.startX = x;\n                    bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    bottomCenterCircle.startX = x;\n                    bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    bottomRightCircle.startX = x;\n                    bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.findTargetObj = function (x, y, isCrop) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length !== 0 && !parent.currObjType.isCustomCrop && !isCrop) {\n            var diffX = 0;\n            var i = void 0;\n            for (var index = 0; index < parent.objColl.length; index++) {\n                var cursor = parent.upperCanvas.style.cursor;\n                this.setCursor(x, y);\n                var actObj = extend({}, parent.objColl[index], {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                    for (var j = 0; j < actObj.pointColl.length; j++) {\n                        if (x >= actObj.pointColl[j].x - (radius * 2) &&\n                            x <= actObj.pointColl[j].x + (radius * 2) &&\n                            y >= actObj.pointColl[j].y - (radius * 2) &&\n                            y <= actObj.pointColl[j].y + (radius * 2)) {\n                            if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                                JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                                i = index;\n                                break;\n                            }\n                            else {\n                                if (this.isTouch || parent.cursor === 'move' ||\n                                    parent.cursor === 'grab' || this.isShapeInserted) {\n                                    if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                        diffX = x - parent.objColl[index].activePoint.startX;\n                                        i = index;\n                                    }\n                                }\n                                else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                    i = index;\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n                else if (actObj.shape === 'path') {\n                    var cursor_3 = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                    if (cursor_3 !== 'default' && cursor_3 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                    diffX = x - parent.objColl[index].activePoint.startX;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else if (actObj.rotatedAngle !== 0) {\n                    var cursor_4 = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                    if (cursor_4 !== 'default' && cursor_4 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                    diffX = x - parent.objColl[index].activePoint.startX;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else {\n                    var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                    if ((x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2))) ||\n                        (rotationCirclePoint &&\n                            x >= (rotationCirclePoint.x - (radius * 2)) &&\n                            x <= (rotationCirclePoint.x + (radius * 2)) &&\n                            y >= (rotationCirclePoint.y - (radius * 2)) &&\n                            y <= (rotationCirclePoint.y + (radius * 2)))) {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || cursor === 'move' || cursor === 'grabbing' || this.isShapeInserted\n                                || parent.cursor === 'move' || parent.cursor === 'grabbing') {\n                                if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                    diffX = x - parent.objColl[index].activePoint.startX;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                isShape = false;\n            }\n            else {\n                this.tempObjColl = extend([], parent.objColl, [], true);\n                parent.currObjType.isCustomCrop = false;\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var temp = extend({}, parent.objColl[i], {}, true);\n                parent.objColl.splice(i, 1);\n                if (parent.transform.degree === 0) {\n                    var temp_1 = this.lowerContext.filter;\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                    this.lowerContext.filter = 'none';\n                    parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                    parent.activeObj = extend({}, temp_1, {}, true);\n                    parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                        value: { context: this.lowerContext, points: null } });\n                    this.lowerContext.filter = temp_1;\n                    this.getCurrentFlipState();\n                }\n                else {\n                    var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n                    var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                        height: parent.img.destHeight };\n                    parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.img.destLeft = destPoints.startX;\n                    parent.img.destTop = destPoints.startY;\n                    parent.img.destWidth = destPoints.width;\n                    parent.img.destHeight = destPoints.height;\n                    parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                        value: { context: this.lowerContext, points: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = extend({}, temp, {}, true);\n                this.setActivePoint();\n                parent.activeObj = extend({}, temp, {}, true);\n                var tempStrokeSettings = extend({}, parent.activeObj.strokeSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempStrokeSettings', onPropertyChange: false,\n                    value: { tempStrokeSettings: tempStrokeSettings } });\n                var tempTextSettings = extend({}, parent.activeObj.textSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempTextSettings', onPropertyChange: false, value: { tempTextSettings: tempTextSettings } });\n                var shapeSettings = this.updatePrevShapeSettings();\n                var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n                    shapeChangingArgs.currentShapeSettings.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                    shapeChangingArgs.currentShapeSettings.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                this.isCropSelection = false;\n                var splitWords = void 0;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    this.isCropSelection = true;\n                }\n                if (!this.isCropSelection) {\n                    parent.trigger('shapeChanging', shapeChangingArgs);\n                    this.shapeEvent(shapeChangingArgs);\n                }\n                else {\n                    var selectionChangingArgs = { action: shapeChangingArgs.action,\n                        previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.previousShapeSettings.startX,\n                            startY: shapeChangingArgs.previousShapeSettings.startY,\n                            width: shapeChangingArgs.previousShapeSettings.width,\n                            height: shapeChangingArgs.previousShapeSettings.height },\n                        currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.currentShapeSettings.startX,\n                            startY: shapeChangingArgs.currentShapeSettings.startY,\n                            width: shapeChangingArgs.currentShapeSettings.width,\n                            height: shapeChangingArgs.currentShapeSettings.height } };\n                    parent.trigger('selectionChanging', selectionChangingArgs);\n                    shapeChangingArgs.currentShapeSettings.startX = selectionChangingArgs.currentSelectionSettings.startX;\n                    shapeChangingArgs.currentShapeSettings.startY = selectionChangingArgs.currentSelectionSettings.startY;\n                    shapeChangingArgs.currentShapeSettings.width = selectionChangingArgs.currentSelectionSettings.width;\n                    shapeChangingArgs.currentShapeSettings.height = selectionChangingArgs.currentSelectionSettings.height;\n                    this.shapeEvent(shapeChangingArgs);\n                }\n                isShape = true;\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.shapeEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n            value: { shapeSettings: shapeChangingArgs.currentShapeSettings } });\n        if (parent.activeObj.activePoint) {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(obj['prevActObj'])) {\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n                    value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n            }\n            if (parent.activeObj.shape === 'image' && !this.isImageClarity) {\n                this.upgradeImageQuality();\n                this.isImageClarity = true;\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            if (!this.isShapeInserted) {\n                var activePoint = parent.activeObj.activePoint;\n                var _a = parent.img, destLeft = _a.destLeft, destWidth = _a.destWidth, destTop = _a.destTop, destHeight = _a.destHeight;\n                this.isPreventDragging =\n                    activePoint.startX < destLeft ||\n                        activePoint.endX > destLeft + destWidth ||\n                        activePoint.startY < destTop ||\n                        activePoint.endY > destTop + destHeight;\n            }\n        }\n    };\n    Selection.prototype.upgradeImageQuality = function () {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var ctx = parent.activeObj.imageCanvas.getContext('2d');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: parent.activeObj.imageElement.width,\n                height: parent.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        parent.notify('shape', { prop: 'updateObj', onPropertyChange: false, value: { dimObj: dimObj, x: null, y: null } });\n        ctx.clearRect(0, 0, parent.activeObj.imageCanvas.width, parent.activeObj.imageCanvas.height);\n        this.applyTransformToImg(ctx);\n        parent.activeObj = activeObj;\n    };\n    Selection.prototype.applyTransformToImg = function (ctx) {\n        var parent = this.parent;\n        if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n        }\n        else if (parent.activeObj.isHorImageFlip) {\n            parent.activeObj.isHorImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: false } });\n        }\n        else if (parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: false } });\n        }\n    };\n    // eslint-disable-next-line\n    Selection.prototype.targetTouches = function (touches) {\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        var p1 = { x: touches[0].pageX - bbox.left, y: touches[0].pageY - bbox.top };\n        var p2 = { x: touches[1].pageX - bbox.left, y: touches[1].pageY - bbox.top };\n        var points = [p1, p2];\n        return points;\n    };\n    Selection.prototype.calculateScale = function (startTouches, endTouches) {\n        var startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        var endDistance = this.getDistance(endTouches[0], endTouches[1]);\n        return endDistance / startDistance;\n    };\n    Selection.prototype.getDistance = function (a, b) {\n        var x = 0;\n        var y = 0;\n        if (a && b) {\n            x = a.x - b.x;\n            y = a.y - b.y;\n        }\n        return Math.sqrt(x * x + y * y);\n    };\n    Selection.prototype.redrawShape = function (obj, isMouseUp) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(parent.objColl[i])) {\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (this.isPreventDragging) {\n            if (parent.activeObj.activePoint.startX > parent.img.destLeft) {\n                this.isPreventDragging = false;\n            }\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n        else {\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n    };\n    Selection.prototype.setTimer = function (e) {\n        var parent = this.parent;\n        if (this.timer > 10) {\n            clearTimeout(this.timer);\n            this.timer = 0;\n            parent.notify('shape', { prop: 'findTextTarget', onPropertyChange: false, value: { e: e } });\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n    };\n    Selection.prototype.applyCurrActObj = function (x, y) {\n        var parent = this.parent;\n        var isInside = false;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var radius = actObj.topLeftCircle ? actObj.topLeftCircle.radius : 0;\n        if ((x >= Math.floor(startX) && x <= Math.ceil(endX) && y >= Math.floor(startY) && y <= Math.ceil(endY))) {\n            isInside = true;\n        }\n        else if (radius !== 0 && (x >= Math.floor(startX) - radius && x <= Math.ceil(endX) + radius &&\n            y >= Math.floor(startY) - radius && y <= Math.ceil(endY) + radius)) {\n            isInside = true;\n            this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [] };\n        }\n        else if ((actObj.shape === 'text' || actObj.shape === 'image') && this.dragElement !== '') {\n            isInside = true;\n        }\n        else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n            var smallPoint = { x: startX < endX ? startX : endX, y: startY < endY ? startY : endY };\n            var largePoint = { x: startX > endX ? startX : endX, y: startY > endY ? startY : endY };\n            if (x >= (Math.floor(smallPoint.x) - 5) && x <= (Math.ceil(largePoint.x) + 5) &&\n                y >= (Math.floor(smallPoint.y) - 5) && y <= (Math.ceil(largePoint.y) + 5)) {\n                isInside = true;\n            }\n        }\n        else if (actObj.shape === 'path') {\n            var cursor = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            if (cursor === 'move') {\n                isInside = true;\n            }\n        }\n        else if (this.dragElement === 'grabbing') {\n            isInside = true;\n        }\n        else if (actObj.rotatedAngle !== 0) {\n            var cursor = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            if ((cursor !== 'default' && cursor !== 'grab') || this.dragElement === 'n-resize' || this.dragElement === 'e-resize' ||\n                this.dragElement === 's-resize' || this.dragElement === 'w-resize') {\n                isInside = true;\n            }\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            isInside = true;\n        }\n        if (!isInside) {\n            if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n                parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n                parent.activeObj.currIndex = shapeIDObj['id'];\n            }\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            if (parent.activeObj.horTopLine !== undefined && parent.activeObj.horTopLine.startX !== 0 && parent.activeObj.horTopLine.endX\n                !== 0 && !parent.currObjType.isCustomCrop && parent.currObjType.shape !== '') {\n                parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            }\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' +\n                    'invert(0%)';\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var obj = { isInside: false };\n                    parent.notify('crop', { prop: 'isObjInImage', onPropertyChange: false,\n                        value: { obj: parent.objColl[i], object: obj } });\n                    if (obj['isInside']) {\n                        parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                            value: { shape: parent.objColl[i].shape, obj: parent.objColl[i], canvas: null } });\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    }\n                }\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                this.lowerContext.filter = tempFilter;\n                if (parent.activeObj.shape) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: null, obj: null, canvas: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if (parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.getCurrentFlipState = function () {\n        var parent = this.parent;\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n        }\n        else {\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.setTextBoxStylesToActObj = function () {\n        var parent = this.parent;\n        parent.activeObj.textSettings.fontFamily = parent.textArea.style.fontFamily;\n        parent.activeObj.strokeSettings.strokeColor = parent.textArea.style.color !== '' &&\n            parent.textArea.style.color.split('(')[1] && parent.textArea.style.color.split('(')[1].split(',')[0] &&\n            parent.textArea.style.color.split('(')[1].split(',')[1] && parent.textArea.style.color.split('(')[1].split(',')[2]\n            && parent.textArea.style.color.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.color.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[3])) :\n            parent.textArea.style.color;\n        if (parent.textArea.style.fontWeight === 'bold') {\n            parent.activeObj.textSettings.bold = true;\n        }\n        else {\n            parent.activeObj.textSettings.bold = false;\n        }\n        if (parent.textArea.style.fontStyle === 'italic') {\n            parent.activeObj.textSettings.italic = true;\n        }\n        else {\n            parent.activeObj.textSettings.italic = false;\n        }\n        parent.activeObj.textSettings.fontSize = (parseFloat(parent.textArea.style.fontSize));\n    };\n    Selection.prototype.rgbToHex = function (r, g, b, a) {\n        r = Math.max(0, Math.min(255, Math.round(r)));\n        g = Math.max(0, Math.min(255, Math.round(g)));\n        b = Math.max(0, Math.min(255, Math.round(b)));\n        a = Math.max(0, Math.min(1, a));\n        var hexR = this.padLeft(r.toString(16), 2, '0');\n        var hexG = this.padLeft(g.toString(16), 2, '0');\n        var hexB = this.padLeft(b.toString(16), 2, '0');\n        var hexA = this.padLeft(Math.round(a * 255).toString(16), 2, '0');\n        var hex = \"#\" + hexR + hexG + hexB + hexA;\n        return hex;\n    };\n    Selection.prototype.padLeft = function (value, length, padChar) {\n        while (value.length < length) {\n            value = padChar + value;\n        }\n        return value;\n    };\n    Selection.prototype.deleteItem = function () {\n        var parent = this.parent;\n        var shapeChangingArgs = { cancel: false };\n        var previousShapeSettings = {};\n        if (this.isFhdEditing) {\n            this.updateFreehandDrawColorChange();\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('freehand-draw', { prop: 'deleteFhd', value: { id: obj['freehandDrawSelectedId'] } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'deleteFreehandDrawing', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            parent.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId' });\n        }\n        else if (parent.textArea.style.display === 'none') {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (obj['prevActObj']) {\n                obj['prevActObj']['activePoint']['width'] = Math.abs(obj['prevActObj']['activePoint']['width']);\n                obj['prevActObj']['activePoint']['height'] = Math.abs(obj['prevActObj']['activePoint']['height']);\n            }\n            if (obj['prevActObj'] && JSON.stringify(obj['prevActObj']) !== JSON.stringify(parent.activeObj)) {\n                var index = parent.activeObj.currIndex;\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === index) {\n                        parent.objColl.splice(i, 1);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                        break;\n                    }\n                }\n            }\n            var object = { isNewPath: null };\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: object } });\n            if (object['isNewPath']) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else if (parent.activeObj.shape) {\n                parent.objColl.push(parent.activeObj);\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object_2 = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_2 } });\n                var prevObj = object_2['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.objColl.pop();\n                previousShapeSettings = this.updatePrevShapeSettings();\n                shapeChangingArgs = { cancel: false, action: 'delete', previousShapeSettings: previousShapeSettings, currentShapeSettings: null };\n                parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n                parent.clearSelection();\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                if (!isNullOrUndefined(prevObj.objColl[prevObj.objColl.length - 1].currIndex)) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'deleteObj', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    Selection.prototype.updateFreehandDrawColorChange = function () {\n        var parent = this.parent;\n        var indexObj = { freehandSelectedIndex: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && !isNullOrUndefined(parent.pointColl[indexObj['freehandSelectedIndex']])\n            && parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor === '#42a5f5') {\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor = obj['tempFreeHandDrawEditingStyles'].strokeColor;\n        }\n    };\n    Selection.prototype.updatePrevShapeSettings = function (obj) {\n        var parent = this.parent;\n        var fontStyle = [];\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n            parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n            parent.activeObj.currIndex = shapeIDObj['id'];\n        }\n        if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n            if (parent.activeObj.textSettings.bold) {\n                fontStyle.push('bold');\n            }\n            if (parent.activeObj.textSettings.italic) {\n                fontStyle.push('italic');\n            }\n            if (parent.activeObj.textSettings.underline) {\n                fontStyle.push('underline');\n            }\n        }\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var _b = parent.activeObj, keyHistory = _b.keyHistory, currIndex = _b.currIndex, shape = _b.shape, textSettings = _b.textSettings, strokeSettings = _b.strokeSettings, rotatedAngle = _b.rotatedAngle, imageElement = _b.imageElement, opacity = _b.opacity;\n        var shapeSettingsObj = {\n            id: !isNullOrUndefined(currIndex) ? currIndex : null,\n            type: parent.toPascalCase(shape),\n            startX: startX, startY: startY, width: width, height: height,\n            strokeColor: strokeSettings ? strokeSettings.strokeColor : null,\n            strokeWidth: strokeSettings ? strokeSettings.strokeWidth : null,\n            fillColor: strokeSettings ? strokeSettings.fillColor : null,\n            radius: shape === 'ellipse' ? width / 2 : null,\n            length: shape === 'line' || shape === 'arrow' ? width : null,\n            text: shape === 'text' ? (keyHistory ? keyHistory : (textSettings.text ? textSettings.text : null)) : null,\n            fontSize: shape === 'text' ? (textSettings ? textSettings.fontSize : null) : null,\n            fontFamily: shape === 'text' ? (textSettings ? textSettings.fontFamily : null) : null,\n            fontStyle: shape === 'text' ? fontStyle : null,\n            color: shape === 'text' ? (strokeSettings ? strokeSettings.strokeColor : null) : null,\n            degree: shape === 'ellipse' || shape === 'rectangle' || shape === 'image' || shape === 'text' ? rotatedAngle * (180 / Math.PI) : null,\n            imageData: shape === 'image' ? imageElement.src : null,\n            opacity: shape === 'image' ? opacity : null,\n            radiusX: shape === 'ellipse' ? width / 2 : null,\n            radiusY: shape === 'ellipse' ? height / 2 : null,\n            endX: shape === 'line' || shape === 'arrow' ? endX : null,\n            endY: shape === 'line' || shape === 'arrow' ? endY : null,\n            arrowHead: shape === 'arrow' ? this.getArrowType(parent.activeObj.start) : null,\n            arrowTail: shape === 'arrow' ? this.getArrowType(parent.activeObj.end) : null,\n            points: shape === 'path' ? parent.activeObj.pointColl : null\n        };\n        if (obj) {\n            obj['shapeSettingsObj'] = shapeSettingsObj;\n        }\n        return shapeSettingsObj;\n    };\n    Selection.prototype.getArrowType = function (type) {\n        var typeToArrowType = { 'none': 'None', 'arrow': 'Arrow', 'arrowSolid': 'SolidArrow',\n            'circle': 'Circle', 'circleSolid': 'SolidCircle', 'square': 'Square', 'squareSolid': 'SolidSquare', 'bar': 'Bar' };\n        return typeToArrowType[\"\" + type];\n    };\n    Selection.prototype.getRectanglePoints = function (rectX, rectY, rectWidth, rectHeight, rectAngle, pointX, pointY) {\n        var centerX = rectX + rectWidth / 2;\n        var centerY = rectY + rectHeight / 2;\n        var angleRad = rectAngle * (Math.PI / 180);\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var localX = pointX - centerX;\n        var localY = pointY - centerY;\n        var rotatedX = localX * cosAngle + localY * sinAngle;\n        var rotatedY = -localX * sinAngle + localY * cosAngle;\n        var halfWidth = rectWidth / 2;\n        var halfHeight = rectHeight / 2;\n        if (rotatedX >= -halfWidth && rotatedX <= halfWidth && rotatedY >= -halfHeight &&\n            rotatedY <= halfHeight) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.getTransRotationPoint = function (obj, object) {\n        var rotationCirclePoint;\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        degree = (obj.shapeDegree === 0) ? this.parent.transform.degree : this.parent.transform.degree - obj.shapeDegree;\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (obj.flipObjColl) {\n            for (var i = 0, iLen = obj.flipObjColl.length; i < iLen; i++) {\n                if (obj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (obj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        if (degree === 0 || degree === 360) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 90 || degree === -270) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        else if (degree === 180 || degree === -180) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 270 || degree === -90) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        if (object) {\n            object['rotationCirclePoint'] = rotationCirclePoint;\n        }\n        return rotationCirclePoint;\n    };\n    Selection.prototype.getNumTextValue = function (obj) {\n        var parent = this.parent;\n        var elem = parent.element;\n        var height;\n        var width;\n        var widthElement;\n        var heightElement;\n        widthElement = elem.querySelector('#' + elem.id + '_resizeWidth');\n        heightElement = elem.querySelector('#' + elem.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            var heightString = heightElement.value.replace(/,/g, '');\n            var widthString = widthElement.value.replace(/,/g, '');\n            if (heightString === '') {\n                heightString = heightElement.placeholder.replace(/,/g, '');\n            }\n            if (widthString === '') {\n                widthString = widthElement.placeholder.replace(/,/g, '');\n            }\n            height = parseFloat(heightString);\n            width = parseFloat(widthString);\n        }\n        if (obj) {\n            obj['width'] = width;\n            obj['height'] = height;\n        }\n        return { x: width, y: height };\n    };\n    Selection.prototype.isValueUpdated = function () {\n        var isValue = true;\n        var widthElement;\n        var heightElement;\n        widthElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeWidth');\n        heightElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            if (heightElement.value.replace(/,/g, '') === '' && widthElement.value.replace(/,/g, '') === '') {\n                isValue = false;\n            }\n        }\n        return isValue;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar Shape = /** @class */ (function () {\n    function Shape(parent) {\n        this.textSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.keyHistory = ''; // text history\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Shape.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Shape.prototype.addEventListener = function () {\n        this.parent.on('shape', this.shape, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Shape.prototype.removeEventListener = function () {\n        this.parent.off('shape', this.shape);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Shape.prototype.shape = function (args) {\n        var parent = this.parent;\n        this.initShapePvtProps();\n        var uploader;\n        switch (args.prop) {\n            case 'drawEllipse':\n                this.drawEllipse(args.value['x'], args.value['y'], args.value['radiusX'], args.value['radiusY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected']);\n                break;\n            case 'drawLine':\n                this.drawLine(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawArrow':\n                this.drawArrow(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['arrowStart'], args.value['arrowEnd'], args.value['isSelected']);\n                break;\n            case 'drawPath':\n                this.drawPath(args.value['pointColl'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawRectangle':\n                this.drawRectangle(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected']);\n                break;\n            case 'drawText':\n                this.drawText(args.value['x'], args.value['y'], args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['color'], args.value['isSelected']);\n                break;\n            case 'redrawActObj':\n                this.redrawActObj(args.value['x'], args.value['y'], args.value['isMouseDown']);\n                break;\n            case 'apply':\n                this.apply(args.value['shape'], args.value['obj'], args.value['canvas']);\n                break;\n            case 'updateShapeChangeEventArgs':\n                this.updateShapeChangeEventArgs(args.value['shapeSettings']);\n                break;\n            case 'updSelChangeEventArgs':\n                this.updSelChangeEventArgs(args.value['selectionSettings']);\n                break;\n            case 'iterateObjColl':\n                this.iterateObjColl();\n                break;\n            case 'updImgRatioForActObj':\n                this.updImgRatioForActObj();\n                break;\n            case 'zoomObjColl':\n                this.zoomObjColl(args.value['isPreventApply']);\n                break;\n            case 'redrawObj':\n                this.redrawObj(args.value['degree']);\n                break;\n            case 'rotateObjColl':\n                this.rotateObjColl();\n                break;\n            case 'draw-shape-text':\n                this.drawShapeText();\n                break;\n            case 'redraw-text':\n                this.redrawText();\n                break;\n            case 'draw-shape':\n                this.drawShape(args.value['obj'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['start'], args.value['width'], args.value['height']);\n                break;\n            case 'renderTextArea':\n                this.renderTextArea(args.value['x'], args.value['y'], args.value['actObj']);\n                break;\n            case 'setTextBoxWidth':\n                this.setTextBoxWidth(args.value['e']);\n                break;\n            case 'findTextTarget':\n                this.findTextTarget(args.value['e']);\n                break;\n            case 'panObjColl':\n                this.panObjColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFontStyles':\n                this.updateFontStyles(args.value['isTextBox']);\n                break;\n            case 'applyFontStyle':\n                this.applyFontStyle(args.value['item']);\n                break;\n            case 'updateFontRatio':\n                this.updateFontRatio(args.value['obj'], args.value['isTextArea']);\n                break;\n            case 'updateFontSize':\n                this.updateFontSize(args.value['obj']);\n                break;\n            case 'updateObjColl':\n                this.updateObjColl(args.value['item'], args.value['objColl']);\n                break;\n            case 'pushActItemIntoObj':\n                this.pushActItemIntoObj();\n                break;\n            case 'clearActObj':\n                this.clearActObj();\n                break;\n            case 'refreshActiveObj':\n                this.refreshActiveObj();\n                break;\n            case 'applyActObj':\n                this.applyActObj(args.value['isMouseDown']);\n                break;\n            case 'wireEvent':\n                EventHandler.add(parent.upperCanvas, 'dblclick', this.findTextTarget, this);\n                EventHandler.add(parent.textArea, 'mousedown', this.findTextTarget, this);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                if (uploader) {\n                    EventHandler.add(uploader, 'change', this.fileChanged, this);\n                }\n                break;\n            case 'unWireEvent':\n                EventHandler.remove(parent.upperCanvas, 'dblclick', this.findTextTarget);\n                EventHandler.remove(parent.textArea, 'mousedown', this.findTextTarget);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                EventHandler.remove(uploader, 'change', this.fileChanged);\n                break;\n            case 'getShapeSetting':\n                this.getShapeSetting(args.value['id'], args.value['obj']);\n                break;\n            case 'getShapeSettings':\n                this.getShapeSettings(args.value['obj']);\n                break;\n            case 'isPointsInRange':\n                this.isPointsInRange(args.value['x'], args.value['y'], args.value['obj']);\n                break;\n            case 'alignRotateFlipColl':\n                this.alignRotateFlipColl(args.value['collection'], args.value['isRotateFlipCollection'], args.value['obj']);\n                break;\n            case 'selectShape':\n                this.selectShape(args.value['id'], args.value['obj']);\n                break;\n            case 'deleteShape':\n                this.deleteShape(args.value['id']);\n                break;\n            case 'getMaxText':\n                this.getMaxText(args.value['isTextBox'], args.value['text'], args.value['obj']);\n                break;\n            case 'setPointCollForLineArrow':\n                args.value['obj'].pointColl = this.getLinePoints(args.value['obj'].activePoint.startX, args.value['obj'].activePoint.startY, args.value['obj'].activePoint.endX, args.value['obj'].activePoint.endY);\n                break;\n            case 'setPointCollForShapeRotation':\n                this.setPointCollForShapeRotation(args.value['obj']);\n                break;\n            case 'setTextSettings':\n                if (args.value['textSettings']) {\n                    this.textSettings = args.value['textSettings'];\n                }\n                else if (args.value['fontFamily']) {\n                    this.textSettings.fontFamily = args.value['fontFamily'];\n                }\n                else if (args.value['fontSize']) {\n                    this.textSettings.fontSize = args.value['fontSize'];\n                }\n                break;\n            case 'setStrokeSettings':\n                if (args.value['strokeSettings']) {\n                    this.strokeSettings = args.value['strokeSettings'];\n                }\n                else if (args.value['strokeColor']) {\n                    this.strokeSettings.strokeColor = args.value['strokeColor'];\n                }\n                else if (args.value['fillColor']) {\n                    this.strokeSettings.fillColor = args.value['fillColor'];\n                }\n                else if (args.value['strokeWidth']) {\n                    this.strokeSettings.strokeWidth = args.value['strokeWidth'];\n                }\n                break;\n            case 'getStrokeSettings':\n                args.value['obj']['strokeSettings'] = this.strokeSettings;\n                break;\n            case 'setKeyHistory':\n                this.keyHistory = args.value['keyHistory'];\n                break;\n            case 'getKeyHistory':\n                args.value['obj']['keyHistory'] = this.keyHistory;\n                break;\n            case 'setTextBoxPos':\n                this.setTextBoxPos(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'setTextBoxPoints':\n                this.setTextBoxPoints(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'alignTextAreaIntoCanvas':\n                this.alignTextAreaIntoCanvas();\n                break;\n            case 'initializeTextShape':\n                this.initializeTextShape(args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['strokeColor']);\n                break;\n            case 'stopPathDrawing':\n                this.stopPathDrawing(args.value['e'], args.value['isApply']);\n                break;\n            case 'updateArrowRatio':\n                this.updateArrowRatio(args.value['obj']);\n                break;\n            case 'getSquarePointForRotatedShape':\n                this.getSquarePointForRotatedShape(args.value['obj'], args.value['object']);\n                break;\n            case 'drawImage':\n                this.drawImage(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['src'], args.value['degree'], args.value['isAspectRatio'], args.value['opacity'], args.value['isSelected']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'fileChanged':\n                this.fileChanged(args.value['e']);\n                break;\n            case 'updateObj':\n                this.updateObj(args.value['dimObj'], args.value['x'], args.value['y']);\n                break;\n            case 'straightenShapes':\n                this.straightenShapes();\n                break;\n            case 'straightenShapePoints':\n                this.straightenShapePoints(args.value['obj'], args.value['isReverse']);\n                break;\n            case 'straightenPath':\n                this.straightenPath(args.value['obj']);\n                break;\n            case 'straightenFHD':\n                this.straightenFHD();\n                break;\n            case 'getTextBoxPosition':\n                this.getTextBoxPosition(args.value['obj'], args.value['object']);\n                break;\n            case 'updateSelectionChangeEventArgs':\n                this.updateSelectionChangeEventArgs(args.value['selectionSettings']);\n                break;\n            case 'setFlipState':\n                this.setFlipState(args.value['x'], args.value['y'], args.value['obj'], args.value['object']);\n                break;\n            case 'getNewShapeId':\n                args.value['obj']['id'] = this.getNewShapeId();\n                break;\n        }\n    };\n    Shape.prototype.getModuleName = function () {\n        return 'shape';\n    };\n    Shape.prototype.initShapePvtProps = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.shapeImg)) {\n            this.shapeImg = parent.createElement('img', {\n                id: parent.element.id + '_shapeImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n            });\n        }\n        if (this.textSettings.fontFamily === '') {\n            this.textSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Shape.prototype.reset = function () {\n        this.textSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n    };\n    Shape.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        this.initializeShape('ellipse');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('ellipse', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY, null, null, null, degree, null, isSelected);\n    };\n    Shape.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        this.initializeShape('line');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('line', strokeWidth, strokeColor, null, start, width, height, null, null, null, null, null, isSelected);\n    };\n    Shape.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        var parent = this.parent;\n        this.initializeShape('path');\n        if (pointColl) {\n            this.drawShape('path', strokeWidth, strokeColor, null, null, null, null, pointColl, null, null, null, null, isSelected);\n        }\n        else {\n            this.drawShape('line', strokeWidth, strokeColor, null, null, null, null, null, null, null, null, null, isSelected);\n            var obj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n            obj.shape = 'path';\n            obj.lineDraw = null;\n            obj.pointColl = [{ x: obj.activePoint.startX, y: obj.activePoint.startY },\n                { x: obj.activePoint.endX, y: obj.activePoint.endY }];\n            parent.objColl[parent.objColl.length - 1] = obj;\n        }\n    };\n    Shape.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        this.initializeShape('arrow');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('arrow', strokeWidth, strokeColor, null, start, width, height, null, arrowStart, arrowEnd, null, null, isSelected);\n    };\n    Shape.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        this.initializeShape('rectangle');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height, null, null, null, degree, null, isSelected);\n    };\n    Shape.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected) {\n        this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y, isSelected);\n    };\n    Shape.prototype.initializeShape = function (type) {\n        var parent = this.parent;\n        this.redrawActObj();\n        parent.activeObj.shape = type;\n        if (parent.currObjType.shape === 'freehanddraw') {\n            this.apply();\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.shape = '';\n        }\n        parent.currObjType.isCustomCrop = false;\n    };\n    Shape.prototype.updateWidthHeight = function (obj) {\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        return obj;\n    };\n    Shape.prototype.setDimension = function (width, height) {\n        var parent = this.parent;\n        if (width && height) {\n            parent.activeObj.activePoint.width = width;\n            parent.activeObj.activePoint.height = height;\n            if (parent.currObjType.shape.toLowerCase() === 'ellipse') {\n                parent.activeObj.activePoint.width = 2 * width;\n                parent.activeObj.activePoint.height = 2 * height;\n            }\n        }\n    };\n    Shape.prototype.getArrowType = function (type) {\n        var arrowType = type;\n        if (type) {\n            var typeToArrowType = { 'None': 'none', 'Arrow': 'arrow', 'SolidArrow': 'arrowSolid',\n                'Circle': 'circle', 'SolidCircle': 'circleSolid', 'Square': 'square', 'SolidSquare': 'squareSolid', 'Bar': 'bar' };\n            arrowType = typeToArrowType[\"\" + type];\n        }\n        return arrowType;\n    };\n    Shape.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height, pointColl, arrowStart, arrowEnd, degree, opacity, isSelected) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            this.redrawActObj();\n            var objColl = extend([], parent.objColl, [], true);\n            parent.togglePen = false;\n            this.keyHistory = '';\n            parent.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            parent.currObjType.shape = type = type.toLowerCase();\n            if (type === 'path' && isNullOrUndefined(pointColl)) {\n                parent.activeObj.shape = type;\n                parent.activeObj.pointColl = [];\n                parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: 'path' } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            }\n            else {\n                if (type !== 'freehanddraw' && type !== '') {\n                    parent.activeObj.shape = type;\n                    var strokeSettings = parent.activeObj.strokeSettings;\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (isNullOrUndefined(strokeSettings)) {\n                        strokeSettings = this.strokeSettings;\n                    }\n                    if (type === 'path' && pointColl) {\n                        parent.activeObj.pointColl = pointColl;\n                    }\n                    if (opacity !== null && opacity !== undefined) {\n                        parent.activeObj.opacity = opacity;\n                    }\n                    strokeSettings.strokeWidth = strokeWidth ? strokeWidth : strokeSettings.strokeWidth;\n                    strokeSettings.strokeColor = strokeColor ? strokeColor : strokeSettings.strokeColor;\n                    strokeSettings.fillColor = fillColor ? fillColor : strokeSettings.fillColor;\n                    var tempWidth = parent.img.destWidth > 100 ? 100 : parent.img.destWidth / 2;\n                    var tempHeight = parent.img.destHeight > 100 ? 100 : parent.img.destHeight / 2;\n                    parent.activeObj.activePoint.width = tempWidth;\n                    parent.activeObj.activePoint.height = tempHeight;\n                    if (type === 'line' || type === 'arrow') {\n                        parent.activeObj.lineDraw = 'horizontal';\n                        parent.activeObj.activePoint.height = 0;\n                        if (type === 'arrow') {\n                            parent.activeObj.activePoint.width += 50;\n                            parent.activeObj.start = this.getArrowType(arrowStart);\n                            parent.activeObj.end = this.getArrowType(arrowEnd);\n                        }\n                    }\n                    else if (type === 'rectangle') {\n                        parent.activeObj.activePoint.width += parent.activeObj.activePoint.width / 2;\n                    }\n                    this.setDimension(width, height);\n                    if (start) {\n                        parent.activeObj.activePoint.startX = start.x;\n                        parent.activeObj.activePoint.startY = start.y;\n                        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX +\n                            parent.activeObj.activePoint.width;\n                        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY +\n                            parent.activeObj.activePoint.height;\n                    }\n                    else {\n                        this.setCenterPoints();\n                    }\n                    this.setPointCollForLineAndArrow();\n                    if (type === 'arrow') {\n                        parent.activeObj.triangleDirection = 'right';\n                    }\n                    parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n                    this.initShapeProps();\n                    var obj = { shapeSettingsObj: {} };\n                    parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n                    var shapeSettings = obj['shapeSettingsObj'];\n                    var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                        currentShapeSettings: shapeSettings };\n                    parent.trigger('shapeChanging', shapeChangingArgs);\n                    this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n                    this.setDimension(width, height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                    if (degree) {\n                        parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                        parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                    }\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n                    parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    if (parent.isPublicMethod && !isSelected) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n                    }\n                    parent.isPublicMethod = false;\n                }\n            }\n        }\n    };\n    Shape.prototype.initShapeProps = function () {\n        var parent = this.parent;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n    };\n    Shape.prototype.setPointCollForLineAndArrow = function () {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (shape === 'line' || shape === 'arrow') {\n            parent.activeObj.pointColl = this.getLinePoints(startX, startY, endX, endY);\n            if (parent.activeObj.pointColl) {\n                for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                    parent.activeObj.pointColl[i].ratioX = (parent.activeObj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    parent.activeObj.pointColl[i].ratioY = (parent.activeObj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n    };\n    Shape.prototype.prevObjColl = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevObj = object['currObj'];\n        this.prevObj.objColl = extend([], parent.objColl, [], true);\n        this.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        this.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n    };\n    Shape.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y, isSelected) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                parent.currObjType.shape = '';\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.togglePen = false;\n            this.redrawActObj();\n            this.prevObjColl();\n            this.refreshActiveObj();\n            parent.activeObj.shape = parent.currObjType.shape = 'text';\n            parent.currObjType.isCustomCrop = false;\n            this.initializeTextShape(text, fontFamily, fontSize, bold, italic, strokeColor);\n            parent.currObjType.isText = parent.currObjType.isInitialText = true;\n            if (isNullOrUndefined(parent.activeObj.textSettings.fontSize)) {\n                parent.getFontSizes();\n                parent.activeObj.textSettings.fontSize = parseInt(parent.fontSizeColl[(parseInt('3', 10) - 1)].text, 10);\n            }\n            if (parent.img.destWidth < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destWidth / 20));\n            }\n            else if (parent.img.destHeight < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destHeight / 20));\n            }\n            parent.activeObj.shapeDegree = parent.transform.degree;\n            parent.activeObj.shapeFlip = parent.transform.currFlipState;\n            parent.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n            var height = parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25;\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                parent.activeObj.activePoint.startX = x;\n                parent.activeObj.activePoint.startY = y;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            parent.trigger('shapeChanging', shapeChangingArgs);\n            this.drawShapeTextEvent(shapeChangingArgs);\n            if (parent.isPublicMethod && !isSelected) {\n                parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n            }\n            parent.isPublicMethod = false;\n        }\n    };\n    Shape.prototype.drawShapeImageEvent = function (shapeChangingArgs, isSelect) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl, previousCropObj: prevCropObj,\n                previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        if (isSelect) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        else {\n            parent.okBtn();\n        }\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n    };\n    Shape.prototype.drawShapeTextEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n        this.addLetter(parent.activeObj.textSettings.text);\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        this.updateFontRatio(parent.activeObj);\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n    };\n    Shape.prototype.initializeTextShape = function (text, fontFamily, fontSize, bold, italic, strokeColor) {\n        var parent = this.parent;\n        this.keyHistory = '';\n        parent.upperCanvas.style.display = 'block';\n        if (isNullOrUndefined(parent.activeObj.textSettings)) {\n            parent.activeObj.textSettings = this.textSettings;\n        }\n        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n            parent.activeObj.strokeSettings = this.strokeSettings;\n        }\n        parent.activeObj.strokeSettings.strokeColor = strokeColor || parent.activeObj.strokeSettings.strokeColor;\n        parent.activeObj.textSettings.text = text || parent.activeObj.textSettings.text;\n        parent.activeObj.textSettings.fontFamily = fontFamily || parent.activeObj.textSettings.fontFamily;\n        parent.activeObj.textSettings.fontSize = fontSize || parent.activeObj.textSettings.fontSize;\n        parent.activeObj.textSettings.bold = bold || parent.activeObj.textSettings.bold;\n        parent.activeObj.textSettings.italic = italic || parent.activeObj.textSettings.italic;\n    };\n    Shape.prototype.drawImage = function (x, y, width, height, src, degree, isAspectRatio, opacity, isSelected) {\n        this.initializeShape('image');\n        this.onLoadImgShape(x, y, width, height, src, null, degree, isAspectRatio, opacity, isSelected);\n    };\n    Shape.prototype.redrawActObj = function (x, y, isMouseDown) {\n        var splitWords;\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n            if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n                this.updateFontRatio(parent.activeObj, true);\n                if (x && y) {\n                    if ((x !== parent.activeObj.activePoint.startX) && (y !== parent.activeObj.activePoint.startY)) {\n                        this.updateTextFromTextArea();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea();\n                    parent.textArea.style.transform = '';\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                this.refreshActiveObj();\n            }\n            else {\n                this.applyActObj(isMouseDown);\n            }\n        }\n    };\n    Shape.prototype.apply = function (shape, obj, canvas) {\n        var parent = this.parent;\n        if (!parent.disabled) {\n            if (parent.togglePen && !parent.currObjType.isCustomCrop) {\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.togglePen = false;\n                if (parent.isCircleCrop || (parent.currSelectionPoint &&\n                    parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.img.destWidth = destWidth;\n                parent.img.destHeight = destHeight;\n                this.lowerContext.filter = temp;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                if (isNullOrUndefined(parent.activeObj.shape) && isNullOrUndefined(shape)) {\n                    parent.currObjType.shape = '';\n                }\n                else {\n                    parent.currObjType.shape = shape || parent.currObjType.shape;\n                }\n                if (parent.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj, isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                    }\n                    else {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj } });\n                    }\n                    parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                    if (!shape && parent.currObjType.shape !== '' && !parent.currObjType.isCustomCrop) {\n                        parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n            }\n        }\n    };\n    Shape.prototype.setCenterPoints = function (text, width, height) {\n        var parent = this.parent;\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = parent.activeObj.activePoint.width;\n            renderHeight = parent.activeObj.activePoint.height;\n        }\n        parent.activeObj.activePoint.startX = (parent.lowerCanvas.width / 2) - renderWidth / 2;\n        parent.activeObj.activePoint.startY = (parent.lowerCanvas.height / 2) - renderHeight / 2;\n        parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + renderWidth / 2;\n        parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) + renderHeight / 2;\n    };\n    Shape.prototype.updSelChangeEventArgs = function (selectionSettings) {\n        var parent = this.parent;\n        parent.activeObj.activePoint = { startX: selectionSettings.startX, startY: selectionSettings.startY,\n            endX: parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width,\n            endY: parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height,\n            width: selectionSettings.width, height: selectionSettings.height };\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n    };\n    Shape.prototype.updateShapeChangeEventArgs = function (shapeSettings) {\n        var parent = this.parent;\n        var shapeId;\n        if (shapeSettings.id && shapeSettings.id.split('_')[0] && shapeSettings.id.split('_')[0] === 'pen') {\n            shapeId = parseInt(shapeSettings.id.split('_')[1], 10) - 1;\n            parent.pointColl[shapeId].points = shapeSettings.points;\n            parent.pointColl[shapeId].strokeColor = shapeSettings.strokeColor;\n            parent.pointColl[shapeId].strokeWidth = shapeSettings.strokeWidth;\n            parent.pointColl[shapeId].opacity = shapeSettings.opacity;\n        }\n        else {\n            parent.activeObj.currIndex = shapeSettings.id;\n            parent.activeObj.activePoint.startX = shapeSettings.startX;\n            parent.activeObj.activePoint.startY = shapeSettings.startY;\n            if (shapeSettings.width && shapeSettings.height) {\n                parent.activeObj.activePoint.width = shapeSettings.width;\n                parent.activeObj.activePoint.height = shapeSettings.height;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n            }\n            parent.activeObj.strokeSettings.strokeColor = shapeSettings.strokeColor;\n            parent.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n            parent.activeObj.strokeSettings.strokeWidth = shapeSettings.strokeWidth;\n            parent.activeObj.opacity = shapeSettings.opacity;\n            if (isNullOrUndefined(shapeSettings.degree)) {\n                shapeSettings.degree = 0;\n            }\n            switch (parent.activeObj.shape) {\n                case 'ellipse':\n                    parent.activeObj.activePoint.width = shapeSettings.radiusX * 2;\n                    parent.activeObj.activePoint.height = shapeSettings.radiusY * 2;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    break;\n                case 'line':\n                case 'arrow':\n                    parent.activeObj.activePoint.width = shapeSettings.length;\n                    parent.activeObj.activePoint.endX = shapeSettings.endX;\n                    parent.activeObj.activePoint.endY = shapeSettings.endY;\n                    parent.activeObj.activePoint.width = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (parent.activeObj.shape === 'arrow') {\n                        parent.activeObj.start = this.getArrowType(shapeSettings.arrowHead);\n                        parent.activeObj.end = this.getArrowType(shapeSettings.arrowTail);\n                    }\n                    break;\n                case 'text':\n                    parent.activeObj.keyHistory = parent.activeObj.textSettings.text = shapeSettings.text;\n                    parent.activeObj.textSettings.fontSize = shapeSettings.fontSize;\n                    parent.activeObj.strokeSettings.strokeColor = shapeSettings.color;\n                    parent.activeObj.textSettings.fontFamily = shapeSettings.fontFamily;\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    this.updateFontRatio(parent.activeObj);\n                    break;\n                case 'rectangle':\n                case 'image':\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    // Prevented setting image src as it cannot be set in canvas\n                    break;\n                case 'path':\n                    parent.activeObj.pointColl = shapeSettings.points;\n                    break;\n            }\n            if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                parent.activeObj.textSettings.underline = false;\n                for (var i = 0; i < shapeSettings.fontStyle.length; i++) {\n                    switch (shapeSettings.fontStyle[i]) {\n                        case 'bold':\n                            parent.activeObj.textSettings.bold = true;\n                            break;\n                        case 'italic':\n                            parent.activeObj.textSettings.italic = true;\n                            break;\n                        case 'underline':\n                            parent.activeObj.textSettings.underline = true;\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.updateSelectionChangeEventArgs = function (selectionSettings) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.startX = selectionSettings.startX;\n        parent.activeObj.activePoint.startY = selectionSettings.startY;\n        if (selectionSettings.width && selectionSettings.height) {\n            parent.activeObj.activePoint.width = selectionSettings.width;\n            parent.activeObj.activePoint.height = selectionSettings.height;\n            parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n            parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n        }\n    };\n    Shape.prototype.addLetter = function (letter) {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none' && (parent.currObjType.isText || parent.activeObj.shape === 'text')) {\n            var fontSize = parent.activeObj.textSettings.fontSize;\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory).width + fontSize * 0.5;\n            var height = fontSize + fontSize * 0.25;\n            this.upperContext.fillText(this.keyHistory, parent.activeObj.activePoint.startX, parent.activeObj.activePoint.startY + fontSize);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isText = true;\n            parent.notify('selection', { prop: 'setActivePoint', onPropertyChange: false,\n                value: { startX: width, startY: height } });\n        }\n    };\n    Shape.prototype.redrawText = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.textSettings, fontSize = _a.fontSize, fontFamily = _a.fontFamily, bold = _a.bold, italic = _a.italic;\n        var fontStyle = '';\n        if (bold) {\n            fontStyle += 'bold ';\n        }\n        if (italic) {\n            fontStyle += 'italic ';\n        }\n        this.upperContext.font = fontStyle + fontSize + 'px ' + fontFamily;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var text = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + fontSize * 0.5;\n        var height = rows.length * (fontSize + fontSize * 0.25);\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.activeObj } });\n    };\n    Shape.prototype.updateTextFromTextArea = function () {\n        var parent = this.parent;\n        var allowUndoRedo = false;\n        var fontSize = parent.activeObj.textSettings.fontSize;\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (parent.activeObj.keyHistory !== parent.textArea.value) {\n            allowUndoRedo = true;\n        }\n        parent.activeObj.keyHistory = parent.textArea.value;\n        parent.textArea.style.display = 'none';\n        parent.textArea.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(parent.activeObj.keyHistory).width + fontSize * 0.5;\n        var height = fontSize + fontSize * 0.25;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            var widthColl = [];\n            for (var i = 0, len = rows.length; i < len; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width + fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var width_1 = parent.activeObj.activePoint.width - tempActiveObj.activePoint.width;\n            var height_1 = parent.activeObj.activePoint.height - tempActiveObj.activePoint.height;\n            var value = '';\n            if (width_1 > 0 && height_1 > 0) {\n                value = 'widthHeight';\n            }\n            else if (width_1 !== 0) {\n                value = 'width';\n            }\n            else if (height_1 !== 0) {\n                value = 'height';\n            }\n            parent.activeObj.activePoint = extend({}, tempActiveObj.activePoint, {}, true);\n            parent.notify('selection', { prop: 'adjustRotationPoints', onPropertyChange: false, value: { rectangle: parent.activeObj.activePoint,\n                    x: width_1, y: height_1, angle: parent.activeObj.rotatedAngle, type: 'text', elem: value } });\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.updImgRatioForActObj();\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        if (allowUndoRedo) {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'text', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: parent.activeObj.keyHistory,\n                    currentText: parent.textArea.value, previousFilter: null, isCircleCrop: null } });\n        }\n        else {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n        }\n    };\n    Shape.prototype.iterateObjColl = function () {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.apply(parent.objColl[i].shape, parent.objColl[i]);\n                this.lowerContext.filter = temp;\n                this.refreshActiveObj();\n            }\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n        }\n    };\n    Shape.prototype.updImgRatioForActObj = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var activePoint = parent.activeObj.activePoint;\n        parent.activeObj.imageRatio = { startX: ((activePoint.startX - destLeft) /\n                destWidth), startY: ((activePoint.startY - destTop) / destHeight),\n            endX: ((activePoint.endX - destLeft) / destWidth),\n            endY: ((activePoint.endY - destTop) / destHeight),\n            width: destWidth / activePoint.width, height: destHeight / activePoint.height };\n        if (parent.activeObj.rotationCirclePointColl) {\n            parent.activeObj.rotationCirclePointColl.ratioX = (parent.activeObj.rotationCirclePointColl.x -\n                destLeft) / destWidth;\n            parent.activeObj.rotationCirclePointColl.ratioY = (parent.activeObj.rotationCirclePointColl.y -\n                destTop) / destHeight;\n        }\n        if (parent.activeObj.shape === 'path') {\n            this.updatePathRatio(parent.activeObj);\n        }\n        else if (parent.activeObj.shape === 'arrow') {\n            this.updateArrowRatio(parent.activeObj);\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.zoomObjColl = function (preventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.activePoint.startX = (currObj.imageRatio.startX * destWidth) + destLeft;\n            currObj.activePoint.startY = (currObj.imageRatio.startY * destHeight) + destTop;\n            currObj.activePoint.endX = (currObj.imageRatio.endX * destWidth) + destLeft;\n            currObj.activePoint.endY = (currObj.imageRatio.endY * destHeight) + destTop;\n            currObj = this.updateWidthHeight(currObj);\n            if (currObj.shape === 'text') {\n                this.updateFontSize(currObj);\n            }\n            else if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                for (var n = 0, len_1 = currObj.pointColl.length; n < len_1; n++) {\n                    currObj.pointColl[n].ratioX =\n                        (currObj.pointColl[n].x - destLeft) / destWidth;\n                    currObj.pointColl[n].ratioY =\n                        (currObj.pointColl[n].y - destTop) / destHeight;\n                }\n                if (currObj.shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n                if (parent.transform.straighten !== 0 && (currObj.shape === 'line' || currObj.shape === 'arrow')) {\n                    this.straightenShapePoints(currObj);\n                }\n            }\n            else if (currObj.shape === 'path') {\n                for (var l = 0, len_2 = currObj.pointColl.length; l < len_2; l++) {\n                    currObj.pointColl[l].x = (currObj.pointColl[l].ratioX * destWidth) +\n                        destLeft;\n                    currObj.pointColl[l].y = (currObj.pointColl[l].ratioY * destHeight) +\n                        destTop;\n                }\n                this.updatePathRatio(currObj);\n                if (parent.transform.straighten !== 0) {\n                    this.straightenPath(currObj);\n                }\n            }\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                    obj: currObj } });\n            if (isNullOrUndefined(preventApply)) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.apply(currObj.shape, currObj);\n                this.refreshActiveObj();\n                this.lowerContext.filter = temp;\n                parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n            }\n            if (currObj.shape !== 'line' && currObj.shape !== 'arrow' && currObj.shape !== 'path' && currObj.rotatedAngle !== 0) {\n                this.setPointCollForShapeRotation(currObj);\n                currObj.rotationCirclePoint.x = (currObj.rotationCirclePoint.ratioX * destWidth) + destLeft;\n                currObj.rotationCirclePoint.y = (currObj.rotationCirclePoint.ratioY * destHeight) + destTop;\n                currObj.rotationCirclePointColl.x = (currObj.rotationCirclePointColl.ratioX * destWidth) + destLeft;\n                currObj.rotationCirclePointColl.y = (currObj.rotationCirclePointColl.ratioY * destHeight) + destTop;\n            }\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.straightenPath = function (obj) {\n        var point;\n        for (var j = 0, len = obj.pointColl.length; j < len; j++) {\n            point = this.straightenPoints(obj.pointColl[j].x, obj.pointColl[j].y);\n            obj.pointColl[j].x = point.x;\n            obj.pointColl[j].y = point.y;\n        }\n    };\n    Shape.prototype.straightenFHD = function () {\n        var parent = this.parent;\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            parent.points = extend([], parent.pointColl[i].points, []);\n            var len = parent.points.length;\n            var point = void 0;\n            for (var l = 0; l < len; l++) {\n                point = this.straightenPoints(parent.points[l].x, parent.points[l].y);\n                parent.points[l].x = point.x;\n                parent.points[l].y = point.y;\n            }\n        }\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            var len = selPointCollObj['selPointColl'][i].points.length;\n            var point = void 0;\n            for (var l = 0; l < len; l++) {\n                point = this.straightenPoints(selPointCollObj['selPointColl'][i].points[l].x, selPointCollObj['selPointColl'][i].points[l].y);\n                selPointCollObj['selPointColl'][i].points[l].x = point.x;\n                selPointCollObj['selPointColl'][i].points[l].y = point.y;\n            }\n        }\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var obj = { angle: 0 };\n            parent.notify('freehand-draw', { prop: 'getStraightenPointAngle', onPropertyChange: false, value: { obj: obj } });\n            var angle = (((parent.transform.straighten === 360 ? 0 : parent.transform.straighten) - obj['angle']) * (Math.PI / 180));\n            var point = this.straightenPoints(straightenObj['straightenPoint']['x'], straightenObj['straightenPoint']['y'], angle);\n            if (angle === 0) {\n                point.x = straightenObj['straightenPoint']['x'];\n                point.y = straightenObj['straightenPoint']['y'];\n            }\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false, value: { x: point.x, y: point.y } });\n        }\n    };\n    Shape.prototype.straightenPoints = function (x, y, angle) {\n        var parent = this.parent;\n        var center = { x: parent.img.destLeft + (parent.img.destWidth / 2), y: parent.img.destTop + (parent.img.destHeight / 2) };\n        angle = angle ? angle : ((parent.transform.straighten) * (Math.PI / 180));\n        var point = { x: Math.cos(angle) * (x - center.x) - Math.sin(angle) * (y - center.y) + center.x,\n            y: Math.sin(angle) * (x - center.x) + Math.cos(angle) * (y - center.y) + center.y };\n        return point;\n    };\n    Shape.prototype.straightenShapes = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool'] || parent.transform.straighten === 0) {\n            return;\n        }\n        parent.notify('draw', { prop: 'updateImgCanvasPoints' });\n        var object = { points: null };\n        parent.notify('draw', { prop: 'getImageCanvasPoints', value: { obj: object } });\n        var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n        var angle = -((parent.transform.straighten) * (Math.PI / 180));\n        var p1 = { x: Math.cos(angle) * (object['points'][0]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][0]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][0]['x'] - center.x) + Math.cos(angle) *\n                (object['points'][0]['y'] - center.y) + center.y };\n        var p2 = { x: Math.cos(angle) * (object['points'][1]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][1]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][1]['x'] - center.x) + Math.cos(angle) * (object['points'][1]['y']\n                - center.y) + center.y };\n        var p3 = { x: Math.cos(angle) * (object['points'][2]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][2]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][2]['x'] - center.x) + Math.cos(angle) * (object['points'][2]['y']\n                - center.y) + center.y };\n        parent.img.destWidth = p2.x - p1.x;\n        parent.img.destHeight = p3.y - p2.y;\n        parent.img.destLeft = p1.x;\n        parent.img.destTop = p1.y;\n    };\n    Shape.prototype.straightenShapePoints = function (obj, isReverse) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool']) {\n            return;\n        }\n        if (obj.shape === 'line' || obj.shape === 'arrow') {\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n            var angle = (isReverse ? -parent.transform.straighten : parent.transform.straighten) * (Math.PI / 180);\n            var start = { x: Math.cos(angle) * (obj.activePoint.startX - center.x) - Math.sin(angle) *\n                    (obj.activePoint.startY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.startX - center.x) + Math.cos(angle)\n                    * (obj.activePoint.startY - center.y) + center.y };\n            var end = { x: Math.cos(angle) * (obj.activePoint.endX - center.x) -\n                    Math.sin(angle) * (obj.activePoint.endY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.endX - center.x) +\n                    Math.cos(angle) * (obj.activePoint.endY - center.y) + center.y };\n            obj.activePoint.startX = start.x;\n            obj.activePoint.startY = start.y;\n            obj.activePoint.endX = end.x;\n            obj.activePoint.endY = end.y;\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            parent.notify('selection', { prop: 'adjustActObjForLineArrow', onPropertyChange: false, value: { obj: obj } });\n        }\n    };\n    Shape.prototype.redrawObj = function (degree) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n                degree === 'horizontalVertical' || degree === 'verticalHorizontal') {\n                this.updateCurrentActiveObjPoint(degree.toLowerCase());\n            }\n            else if (typeof (degree) === 'number') {\n                this.updateCurrentActiveObjPoint(degree);\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var splitWords = parent.objColl[i].shape.split('-');\n                    if (splitWords[0] !== 'crop') {\n                        this.apply(parent.objColl[i].shape, parent.objColl[i]);\n                        isShape = true;\n                    }\n                }\n                if (isShape) {\n                    parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                }\n                this.lowerContext.filter = tempFilter;\n            }\n        }\n    };\n    Shape.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var parent = this.parent;\n        var currActObjIndex;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var index = 0, len = parent.objColl.length; index < len; index++) {\n            var currObj = parent.objColl[index];\n            if (parent.activeObj.shape === currObj.shape &&\n                parent.activeObj.activePoint.startX === currObj.activePoint.startX &&\n                parent.activeObj.activePoint.startY === currObj.activePoint.startY &&\n                parent.activeObj.activePoint.endX === currObj.activePoint.endX &&\n                parent.activeObj.activePoint.endY === currObj.activePoint.endY &&\n                parent.activeObj.currIndex === currObj.currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n            degree === 'horizontalvertical' || degree === 'verticalhorizontal') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX - destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft + destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'horizontal');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = currObj.rotatedAngle + (Math.PI - currObj.rotatedAngle) * 2;\n                            if (currObj.rotationCirclePointColl.x <= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                                    (currObj.rotationCirclePointColl.x - destLeft);\n                            }\n                            else if (currObj.rotationCirclePointColl.x >= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = destLeft +\n                                    (destLeft + destWidth - currObj.rotationCirclePointColl.x);\n                            }\n                            currObj.rotationCirclePointColl.ratioX =\n                                (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) - (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY - currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop + destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY + currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' ||\n                            currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'vertical');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = -currObj.rotatedAngle;\n                            if (currObj.rotationCirclePointColl.y <= destTop + (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = (destTop + destHeight) - (currObj.rotationCirclePointColl.y - destTop);\n                            }\n                            else if (currObj.rotationCirclePointColl.y >= destTop +\n                                (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = destTop + (destTop + destHeight - currObj.rotationCirclePointColl.y);\n                            }\n                            currObj.rotationCirclePointColl.ratioY =\n                                (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'verticalhorizontal' || degree === 'horizontalvertical') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX -\n                                destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft +\n                                destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) -\n                                (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY -\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop +\n                                destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY +\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, degree);\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                parent.activeObj = extend({}, parent.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90) {\n            this.rotateObjColl();\n        }\n        else if (degree === -90) {\n            for (var i = 0; i < 3; i++) {\n                this.rotateObjColl();\n            }\n        }\n        else if (typeof (degree) === 'number') {\n            if (degree > 0) {\n                this.rotateObjColl();\n            }\n            else {\n                for (var i = 0; i < 3; i++) {\n                    this.rotateObjColl();\n                }\n            }\n        }\n    };\n    Shape.prototype.rotateObjColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            var shape = currObj.shape;\n            currObj.activePoint.startY = destTop + (destHeight * currObj.imageRatio.startX);\n            currObj.activePoint.endY = destTop + (destHeight * currObj.imageRatio.endX);\n            currObj.activePoint.startX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.endY);\n            currObj.activePoint.endX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.startY);\n            currObj = this.updateWidthHeight(parent.objColl[i]);\n            this.updateFontSize(currObj);\n            if (shape === 'line' || shape === 'arrow' || shape === 'path') {\n                this.rotateLineArrowObj(currObj);\n                if (shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n            }\n            else if (currObj.rotatedAngle !== 0) {\n                currObj.rotationCirclePointColl.y = destTop + (destHeight * currObj.rotationCirclePointColl.ratioX);\n                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                    (destWidth * currObj.rotationCirclePointColl.ratioY);\n                currObj.rotationCirclePointColl.ratioX = (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                currObj.rotationCirclePointColl.ratioY = (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n            }\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.objColl[i].activePoint, obj: parent.objColl[i] } });\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width,\n                height: destHeight / currObj.activePoint.height };\n        }\n    };\n    Shape.prototype.rotateLineArrowObj = function (obj) {\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.pointColl.length > 0) {\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].y = destTop + (destHeight * obj.pointColl[n].ratioX);\n                obj.pointColl[n].x = (destLeft + destWidth) - (destWidth *\n                    obj.pointColl[n].ratioY);\n            }\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].ratioX = (obj.pointColl[n].x - destLeft) / destWidth;\n                obj.pointColl[n].ratioY = (obj.pointColl[n].y - destTop) / destHeight;\n            }\n            var prevPoint = void 0;\n            if (isNullOrUndefined(obj.pointColl[obj.pointColl.length - 2])) {\n                prevPoint = { x: 0, y: 0 };\n            }\n            else {\n                prevPoint = { x: obj.pointColl[obj.pointColl.length - 2].x, y: obj.pointColl[obj.pointColl.length - 2].y };\n            }\n            var diffX = obj.pointColl[obj.pointColl.length - 1].x - prevPoint.x;\n            var diffY = obj.pointColl[obj.pointColl.length - 1].y - prevPoint.y;\n            obj.activePoint.startX = obj.pointColl[0].x;\n            obj.activePoint.startY = obj.pointColl[0].y;\n            obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x + (diffX / 2);\n            obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y + (diffY / 2);\n            obj = this.updateWidthHeight(obj);\n        }\n    };\n    Shape.prototype.flipLineArrowObj = function (obj, value) {\n        value = value.toLowerCase();\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        if (value === 'horizontal') {\n            this.lineArrowHorizontalFlip(obj);\n        }\n        else if (value === 'vertical') {\n            this.lineArrowVerticalFlip(obj);\n        }\n        else {\n            this.lineArrowHorizontalFlip(obj);\n            obj.shapeFlip = '';\n            this.lineArrowVerticalFlip(obj);\n        }\n        obj.activePoint.startX = obj.pointColl[0].x;\n        obj.activePoint.startY = obj.pointColl[0].y;\n        obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x;\n        obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y;\n        if (obj.activePoint.startX > obj.activePoint.endX) {\n            var temp = obj.activePoint.startX;\n            obj.activePoint.startX = obj.activePoint.endX;\n            obj.activePoint.endX = temp;\n            temp = obj.activePoint.startY;\n            obj.activePoint.startY = obj.activePoint.endY;\n            obj.activePoint.endY = temp;\n        }\n    };\n    Shape.prototype.lineArrowHorizontalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.x <= destLeft + (destWidth / 2)) {\n                    currPoint.x = (destLeft + destWidth) - (currPoint.x - destLeft);\n                }\n                else if (currPoint.x >= destLeft + (destWidth / 2)) {\n                    currPoint.x = destLeft + (destLeft + destWidth - currPoint.x);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            if (obj.shape === 'arrow') {\n                var value = obj.start;\n                obj.start = obj.end;\n                obj.end = value;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.lineArrowVerticalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.y <= destTop + (destHeight / 2)) {\n                    currPoint.y = (destTop + destHeight) - (currPoint.y - destTop);\n                }\n                else if (currPoint.y >= destTop + (destHeight / 2)) {\n                    currPoint.y = destTop + (destTop + destHeight - currPoint.y);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.getRotDegOfShape = function (obj) {\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.parent.transform.degree;\n        }\n        else {\n            degree = this.parent.transform.degree - obj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        return degree;\n    };\n    Shape.prototype.renderTextArea = function (x, y, actObj) {\n        var parent = this.parent;\n        var degree = this.getRotDegOfShape(parent.activeObj);\n        this.transformTextArea();\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var dupElem = parent.element.querySelector('#' + parent.element.id + '_duplicate');\n        var removeElem = parent.element.querySelector('#' + parent.element.id + '_remove');\n        var editTextElem = parent.element.querySelector('#' + parent.element.id + '_editText');\n        if (dupElem) {\n            dupElem.classList.add('e-disabled');\n        }\n        if (removeElem) {\n            removeElem.classList.add('e-disabled');\n        }\n        if (editTextElem) {\n            editTextElem.classList.add('e-disabled');\n        }\n        parent.textArea.style.display = 'block';\n        parent.textArea.style.left = x + 'px';\n        parent.textArea.style.top = y + 'px';\n        parent.textArea.style.fontFamily = actObj.textSettings.fontFamily;\n        parent.textArea.style.fontSize = actObj.textSettings.fontSize + 'px';\n        parent.textArea.style.color = actObj.strokeSettings.strokeColor;\n        parent.textArea.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n        parent.textArea.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n        parent.textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        parent.textArea.value = actObj.keyHistory;\n        parent.textArea.style.overflow = 'hidden';\n        parent.textArea.style.width = 'auto';\n        parent.textArea.style.height = 'auto';\n        parent.textArea.focus();\n        var zoomFactor = parent.transform.zoomFactor;\n        var _a = actObj.activePoint, width = _a.width, height = _a.height;\n        if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n            parent.textArea.style.width = (zoomFactor === 0 ? height : height) + 'px';\n            parent.textArea.style.height = (zoomFactor === 0 ? width : width) + 'px';\n        }\n        else {\n            parent.textArea.style.width = (zoomFactor === 0 ? width : width) + 'px';\n            parent.textArea.style.height = (zoomFactor === 0 ? height : height) + 'px';\n        }\n        this.setTextBoxWidth();\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (obj['flipColl'].length <= 1) {\n            this.setTextBoxHeight();\n        }\n        if (parseFloat(parent.textArea.style.maxHeight) < parent.activeObj.textSettings.fontSize) {\n            parent.textArea.style.maxHeight = parent.activeObj.textSettings.fontSize + 'px';\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destTop +\n                parent.img.destHeight) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        else {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destLeft +\n                parent.img.destWidth) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        // Limit text area\n        if (actObj.rotatedAngle !== 0) {\n            var tempLeft = parseFloat(parent.textArea.style.left);\n            var tempTop = parseFloat(parent.textArea.style.top);\n            if (actObj.flipObjColl.length > 0) {\n                var panObj = { panRegion: '' };\n                var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n                var center_1 = { x: 0, y: 0 };\n                parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                    value: { panObj: panObj } });\n                if (panObj['panRegion'] !== '') {\n                    if (panObj['panRegion'] === 'horizontal') {\n                        center_1.x = clientWidth - (clientWidth / 2);\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                    }\n                    else if (panObj['panRegion'] === 'vertical') {\n                        center_1.y = clientHeight - (clientHeight / 2);\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                    else {\n                        center_1 = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                }\n            }\n            var left = tempLeft + parseFloat(parent.textArea.style.width);\n            var top_1 = tempTop + parseFloat(parent.textArea.style.height);\n            var width1 = parseFloat(parent.textArea.style.width);\n            var height1 = parseFloat(parent.textArea.style.height);\n            var center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n            var cosAngle = Math.cos(actObj.rotatedAngle);\n            var sinAngle = Math.sin(actObj.rotatedAngle);\n            var p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n            if (p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) {\n                parent.textArea.style.width = parent.textArea.style.width;\n            }\n            else {\n                var count = 0;\n                var width2 = parseFloat(parent.textArea.style.width);\n                while (true) {\n                    count++;\n                    width1 -= 1;\n                    left = tempLeft + width1;\n                    center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n                    p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                        y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n                    if ((p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                        p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) ||\n                        count === width2) {\n                        parent.textArea.style.width = width1 + 'px';\n                        break;\n                    }\n                }\n            }\n        }\n        parent.notify('selection', { prop: 'clearUpperCanvas', onPropertyChange: false });\n    };\n    Shape.prototype.setTextBoxWidth = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.textArea.style.whiteSpace = 'nowrap';\n            parent.textArea.style.textOverflow = 'ellipsis';\n            parent.textArea.style.display = 'inline-block';\n            return;\n        }\n        else {\n            parent.textArea.style.whiteSpace = '';\n            parent.textArea.style.textOverflow = '';\n            if (parent.textArea.style.display === 'inline-block') {\n                parent.textArea.style.display = 'block';\n            }\n        }\n        var text = this.getMaxText(true);\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textAreaWidth = (this.upperContext.measureText(text).width + (parseFloat(parent.textArea.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.shapeFlip !== parent.transform.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = parent.transform.currFlipState;\n        }\n        if ((e && parseFloat(parent.textArea.style.width) < (textAreaWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(parent.textArea.style.left) - parent.img.destLeft) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                    parent.img.destLeft)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(parent.textArea.style.top) - parent.img.destTop) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destHeight - (parseFloat(parent.textArea.style.top) -\n                    parent.img.destTop)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 180) {\n                var textAreaLeft = parseFloat(parent.textArea.style.left);\n                var destLeft = parent.img.destLeft;\n                if (flip.toLowerCase() === 'horizontal') {\n                    var remainingWidth = parent.img.destWidth - (textAreaLeft - destLeft);\n                    if (remainingWidth > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToLeft = textAreaLeft - destLeft;\n                    if (distanceToLeft - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                var textAreaTop = parseFloat(parent.textArea.style.top);\n                var destTop = parent.img.destTop;\n                if (flip.toLowerCase() === 'vertical') {\n                    var remainingHeight = parent.img.destHeight - (textAreaTop - destTop);\n                    if (remainingHeight > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToTop = textAreaTop - destTop;\n                    if (distanceToTop - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.setTextBoxHeight = function () {\n        var parent = this.parent;\n        var textAreaTop;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.textFlip === parent.transform.currFlipState) {\n            flip = '';\n        }\n        else if (actObj.textFlip === '') {\n            flip = parent.transform.currFlipState;\n        }\n        else {\n            flip = actObj.textFlip;\n        }\n        switch (degree) {\n            case 0:\n                if (flip.toLowerCase() === 'vertical') {\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - (parent.img.destHeight -\n                        parseFloat(parent.textArea.style.top))) + 'px';\n                }\n                else {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                break;\n            case 90:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                        parent.img.destLeft)) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                break;\n            case 180:\n                if (flip.toLowerCase() === 'vertical') {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.top) - parent.img.destTop) + 'px';\n                }\n                break;\n            case 270:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = parent.img.destWidth - (parseFloat(parent.textArea.style.left)\n                        - parent.img.destLeft) + 'px';\n                }\n                break;\n        }\n    };\n    Shape.prototype.updatePathRatio = function (obj) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.pointColl.length; i < len; i++) {\n            var currPoint = obj.pointColl[i];\n            currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n            currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n    };\n    Shape.prototype.stopPathDrawing = function (e, isApply) {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'path') {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                parent.currObjType.isDragging = false;\n                if (e && e.type !== 'touchstart' && isNullOrUndefined(isApply)) {\n                    parent.activeObj.pointColl.pop();\n                }\n                this.updatePathRatio(parent.activeObj);\n                if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                }\n                parent.objColl.push(parent.activeObj);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                parent.objColl.pop();\n                if (e) {\n                    parent.notify('selection', { prop: 'mouseUpEventHandler', value: { e: e } });\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                }\n                parent.notify('draw', { prop: 'setNewPath', value: { bool: true } });\n                if (parent.objColl[parent.objColl.length - 1]) {\n                    parent.selectShape(parent.objColl[parent.objColl.length - 1].currIndex);\n                }\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                var obj_1 = { shapeSettingsObj: {} };\n                parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                var shapeSettings = obj_1['shapeSettingsObj'];\n                var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings };\n                var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: shapeSettings };\n                parent.notify('selection', { prop: 'triggerShapeChange', onPropertyChange: false,\n                    value: { shapeResizingArgs: shapeResizingArgs, shapeMovingArgs: shapeMovingArgs, type: 'mouse-up' } });\n            }\n        }\n    };\n    Shape.prototype.findTextTarget = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.shape !== 'text') {\n            if (parent.activeObj.shape === 'path') {\n                this.stopPathDrawing(e, null);\n                return;\n            }\n            else if (e.type === 'dblclick') {\n                var activeObj = extend({}, parent.activeObj, {}, true);\n                var objColl = extend([], parent.objColl, [], true);\n                var obj = { bool: null };\n                parent.notify('selection', { prop: 'findTargetObj', onPropertyChange: false,\n                    value: { x: e.clientX, y: e.clientY, isCrop: false, obj: obj } });\n                parent.objColl = objColl;\n                if (!obj['bool'] || parent.activeObj.shape !== 'text') {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                    return;\n                }\n            }\n            else {\n                return;\n            }\n        }\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            x = e.touches[0].clientX;\n            y = e.touches[0].clientY;\n            parent.notify('selection', { prop: 'setTouchEndPoint', onPropertyChange: false,\n                value: { x: e.touches[0].clientX, y: e.touches[0].clientY } });\n        }\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: false } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var flip = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.textFlip === '') {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            else {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else if (parent.transform.currFlipState === '') {\n                    flip = parent.activeObj.textFlip;\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            var temp = void 0;\n            if (parent.textArea.style.display === 'none') {\n                temp = extend({}, parent.activeObj, {}, true);\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        parent.objColl.splice(i, 1);\n                    }\n                }\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = temp;\n                this.updateFontStyles();\n                var actObj = extend({}, parent.activeObj, {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n                var center = { x: startX + (width / 2), y: startY +\n                        (height / 2) };\n                var cosAngle = Math.cos(actObj.rotatedAngle);\n                var sinAngle = Math.sin(actObj.rotatedAngle);\n                var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var obj = { position: null, x: x, y: y, x1: p1.x, y1: p1.y, x2: p2.x, y2: p2.y,\n                    x3: p3.x, y3: p3.y, x4: p4.x, y4: p4.y };\n                parent.notify('draw', { prop: 'checkPointPosition', onPropertyChange: false, value: { obj: obj } });\n                if ((actObj.rotatedAngle !== 0 && (obj['position'] === 'inside' || obj['position'] === 'on')) ||\n                    (actObj.rotatedAngle === 0 && x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2)))) {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (actObj.flipObjColl.length === 4) {\n                        actObj.flipObjColl = [];\n                        flip = '';\n                        actObj.shapeFlip = '';\n                    }\n                    if (flip === '' && actObj.flipObjColl.length > 1) {\n                        flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                    }\n                    if (actObj.flipObjColl.length <= 1) {\n                        var points = this.setTextBoxPos(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    else {\n                        var points = this.setTextBoxPoints(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    if (parent.activeObj.rotatedAngle !== 0) {\n                        var point = this.getTextBoxPosition(parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                        point = this.setFlipState(x, y, parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                    }\n                    this.renderTextArea(x, y, actObj);\n                }\n                else {\n                    this.applyActObj();\n                }\n            }\n        }\n        else if ((parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n            && this.selectedText() !== '' && e.type === 'mousedown') {\n            var temp = parent.textArea.value;\n            parent.textArea.value += 'a';\n            parent.textArea.value = temp;\n        }\n        else if (parent.textArea.style.display === 'none') {\n            parent.textArea.style.display = 'block';\n        }\n    };\n    Shape.prototype.getTextBoxPosition = function (obj, object) {\n        var point = { x: 0, y: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || degree === 360) {\n            point = { x: p1.x, y: p1.y };\n        }\n        else if (degree === 90 || degree === -270) {\n            point = { x: p2.x, y: p2.y };\n        }\n        else if (degree === 180 || degree === -180) {\n            point = { x: p4.x, y: p4.y };\n        }\n        else if (degree === 270 || degree === -90) {\n            point = { x: p3.x, y: p3.y };\n        }\n        if (object) {\n            object['x'] = point.x;\n            object['y'] = point.y;\n        }\n        return point;\n    };\n    Shape.prototype.setFlipState = function (x, y, obj, object) {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.lowerCanvas, clientWidth = _a.clientWidth, clientHeight = _a.clientHeight;\n        var center = { x: 0, y: 0 };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                center.x = clientWidth - (clientWidth / 2);\n                x = (center.x - x) + center.x;\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                center.y = clientHeight - (clientHeight / 2);\n                y = (center.y - y) + center.y;\n            }\n            else {\n                center = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                x = (center.x - x) + center.x;\n                y = (center.y - y) + center.y;\n            }\n        }\n        if (object) {\n            object['x'] = x;\n            object['y'] = y;\n        }\n        return { x: x, y: y };\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.fileChanged = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = e.target.files[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var fileData = filesData;\n        var fileExtension = fileData.name && fileData.name.split('.')[1].toLowerCase();\n        if (fileExtension && ['jpg', 'jpeg', 'png', 'svg'].indexOf(fileExtension) === -1) {\n            this.refreshActiveObj();\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/tslint/config, @typescript-eslint/no-explicit-any\n        var URL = window.URL;\n        var url = URL.createObjectURL(e.target.files[0]);\n        this.onLoadImgShape(null, null, null, null, url.toString(), true);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    Shape.prototype.onLoadImgShape = function (x, y, width, height, url, isSelect, degree, isAspectRatio, opacity, isSelected) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        if (typeof (url) === 'string') {\n            this.shapeImg.src = url;\n        }\n        else {\n            parent.inMemoryCanvas.width = url.width;\n            parent.inMemoryCanvas.height = url.height;\n            parent.inMemoryCanvas.getContext('2d').putImageData(url, 0, 0);\n            this.shapeImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n        this.prevObjColl();\n        parent.activeObj.shape = 'image';\n        this.initShapeProps();\n        this.shapeImg.onload = function () {\n            proxy.upperContext.drawImage(proxy.shapeImg, 0, 0, proxy.shapeImg.width, proxy.shapeImg.height);\n            proxy.updateImgCanvas(isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected);\n        };\n    };\n    Shape.prototype.updateImgCanvas = function (isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected) {\n        var parent = this.parent;\n        parent.activeObj.imageElement = this.shapeImg;\n        parent.activeObj.imageCanvas = parent.createElement('canvas');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: null } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_2 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_2 } });\n                dimObj = this.resizeImage(width, obj_2['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: parent.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: true } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_3 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_3 } });\n                dimObj = this.resizeImage(width, obj_3['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        if (opacity !== null && opacity !== undefined) {\n            parent.activeObj.opacity = opacity;\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.shapeImg = null;\n        if (degree) {\n            parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        isSelect = isSelect ? isSelect : isSelected;\n        this.drawShapeImageEvent(shapeChangingArgs, isSelect);\n        if (parent.isPublicMethod && !isSelected) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n        }\n        parent.isPublicMethod = false;\n    };\n    Shape.prototype.updateObj = function (dimObj, x, y) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.width = dimObj['width'];\n        parent.activeObj.activePoint.height = dimObj['height'];\n        parent.activeObj.activePoint.startX = x ? x : (parent.lowerCanvas.width / 2) - (dimObj['width'] / 2);\n        parent.activeObj.activePoint.startY = y ? y : (parent.lowerCanvas.height / 2) - (dimObj['height'] / 2);\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + dimObj['width'];\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + dimObj['height'];\n    };\n    Shape.prototype.resizeImage = function (newWidth, aspectRatio) {\n        var aspectRatioArray = aspectRatio.split(':');\n        var aspectRatioWidth = parseInt(aspectRatioArray[0], 10);\n        var aspectRatioHeight = parseInt(aspectRatioArray[1], 10);\n        var newHeight = Math.round((newWidth * aspectRatioHeight) / aspectRatioWidth);\n        return { width: newWidth, height: newHeight };\n    };\n    Shape.prototype.setTextBoxPos = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                break;\n            case 90:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                break;\n            case 180:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                break;\n            case 270:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 90:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 180:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                break;\n            case 270:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.selectedText = function () {\n        var parent = this.parent;\n        var start = parent.textArea.selectionStart;\n        var finish = parent.textArea.selectionEnd;\n        return parent.textArea.value.substring(start, finish);\n    };\n    Shape.prototype.panObjColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                if (panRegion === '' || panRegion === 'vertical') {\n                    currObj.activePoint.startX += xDiff;\n                    currObj.activePoint.endX += xDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x += xDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0, len_3 = currObj.pointColl.length; l < len_3; l++) {\n                            currObj.pointColl[l].x += xDiff;\n                        }\n                    }\n                }\n                else {\n                    currObj.activePoint.startX -= xDiff;\n                    currObj.activePoint.endX -= xDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x -= xDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0, len_4 = currObj.pointColl.length; l < len_4; l++) {\n                            currObj.pointColl[l].x -= xDiff;\n                        }\n                    }\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    currObj.activePoint.startY += yDiff;\n                    currObj.activePoint.endY += yDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.y += yDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0; l < currObj.pointColl.length; l++) {\n                            currObj.pointColl[l].y += yDiff;\n                        }\n                    }\n                }\n                else {\n                    currObj.activePoint.startY -= yDiff;\n                    currObj.activePoint.endY -= yDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.y -= yDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0; l < currObj.pointColl.length; l++) {\n                            currObj.pointColl[l].y -= yDiff;\n                        }\n                    }\n                }\n                currObj = this.updateWidthHeight(currObj);\n                parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                        obj: currObj } });\n                if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                    currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                    for (var j = 0, len_5 = currObj.pointColl.length; j < len_5; j++) {\n                        currObj.pointColl[j].ratioX =\n                            (currObj.pointColl[j].x - parent.img.destLeft) / parent.img.destWidth;\n                        currObj.pointColl[j].ratioY =\n                            (currObj.pointColl[j].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                }\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.apply(currObj.shape, currObj);\n                this.lowerContext.filter = temp;\n                this.refreshActiveObj();\n            }\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n        }\n    };\n    Shape.prototype.updateFontStyles = function (isTextBox) {\n        var parent = this.parent;\n        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (parent.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (parent.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(parent.textArea.style.fontSize) : parent.activeObj.textSettings.fontSize;\n        var fontFamily = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            parent.textArea.style.fontFamily : parent.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    Shape.prototype.applyFontStyle = function (item) {\n        var parent = this.parent;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        this.pushActItemIntoObj();\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl.pop();\n        if (parent.textArea.style.display === 'none') {\n            this.updateFontRatio(parent.activeObj);\n        }\n        else {\n            this.updateFontRatio(parent.activeObj, true);\n        }\n        switch (item) {\n            case 'default':\n                this.updateFontStyle(item, objColl, 'normal', 'normal');\n                break;\n            case 'bold':\n                this.updateFontStyle(item, objColl, 'bold', 'normal');\n                break;\n            case 'italic':\n                this.updateFontStyle(item, objColl, 'normal', 'italic');\n                break;\n            case 'bolditalic':\n                this.updateFontStyle(item, objColl, 'bold', 'italic');\n                break;\n        }\n        var shapeChangedArgs = { action: 'font-style', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontStyle = [item];\n        parent.trigger('shapeChange', shapeChangedArgs);\n    };\n    Shape.prototype.updateFontStyle = function (item, objColl, fontWeight, fontStyle) {\n        var parent = this.parent;\n        var style = parent.textArea.style;\n        if (style.display === 'block' || style.display === 'inline-block') {\n            if (style.fontWeight === 'normal' && fontWeight === 'bold') {\n                style.fontWeight = 'bold';\n            }\n            else if (style.fontWeight === 'bold' && fontWeight === 'bold') {\n                style.fontWeight = 'normal';\n            }\n            if (style.fontStyle === 'normal' && fontStyle === 'italic') {\n                style.fontStyle = 'italic';\n            }\n            else if (style.fontStyle === 'italic' && fontStyle === 'italic') {\n                style.fontStyle = 'normal';\n            }\n            var value = (style.fontWeight === 'normal' && style.fontStyle === 'normal' ? 'default' :\n                (style.fontWeight === 'bold' && style.fontStyle === 'normal' ? 'bold' :\n                    (style.fontWeight === 'normal' && style.fontStyle === 'italic' ? 'italic' : 'bolditalic')));\n            var width = this.getTextAreaWidth(value);\n            style.width = width + 'px';\n            this.updateObjColl(item, objColl);\n        }\n        else {\n            this.textSettings.bold = parent.activeObj.textSettings.bold = fontWeight === 'normal' ? false : true;\n            this.textSettings.italic = parent.activeObj.textSettings.italic = fontStyle === 'normal' ? false : true;\n            this.redrawText();\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n    };\n    Shape.prototype.updateArrowRatio = function (obj) {\n        var parent = this.parent;\n        var object = { arrowDimension: null };\n        parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_1 = dimensions; _i < dimensions_1.length; _i++) {\n            dimension = dimensions_1[_i];\n            var ratioX = length / object['arrowDimension'][dimension]['width'];\n            var ratioY = length / object['arrowDimension'][dimension]['height'];\n            object['arrowDimension'][dimension]['ratioX'] = ratioX;\n            object['arrowDimension'][dimension]['ratioY'] = ratioY;\n        }\n    };\n    Shape.prototype.updateArrowSize = function (obj) {\n        var object = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_2 = dimensions; _i < dimensions_2.length; _i++) {\n            dimension = dimensions_2[_i];\n            var ratioX = object['arrowDimension'][dimension]['ratioX'];\n            var ratioY = object['arrowDimension'][dimension]['ratioY'];\n            object['arrowDimension'][dimension]['width'] = length / ratioX;\n            object['arrowDimension'][dimension]['height'] = length / ratioY;\n        }\n    };\n    Shape.prototype.updateFontRatio = function (obj, isTextArea) {\n        var parent = this.parent;\n        var text = this.getMaxText(isTextArea);\n        var width = this.upperContext.measureText(text).width +\n            parent.activeObj.textSettings.fontSize * 0.5;\n        var height = (parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25);\n        var degree = this.getRotDegOfShape(obj);\n        if (isNullOrUndefined(isTextArea)) {\n            if (degree === 0 || Math.abs(degree) === 180) {\n                obj.textSettings.fontRatio = width / obj.textSettings.fontSize;\n            }\n            else {\n                obj.textSettings.fontRatio = height / obj.textSettings.fontSize;\n            }\n        }\n        else if (isTextArea) {\n            obj.textSettings.fontRatio = width / parseFloat(parent.textArea.style.fontSize);\n        }\n    };\n    Shape.prototype.updateFontSize = function (obj) {\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || Math.abs(degree) === 180) {\n            obj.textSettings.fontSize = (obj.activePoint.width / obj.textSettings.fontRatio);\n        }\n        else {\n            obj.textSettings.fontSize = (obj.activePoint.height / obj.textSettings.fontRatio);\n        }\n    };\n    Shape.prototype.updateObjColl = function (item, objColl) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = objColl;\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        parent.objColl.push(parent.activeObj);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.objColl.pop();\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n    };\n    Shape.prototype.pushActItemIntoObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            parent.objColl.push(parent.activeObj);\n        }\n        else {\n            var temp = extend({}, parent.activeObj, {}, true);\n            parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n            parent.activeObj = temp;\n        }\n    };\n    Shape.prototype.clearActObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            this.refreshActiveObj();\n            this.applyActObj();\n            this.refreshActiveObj();\n            parent.currObjType.isCustomCrop = false;\n        }\n    };\n    Shape.prototype.refreshActiveObj = function () {\n        var parent = this.parent;\n        parent.activeObj = {};\n        parent.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        parent.activeObj.triangle = [];\n        parent.activeObj.triangleRatio = [];\n        parent.activeObj.flipObjColl = [];\n        parent.activeObj.strokeSettings = this.strokeSettings;\n        parent.activeObj.textSettings = this.textSettings;\n        parent.activeObj.rotatedAngle = 0;\n        parent.activeObj.opacity = 1;\n    };\n    Shape.prototype.applyActObj = function (isMouseDown) {\n        var parent = this.parent;\n        var isActObj = false;\n        if (parent.activeObj.shape !== undefined && parent.activeObj.shape === 'text' && parent.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && parent.activeObj.shape !== 'shape') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.activeObj.currIndex = this.getNewShapeId();\n                    }\n                    this.updImgRatioForActObj();\n                    var splitWords_1 = parent.activeObj.currIndex.split('_');\n                    var tempObjColl = parent.objColl.splice(0, parseInt(splitWords_1[1], 10) - 1);\n                    tempObjColl.push(extend({}, parent.activeObj, {}, true));\n                    for (var i = 0; i < parent.objColl.length; i++) {\n                        tempObjColl.push(parent.objColl[i]);\n                    }\n                    parent.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                    parent.currObjType.shape = '';\n                    this.refreshActiveObj();\n                    if (parent.isCircleCrop) {\n                        parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                            value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    if (isNullOrUndefined(isMouseDown)) {\n                        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.getNewShapeId = function () {\n        var parent = this.parent;\n        var value = parent.objColl.length + 1;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            if (parent.objColl[i].currIndex === 'shape_' + value) {\n                value++;\n                i = -1;\n            }\n        }\n        return 'shape_' + value;\n    };\n    Shape.prototype.alignTextAreaIntoCanvas = function () {\n        var parent = this.parent;\n        var letters = parent.textArea.value;\n        parent.textArea.value = '';\n        for (var i = 0, len = letters.length; i < len; i++) {\n            parent.textArea.value += letters[i];\n            parent.textArea.style.height = 'auto';\n            parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n            this.setTextBoxWidth();\n        }\n    };\n    Shape.prototype.transformTextArea = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'text') {\n            parent.textArea.style.transformOrigin = '0 0';\n            var rotatedDegree = parent.activeObj.rotatedAngle * (180 / Math.PI);\n            var scale = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.flipObjColl.length > 0) {\n                for (var i = 0; i < parent.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    degree += rotatedDegree;\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                degree += rotatedDegree;\n                parent.textArea.style.transform = 'rotate(' + degree + 'deg)';\n            }\n        }\n    };\n    Shape.prototype.getTextAreaWidth = function (item) {\n        var parent = this.parent;\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        var isTextArea = parent.textArea.style.display === 'none' ? false : true;\n        this.updateFontStyles(isTextArea);\n        var width;\n        if (!isTextArea) {\n            width = this.upperContext.measureText(parent.activeObj.keyHistory).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        else {\n            width = this.upperContext.measureText(parent.textArea.value).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    Shape.prototype.getObjDetails = function (obj) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = parent.toPascalCase(obj.shape);\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        switch (obj.shape) {\n            case 'rectangle':\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'ellipse':\n                shapeDetails.radius = obj.activePoint.width / 2;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.radiusX = obj.activePoint.width / 2;\n                shapeDetails.radiusY = obj.activePoint.height / 2;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'line':\n            case 'arrow':\n                shapeDetails.length = obj.activePoint.width;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.endX = obj.activePoint.endX;\n                shapeDetails.endY = obj.activePoint.endY;\n                if (obj.shape === 'arrow') {\n                    var arrowObj = { type: null };\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.start, obj: arrowObj } });\n                    shapeDetails.arrowHead = arrowObj['type'];\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.end, obj: arrowObj } });\n                    shapeDetails.arrowTail = arrowObj['type'];\n                }\n                break;\n            case 'text':\n                shapeDetails.text = obj.keyHistory;\n                shapeDetails.fontSize = obj.textSettings.fontSize;\n                shapeDetails.fontFamily = obj.textSettings.fontFamily;\n                shapeDetails.color = obj.strokeSettings.strokeColor;\n                shapeDetails.fontStyle = [];\n                if (obj.textSettings.bold) {\n                    shapeDetails.fontStyle.push('bold');\n                }\n                if (obj.textSettings.italic) {\n                    shapeDetails.fontStyle.push('italic');\n                }\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'path':\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.points = obj.pointColl;\n                break;\n            case 'image':\n                shapeDetails.imageData = obj.imageCanvas.toDataURL();\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.opacity = obj.opacity;\n                break;\n        }\n        return shapeDetails;\n    };\n    Shape.prototype.getFreehandDrawDetails = function (index) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = parent.pointColl[index].id;\n        shapeDetails.type = ShapeType.FreehandDraw;\n        shapeDetails.points = extend([], parent.pointColl[index].points);\n        shapeDetails.strokeColor = parent.pointColl[index].strokeColor;\n        shapeDetails.strokeWidth = parent.pointColl[index].strokeWidth;\n        return shapeDetails;\n    };\n    Shape.prototype.getShapeSetting = function (id, obj) {\n        var parent = this.parent;\n        var shapeDetails;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn();\n            }\n            else {\n                this.applyActObj(true);\n            }\n            if (id.split('_')[0] === 'shape') {\n                var obj_4;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_4 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                shapeDetails = this.getObjDetails(obj_4);\n            }\n            else if (id.split('_')[0] === 'pen') {\n                shapeDetails = this.getFreehandDrawDetails(parseInt(id.split('_')[1], 10) - 1);\n            }\n        }\n        obj['shapeDetails'] = shapeDetails;\n    };\n    Shape.prototype.getShapeSettings = function (obj) {\n        var parent = this.parent;\n        var shapeDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn();\n            }\n            else {\n                this.applyActObj(true);\n            }\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var shapeDetails = this.getObjDetails(parent.objColl[i]);\n                shapeDetailsColl.push(shapeDetails);\n            }\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                var shapeDetails = this.getFreehandDrawDetails(i);\n                shapeDetailsColl.push(shapeDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = shapeDetailsColl;\n    };\n    Shape.prototype.isPointsInRange = function (x, y, obj) {\n        var inRange = false;\n        var parent = this.parent;\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y) && x >= parent.img.destLeft && y >= parent.img.destTop &&\n            x <= parent.img.destLeft + parent.img.destWidth && y <= parent.img.destTop + parent.img.destHeight) {\n            inRange = true;\n        }\n        obj['inRange'] = inRange;\n    };\n    Shape.prototype.alignRotateFlipColl = function (collection, isRotateFlipCollection, obj) {\n        collection = this.popForDefaultTransformedState(collection);\n        collection = this.popForDefaultFlipState(collection);\n        collection = this.popForDefaultRotateState(collection);\n        if (collection.length === 0 && isRotateFlipCollection) {\n            this.parent.transform.degree = 0;\n            this.parent.transform.currFlipState = '';\n        }\n        obj['collection'] = collection;\n        return collection;\n    };\n    Shape.prototype.popForDefaultTransformedState = function (collection) {\n        var rotateRight = 0;\n        var rotateleft = 0;\n        var horizontal = 0;\n        var vertical = 0;\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i] === 90 || collection[i] === 'rotateRight') {\n                rotateRight++;\n                rotateleft = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateRight === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === -90 || collection[i] === 'rotateLeft') {\n                rotateleft++;\n                rotateRight = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateleft === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalflip') {\n                horizontal++;\n                rotateleft = 0;\n                rotateRight = 0;\n                vertical = 0;\n                if (horizontal === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'vertical' || collection[i] === 'Vertical'\n                || collection[i] === 'verticalflip') {\n                vertical++;\n                horizontal = 0;\n                rotateleft = 0;\n                rotateRight = 0;\n                if (vertical === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultFlipState = function (collection) {\n        for (var i = 0, iLen = collection.length - 3; i < iLen; i++) {\n            var isHorizontal = collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalFlip';\n            var isVertical = collection[i] === 'vertical' || collection[i] === 'Vertical' ||\n                collection[i] === 'verticalFlip';\n            var isNextHorizontal = collection[i + 1] === 'horizontal' || collection[i + 1] === 'Horizontal' ||\n                collection[i + 1] === 'horizontalFlip';\n            var isNextVertical = collection[i + 1] === 'vertical' || collection[i + 1] === 'Vertical' ||\n                collection[i + 1] === 'verticalFlip';\n            var isNextToNextHorizontal = collection[i + 2] === 'horizontal' || collection[i + 2] === 'Horizontal' ||\n                collection[i + 2] === 'horizontalFlip';\n            var isNextToNextVertical = collection[i + 2] === 'vertical' || collection[i + 2] === 'Vertical' ||\n                collection[i + 2] === 'verticalFlip';\n            var isNextToNextToNextHorizontal = collection[i + 3] === 'horizontal' || collection[i + 3] === 'Horizontal' ||\n                collection[i + 3] === 'horizontalFlip';\n            if ((isHorizontal && isNextVertical && isNextToNextHorizontal && isNextToNextVertical) ||\n                (isVertical && isNextHorizontal && isNextToNextVertical && isNextToNextToNextHorizontal)) {\n                collection.splice(i, 4);\n                i -= 4;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultRotateState = function (collection) {\n        for (var i = 0; i < collection.length - 1; i++) {\n            var curr = collection[i];\n            var next = collection[i + 1];\n            if ((curr === 90 || curr === 'rotateRight') && (next === -90 || next === 'rotateLeft')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n            else if ((curr === -90 || curr === 'rotateLeft') && (next === 90 || next === 'rotateRight')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.selectShape = function (id, obj) {\n        var parent = this.parent;\n        var isSelected = false;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj_5;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_5 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                if (isNullOrUndefined(obj_5)) {\n                    isSelected = false;\n                }\n                else {\n                    isSelected = true;\n                    parent.activeObj = obj_5;\n                    var object = { canvasFilter: null };\n                    parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n                    this.lowerContext.filter = object['canvasFilter'];\n                    parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj } });\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'pen') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                var object = { bool: false };\n                parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: object } });\n                if (object['bool']) {\n                    parent.okBtn();\n                }\n                var obj_6 = { isIndex: false };\n                parent.notify('freehand-draw', { prop: 'isFHDIdx', value: { index: parseInt(id.split('_')[1], 10) - 1, obj: obj_6 } });\n                if (obj_6['isIndex']) {\n                    isSelected = true;\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { id: id } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n                else {\n                    isSelected = false;\n                }\n            }\n        }\n        obj['isSelected'] = isSelected;\n    };\n    Shape.prototype.deleteShape = function (id) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.activeObj.currIndex && parent.activeObj.currIndex === id) {\n                parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n            }\n            else {\n                this.applyActObj();\n                if (id.split('_')[0] === 'shape') {\n                    for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                        if (parent.objColl[i].currIndex === id) {\n                            parent.objColl.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n                else if (id.split('_')[0] === 'pen') {\n                    parent.notify('freehand-draw', { prop: 'handle-freehand-draw', value: { id: id } });\n                }\n            }\n            var object = { canvasFilter: null };\n            parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n            this.lowerContext.filter = object['canvasFilter'];\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Shape.prototype.getMaxText = function (isTextBox, text, obj) {\n        if (isNullOrUndefined(text)) {\n            text = isTextBox ? this.parent.textArea.value : this.parent.activeObj.keyHistory;\n        }\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        if (obj) {\n            obj['maxText'] = maxText;\n        }\n        return maxText;\n    };\n    Shape.prototype.getLinePoints = function (x1, y1, x2, y2) {\n        var points = [];\n        var i;\n        var j;\n        if (x1 === x2) {\n            if (y1 < y2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, true);\n            var b = this.getIntercept(i, m);\n            for (var y = i[1]; y <= j[1]; y++) {\n                var x = m * y + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        else {\n            if (x1 < x2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, false);\n            var b = this.getIntercept(i, m);\n            for (var x = i[0]; x <= j[0]; x++) {\n                var y = m * x + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        if (Math.floor(x1) === Math.floor(x2) || (points.length < 10 && (y2 - y1 > 10 || y1 - y2 > 10))) {\n            points = [];\n            var lesserY = Math.min(y1, y2);\n            for (var i_1 = 0; i_1 < Math.abs(Math.floor(y2) - Math.floor(y1)); i_1++) {\n                points.push({ x: x1, y: lesserY + i_1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        else if (Math.floor(y1) === Math.floor(y2) || (points.length < 10 && (x2 - x1 > 10 || x1 - x2 > 10))) {\n            points = [];\n            var lesserX = Math.min(x1, x2);\n            for (var i_2 = 0; i_2 < Math.abs(Math.floor(x2) - Math.floor(x1)); i_2++) {\n                points.push({ x: lesserX + i_2, y: y1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        return points;\n    };\n    Shape.prototype.getSlope = function (a, b, isSameAxis) {\n        var slope;\n        if (isSameAxis) {\n            if (a[1] === b[1]) {\n                return null;\n            }\n            slope = (b[0] - a[0]) / (b[1] - a[1]);\n        }\n        else {\n            if (a[0] === b[0]) {\n                return null;\n            }\n            slope = (b[1] - a[1]) / (b[0] - a[0]);\n        }\n        return slope;\n    };\n    Shape.prototype.getIntercept = function (point, getSlope) {\n        if (getSlope === null) {\n            return point[0];\n        }\n        return point[1] - getSlope * point[0];\n    };\n    Shape.prototype.setPointCollForShapeRotation = function (obj) {\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY +\n                (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horBottomLinePointColl = this.getLinePoints(p3.x, p3.y, p4.x, p4.y);\n        obj.verLeftLinePointColl = this.getLinePoints(p1.x, p1.y, p3.x, p3.y);\n        obj.verRightLinePointColl = this.getLinePoints(p2.x, p2.y, p4.x, p4.y);\n        obj.verLeftLinePointColl.reverse();\n        obj.verRightLinePointColl.reverse();\n        for (var i = 0; i < obj.horTopLinePointColl.length; i++) {\n            obj.horTopLinePointColl[i].ratioX = (obj.horTopLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horTopLinePointColl[i].ratioY = (obj.horTopLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.horBottomLinePointColl.length; i++) {\n            obj.horBottomLinePointColl[i].ratioX = (obj.horBottomLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horBottomLinePointColl[i].ratioY = (obj.horBottomLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verLeftLinePointColl.length; i++) {\n            obj.verLeftLinePointColl[i].ratioX = (obj.verLeftLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verLeftLinePointColl[i].ratioY = (obj.verLeftLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verRightLinePointColl.length; i++) {\n            obj.verRightLinePointColl[i].ratioX = (obj.verRightLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verRightLinePointColl[i].ratioY = (obj.verRightLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        if (parent.upperCanvas.style.cursor !== 'move') {\n            var object = { rotationCirclePoint: null };\n            parent.notify('selection', { prop: 'getTransRotationPoint', value: { obj: obj, object: object } });\n            var rotationCirclePoint = object['rotationCirclePoint'];\n            if (rotationCirclePoint) {\n                obj.rotationCirclePointColl = { x: cosAngle * (rotationCirclePoint.x - center.x) -\n                        sinAngle * (rotationCirclePoint.y - center.y) + center.x,\n                    y: sinAngle * (rotationCirclePoint.x - center.x) + cosAngle\n                        * (rotationCirclePoint.y - center.y) + center.y };\n                obj.rotationCirclePointColl.ratioX = (obj.rotationCirclePointColl.x - parent.img.destLeft) /\n                    parent.img.destWidth;\n                obj.rotationCirclePointColl.ratioY = (obj.rotationCirclePointColl.y - parent.img.destTop) /\n                    parent.img.destHeight;\n            }\n        }\n    };\n    Shape.prototype.getSquarePointForRotatedShape = function (obj, object) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        point.startX = p1.x;\n        point.startY = p1.y;\n        point.endX = p1.x;\n        point.endY = p1.y;\n        if (point.startX > p2.x) {\n            point.startX = p2.x;\n        }\n        if (point.startX > p3.x) {\n            point.startX = p3.x;\n        }\n        if (point.startX > p4.x) {\n            point.startX = p4.x;\n        }\n        if (point.startY > p2.y) {\n            point.startY = p2.y;\n        }\n        if (point.startY > p3.y) {\n            point.startY = p3.y;\n        }\n        if (point.startY > p4.y) {\n            point.startY = p4.y;\n        }\n        if (point.endX < p2.x) {\n            point.endX = p2.x;\n        }\n        if (point.endX < p3.x) {\n            point.endX = p3.x;\n        }\n        if (point.endX < p4.x) {\n            point.endX = p4.x;\n        }\n        if (point.endY < p2.y) {\n            point.endY = p2.y;\n        }\n        if (point.endY < p3.y) {\n            point.endY = p3.y;\n        }\n        if (point.endY < p4.y) {\n            point.endY = p4.y;\n        }\n        point.width = point.endX - point.startX;\n        point.height = point.endY - point.startY;\n        if (object) {\n            object['activePoint'] = point;\n        }\n        return point;\n    };\n    return Shape;\n}());\nexport { Shape };\n","import { Browser, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Direction } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Transform = /** @class */ (function () {\n    function Transform(parent) {\n        this.isReverseFlip = false; // True when rotate method is called from iteration\n        this.disablePan = false; // auto enable / disable pan while zooming\n        this.isReverseRotate = false; // True when rotate method is called from iteration\n        this.flipColl = []; // To store flip order\n        this.prevZoomValue = 1;\n        this.cropDimension = { width: 0, height: 0 };\n        this.isPreventSelect = false;\n        this.preventDownScale = false;\n        this.resizedImgAngle = null;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Transform.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Transform.prototype.addEventListener = function () {\n        this.parent.on('transform', this.transform, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Transform.prototype.removeEventListener = function () {\n        this.parent.off('transform', this.transform);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Transform.prototype.transform = function (args) {\n        this.initTransformPvtVar();\n        switch (args.prop) {\n            case 'rotateImage':\n                this.rotateImage(args.value['degree']);\n                break;\n            case 'flipImage':\n                this.flipImage(args.value['direction']);\n                break;\n            case 'setDestPointsForFlipState':\n                this.setDestPointsForFlipState();\n                break;\n            case 'zoomAction':\n                this.zoomAction(args.value['zoomFactor'], args.value['zoomPoint'], args.value['isResize']);\n                break;\n            case 'disableZoomOutBtn':\n                this.disableZoomOutBtn(args.value['isZoomOut']);\n                break;\n            case 'rotatedFlip':\n                this.rotatedFlip();\n                break;\n            case 'drawPannedImage':\n                this.drawPannedImage(args.value['xDiff'], args.value['yDiff']);\n                break;\n            case 'drawPannImage':\n                this.drawPannImage(args.value['point']);\n                break;\n            case 'performTransformation':\n                this.performTransformation(args.value['text']);\n                break;\n            case 'updateTransform':\n                this.updateTransform(args.value['text']);\n                break;\n            case 'rotatePan':\n                this.rotatePan(args.value['isCropSelection'], args.value['isDefaultZoom']);\n                break;\n            case 'drawRotatedImage':\n                this.drawRotatedImage(args.value['degree']);\n                break;\n            case 'limitPan':\n                this.limitPan();\n                break;\n            case 'updateFlipActiveObj':\n                this.updateFlipActiveObj(args.value['panRegion']);\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'pan':\n                this.pan(args.value['value'], args.value['x'], args.value['y']);\n                break;\n            case 'zoom':\n                this.zoom(args.value['zoomFactor'], args.value['zoomPoint']);\n                break;\n            case 'setCurrPanRegion':\n                this.setCurrPanRegion(args.value['region'], args.value['type'], args.value['obj']);\n                break;\n            case 'rotate':\n                this.rotate(args.value['degree'], args.value['obj']);\n                break;\n            case 'flip':\n                this.flip(args.value['direction']);\n                break;\n            case 'update':\n                this.update();\n                break;\n            case 'calcMaxDimension':\n                this.calcMaxDimension(args.value['width'], args.value['height'], args.value['obj'], args.value['isImgShape']);\n                break;\n            case 'getPanMove':\n                args.value['obj']['panMove'] = this.panMove;\n                break;\n            case 'setPanMove':\n                this.panMove = args.value['point'];\n                break;\n            case 'getTempPanMove':\n                args.value['obj']['tempPanMove'] = this.tempPanMove;\n                break;\n            case 'setTempPanMove':\n                this.tempPanMove = args.value['point'];\n                break;\n            case 'setReverseFlip':\n                this.isReverseFlip = args.value['isReverseFlip'];\n                break;\n            case 'setDisablePan':\n                this.disablePan = args.value['bool'];\n                break;\n            case 'setCurrDestinationPoint':\n                this.currDestPoint = args.value['point'];\n                this.currDestPoint.startX -= this.parent.cropObj.totalPannedPoint.x;\n                this.currDestPoint.startY -= this.parent.cropObj.totalPannedPoint.y;\n                break;\n            case 'setReverseRotate':\n                this.isReverseRotate = args.value['bool'];\n                break;\n            case 'getFlipColl':\n                args.value['obj']['flipColl'] = this.flipColl;\n                break;\n            case 'setFlipColl':\n                this.flipColl = args.value['flipColl'];\n                break;\n            case 'getPreviousZoomValue':\n                args.value['obj']['previousZoomValue'] = this.prevZoomValue;\n                break;\n            case 'setPreviousZoomValue':\n                this.prevZoomValue = args.value['previousZoomValue'];\n                break;\n            case 'getCropDimension':\n                args.value['obj']['cropDimension'] = this.cropDimension;\n                break;\n            case 'setCropDimension':\n                this.cropDimension.width = args.value['width'];\n                this.cropDimension.height = args.value['height'];\n                break;\n            case 'getPreventSelect':\n                args.value['obj']['bool'] = this.isPreventSelect;\n                break;\n            case 'setPreventSelect':\n                this.isPreventSelect = args.value['bool'];\n                break;\n            case 'resizeImage':\n                this.resizeImage(args.value['width'], args.value['height']);\n                break;\n            case 'resizeCrop':\n                this.resizeCrop(args.value['width'], args.value['height']);\n                break;\n            case 'setPreventDownScale':\n                this.preventDownScale = args.value['bool'];\n                break;\n            case 'updateResize':\n                this.updateResize();\n                break;\n            case 'resize':\n                this.resize(args.value['width'], args.value['height'], args.value['isAspectRatio']);\n                break;\n            case 'straightenImage':\n                this.straightenImage(args.value['degree']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'cropZoom':\n                args.value['obj']['maxDimension'] = this.cropZoom(args.value['value'], args.value['selectionObj']);\n                break;\n            case 'setResizedImgAngle':\n                this.resizedImgAngle = args.value['angle'];\n                break;\n        }\n    };\n    Transform.prototype.getModuleName = function () {\n        return 'transform';\n    };\n    Transform.prototype.initTransformPvtVar = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    Transform.prototype.reset = function () {\n        this.zoomBtnHold = null;\n        this.tempPanMove = null;\n        this.panMove = null;\n        this.disablePan = false;\n        this.currDestPoint = null;\n        this.isReverseRotate = false;\n        this.flipColl = [];\n        this.resizedImgAngle = null;\n        this.transCurrObj = null;\n        this.prevZoomValue = 1;\n        this.isPreventSelect = this.preventDownScale = false;\n    };\n    Transform.prototype.rotateImage = function (degree) {\n        var parent = this.parent;\n        var transitionArgs = { cancel: false, previousDegree: parent.transform.degree,\n            currentDegree: Math.abs(parent.transform.degree + degree) === 360 ? 0 : parent.transform.degree + degree };\n        if (!this.isPreventSelect) {\n            parent.trigger('rotating', transitionArgs);\n        }\n        this.rotateEvent(transitionArgs, degree);\n    };\n    Transform.prototype.rotateEvent = function (transitionArgs, degree) {\n        var parent = this.parent;\n        if (!transitionArgs.cancel) {\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transCurrObj)) {\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, null, true);\n                prevObj.pointColl = extend({}, parent.pointColl, null, true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            }\n            parent.afterCropActions.push(degree === 90 ? 'rotateRight' : 'rotateLeft');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (parent.activeObj.activePoint && parent.activeObj.shape) {\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.drawRotatedImage(degree);\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            if (activeObjShape) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n            parent.isUndoRedo = false;\n            var obj = { collection: parent.rotateFlipColl };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n            parent.rotateFlipColl = obj['collection'];\n            if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n                parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n                this.isPreventSelect = true;\n                parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                    value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                this.isPreventSelect = false;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                this.prevZoomValue = parent.zoomSettings.zoomFactor;\n            }\n        }\n        else {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n    };\n    Transform.prototype.drawRotatedImage = function (degree) {\n        var parent = this.parent;\n        if (degree === 0) {\n            parent.transform.degree = 0;\n        }\n        else {\n            parent.transform.degree += degree;\n        }\n        if (Math.abs(parent.transform.degree) === 360) {\n            parent.transform.degree = 0;\n        }\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        this.rotateDegree(degree);\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.rotateFlipColl.push(degree);\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (degree > 0) {\n            parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n        }\n        else {\n            for (var i = 0; i < 3; i++) {\n                parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.updateCurrSelectionPoint(degree);\n    };\n    Transform.prototype.rotateDegree = function (degree) {\n        var parent = this.parent;\n        this.lowerContext.save();\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * -degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        this.lowerContext.restore();\n    };\n    Transform.prototype.updateCurrSelectionPoint = function (degree) {\n        var parent = this.parent;\n        if (parent.currSelectionPoint && this.currDestPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            var objColl = extend([], parent.objColl, [], true);\n            var srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                height: parent.img.srcHeight };\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = [];\n            parent.objColl.push(extend({}, parent.currSelectionPoint, {}, true));\n            if (isNullOrUndefined(parent.objColl[0].imageRatio)) {\n                parent.activeObj = parent.objColl[0];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl[0] = parent.activeObj;\n            }\n            parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n                destLeft: this.currDestPoint.startX, destTop: this.currDestPoint.startY, destWidth: this.currDestPoint.width,\n                destHeight: this.currDestPoint.height };\n            if (typeof (degree) === 'number') {\n                parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n            parent.currSelectionPoint = extend({}, parent.objColl[0], {}, true);\n            this.currDestPoint = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = objColl;\n            parent.activeObj = activeObj;\n            parent.img = { srcLeft: srcPoints.startX, srcTop: srcPoints.startY, srcWidth: srcPoints.width, srcHeight: srcPoints.height,\n                destLeft: destPoints.startX, destTop: destPoints.startY, destWidth: destPoints.width, destHeight: destPoints.height };\n        }\n    };\n    Transform.prototype.flipImage = function (direction) {\n        var parent = this.parent;\n        var transitionArgs = { direction: direction, cancel: false,\n            previousDirection: parent.toPascalCase(parent.transform.currFlipState || direction) };\n        if (!this.isPreventSelect) {\n            parent.trigger('flipping', transitionArgs);\n        }\n        this.flipEvent(transitionArgs, direction);\n    };\n    Transform.prototype.flipEvent = function (transitionArgs, direction) {\n        var parent = this.parent;\n        if (transitionArgs.cancel) {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            return;\n        }\n        var prevObj;\n        if (isNullOrUndefined(this.transCurrObj)) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, null, true);\n            prevObj.pointColl = extend({}, parent.pointColl, null, true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        }\n        parent.afterCropActions.push(direction.toLowerCase() === 'horizontal' ? 'horizontalflip' : 'verticalflip');\n        var splitWords = [];\n        var activeObjShape;\n        if (parent.activeObj.activePoint) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        var lowercaseDirection = direction.toLowerCase();\n        this.updateFlipState(lowercaseDirection);\n        var flipState = parent.transform.currFlipState.toLowerCase();\n        parent.transform.currFlipState = (lowercaseDirection === 'horizontal' && flipState === 'horizontal') ||\n            (lowercaseDirection === 'vertical' && flipState === 'vertical') ? '' : lowercaseDirection;\n        var selObj = { isSelected: null };\n        parent.notify('draw', { prop: 'getRotatedFlipCropSelection', onPropertyChange: false, value: { bool: selObj } });\n        if (selObj['isSelected']) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        this.updateFlipState(direction.toLowerCase());\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            this.updateFlipColl(direction.toLocaleLowerCase());\n            parent.rotateFlipColl.push(direction.toLowerCase());\n        }\n        if (parent.rotateFlipColl.length === 1) {\n            var panObj = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj } });\n            if (panObj['panRegion'] === '') {\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            else {\n                this.setDestPointsForFlipState();\n            }\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var flipObjColl = parent.objColl[i].flipObjColl;\n            if (flipObjColl.length === 0) {\n                flipObjColl.push(direction);\n            }\n            else if (flipObjColl[flipObjColl.length - 1] === direction) {\n                flipObjColl.pop();\n            }\n            else {\n                flipObjColl.push(direction);\n            }\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: direction.toLowerCase() } });\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        var dir = direction.toLowerCase();\n        if (dir === 'horizontal' || dir === 'vertical') {\n            parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n                value: { value: dir } });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        else {\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        this.lowerContext.filter = tempFilter;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.updateCurrSelectionPoint(dir);\n        parent.isUndoRedo = false;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (activeObjShape) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n        var obj = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n        parent.rotateFlipColl = obj['collection'];\n        if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n            parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n            this.isPreventSelect = true;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n            this.isPreventSelect = false;\n            parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n            this.prevZoomValue = parent.zoomSettings.zoomFactor;\n        }\n    };\n    Transform.prototype.updateFlipState = function (direction) {\n        var degree = this.parent.transform.degree;\n        if (direction === 'horizontal') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.verticalFlip();\n            }\n            else {\n                this.horizontalFlip();\n            }\n        }\n        else if (direction === 'vertical') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.horizontalFlip();\n            }\n            else {\n                this.verticalFlip();\n            }\n        }\n    };\n    Transform.prototype.horizontalFlip = function () {\n        this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n        this.lowerContext.scale(-1, 1);\n        this.upperContext.translate(this.upperContext.canvas.width, 0);\n        this.upperContext.scale(-1, 1);\n    };\n    Transform.prototype.verticalFlip = function () {\n        this.lowerContext.translate(0, this.lowerContext.canvas.height);\n        this.lowerContext.scale(1, -1);\n        this.upperContext.translate(0, this.upperContext.canvas.height);\n        this.upperContext.scale(1, -1);\n    };\n    Transform.prototype.updateFlipColl = function (direction) {\n        if (this.isPreventSelect) {\n            return;\n        }\n        if (this.flipColl.length === 0 || this.flipColl[this.flipColl.length - 1] !== direction) {\n            this.flipColl.push(direction);\n        }\n        else {\n            this.flipColl.pop();\n        }\n        if (this.flipColl.length >= 4) {\n            var lastFourItems = this.flipColl.slice(-4);\n            if ((lastFourItems[0] === 'horizontal' && lastFourItems[1] === 'vertical' &&\n                lastFourItems[2] === 'horizontal' && lastFourItems[3] === 'vertical') ||\n                (lastFourItems[0] === 'vertical' && lastFourItems[1] === 'horizontal' &&\n                    lastFourItems[2] === 'vertical' && lastFourItems[3] === 'horizontal')) {\n                this.flipColl.splice(-4);\n            }\n        }\n    };\n    Transform.prototype.setDestPointsForFlipState = function () {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n            else {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n        }\n    };\n    Transform.prototype.zoomAction = function (zoomFactor, zoomPoint, isResize, isPreventApply) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (isNullOrUndefined(isResize) && (parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor && zoomFactor > 0 ||\n                (parent.zoomSettings.zoomFactor > parent.zoomSettings.minZoomFactor && zoomFactor < 0 && this.disableZoomOutBtn(true)) ||\n                (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor && zoomFactor < 0))) {\n                parent.notify('toolbar', { prop: 'zoom-up-handler', onPropertyChange: false });\n                return;\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            var tempZoomFactor = zoomFactor;\n            zoomFactor = tempZoomFactor > 0 ? 0.1 : -0.1;\n            for (var i = 0; i < Math.round(Math.abs(tempZoomFactor / 0.1)); i++) {\n                if (this.prevZoomValue === 1) {\n                    this.prevZoomValue += zoomFactor > 0 ? zoomFactor * 10 : (zoomFactor * 10) / 10;\n                }\n                else if (this.prevZoomValue > 1) {\n                    this.prevZoomValue += (zoomFactor * 10);\n                }\n                else if (this.prevZoomValue < 1) {\n                    this.prevZoomValue += (zoomFactor * 10) / 10;\n                    var powerOften = Math.pow(10, 1);\n                    this.prevZoomValue = (Math.round(this.prevZoomValue * powerOften) / powerOften);\n                }\n            }\n            zoomFactor = tempZoomFactor;\n            parent.setProperties({ zoomSettings: { zoomFactor: this.prevZoomValue } }, true);\n            var splitWords = void 0;\n            this.tempActiveObj = null;\n            this.isShape = false;\n            if (parent.activeObj.shape !== undefined) {\n                if (parent.activeObj.shape === 'shape') {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n                else {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n                parent.isCropTab = true;\n            }\n            else if (parent.activeObj.shape && splitWords[0] !== 'crop') {\n                this.isShape = true;\n            }\n            var obj = { zoomType: null };\n            parent.notify('selection', { prop: 'getZoomType', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(zoomPoint)) {\n                if (parent.isCropTab && this.tempActiveObj) {\n                    zoomPoint = { x: parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2),\n                        y: parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2) };\n                }\n                else {\n                    zoomPoint = { x: parent.lowerCanvas.clientWidth / 2, y: parent.lowerCanvas.clientHeight / 2 };\n                }\n                if (obj['zoomType'] === 'MouseWheel' || obj['zoomType'] === 'Pinch') {\n                    zoomPoint = { x: parent.zoomSettings.zoomPoint.x, y: parent.zoomSettings.zoomPoint.y };\n                }\n            }\n            var previousZoomFactor = parent.zoomSettings.zoomFactor - (zoomFactor * 10);\n            var zoomEventArgs = { zoomPoint: zoomPoint, cancel: false, previousZoomFactor: previousZoomFactor,\n                currentZoomFactor: parent.zoomSettings.zoomFactor, zoomTrigger: obj['zoomType'] };\n            if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n                parent.trigger('zooming', zoomEventArgs);\n            }\n            this.zoomEvent(zoomEventArgs, zoomFactor, isPreventApply);\n        }\n    };\n    Transform.prototype.zoomEvent = function (zoomEventArgs, zoomFact, isPreventApply) {\n        var parent = this.parent;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        if (zoomEventArgs.cancel) {\n            parent.isZoomBtnClick = false;\n            return;\n        }\n        parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var object = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = object['canvasFilter'];\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var objColl = extend([], parent.objColl, [], true);\n        if (!parent.isCropTab) {\n            if (parent.transform.degree !== 0) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false, value: { x: null, y: null, isMouseDown: null } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                var temp = parent.allowDownScale;\n                parent.allowDownScale = false;\n                this.rotatePan(true, true);\n                parent.allowDownScale = temp;\n            }\n            else if (parent.transform.currFlipState !== '') {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n        }\n        if (parent.transform.degree === 0) {\n            this.drawZoomImgToCanvas(zoomFact, this.tempActiveObj);\n            var panObj_1 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_1 } });\n            if (panObj_1['panRegion'] !== '') {\n                parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: parent.panPoint.totalPannedPoint, isAdd: true } });\n                objColl = extend([], parent.objColl, [], true);\n                parent.objColl = [];\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                this.setDestPointsForFlipState();\n                this.rotatedFlip();\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.objColl = objColl;\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                }\n            }\n            if (zoomFactor <= minZoomFactor && !parent.isCropTab) {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n        }\n        else {\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n            parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n            parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.rotateZoom(zoomFact);\n            var panObj_2 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_2 } });\n            if (panObj_2['panRegion'] !== '') {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                this.lowerContext.filter = temp;\n            }\n        }\n        var powerOften = Math.pow(10, 1);\n        if (zoomFactor <= minZoomFactor ||\n            (Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 2) {\n            clearInterval(this.zoomBtnHold);\n            this.zoomBtnHold = 0;\n        }\n        var panObj = { panRegion: '' };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj } });\n        if (panObj['panRegion'] === '') {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            this.lowerContext.filter = temp;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            if (zoomFactor <= minZoomFactor) {\n                parent.currSelectionPoint = null;\n            }\n        }\n        parent.isUndoRedo = false;\n        var zoomOut;\n        zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n        if (zoomOut && zoomFactor <= minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        this.autoEnablePan();\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n        }\n        if (parent.activeObj.shape === 'crop-custom') {\n            parent.currObjType.isCustomCrop = true;\n        }\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn && parent.togglePan) {\n            panBtn.classList.add('e-selected-btn');\n        }\n        else if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        if (this.isShape) {\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        parent.notify('selection', { prop: 'setZoomType', onPropertyChange: false, value: { zoomType: 'Toolbar' } });\n        zoomEventArgs = { zoomPoint: zoomEventArgs.zoomPoint, previousZoomFactor: zoomEventArgs.previousZoomFactor, currentZoomFactor: zoomEventArgs.currentZoomFactor, zoomTrigger: zoomEventArgs.zoomTrigger };\n        if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n            parent.isZoomBtnClick = false;\n        }\n    };\n    Transform.prototype.disableZoomOutBtn = function (isZoomOut) {\n        var parent = this.parent;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        var isDisabled = false;\n        var zoomOut;\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor -= 0.1;\n        }\n        zoomOut = parent.element.querySelector('#' + parent.element.id + '_zoomOut');\n        var destPoints = { destLeft: parent.img.destLeft, destTop: parent.img.destTop,\n            destWidth: parent.img.destWidth, destHeight: parent.img.destHeight };\n        if (parent.activeObj.shape) {\n            var maxDimension = this.setZoomDimension(-0.1, parent.activeObj);\n            if (!isNullOrUndefined(zoomOut)) {\n                var actPoint = parent.activeObj.activePoint;\n                if (parent.transform.straighten === 0) {\n                    if (parent.img.destLeft > actPoint.startX || parent.img.destTop >\n                        actPoint.startY || parent.img.destLeft + parent.img.destWidth <\n                        actPoint.endX || parent.img.destTop + parent.img.destHeight < actPoint.endY\n                        || zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n                else {\n                    parent.img.destWidth = maxDimension.width;\n                    parent.img.destHeight = maxDimension.height;\n                    var obj = { isIntersect: null };\n                    parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n                    if (obj['isIntersect'] ||\n                        zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n            }\n        }\n        else {\n            this.setZoomDimension(-0.1, null);\n        }\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor += 0.1;\n        }\n        parent.img.destLeft = destPoints['destLeft'];\n        parent.img.destTop = destPoints['destTop'];\n        parent.img.destWidth = destPoints['destWidth'];\n        parent.img.destHeight = destPoints['destHeight'];\n        return isDisabled;\n    };\n    Transform.prototype.drawZoomImgToCanvas = function (value, selectionObj) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        parent.transform[parent.isCropTab ? 'cropZoomFactor' : 'defaultZoomFactor'] = parent.transform.zoomFactor;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.isCropTab) {\n            maxDimension = this.cropZoom(value, selectionObj);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        }\n        parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n        maxDimension.width = this.cropDimension.width;\n        maxDimension.height = this.cropDimension.height;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.rotatedFlip = function () {\n        var parent = this.parent;\n        this.isReverseFlip = true;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var tempFlipColl = this.flipColl;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        this.flipColl = [];\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, context: null, isPreventCircleCrop: null } });\n        if (tempCurrFlipState === '' && parent.transform.currFlipState !== '') {\n            tempCurrFlipState = parent.transform.currFlipState;\n        }\n        parent.transform.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        parent.objColl = extend([], tempObjColl, [], true);\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        if (tempActiveObj.activePoint.width !== 0) {\n            parent.activeObj = extend({}, tempActiveObj, {}, true);\n        }\n        this.isReverseFlip = false;\n    };\n    Transform.prototype.rotateZoom = function (value) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        if (parent.isCropTab) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n        }\n        else {\n            parent.transform.defaultZoomFactor = parent.transform.zoomFactor;\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.objColl = tempObjColl;\n        parent.activeObj = tempActiveObj;\n        var maxDimension = { width: this.cropDimension.width, height: this.cropDimension.height };\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.autoEnablePan = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor <= 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n            parent.pan(false);\n            this.disablePan = false;\n        }\n        else {\n            parent.pan(!this.disablePan);\n        }\n    };\n    Transform.prototype.cropZoom = function (value, selectionObj) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.img.srcLeft === 0 || parent.img.srcTop === 0) {\n            if (isNullOrUndefined(selectionObj)) {\n                maxDimension = this.setZoomDimension(value, null);\n            }\n            else {\n                maxDimension = this.setZoomDimension(value, selectionObj);\n            }\n        }\n        else {\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n            }\n            else {\n                maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            }\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        }\n        parent.img.destLeft = destLeft - ((maxDimension.width - parent.img.destWidth) / 2);\n        parent.img.destTop = destTop - ((maxDimension.height - parent.img.destHeight) / 2);\n        destLeft = parent.img.destLeft;\n        destTop = parent.img.destTop;\n        if (selectionObj && parent.transform.straighten === 0) {\n            if (parent.img.destLeft > selectionObj.activePoint.startX) {\n                parent.img.destLeft = selectionObj.activePoint.startX;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop > selectionObj.activePoint.startY) {\n                parent.img.destTop = selectionObj.activePoint.startY;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n            if (parent.img.destLeft + maxDimension.width < selectionObj.activePoint.endX) {\n                parent.img.destLeft = selectionObj.activePoint.endX - maxDimension.width;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop + maxDimension.height < selectionObj.activePoint.endY) {\n                parent.img.destTop = selectionObj.activePoint.endY - maxDimension.height;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.setZoomDimension = function (value, selectionObj) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var maxDimension = { width: 0, height: 0 };\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft += ((parent.img.destWidth - maxDimension.width) / 2);\n        parent.img.destTop += ((parent.img.destHeight - maxDimension.height) / 2);\n        // While zoom out limit image to draw inside the selection range\n        if (value < 0 && selectionObj) {\n            var startX = selectionObj.activePoint.startX;\n            var startY = selectionObj.activePoint.startY;\n            var width = selectionObj.activePoint.width;\n            var height = selectionObj.activePoint.height;\n            var maxDestLeft = parent.img.destLeft + maxDimension.width;\n            var maxDestTop = parent.img.destTop + maxDimension.height;\n            if (parent.img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (parent.img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (maxDestLeft < startX + width) {\n                parent.img.destLeft = startX + width - maxDimension.width;\n            }\n            if (maxDestTop < startY + height) {\n                parent.img.destTop = startY + height - maxDimension.height;\n            }\n        }\n        else if (value < 0 && isNullOrUndefined(selectionObj)) {\n            if (parent.img.destLeft > 0) {\n                parent.img.destLeft = 0;\n            }\n            if (parent.img.destTop > 0) {\n                parent.img.destTop = 0;\n            }\n            if (parent.img.destLeft + maxDimension.width < parent.lowerCanvas.clientWidth) {\n                parent.img.destLeft = parent.lowerCanvas.clientWidth - parent.img.destWidth;\n            }\n            if (parent.img.destTop + maxDimension.height < parent.lowerCanvas.clientHeight) {\n                parent.img.destTop = parent.lowerCanvas.clientHeight - parent.img.destHeight;\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.drawPannedImage = function (xDiff, yDiff) {\n        var parent = this.parent;\n        var obj = { panDown: null };\n        parent.notify('selection', { prop: 'getPanDown', onPropertyChange: false, value: { obj: obj } });\n        var panEventArgs = { startPoint: obj['panDown'], endPoint: this.panMove, cancel: false };\n        parent.trigger('panning', panEventArgs);\n        if (panEventArgs.cancel) {\n            return;\n        }\n        this.panEvent(xDiff, yDiff);\n    };\n    Transform.prototype.panEvent = function (xDiff, yDiff, isPanMethod) {\n        var parent = this.parent;\n        var isObjCreated = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'shape') {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (isNullOrUndefined(parent.activeObj.shape)) {\n            isObjCreated = true;\n            var actPoint = parent.activeObj.activePoint = { startX: parent.img.destLeft, startY: parent.img.destTop,\n                endX: parent.img.destLeft + parent.img.destWidth, endY: parent.img.destTop + parent.img.destHeight };\n            var startX = actPoint.startX;\n            var startY = actPoint.startY;\n            var endX = actPoint.endX;\n            var endY = actPoint.endY;\n            if (startX < 0) {\n                actPoint.startX = 0;\n            }\n            if (startY < 0) {\n                actPoint.startY = 0;\n            }\n            if (endX > parent.lowerCanvas.width) {\n                actPoint.endX = parent.lowerCanvas.width;\n            }\n            if (endY > parent.lowerCanvas.height) {\n                actPoint.endY = parent.lowerCanvas.height;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            parent.activeObj.shape = 'crop-custom';\n            var obj = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj } });\n            parent.activeObj.strokeSettings = obj['strokeSettings'];\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: actPoint, obj: parent.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            parent.isCropTab = true;\n        }\n        if (parent.transform.degree === 0) {\n            var point = void 0;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    point = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    point = this.updatePanPoints();\n                }\n            }\n            else {\n                point = { x: xDiff, y: yDiff };\n            }\n            parent.panPoint.totalPannedPoint.x += point.x;\n            parent.panPoint.totalPannedPoint.y += point.y;\n            var tempSelectionObj = extend({}, parent.activeObj, {}, true);\n            var temp = this.lowerContext.filter;\n            this.drawPannImage(point, isObjCreated);\n            this.lowerContext.filter = temp;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            parent.activeObj = extend({}, tempSelectionObj, {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n        else {\n            var tempFlipState = parent.transform.currFlipState;\n            parent.isCropTab = true;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints();\n                }\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: xDiff, y: yDiff };\n            }\n            parent.transform.currFlipState = tempFlipState;\n            this.rotatePan(null, null, isObjCreated);\n            parent.isCropTab = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n        }\n        if (isObjCreated) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.isCropTab = false;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n    };\n    Transform.prototype.drawPannImage = function (point, isObjCreated) {\n        var parent = this.parent;\n        var filter = this.lowerContext.filter;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        this.setDestPointsForFlipState();\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n            value: { xDiff: point.x, yDiff: point.y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n            value: { xDiff: point.x, yDiff: point.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n    };\n    Transform.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.defaultZoomFactor !== 0) {\n            var isUndoRedo = parent.isUndoRedo;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            this.transCurrObj = object['currObj'];\n            this.transCurrObj.objColl = extend([], parent.objColl, null, true);\n            this.transCurrObj.pointColl = extend({}, parent.pointColl, null, true);\n            this.transCurrObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.transCurrObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.isUndoRedo = parent.isCropToolbar = true;\n            var zmFactor = parent.transform.defaultZoomFactor;\n            if (zmFactor > 0) {\n                this.zoomAction(-zmFactor);\n            }\n            else {\n                this.zoomAction(Math.abs(zmFactor));\n            }\n            parent.isCropToolbar = false;\n            parent.isUndoRedo = isUndoRedo;\n        }\n    };\n    Transform.prototype.performTransformation = function (text) {\n        var parent = this.parent;\n        var tempZoomFactor = parent.transform.defaultZoomFactor;\n        var isUndoRedo = parent.isUndoRedo;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        this.resetZoom();\n        this.updateTransform(text);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].flipObjColl.length > 0) {\n                var flipObjColl = { collection: parent.objColl[i].flipObjColl };\n                parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: flipObjColl['collection'], isRotateFlipCollection: null, obj: flipObjColl } });\n                parent.objColl[i].flipObjColl = flipObjColl['collection'];\n                if (parent.objColl[i].flipObjColl.length === 0) {\n                    parent.objColl[i].shapeFlip = '';\n                }\n            }\n        }\n        if (tempZoomFactor !== 0) {\n            parent.isUndoRedo = true;\n            this.zoomAction(tempZoomFactor);\n            parent.isUndoRedo = isUndoRedo;\n            var state = '';\n            if (text === 'rotateleft' || text === 'rotateright') {\n                state = 'rotate';\n            }\n            else if (text === 'horizontalflip' || text === 'verticalflip') {\n                state = 'flip';\n            }\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: state, previousObj: this.transCurrObj, previousObjColl: this.transCurrObj.objColl,\n                    previousPointColl: this.transCurrObj.pointColl, previousSelPointColl: this.transCurrObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.transCurrObj = null;\n        }\n    };\n    Transform.prototype.updateTransform = function (text) {\n        switch (text.toLowerCase()) {\n            case 'rotateleft':\n                this.rotateImage(-90);\n                break;\n            case 'rotateright':\n                this.rotateImage(90);\n                break;\n            case 'horizontalflip':\n                this.flipImage(Direction.Horizontal);\n                break;\n            case 'verticalflip':\n                this.flipImage(Direction.Vertical);\n                break;\n        }\n    };\n    Transform.prototype.rotatePan = function (isCropSelection, isDefaultZoom, isObjCreated) {\n        var parent = this.parent;\n        this.isReverseRotate = true;\n        var tempDegree = parent.transform.degree;\n        var rotatePanActiveObj;\n        var object = { selPointColl: null };\n        if (parent.activeObj.activePoint && parent.activeObj.shape) {\n            rotatePanActiveObj = extend({}, parent.activeObj, {}, true);\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n        var cropSelPointColl = object['selPointColl'];\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        var initialDestLeft = parent.img.destLeft;\n        var initialDestTop = parent.img.destTop;\n        var intPan = parent.panPoint.totalPannedInternalPoint;\n        if (parent.isCropTab) {\n            parent.img.destLeft += intPan.x;\n            parent.img.destTop += intPan.y;\n        }\n        parent.notify('crop', { prop: 'updateRotatePan', onPropertyChange: false });\n        if (parent.isCropTab) {\n            parent.panPoint.totalPannedInternalPoint.x = parent.img.destLeft - initialDestLeft;\n            parent.panPoint.totalPannedInternalPoint.y = parent.img.destTop - initialDestTop;\n        }\n        var temp = this.lowerContext.filter;\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, isRotatePan: true } });\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n        parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n        parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n        parent.panPoint.totalPannedClientPoint.x = parent.img.destLeft - destLeft;\n        parent.panPoint.totalPannedClientPoint.y = parent.img.destTop - destTop;\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: cropSelPointColl } } });\n        parent.transform.degree = tempDegree;\n        this.lowerContext.filter = 'none';\n        if (isCropSelection) {\n            if (isDefaultZoom) {\n                parent.panPoint.totalPannedClientPoint.x = -parent.panPoint.totalPannedClientPoint.x;\n                parent.panPoint.totalPannedClientPoint.y = -parent.panPoint.totalPannedClientPoint.y;\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n                parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n                parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n                parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n            }\n            else {\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n            }\n        }\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n            value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n            value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.activeObj = extend({}, rotatePanActiveObj, {}, true);\n        if (parent.activeObj.activePoint) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n        }\n        this.isReverseRotate = false;\n    };\n    Transform.prototype.limitPan = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var img = parent.img;\n        if (parent.activeObj.activePoint) {\n            if (img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (img.destLeft + img.destWidth < endX) {\n                parent.img.destLeft = endX - img.destWidth;\n            }\n            if (img.destTop + img.destHeight < endY) {\n                parent.img.destTop = endY - img.destHeight;\n            }\n        }\n    };\n    Transform.prototype.updateFlipActiveObj = function (panRegion) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.lowerCanvas, width = _a.width, height = _a.height;\n        var endX;\n        var endY;\n        if (panRegion === 'horizontal') {\n            endX = actPoint.startX > width / 2 ? (width / 2) - (actPoint.startX - (width / 2)) :\n                (width / 2) + ((width / 2) - actPoint.startX);\n            actPoint.startX = endX - actPoint.width;\n            actPoint.endX = endX;\n        }\n        else if (panRegion === 'vertical') {\n            endY = actPoint.startX > width / 2 ? (height / 2) - (actPoint.startY - (height / 2)) :\n                (height / 2) + ((height / 2) - actPoint.startY);\n            actPoint.startY = endY - actPoint.height;\n            actPoint.endY = endY;\n        }\n        else if (panRegion === 'verticalHorizontal' || panRegion === 'horizontalVertical') {\n            endX = actPoint.startX > width / 2 ? (width / 2) - (actPoint.startX - (width / 2)) :\n                (width / 2) + ((width / 2) - actPoint.startX);\n            endY = actPoint.startX > width / 2 ? (height / 2) - (actPoint.startY - (height / 2)) :\n                (height / 2) + ((height / 2) - actPoint.startY);\n            actPoint.startX = endX - actPoint.width;\n            actPoint.startY = endY - actPoint.height;\n            actPoint.endX = endX;\n            actPoint.endY = endY;\n        }\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: actPoint,\n                obj: parent.activeObj, isMouseMove: null, x: null, y: null } });\n    };\n    Transform.prototype.pan = function (value, x, y) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (value) {\n                parent.togglePan = true;\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n                if (x || y) {\n                    x = x ? x : 0;\n                    y = y ? y : 0;\n                    if (isNullOrUndefined(this.panMove)) {\n                        this.panMove = { x: x, y: y };\n                    }\n                    if (isNullOrUndefined(this.tempPanMove)) {\n                        this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n                    }\n                    this.panEvent(x, y, true);\n                    this.tempPanMove = null;\n                }\n            }\n            else {\n                parent.togglePan = parent.currObjType.isCustomCrop = false;\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Transform.prototype.zoom = function (zoomFactor, zoomPoint) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var value = this.getCurrentZoomFactor(zoomFactor);\n            if (isNullOrUndefined(zoomPoint)) {\n                this.zoomAction(value, zoomPoint);\n            }\n            else {\n                var type = value > 0 ? 'zoomIn' : 'zoomOut';\n                var absValue = Math.abs(value) * 10;\n                for (var i = 0; i < absValue; i++) {\n                    parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                        value: { x: zoomPoint.x, y: zoomPoint.y, type: type, isResize: null } });\n                }\n            }\n        }\n    };\n    Transform.prototype.getCurrentZoomFactor = function (zoomFactor) {\n        return zoomFactor >= 1 ? (this.prevZoomValue < 1 ? (zoomFactor - this.prevZoomValue) : (zoomFactor - this.prevZoomValue) * 0.1) :\n            (zoomFactor - this.prevZoomValue);\n    };\n    Transform.prototype.setCurrPanRegion = function (region, type, obj) {\n        var panRegion = region;\n        if (region === '') {\n            panRegion = type === 'horizontal' ? 'horizontal' : type === 'vertical' ? 'vertical' : region;\n        }\n        else if (region === 'horizontal') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'vertical' : type === -90 ? 'horizontal' : region;\n        }\n        else if (region === 'vertical') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'horizontal' : type === -90 ? 'vertical' : region;\n        }\n        else {\n            panRegion = type === 'horizontal' ? 'vertical' : type === 'vertical' ? 'horizontal' : region;\n        }\n        obj['panRegion'] = panRegion;\n    };\n    Transform.prototype.rotate = function (degree, obj) {\n        var parent = this.parent;\n        var isRotate = false;\n        if (!parent.disabled && parent.isImageLoaded && (degree % 90 === 0)) {\n            this.rotateImage(degree);\n        }\n        obj['isRotate'] = isRotate;\n    };\n    Transform.prototype.flip = function (direction) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.flipImage(direction);\n        }\n    };\n    Transform.prototype.update = function () {\n        var parent = this.parent;\n        var toolbarHeight = 0;\n        var isFrameToolbar = false;\n        var isActiveObj = false;\n        var freehandObj = { bool: false };\n        var straightenObj = { bool: parent.isStraightening };\n        var cxtTbarHeight = 0;\n        var ctToolbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbar');\n        var ctWrapper = parent.element.querySelector('.e-contextual-toolbar-wrapper');\n        var hdWrapper = parent.element.querySelector('#' + parent.element.id + '_headWrapper');\n        if (parent.isImageLoaded) {\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (Browser.isDevice) {\n                if (parent.activeObj.shape) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n            }\n            var frameObj = { bool: null };\n            parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObj } });\n            if (!straightenObj['bool'] && ((ctToolbar && !ctToolbar.parentElement.classList.contains('e-hide')) ||\n                (hdWrapper && !hdWrapper.parentElement.classList.contains('e-hide')))) {\n                ctWrapper.classList.add('e-hide');\n                if (!isCropSelection) {\n                    parent.okBtn();\n                }\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            if (parent.activeObj.shape !== undefined) {\n                isActiveObj = true;\n                if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: null } });\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        var tempFilter = this.lowerContext.filter;\n        var canvasWrapper = parent.element.querySelector('#' + parent.element.id + '_canvasWrapper');\n        if (canvasWrapper) {\n            canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n        }\n        parent.lowerCanvas.width = parent.upperCanvas.width = parent.element.offsetWidth - 2;\n        if (parent.toolbarTemplate) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + parent.element.id + '_toolbar')) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbar').clientHeight;\n            if (toolbarHeight === 0 && parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                var obj = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n                toolbarHeight = obj['toolbarHeight'];\n            }\n        }\n        var ctxTbarArea = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n        if (Browser.isDevice && straightenObj['bool'] && ctxTbarArea) {\n            cxtTbarHeight = ctxTbarArea.clientHeight;\n        }\n        parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: toolbarHeight } });\n        if (Browser.isDevice) {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - ((2 * toolbarHeight) + cxtTbarHeight) - 4 + 'px';\n            }\n        }\n        else {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - toolbarHeight - 2 + 'px';\n            }\n        }\n        parent.lowerCanvas.height = parent.upperCanvas.height = parseFloat(canvasWrapper.style.height);\n        this.lowerContext.filter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.canvasFilter = this.lowerContext.filter;\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        if (parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.lowerContext.filter = tempFilter;\n            parent.initialAdjustmentValue = tempFilter;\n            parent.canvasFilter = this.lowerContext.filter;\n            if (parent.isImageLoaded) {\n                showSpinner(parent.element);\n                parent.element.style.opacity = '0.5';\n            }\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (canvasWrapper) {\n                canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n                canvasWrapper.style.height = parent.element.offsetHeight + 'px';\n                var obj_1 = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj_1 } });\n                if (Browser.isDevice) {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * obj_1['toolbarHeight']) - cxtTbarHeight) - 4 + 'px';\n                }\n                else {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - obj_1['toolbarHeight']) - 2 + 'px';\n                }\n            }\n            parent.lowerCanvas.width = parent.upperCanvas.width = parseFloat(canvasWrapper.style.width);\n            parent.lowerCanvas.height = parent.upperCanvas.height = parseFloat(canvasWrapper.style.height);\n            this.lowerContext.filter = tempFilter;\n            var obj = { width: 0, height: 0 };\n            this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight, obj);\n            var maxDimension = obj;\n            if (straightenObj['bool'] && parent.transform.cropZoomFactor !== 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.cropZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.cropZoomFactor);\n            }\n            else if (parent.transform.defaultZoomFactor > 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.defaultZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.defaultZoomFactor);\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '') {\n                if (parent.transform.defaultZoomFactor > 0) {\n                    parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n                }\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n            }\n            else {\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n                var temp = this.lowerContext.filter;\n                parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                this.lowerContext.filter = temp;\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            }\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            var obj1 = { defToolbarItems: null };\n            parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj1 } });\n            if (obj1['defToolbarItems'] && obj1['defToolbarItems'].length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                toolbar_1.refreshOverflow();\n                if (ctWrapper && !straightenObj['bool']) {\n                    ctWrapper.classList.add('e-hide');\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (isActiveObj) {\n                var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                parent.objColl.pop();\n                if (activeObj.activePoint.width !== 0 && activeObj.activePoint.height !== 0) {\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.objColl.push(activeObj);\n                    parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n                    parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                    activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                    parent.objColl.pop();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                    if (straightenObj['bool']) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: activeObj } });\n                    }\n                    if (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse' || parent.activeObj.shape === 'text' ||\n                        parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path' ||\n                        parent.activeObj.shape === 'image') {\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    }\n                }\n            }\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n            }\n            if (isFrameToolbar) {\n                parent.notify('toolbar', { prop: 'callFrameToolbar', onPropertyChange: false });\n            }\n            else if (parent.isResize) {\n                parent.aspectWidth = Math.ceil(parent.img.destWidth);\n                parent.aspectHeight = Math.ceil(parent.img.destHeight);\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            if ((parent.transform.degree !== 0 || parent.transform.currFlipState !== '') && parent.transform.defaultZoomFactor > 0) {\n                var totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, null, true);\n                var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, null, true);\n                var totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, null, true);\n                this.zoomAction(.1);\n                this.zoomAction(-.1);\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += totalPannedPoint.x;\n                    parent.img.destTop += totalPannedPoint.y;\n                    parent.panPoint.totalPannedPoint = totalPannedPoint;\n                    parent.notify('draw', { prop: 'updateFlipPan', value: { tempSelectionObj: null } });\n                }\n                else {\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.panPoint.totalPannedClientPoint = totalPannedClientPoint;\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                    parent.isCropTab = true;\n                    this.rotatePan();\n                    parent.isCropTab = false;\n                }\n            }\n            else if (parent.transform.degree !== 0 && parent.transform.cropZoomFactor > 0) {\n                parent.transform.zoomFactor = 0;\n                parent.transform.cropZoomFactor = null;\n                parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n            }\n        }\n    };\n    Transform.prototype.calcMaxDimension = function (width, height, obj, isImgShape) {\n        var object = { toolbarHeight: 0 };\n        var parent = this.parent;\n        parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: object } });\n        var canvasMaxWidth = isImgShape ? parent.element.clientWidth / 3 :\n            parent.element.clientWidth;\n        var canvasMaxHeight = isImgShape ? (parent.element.clientHeight - object['toolbarHeight']) / 3 :\n            parent.element.clientHeight - (object['toolbarHeight']); // 1px border\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - (object['toolbarHeight']) : canvasMaxHeight; // 1px border\n        if (Browser.isDevice && parent.isStraightening) {\n            var cxtTbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n            canvasMaxHeight -= cxtTbar ? cxtTbar.clientHeight : 0;\n        }\n        if (!isImgShape && parent.element.clientHeight === 0) {\n            canvasMaxHeight = 0;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            if (canvasMaxWidth > 30) {\n                canvasMaxWidth -= 30;\n            }\n            if (canvasMaxHeight > 30) {\n                canvasMaxHeight -= 30;\n            }\n        }\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            var cropObj = { bool: null };\n            parent.notify('crop', { prop: 'getPreventScaling', onPropertyChange: false,\n                value: { obj: cropObj } });\n            if (cropObj['bool'] && parent.cropObj.activeObj.activePoint &&\n                parent.cropObj.activeObj.activePoint.width !== 0 && parent.cropObj.activeObj.activePoint.height !== 0) {\n                cssMaxWidth = parent.cropObj.activeObj.activePoint.width;\n                cssMaxHeight = parent.cropObj.activeObj.activePoint.height;\n            }\n        }\n        if (obj) {\n            obj['width'] = cssMaxWidth;\n            obj['height'] = cssMaxHeight;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    Transform.prototype.updatePanPoints = function (x, y) {\n        var parent = this.parent;\n        var tempActObj = extend({}, parent.activeObj, {}, true);\n        var tempDestLeft = parent.img.destLeft;\n        var tempDestTop = parent.img.destTop;\n        if (isNullOrUndefined(this.tempPanMove)) {\n            this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n        }\n        var xDiff = this.panMove.x - this.tempPanMove.x;\n        var yDiff = this.panMove.y - this.tempPanMove.y;\n        if (x || y) {\n            xDiff = x;\n            yDiff = y;\n        }\n        parent.img.destLeft += xDiff;\n        parent.img.destTop += yDiff;\n        this.limitPan();\n        var obj = { bool: null };\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        var count = 0;\n        while (parent.transform.straighten !== 0 && (object['isIntersect'] || obj['bool'])) {\n            count++;\n            parent.img.destLeft = tempDestLeft;\n            parent.img.destTop = tempDestTop;\n            if (xDiff !== 0 && xDiff > 0) {\n                xDiff -= 1;\n            }\n            else if (xDiff !== 0 && xDiff < 0) {\n                xDiff += 1;\n            }\n            if (yDiff !== 0 && yDiff > 0) {\n                yDiff -= 1;\n            }\n            else if (yDiff !== 0 && yDiff < 0) {\n                yDiff += 1;\n            }\n            if ((xDiff === 0 && yDiff === 0) || count === 200) {\n                break;\n            }\n            parent.img.destLeft += xDiff;\n            parent.img.destTop += yDiff;\n            this.limitPan();\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        }\n        parent.activeObj = tempActObj;\n        return { x: parent.img.destLeft - tempDestLeft, y: parent.img.destTop - tempDestTop };\n    };\n    Transform.prototype.resizeImage = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var temp1 = true;\n        parent.allowDownScale = false;\n        parent.img.srcLeft = 0;\n        parent.img.srcTop = 0;\n        parent.isAspectRatio = true;\n        var minimum = [];\n        parent.img.srcWidth = parent.baseImgCanvas.width;\n        parent.img.srcHeight = parent.baseImgCanvas.height;\n        if (parent.resizeSrc && parent.resizeSrc.width !== 0 && parent.resizeSrc.height !== 0) {\n            parent.img.srcLeft = parent.resizeSrc.startX;\n            parent.img.srcTop = parent.resizeSrc.startY;\n            parent.img.srcWidth = parent.resizeSrc.width;\n            parent.img.srcHeight = parent.resizeSrc.height;\n        }\n        while ((width < parent.img.destWidth || height < parent.img.destHeight) && temp1) {\n            this.zoomAction(-.1, null, true, true);\n            if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    this.zoomAction(0.0125, null, true, true);\n                    temp1 = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        while ((width > parent.img.destWidth || height > parent.img.destHeight) && temp1 && temp) {\n            this.zoomAction(.1, null, true, true);\n            if (width < parent.img.destWidth || height < parent.img.destHeight) {\n                while (width < parent.img.destWidth) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        var nearestNumber = minimum[0];\n        var smallestDifference = Math.abs(parent.img.destWidth - nearestNumber);\n        for (var _i = 0, minimum_1 = minimum; _i < minimum_1.length; _i++) {\n            var num = minimum_1[_i];\n            var difference = Math.abs(width - num);\n            if (difference < smallestDifference) {\n                nearestNumber = num;\n                smallestDifference = difference;\n            }\n        }\n        if (nearestNumber < width && temp) {\n            this.zoomAction(-.0125, null, true, true);\n            temp = false;\n        }\n        if (nearestNumber > width && !temp) {\n            this.zoomAction(.0125, null, true, true);\n            temp = false;\n        }\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = true;\n        this.zoomAction(-.0125, null, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = extend({}, this.prevResizeCurrObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null, currentText: null,\n                previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n    };\n    Transform.prototype.resizeCrop = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var obj1 = { prevObj: parent.prevObj };\n        parent.cropObj = extend({}, parent.prevCropObj, {}, true);\n        parent.allowDownScale = false;\n        parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj1 } });\n        var activeObj = extend({}, obj1['prevObj']['activeObj'], {}, true);\n        obj1['prevObj']['activeObj'] = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj1['prevObj'] } });\n        parent.objColl = extend([], obj1['prevObj']['objColl'], [], true);\n        parent.pointColl = extend([], obj1['prevObj']['pointColl'], [], true);\n        parent.transform.straighten = 0;\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        }\n        var tempwidth = width;\n        var tempheight = height;\n        var tempZoom = false;\n        if (height >= width && height <= Math.ceil(parent.img.destHeight)) {\n            while ((height <= Math.ceil(parent.img.destHeight)) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height <= width && width < parent.img.destWidth) {\n            while ((width < parent.img.destWidth) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height >= width && height >= parent.img.destHeight) {\n            while ((height >= parent.img.destHeight) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n        }\n        else if (width >= height && width >= parent.img.destWidth) {\n            while ((width >= parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        else if (height > parent.img.destHeight && width > parent.img.destWidth) {\n            while ((height > parent.img.destHeight) && (width > parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        this.resizeImg(activeObj, width, height);\n        width = tempwidth;\n        height = tempheight;\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height > parent.img.destHeight || width > parent.img.destWidth)) {\n                this.zoomAction(.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height < parent.img.destHeight || width < parent.img.destWidth)) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        obj1['prevObj']['activeObj'] = extend({}, activeObj, {}, true);\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = this.preventDownScale ? false : true;\n        parent.isCropTab = false;\n        this.zoomAction(-.0125, null, true);\n        parent.aspectWidth = width;\n        parent.aspectHeight = height;\n    };\n    Transform.prototype.resizeImg = function (activeObj, width, height) {\n        var parent = this.parent;\n        var widthRatio = width / parent.img.destWidth;\n        var heightRatio = height / parent.img.destHeight;\n        if (activeObj.shape) {\n            parent.currSelectionPoint = activeObj;\n            parent.notify('crop', { prop: 'setInitCrop', onPropertyChange: false, value: { bool: true } });\n        }\n        else if (parent.img.srcWidth === parent.baseImgCanvas.width && parent.img.srcHeight === parent.baseImgCanvas.height) {\n            parent.currSelectionPoint = null;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: parent.img.destLeft, startY: parent.img.destTop,\n                    width: parent.img.destWidth, height: parent.img.destHeight } });\n        }\n        else {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        width = parent.activeObj.activePoint.width * widthRatio;\n        height = parent.activeObj.activePoint.height * heightRatio;\n        var sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n        var sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        var count = 0;\n        while (Browser.isDevice && count < 500 && (sx < 0 || sy < 0 || (sx + width) > parent.img.destWidth\n            || (sy + height) > parent.img.destHeight)) {\n            count++;\n            width -= 1;\n            height -= 1;\n            sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n            sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        }\n        parent.transform.defaultZoomFactor = 0;\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: 'custom', startX: sx, startY: sy, width: width, height: height } });\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: false } });\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            while (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                this.zoomAction(.0125, null, true);\n                parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            }\n        }\n        parent.isCropToolbar = true;\n        parent.crop();\n        parent.isCropToolbar = false;\n    };\n    Transform.prototype.updateResize = function () {\n        var parent = this.parent;\n        parent.prevCropObj = extend({}, parent.cropObj, {}, true);\n        var currObject = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: currObject } });\n        parent.prevObj = currObject['currObj'];\n        if (parent.currSelectionPoint && parent.prevCropObj.activeObj.shape) {\n            parent.prevObj.activeObj = extend({}, parent.prevCropObj.activeObj, {}, true);\n        }\n        parent.prevObj.objColl = extend([], parent.objColl, [], true);\n        parent.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        parent.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        parent.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n            height: parent.img.srcHeight };\n    };\n    Transform.prototype.resize = function (width, height, isAspectRatio) {\n        var parent = this.parent;\n        parent.isResize = true;\n        if (isNullOrUndefined(parent.prevCropObj) && isNullOrUndefined(parent.prevObj)) {\n            parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        }\n        var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        if (aspectIcon && nonAspectIcon) {\n            parent.notify('toolbar', { prop: 'initResizeToolbar' });\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'init-main-toolbar', value: { isApplyBtn: false, isDevice: true, isOkBtn: true, isResize: true } });\n            }\n        }\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        var aspectHeight = aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder : aspectRatioHeight.value;\n        var resizeEventArgs = { cancel: false, previousWidth: Math.ceil(parent.img.destWidth),\n            previousHeight: Math.ceil(parent.img.destHeight), width: Math.ceil(width), height: height && height !== 0 ? Math.ceil(height) :\n                (isAspectRatio ? Math.ceil(parseFloat(aspectHeight)) : Math.ceil(parent.img.destHeight)),\n            isAspectRatio: isAspectRatio ? isAspectRatio : false };\n        parent.trigger('resizing', resizeEventArgs);\n        if (!resizeEventArgs.cancel) {\n            this.resizeEventHandler(resizeEventArgs);\n        }\n        else if (parent.aspectHeight && parent.aspectWidth) {\n            parent.aspectHeight = resizeEventArgs.previousHeight;\n            parent.aspectWidth = resizeEventArgs.previousWidth;\n        }\n    };\n    Transform.prototype.resizeEventHandler = function (args) {\n        var parent = this.parent;\n        var isRotate;\n        var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        var heightElem = parent.element.querySelector('.e-ie-toolbar-e-resize-height-input .e-textbox');\n        var widthElem = parent.element.querySelector('.e-ie-toolbar-e-resize-width-input .e-textbox');\n        if (args.isAspectRatio) {\n            if (this.resizedImgAngle == null || this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: 0 } });\n                var originalWidth = parent.img.destWidth;\n                var originalHeight = parent.img.destHeight;\n                var aspectRatioWidthValue = void 0;\n                aspectRatioWidthValue = parseFloat(aspectRatioWidth.value === '' ? aspectRatioWidth.placeholder : aspectRatioWidth.value);\n                if (aspectRatioHeight) {\n                    var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n                    var height = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                    getComponent(aspectRatioHeight, 'numerictextbox').value = height;\n                    aspectRatioHeight.value = height.toString() + ' px';\n                    parent.aspectHeight = height;\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder :\n                            aspectRatioHeight.value);\n                        value = aspectRatioHeightValue / (originalHeight / originalWidth);\n                        var width = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                        getComponent(aspectRatioWidth, 'numerictextbox').value = width;\n                        aspectRatioWidth.value = width.toString() + ' px';\n                        parent.aspectWidth = width;\n                    }\n                }\n                else if (heightElem) {\n                    var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n                    var height = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                    heightElem.value = height.toString();\n                    parent.aspectHeight = height;\n                    if (widthElem && widthElem.value === '') {\n                        var aspectRatioHeightValue = parseFloat(heightElem.value === '' ? heightElem.placeholder : heightElem.value);\n                        value = aspectRatioHeightValue / (originalHeight / originalWidth);\n                        var width = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                        widthElem.value = width.toString();\n                        parent.aspectWidth = width;\n                    }\n                }\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: null } });\n            }\n        }\n        else {\n            if (this.resizedImgAngle !== null && this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: true } });\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                parent.okBtn();\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                    height: parent.img.srcHeight };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n            }\n        }\n        this.resizedImgAngle = parent.transform.degree;\n    };\n    Transform.prototype.straightenImage = function (degree) {\n        var parent = this.parent;\n        if (parent.toolbar && parent.toolbar.length === 0) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: null } });\n        parent.setStraighten(degree, true);\n        parent.okBtn();\n    };\n    return Transform;\n}());\nexport { Transform };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on('undo-redo', this.undoRedo, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        this.parent.off('undo-redo', this.undoRedo);\n        this.parent.off('destroyed', this.destroy);\n    };\n    UndoRedo.prototype.initializeUrPvtProp = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    UndoRedo.prototype.undoRedo = function (args) {\n        this.initializeUrPvtProp();\n        switch (args.prop) {\n            case 'updateUndoRedoColl':\n                this.updateUrc(args.value['operation'], args.value['previousObj'], args.value['previousObjColl'], args.value['previousPointColl'], args.value['previousSelPointColl'], args.value['previousCropObj'], args.value['previousText'], args.value['currentText'], args.value['previousFilter'], args.value['isCircleCrop']);\n                break;\n            case 'refreshUrc':\n                this.refreshUrc(args.value['bool']);\n                break;\n            case 'updateCurrUrc':\n                this.updateCurrUrc(args.value['type']);\n                break;\n            case 'call-undo':\n                this.callUndo();\n                break;\n            case 'call-redo':\n                this.callRedo();\n                break;\n            case 'undo':\n                this.undo();\n                break;\n            case 'redo':\n                this.redo();\n                break;\n            case 'updateUrObj':\n                this.updateUrObj(args.value['objColl'], args.value['operation']);\n                break;\n            case 'updateUndoRedo':\n                this.updateUndoRedo(args.value ? args.value['operation'] : null);\n                break;\n            case 'getAppliedUndoRedoColl':\n                args.value['obj']['appliedUndoRedoColl'] = this.appliedUndoRedoColl;\n                break;\n            case 'getUndoRedoStep':\n                args.value['obj']['undoRedoStep'] = this.undoRedoStep;\n                break;\n            case 'setUndoRedoStep':\n                this.undoRedoStep = args.value['step'];\n                break;\n            case 'undoDefault':\n                this.undoDefault(args.value['obj']);\n                break;\n            case 'setPreventUR':\n                this.isPreventing = args.value['bool'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undo-redo';\n    };\n    UndoRedo.prototype.reset = function () {\n        this.tempCurrSelPoint = null;\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempActObj = null;\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n    };\n    UndoRedo.prototype.refreshUrc = function (refreshToolbar) {\n        var parent = this.parent;\n        refreshToolbar = refreshToolbar ? refreshToolbar : false;\n        if (refreshToolbar) {\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: true } });\n            this.tempUndoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n            this.tempUndoRedoStep = this.undoRedoStep;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        this.undoRedoColl = this.undoRedoColl.slice(0, this.undoRedoStep);\n        this.appliedUndoRedoColl = this.appliedUndoRedoColl.slice(0, this.undoRedoStep);\n        parent.isUndoRedo = parent.currObjType.isUndoAction = false;\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n    };\n    UndoRedo.prototype.updateCurrUrc = function (type) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing) {\n            return;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        if (type === 'ok') {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: false } });\n            var collection = this.tempUndoRedoColl.length > 0 ?\n                extend([], this.tempUndoRedoColl, [], true) :\n                extend([], this.undoRedoColl, [], true);\n            var prevObj = this.undoRedoColl[this.undoRedoColl.length - 1];\n            var appliedURColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n            var prevTransform = prevObj ? extend({}, prevObj.previousObj, {}, true)\n                : null;\n            if (isNullOrUndefined(appliedURColl)) {\n                if (this.undoRedoColl[0]) {\n                    prevObj.previousCropObj = collection[0].previousCropObj;\n                    prevObj.previousObj = collection[0].previousObj;\n                    prevObj.previousObjColl = collection[0].previousObjColl;\n                    prevObj.previousPointColl = collection[0].previousPointColl;\n                    prevObj.previousText = collection[0].previousText;\n                }\n            }\n            else if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                prevObj.previousCropObj = appliedURColl.currentCropObj;\n                prevObj.previousObj = appliedURColl.currentObj;\n                prevObj.previousObjColl = appliedURColl.currentObjColl;\n                prevObj.previousPointColl = appliedURColl.currentPointColl;\n                prevObj.previousText = appliedURColl.currentText;\n                if (prevObj.operation === 'frame' && prevObj.previousObj && prevTransform) {\n                    prevObj.previousObj.defaultZoom = prevTransform.defaultZoom;\n                    prevObj.previousObj.zoomFactor = prevTransform.zoomFactor;\n                    prevObj.previousObj.cropZoom = prevTransform.cropZoom;\n                }\n            }\n            if (prevObj) {\n                if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                    var obj = this.getZeroZoomObjPointValue(prevObj.currentObjColl, prevObj.currentPointColl);\n                    prevObj.currentObjColl = obj['obj'];\n                    prevObj.currentPointColl = obj['point'];\n                    var adjObj = { adjustmentLevel: null };\n                    parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n                    prevObj.currentObj.adjustmentLevel = extend({}, adjObj['adjustmentLevel'], {}, true);\n                    parent.notify('filter', { prop: 'setTempAdjVal' });\n                    prevObj.currentObj.currentFilter = parent.currentFilter;\n                }\n                this.appliedUndoRedoColl.push(prevObj);\n            }\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        else if (this.tempUndoRedoColl.length > 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        if (this.appliedUndoRedoColl.length > 16) {\n            this.appliedUndoRedoColl.splice(0, 1);\n        }\n        this.undoRedoColl = [];\n        this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        if (type === 'ok') {\n            this.undoRedoStep = this.undoRedoColl.length;\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.togglePan = true;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n    };\n    UndoRedo.prototype.cancelCropSelection = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.currObjType.isCustomCrop || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n        }\n        if (this.tempUndoRedoColl.length !== 0 || this.tempUndoRedoStep !== 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        }\n    };\n    UndoRedo.prototype.refreshToolbarActions = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.applyCurrentChanges = function () {\n        var parent = this.parent;\n        parent.currObjType.isFiltered = false;\n        if (parent.transform.zoomFactor === 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (parent.togglePen) {\n            parent.togglePen = false;\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        if (this.appliedUndoRedoColl.length > 0) {\n            this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        }\n    };\n    UndoRedo.prototype.callUndo = function () {\n        this.applyCurrentChanges();\n        this.undo();\n    };\n    UndoRedo.prototype.callRedo = function () {\n        this.applyCurrentChanges();\n        this.redo();\n    };\n    UndoRedo.prototype.undo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep > 0) {\n                this.refreshToolbarActions();\n                if (parent.activeObj.activePoint && parent.activeObj.activePoint.width !== 0) {\n                    this.tempActObj = parent.activeObj;\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.undoRedoStep--;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                var activeObj = void 0;\n                parent.cropObj = extend({}, obj.previousCropObj, {}, true);\n                parent.afterCropActions = obj.previousObj.afterCropActions;\n                this.lowerContext.filter = obj.previousObj.filter;\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.previousObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.previousObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.previousObjColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.previousPointColl, obj.previousSelPointColl);\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.previousPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.previousObjColl, obj.previousPointColl, obj.previousSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.previousObjColl);\n                        this.updateTextAreaCustomization(activeObj, obj.previousObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.previousObjColl, true);\n                        break;\n                    case 'frame':\n                        parent.transform.zoomFactor = parent.transform.defaultZoomFactor = obj.previousObj.defaultZoom;\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj.previousObj.zoomFactor } }, true);\n                        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                            value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                        extend(parent.frameObj, obj.previousObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.previousObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.previousObjColl);\n                        break;\n                    default:\n                        this.undoDefault(obj, true);\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation, filter: obj.filter } });\n                        break;\n                }\n                if (obj.operation === 'crop') {\n                    if (obj.previousObj.currSelectionPoint) {\n                        parent.currSelectionPoint = extend({}, obj.previousObj.currSelectionPoint, {}, true);\n                        if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                            parent.currSelectionPoint = null;\n                        }\n                    }\n                    parent.updateCropTransformItems();\n                    parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                        value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                    if (parent.isCircleCrop) {\n                        parent.isCircleCrop = false;\n                        this.tempCurrSelPoint = extend({}, parent.currSelectionPoint, {}, true);\n                        parent.currSelectionPoint = null;\n                    }\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isUndoRedo: true } });\n                    parent.currObjType.isActiveObj = false;\n                    if (parent.transform.straighten !== 0) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    }\n                }\n                else if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                if ((this.undoRedoColl[this.undoRedoStep - 1]\n                    && this.undoRedoColl[this.undoRedoStep - 1].isCircleCrop)) {\n                    parent.isCircleCrop = true;\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                this.endUndoRedo(obj.operation, true);\n            }\n        }\n    };\n    UndoRedo.prototype.redo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep < this.appliedUndoRedoColl.length) {\n                this.refreshToolbarActions();\n                this.undoRedoStep++;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep - 1];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                parent.cropObj = extend({}, obj.currentCropObj, {}, true);\n                parent.afterCropActions = obj.currentObj.afterCropActions;\n                this.lowerContext.filter = obj.currentObj.filter;\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.currentObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.currentObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                var activeObj = void 0;\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.currentObjColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.currentPointColl, obj.currentSelPointColl);\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.currentPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.currentObjColl, obj.currentPointColl, obj.currentSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.currentObjColl);\n                        this.updateTextAreaCustomization(activeObj, obj.currentObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.currentObjColl, false);\n                        break;\n                    case 'frame':\n                        extend(parent.frameObj, obj.currentObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.currentObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.currentObjColl);\n                        break;\n                    default:\n                        parent.objColl = [];\n                        parent.pointColl = [];\n                        parent.freehandCounter = 0;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: [] } } });\n                        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.currentObj, isUndoRedo: true } });\n                        parent.img.destLeft = obj.currentObj.destPoints.startX;\n                        parent.img.destTop = obj.currentObj.destPoints.startY;\n                        activeObj = extend({}, parent.activeObj, {}, true);\n                        parent.objColl = extend([], obj.currentObjColl, [], true);\n                        parent.pointColl = extend([], obj.currentPointColl, [], true);\n                        parent.freehandCounter = parent.pointColl.length;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: extend([], obj.currentSelPointColl, [], true) } } });\n                        parent.transform.straighten = 0;\n                        this.lowerContext.filter = 'none';\n                        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                        this.lowerContext.filter = obj.currentObj.filter;\n                        parent.prevStraightenedDegree = parent.transform.straighten;\n                        parent.activeObj = activeObj;\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        }\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation } });\n                        break;\n                }\n                if (obj.operation === 'crop' && obj.isCircleCrop) {\n                    parent.isCircleCrop = true;\n                    parent.currSelectionPoint = extend({}, this.tempCurrSelPoint, {}, true);\n                    this.tempCurrSelPoint = null;\n                }\n                if (obj.operation === 'crop' && !obj.isCircleCrop) {\n                    parent.isCircleCrop = false;\n                }\n                if (obj.operation === 'crop' && obj.currentObj.currSelectionPoint) {\n                    parent.currSelectionPoint = extend({}, obj.currentObj.currSelectionPoint, {}, true);\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.currSelectionPoint } });\n                }\n                if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                    parent.currSelectionPoint = null;\n                }\n                if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                this.endUndoRedo(obj.operation, false);\n            }\n        }\n    };\n    UndoRedo.prototype.imageFlip = function (type, objColl) {\n        var parent = this.parent;\n        this.shapeTransform(objColl);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var _a = parent.activeObj, shape = _a.shape, isHorImageFlip = _a.isHorImageFlip, isVerImageFlip = _a.isVerImageFlip;\n        parent.objColl.pop();\n        if (shape && shape === 'image') {\n            if (type === 'horizontal') {\n                if (isNullOrUndefined(isHorImageFlip) && isVerImageFlip) {\n                    parent.activeObj.isHorImageFlip = true;\n                    parent.activeObj.isVerImageFlip = null;\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isHorImageFlip) || !isHorImageFlip) {\n                        parent.activeObj.isHorImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isHorImageFlip = null;\n                    }\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n            }\n            else if (type === 'vertical') {\n                if (isNullOrUndefined(isVerImageFlip) && isHorImageFlip) {\n                    parent.activeObj.isVerImageFlip = true;\n                    parent.activeObj.isHorImageFlip = null;\n                    parent.verticalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isVerImageFlip) || !isVerImageFlip) {\n                        parent.activeObj.isVerImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isVerImageFlip = null;\n                    }\n                    parent.verticalFlip(this.upperContext, true);\n                }\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n    };\n    UndoRedo.prototype.shapeTransform = function (objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDraw = function (pointColl, selPointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: selPointColl } } });\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDrawCustomized = function (pointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateDelete = function (operation, objColl, pointColl, selPointColl) {\n        var parent = this.parent;\n        if (operation === 'deleteFreehandDrawing') {\n            parent.pointColl = pointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: selPointColl } } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        else if (operation === 'deleteObj') {\n            parent.objColl = objColl;\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextAreaCustomization = function (activeObj, objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            if (this.tempActObj) {\n                if (this.tempActObj.currIndex === objColl[i].currIndex) {\n                    activeObj = extend({}, objColl[i], {}, true);\n                    parent.objColl.splice(i, 1);\n                    break;\n                }\n            }\n            else {\n                activeObj = extend({}, objColl[objColl.length - 1], {}, true);\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        if (activeObj) {\n            this.updateTextBox(activeObj);\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n        }\n    };\n    UndoRedo.prototype.updateText = function (objColl, allowActiveObj) {\n        var parent = this.parent;\n        if (this.tempActObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        if (objColl.length === 0 && parent.objColl.length === 1) {\n            this.tempActObj = extend({}, parent.objColl[0], {}, true);\n        }\n        else {\n            for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n                if (parent.objColl[i] && isNullOrUndefined(objColl[i])) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n                if (objColl[i].currIndex !== parent.objColl[i].currIndex) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        if (allowActiveObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextBox = function (obj) {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var textArea = parent.textArea;\n        textArea.style.display = 'block';\n        textArea.style.fontFamily = obj.textSettings.fontFamily;\n        textArea.style.fontSize = obj.textSettings.fontSize + 'px';\n        textArea.style.color = obj.strokeSettings.strokeColor;\n        textArea.style.fontWeight = obj.textSettings.bold ? 'bold' : 'normal';\n        textArea.style.fontStyle = obj.textSettings.italic ? 'italic' : 'normal';\n        textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        textArea.value = obj.keyHistory;\n        parent.activeObj = extend({}, obj, {}, true);\n        parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n            value: { isTextBox: null } });\n        parent.textArea.style.width = parent.activeObj.activePoint.width + 'px';\n    };\n    UndoRedo.prototype.undoDefault = function (obj, isUndoRedo) {\n        this.lowerContext.filter = obj.previousObj.filter;\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: [] } } });\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.previousObj, isUndoRedo: isUndoRedo } });\n        parent.prevStraightenedDegree = parent.transform.straighten;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.img.destLeft = obj.previousObj.destPoints.startX;\n        parent.img.destTop = obj.previousObj.destPoints.startY;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = extend([], obj.previousObjColl, [], true);\n        parent.pointColl = extend([], obj.previousPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: extend([], obj.previousSelPointColl, [], true) } } });\n        parent.transform.straighten = 0;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = obj.previousObj.filter;\n        parent.activeObj = activeObj;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n    };\n    UndoRedo.prototype.endUndoRedo = function (operation, isUndo) {\n        var parent = this.parent;\n        var frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        if (((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) &&\n            JSON.stringify(parent.frameObj) !== JSON.stringify(frameObj)) {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop && ((isUndo && operation !== 'crop') || !isUndo)) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: false } });\n        if (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] === 'crop') {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: true, isZooming: null, cType: null } });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (parent.transform.degree !== 0) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: 0, yDiff: 0 } });\n        }\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.currObjType.isCustomCrop = false;\n    };\n    UndoRedo.prototype.updateUrc = function (operation, previousObj, previousObjColl, previousPointColl, previousSelPointColl, previousCropObj, previousText, currentText, previousFilter, isCircleCrop) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing) {\n            return;\n        }\n        var obj = { isInitialLoaded: false };\n        if (parent.currObjType.isUndoAction) {\n            this.refreshUrc(true);\n        }\n        parent.notify('draw', { prop: 'isInitialLoaded', onPropertyChange: false, value: { object: obj } });\n        if (!obj['isInitialLoaded'] && parent.allowUndoRedo) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var currentObj = object['currObj'];\n            currentObj.objColl = extend([], parent.objColl, [], true);\n            currentObj.pointColl = extend([], parent.pointColl, [], true);\n            currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (operation === 'crop') {\n                currentObj.currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            }\n            else if (operation === 'frame') {\n                previousObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                currentObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n                    previousObj.defaultZoom = currentObj.defaultZoom = parent.tempFrameZoomLevel;\n                }\n            }\n            else if ((operation === 'imageHFlip' || operation === 'imageVFlip') && this.appliedUndoRedoColl.length > 0) {\n                var index = previousObjColl[previousObjColl.length - 1].currIndex;\n                previousObjColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentObjColl;\n                if (index) {\n                    for (var i = 0, len = previousObjColl.length; i < len; i++) {\n                        if (previousObjColl[i].currIndex === index) {\n                            var actObj = extend({}, previousObjColl[i], {}, true);\n                            previousObjColl.splice(i, 1);\n                            previousObjColl.push(actObj);\n                            break;\n                        }\n                    }\n                }\n            }\n            this.undoRedoColl.push({ operation: operation, previousObj: previousObj, currentObj: currentObj,\n                previousObjColl: previousObjColl, currentObjColl: currentObj.objColl,\n                previousPointColl: previousPointColl, currentPointColl: currentObj.pointColl,\n                previousSelPointColl: previousSelPointColl, currentSelPointColl: currentObj.selPointColl,\n                previousCropObj: previousCropObj, currentCropObj: extend({}, parent.cropObj, {}, true),\n                previousText: previousText, currentText: currentText, filter: previousFilter, isCircleCrop: isCircleCrop });\n            parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.updateUrObj = function (objColl, operation) {\n        var parent = this.parent;\n        if (parent.allowUndoRedo) {\n            if (parent.currObjType.isUndoAction) {\n                this.refreshUrc(true);\n            }\n            if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            parent.objColl.push(parent.activeObj);\n            var cropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var obj = object['currObj'];\n            obj.objColl = extend([], parent.objColl, [], true);\n            obj.pointColl = extend([], parent.pointColl, [], true);\n            obj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            obj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var oper = operation ? operation : 'shapeTransform';\n            this.undoRedoColl.push({ operation: oper, previousObj: obj, currentObj: obj,\n                previousObjColl: objColl, currentObjColl: obj.objColl,\n                previousPointColl: obj.pointColl, currentPointColl: obj.pointColl,\n                previousSelPointColl: obj.selPointColl, currentSelPointColl: obj.selPointColl,\n                previousCropObj: cropObj, currentCropObj: cropObj });\n            parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        }\n    };\n    UndoRedo.prototype.updateUndoRedo = function (operation) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        parent.objColl.push(parent.activeObj);\n        var oper = operation ? operation : 'shapeTransform';\n        this.updateUrc(oper, prevObj, prevObj.objColl, prevObj.pointColl, prevObj.selPointColl, prevCropObj);\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n    };\n    UndoRedo.prototype.getZeroZoomObjPointValue = function (obj, point) {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var cropDimensionObj = { cropDimension: null };\n        parent.notify('transform', { prop: 'getCropDimension', onPropertyChange: false, value: { obj: cropDimensionObj } });\n        var getZeroZoomObjColl = extend([], parent.objColl, [], true);\n        var getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n        var arrowObj = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: arrowObj } });\n        var tempArrowObj = extend({}, arrowObj['arrowDimension'], {}, true);\n        if (parent.transform.zoomFactor > 0 && (obj.length > 0 || point.length > 0)) {\n            if (obj.length > 0) {\n                for (var i = 0; i < obj.length; i++) {\n                    if (obj[i].currIndex) {\n                        continue;\n                    }\n                    else {\n                        obj[i].currIndex = 'shape_' + (i + 1);\n                    }\n                }\n            }\n            parent.objColl = obj;\n            parent.pointColl = point;\n            var isUndoRedo = parent.isUndoRedo;\n            var isCropTab = parent.isCropTab;\n            if (parent.transform.zoomFactor !== 0) {\n                parent.isUndoRedo = true;\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                var zoomSettings = extend({}, parent.zoomSettings, null, true);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: null } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: Math.abs(parent.transform.zoomFactor), zoomPoint: null, isResize: null } });\n                }\n                parent.zoomSettings = zoomSettings;\n                parent.isCropTab = isCropTab;\n                parent.isUndoRedo = isUndoRedo;\n                getZeroZoomObjColl = extend([], parent.objColl, [], true);\n                getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] } });\n                var maxDimension = { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] };\n                maxDimension.width += (maxDimension.width * currentObj.defaultZoom);\n                maxDimension.height += (maxDimension.height * currentObj.defaultZoom);\n                parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n                parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: currentObj } });\n                parent.img.destLeft = currentObj.destPoints.startX;\n                parent.img.destTop = currentObj.destPoints.startY;\n                parent.panPoint.totalPannedPoint = currentObj.totalPannedPoint;\n                parent.panPoint.totalPannedClientPoint = currentObj.totalPannedClientPoint;\n                parent.panPoint.totalPannedInternalPoint = currentObj.totalPannedInternalPoint;\n                parent.objColl = extend([], currentObj.objColl, [], true);\n                parent.pointColl = extend([], currentObj.pointColl, [], true);\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('draw', { prop: 'setArrowDimension', onPropertyChange: false, value: { arrowDimension: tempArrowObj } });\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: extend([], currentObj.selPointColl, [], true) } } });\n                this.lowerContext.filter = 'none';\n                parent.transform.straighten = 0;\n                this.applyImgTranform();\n                parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                    value: { context: this.lowerContext, points: null } });\n                parent.notify('freehand-draw', { prop: 'updateFHDCurPts', onPropertyChange: false });\n                this.lowerContext.filter = currentObj.filter;\n                if (parent.transform.degree !== 0) {\n                    parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                        value: { xDiff: 0, yDiff: 0 } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n        }\n        return { obj: getZeroZoomObjColl, point: getZeroZoomPointColl };\n    };\n    UndoRedo.prototype.applyImgTranform = function () {\n        var parent = this.parent;\n        var obj = extend({}, parent.activeObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].shape === 'image') {\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var ctx = parent.objColl[i].imageCanvas.getContext('2d');\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: true } });\n            }\n        }\n        parent.activeObj = obj;\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, NotifyPropertyChanges, Property, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, isNullOrUndefined, getUniqueID } from '@syncfusion/ej2-base';\nimport { Dialog, createSpinner } from '@syncfusion/ej2-popups';\nimport { Complex, Browser, ChildProperty, compile as templateCompiler, compile } from '@syncfusion/ej2-base';\nimport { ToolbarModule, Crop, Draw, Filter, FreehandDrawing, Selection, Shape, Transform, UndoRedo, Export, FrameLineStyle, ShapeType } from './../index';\nimport { ZoomTrigger, ImageFinetuneOption } from './../index';\nimport { Uploader } from '@syncfusion/ej2-inputs';\n/**\n * This interface is used to specify settings for finetuning operations on images, including brightness, contrast, hue, saturation, exposure, opacity, and blur. It includes properties for setting minimum and maximum values for each of these options, as well as a default value.\n */\nvar FinetuneSettings = /** @class */ (function (_super) {\n    __extends(FinetuneSettings, _super);\n    function FinetuneSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"brightness\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"contrast\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"hue\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"saturation\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"exposure\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"blur\", void 0);\n    return FinetuneSettings;\n}(ChildProperty));\nexport { FinetuneSettings };\n/**\n * An interface used to define the settings such as minimum, maximum, and default zoom factors, and the type of zooming which are available in the image editor control.\n */\nvar ZoomSettings = /** @class */ (function (_super) {\n    __extends(ZoomSettings, _super);\n    function ZoomSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomTrigger\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"minZoomFactor\", void 0);\n    __decorate([\n        Property(10)\n    ], ZoomSettings.prototype, \"maxZoomFactor\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomPoint\", void 0);\n    return ZoomSettings;\n}(ChildProperty));\nexport { ZoomSettings };\n/**\n * This interface is used to specify settings for selection operations on images, including visibility, stroke color and fill color.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], SelectionSettings.prototype, \"showCircle\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"strokeColor\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"fillColor\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n/**\n * Predefine the font families that populate in font family dropdown list from the toolbar.\n */\nvar FontFamily = /** @class */ (function (_super) {\n    __extends(FontFamily, _super);\n    function FontFamily() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Arial')\n    ], FontFamily.prototype, \"default\", void 0);\n    __decorate([\n        Property(null)\n    ], FontFamily.prototype, \"items\", void 0);\n    return FontFamily;\n}(ChildProperty));\nexport { FontFamily };\n/**\n * The Image Editor is a graphical user interface for editing images.\n *\n * {% codeBlock src='image-editor/default/index.md' %}{% endcodeBlock %}\n *\n * @remarks\n * The Image Editor component provides various image editing features such as zooming, cropping, rotating, inserting text and shapes (rectangles, ellipses, and lines), drawing freehand on top of an image, undo/redo, and more.\n *\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options) || this;\n        /**\n         *\n         * Image Editor Private Properties\n         */\n        /** @hidden */\n        _this.isImageLoaded = false;\n        /** @hidden */\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], rotatedAngle: 0, opacity: 1 };\n        // current object's ui interaction properties\n        /** @hidden */\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false, isInitialLine: false,\n            isCustomCrop: false, isZoomed: false, isUndoZoom: false, isUndoAction: false, isFiltered: false, isSave: false, isResize: false };\n        /** @hidden */\n        _this.objColl = [];\n        /** @hidden */\n        // eslint-disable-next-line\n        _this.pointColl = {};\n        /** @hidden */\n        _this.freehandCounter = 0;\n        /** @hidden */\n        _this.points = [];\n        /** @hidden */\n        _this.togglePen = false;\n        /** @hidden */\n        _this.togglePan = false;\n        /** @hidden */\n        _this.img = { destLeft: 0, destTop: 0, destWidth: 0, destHeight: 0, srcLeft: 0, srcTop: 0, srcWidth: 0, srcHeight: 0 };\n        /** @hidden */\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        _this.rotateFlipColl = [];\n        // All prop values saved while cropping (to restore the image to its original state)\n        /** @hidden */\n        _this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n            degree: 0, currFlipState: '', straighten: 0, destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n            zoomFactor: 0, previousZoomValue: 0, aspectWidth: null, aspectHeight: null, frame: 'none', straightenZoom: 0,\n            adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        // Stored transformations performed after cropping\n        /** @hidden */\n        _this.afterCropActions = [];\n        /** @hidden */\n        _this.transform = { degree: 0, currFlipState: '', zoomFactor: 0, cropZoomFactor: null, defaultZoomFactor: 0, straighten: 0 };\n        /** @hidden */\n        _this.panPoint = { currentPannedPoint: { x: 0, y: 0 }, totalPannedPoint: { x: 0, y: 0 }, totalPannedInternalPoint: { x: 0, y: 0 },\n            totalPannedClientPoint: { x: 0, y: 0 } };\n        /** @hidden */\n        _this.isUndoRedo = false;\n        /** @hidden */\n        _this.isCropTab = false;\n        /** @hidden */\n        _this.isCircleCrop = false;\n        /** @hidden */\n        _this.fontSizeColl = [];\n        /** @hidden */\n        _this.initialAdjustmentValue = '';\n        /** @hidden */\n        _this.currentFilter = '';\n        /** @hidden */\n        _this.canvasFilter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        /** @hidden */\n        _this.toolbarHeight = 0;\n        /** @hidden */\n        _this.isPublicMethod = false;\n        /** @hidden */\n        _this.isCropToolbar = false;\n        /** @hidden */\n        _this.cursor = 'default';\n        /** @hidden */\n        _this.resizeSrc = { startX: _this.img.srcLeft, startY: _this.img.srcTop, width: _this.img.srcWidth, height: _this.img.srcHeight };\n        /** @hidden */\n        _this.isResize = false;\n        /** @hidden */\n        _this.isAspectRatio = false;\n        /** @hidden */\n        _this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.allowDownScale = true;\n        /** @hidden */\n        _this.gradientColor = '';\n        /** @hidden */\n        _this.size = 20;\n        /** @hidden */\n        _this.inset = 0;\n        /** @hidden */\n        _this.offset = 0;\n        /** @hidden */\n        _this.borderRadius = 0;\n        /** @hidden */\n        _this.lineCount = 0;\n        /** @hidden */\n        _this.prevStraightenedDegree = 0;\n        /** @hidden */\n        _this.tempStraighten = 0;\n        /** @hidden */\n        _this.isStraightening = false;\n        /** @hidden */\n        _this.isFinetuning = false;\n        /** @hidden */\n        _this.isZoomBtnClick = false;\n        /** @hidden */\n        _this.isFinetuneBtnClick = false;\n        /** @hidden */\n        _this.isFilterCanvasClick = false;\n        /** @hidden */\n        _this.isFrameBtnClick = false;\n        /** @hidden */\n        _this.isChangesSaved = false;\n        ImageEditor_1.Inject(Crop, Draw, Selection, Transform, Export, ToolbarModule);\n        ImageEditor_1.Inject(UndoRedo);\n        ImageEditor_1.Inject(Filter);\n        ImageEditor_1.Inject(Shape);\n        ImageEditor_1.Inject(FreehandDrawing);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    /**\n     * To provide the array of modules needed for component rendering.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for component rendering.\n     * @hidden\n     */\n    ImageEditor.prototype.requiredModules = function () {\n        var modules = [];\n        modules.push({ member: 'crop', args: [this] });\n        modules.push({ member: 'draw', args: [this] });\n        modules.push({ member: 'selection', args: [this] });\n        modules.push({ member: 'transform', args: [this] });\n        modules.push({ member: 'export', args: [this] });\n        modules.push({ member: 'toolbar-module', args: [this] });\n        modules.push({ member: 'undo-redo', args: [this] });\n        modules.push({ member: 'filter', args: [this] });\n        modules.push({ member: 'shape', args: [this] });\n        modules.push({ member: 'freehand-draw', args: [this] });\n        return modules;\n    };\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.initializeThemeColl();\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param {ImageEditorModel} newProperties - Specifies new properties\n     * @param {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        var indexObj;\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    this.update();\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    this.update();\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        if (this.theme && this.theme !== '') {\n                            this.theme = this.toPascalCase(this.theme);\n                        }\n                        else {\n                            this.theme = 'Bootstrap5';\n                        }\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'finetuneSettings':\n                    if (newProperties.finetuneSettings) {\n                        this.finetuneSettings = newProperties.finetuneSettings;\n                        this.notify('filter', { prop: 'update-finetunes' });\n                    }\n                    break;\n                case 'locale':\n                    if (newProperties.locale) {\n                        this.notify('toolbar', { prop: 'setLocale', onPropertyChange: false, value: { locale: newProperties.locale } });\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'allowUndoRedo':\n                    if (newProperties.allowUndoRedo) {\n                        this.allowUndoRedo = true;\n                    }\n                    else {\n                        this.allowUndoRedo = false;\n                    }\n                    this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    break;\n                case 'showQuickAccessToolbar':\n                    if (newProperties.showQuickAccessToolbar) {\n                        this.showQuickAccessToolbar = true;\n                        this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n                        indexObj = { freehandSelectedIndex: null };\n                        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                        if (this.activeObj.shape) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                        }\n                        else if (indexObj['freehandSelectedIndex']) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                        }\n                    }\n                    else {\n                        this.showQuickAccessToolbar = false;\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    break;\n                case 'zoomSettings':\n                    if (newProperties.zoomSettings) {\n                        this.zoomSettings.zoomTrigger = newProperties.zoomSettings.zoomTrigger;\n                    }\n                    if (isNullOrUndefined(this.zoomSettings.zoomTrigger)) {\n                        this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar |\n                            ZoomTrigger.Commands);\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if ((newProperties.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'selectionSettings':\n                    if (newProperties.selectionSettings) {\n                        this.selectionSettings = newProperties.selectionSettings;\n                        if (this.activeObj.shape) {\n                            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n                        }\n                    }\n                    break;\n                case 'toolbar':\n                    if (newProperties.toolbar) {\n                        this.toolbar = newProperties.toolbar;\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'toolbarTemplate':\n                    if (newProperties.toolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                        this.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                        this.element.appendChild(this.createElement('div', {\n                            id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n                        }));\n                        this.toolbarTemplateFn();\n                    }\n                    break;\n                case 'quickAccessToolbarTemplate':\n                    if (newProperties.quickAccessToolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                        this.quickAccessToolbarTemplateFn();\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        this.unwireEvent();\n        this.notify('toolbar', { prop: 'destroySubComponents', onPropertyChange: false });\n        this.notify('destroyed', null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n    };\n    ImageEditor.prototype.initialize = function () {\n        if (this.toolbarTemplate) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            this.toolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        }\n        this.createCanvas();\n        if (this.element.offsetWidth > 359 && this.element.querySelector('.e-ie-min-drop-content') && this.element.querySelector('.e-ie-drop-content')) {\n            this.element.querySelector('.e-ie-min-drop-content').style.display = 'none';\n            this.element.querySelector('.e-ie-drop-content').style.display = 'block';\n        }\n        this.createDropUploader();\n        if (this.showQuickAccessToolbar) {\n            var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n            canvasWrapper.appendChild(this.createElement('div', {\n                id: this.element.id + '_quickAccessToolbarArea', className: 'e-quick-access-toolbar-area'\n            }));\n            var quickAccessToolbar = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            quickAccessToolbar.style.position = 'absolute';\n            quickAccessToolbar.style.display = 'none';\n            if (this.activeObj) {\n                quickAccessToolbar.style.left = this.activeObj.activePoint.startX + 'px';\n                quickAccessToolbar.style.top = this.activeObj.activePoint.startY + 'px';\n            }\n            quickAccessToolbar.style.width = '100%';\n        }\n        if (this.quickAccessToolbarTemplate) {\n            this.quickAccessToolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n        }\n        this.wireEvent();\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        this.canvasFilter = this.lowerContext.filter;\n        this.notify('toolbar', { prop: 'setInitialAdjustmentValue', onPropertyChange: false, value: { value: this.lowerContext.filter } });\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n        this.initializeZoomSettings();\n    };\n    ImageEditor.prototype.createDropUploader = function () {\n        var _this = this;\n        var uploadObj = new Uploader({\n            dropArea: this.element.getElementsByClassName('e-canvas-wrapper')[0],\n            allowedExtensions: '.jpg, .jpeg, .png,.svg',\n            multiple: false,\n            selected: function (args) {\n                if (args.event.type === 'change' || args.event.type === 'drop') {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var type = args.filesData[0].type;\n                    var errType = 'unsupported';\n                    if ((args.event.type === 'change' || (args.event.type === 'drop' && args.event.dataTransfer.files.length === 1)) && (type === 'png' || type === 'jpg' || type === 'jpeg' || type === 'svg')) {\n                        _this.notify('draw', { prop: 'fileSelect', value: { inputElement: _this.element.querySelector('#' + _this.element.id + '_dropfileUpload'), args: args } });\n                    }\n                    else {\n                        if (args.event.type === 'drop' && args.event.dataTransfer.files.length > 1) {\n                            errType = 'multi-select-image';\n                        }\n                        _this.showDialogPopup(errType);\n                    }\n                }\n            }\n        });\n        uploadObj.appendTo('#' + this.element.id + '_dropfileUpload');\n    };\n    ImageEditor.prototype.dlgCloseBtnClick = function () {\n        getComponent(document.getElementById(this.element.id + '_dialog'), 'dialog').destroy();\n    };\n    /**\n     * Show dialog popup for unsupported files.\n     *\n     * @param { string } type - Specifies the type of error.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.showDialogPopup = function (type) {\n        var content = '';\n        this.element.querySelector('#' + this.element.id + '_dialog').style.display = 'block';\n        var headerObj;\n        var okObj = { key: 'DlgOK' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: okObj } });\n        if (type === 'multi-select-image') {\n            headerObj = { key: 'ImageErrorDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'ImageErrorDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            content = '<span>' + contentObj['value'] + '</span>';\n        }\n        else {\n            headerObj = { key: 'AlertDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'AlertDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            var supportObj = { key: 'SupportText' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n            content = '<span>' + contentObj['value'] + ' ' + supportObj['value'] + '<b> JPG, PNG, and SVG</b></span>';\n        }\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: content,\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: okObj['value'] }\n                }\n            ]\n        });\n        dialog.appendTo('#' + this.element.id + '_dialog');\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        EventHandler.add(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'wireEvent', onPropertyChange: false });\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(this.upperCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        EventHandler.remove(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        window.removeEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.removeEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'unWireEvent', onPropertyChange: false });\n        this.notify('selection', { prop: 'unWireEvent', onPropertyChange: false });\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        this.element.style.boxSizing = 'border-box';\n        var obj = { toolbarHeight: 0 };\n        this.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n        var height = obj['toolbarHeight'];\n        if (this.toolbar && this.toolbar.length > 0 && this.toolbar.indexOf('Open') === -1) {\n            height = 0;\n        }\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height - 2) + 'px; width:' +\n                    (this.element.offsetWidth - 2)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        var dragObj = { key: 'DragText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dragObj } });\n        var dropObj = { key: 'DropText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dropObj } });\n        var browseObj = { key: 'BrowseText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: browseObj } });\n        var supportObj = { key: 'SupportText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n        var dropAreaElement = this.createElement('div', { id: this.element.id + '_dropArea', className: 'e-ie-drop-area', attrs: { style: 'position: relative;' } });\n        var dropIconElement = this.createElement('span', { className: 'e-ie-drop-icon e-icons e-image', attrs: { style: 'position: absolute;' } });\n        var dropContentElement = this.createElement('span', { className: 'e-ie-drop-content', attrs: { style: 'position: absolute; display: none;' } });\n        dropContentElement.textContent = dragObj['value'] + ' ';\n        var minDropContentElem = this.createElement('span', { className: 'e-ie-min-drop-content', attrs: { style: 'position: absolute;' } });\n        minDropContentElem.textContent = dropObj['value'] + ' ';\n        var dropAnchorElement = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        dropAnchorElement.textContent = browseObj['value'];\n        var minDropAnchorElem = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        minDropAnchorElem.textContent = browseObj['value'];\n        dropContentElement.appendChild(dropAnchorElement);\n        minDropContentElem.appendChild(minDropAnchorElem);\n        dropAnchorElement.href = '';\n        minDropAnchorElem.href = '';\n        var dropInfoElement = this.createElement('span', { className: 'e-ie-drop-info', attrs: { position: 'absolute' } });\n        dropInfoElement.textContent = supportObj['value'] + ' SVG, PNG, and JPG';\n        var dropUploader = dropAreaElement.appendChild(this.createElement('input', {\n            id: this.element.id + '_dropfileUpload', className: 'e-fileUpload e-image-upload'\n        }));\n        dropUploader.setAttribute('type', 'file');\n        dropUploader.setAttribute('accept', 'image/*');\n        dropAreaElement.appendChild(dropIconElement);\n        dropAreaElement.appendChild(dropContentElement);\n        dropAreaElement.appendChild(minDropContentElem);\n        dropAreaElement.appendChild(dropInfoElement);\n        canvasWrapper.appendChild(dropAreaElement);\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.baseImgCanvas = this.createElement('canvas', {\n            id: this.element.id + '_baseImgCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textArea = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textArea', className: 'e-textarea', attrs: { name: 'textArea' }\n        }));\n        var dialog = this.element.appendChild(this.createElement('div', {\n            id: this.element.id + '_dialog', className: 'e-dialog'\n        }));\n        dialog.style.display = 'none';\n        var uploader = this.element.appendChild(this.createElement('input', {\n            id: this.element.id + '_fileUpload', className: 'e-fileUpload'\n        }));\n        uploader.setAttribute('type', 'file');\n        uploader.setAttribute('accept', 'image/*');\n        uploader.style.display = 'none';\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.style.lineHeight = 'normal';\n        this.lowerCanvas.style.width = this.upperCanvas.style.width = this.inMemoryCanvas.style.width = '100%';\n        this.lowerCanvas.style.height = this.upperCanvas.style.height = this.inMemoryCanvas.style.height = '100%';\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.textArea.style.position = 'absolute';\n        this.textArea.style.backgroundColor = 'transparent';\n        this.textArea.style.display = 'none';\n        this.textArea.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = this.cursor = 'default';\n        this.upperCanvas.style.display = 'block';\n        this.upperContext = this.upperCanvas.getContext('2d');\n        dropAnchorElement.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n        minDropAnchorElem.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        this.notify('selection', { prop: 'touchStartHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseMoveEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseUpEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        this.notify('selection', { prop: 'keyDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        // eslint-disable-next-line\n        if ((this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block')\n            && e.target.id === this.element.id + '_textArea') {\n            this.notify('selection', { prop: 'textKeyDown', value: { e: e } });\n        }\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseDownHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseMoveHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseUpHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.handleScroll = function (e) {\n        this.notify('selection', { prop: 'handleScroll', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        this.update();\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice && this.element.classList.contains('e-image-editor')) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.notifyResetForAllModules = function () {\n        var modules = this.requiredModules();\n        for (var i = 0; i < modules.length; i++) {\n            var module = modules[i].member;\n            this.notify(module === 'toolbar-module' ? 'toolbar' : module, { prop: 'reset', onPropertyChange: false });\n        }\n    };\n    ImageEditor.prototype.allowShape = function (x, y) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n            value: { x: x, y: y, obj: obj } });\n        return obj['inRange'];\n    };\n    /**\n     * Clears the current selection performed in the image editor.\n     *\n     * @param { boolean } resetCrop - Specifies to reset last cropped image.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function (resetCrop) {\n        this.notify('selection', { prop: 'clearSelection', onPropertyChange: false, value: { resetCrop: resetCrop } });\n    };\n    /**\n     * Crops an image based on the selection done in the image editor.\n     *\n     * {% codeBlock src='image-editor/crop/index.md' %}{% endcodeBlock %}\n     *\n     * @remarks\n     * The selection can be done through programmatically using the 'select' method or through UI interactions.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.crop = function () {\n        var obj = { isCrop: false };\n        this.notify('crop', { prop: 'crop', onPropertyChange: false, value: { obj: obj } });\n        return obj['isCrop'];\n    };\n    /**\n     * Flips an image by horizontally or vertically in the image editor.\n     *\n     * {% codeBlock src='image-editor/zoom/index.md' %}{% endcodeBlock %}\n     *\n     * @param { Direction } direction - Specifies the direction to flip the image.\n     * A horizontal direction for horizontal flipping and vertical direction for vertical flipping.\n     *\n     * @remarks\n     * It flips the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        this.notify('transform', { prop: 'flip', value: { direction: direction } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n    };\n    /**\n     * Returns an image as ImageData to load it in to a canvas.\n     *\n     * @remarks\n     * The data returned from this method is directly drawn in a canvas using 'putImageData' method.\n     * And then the user can get the base64 string from the canvas using toDataURL method.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function () {\n        var obj = { canvas: null };\n        var dummyObj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: dummyObj } });\n        if (dummyObj['bool'] || this.togglePen || this.activeObj.shape) {\n            this.okBtn();\n        }\n        this.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        return obj['canvas'].getContext('2d').getImageData(0, 0, obj['canvas'].width, obj['canvas'].height);\n    };\n    /**\n     *  Opens an image as URL or ImageData for editing in an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the image or image data.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        document.getElementById(this.element.id + '_dropArea').style.display = 'none';\n        this.notify('draw', { prop: 'open', value: { data: data } });\n    };\n    /**\n     * Reset all the changes done in an image editor and revert to original image.\n     *\n     * @remarks\n     * The undo redo collection also cleared while resetting the image editor.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        var obj = { isErrorImage: false };\n        this.notify('draw', { prop: 'getErrorImage', value: { obj: obj } });\n        if (!this.disabled && !obj['isErrorImage']) {\n            this.clearContext(this.inMemoryContext);\n            this.clearContext(this.lowerContext);\n            this.clearContext(this.upperContext);\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                this.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            var isImageLoaded = this.isImageLoaded;\n            this.currObjType.isUndoAction = this.isUndoRedo = this.togglePan = this.togglePen = this.isImageLoaded = this.isFinetuning = false;\n            this.isCircleCrop = this.isCropTab = false;\n            this.objColl = [];\n            this.transform.degree = 0;\n            this.upperCanvas.style.display = 'block';\n            this.transform.currFlipState = '';\n            this.allowDownScale = true;\n            this.upperCanvas.style.cursor = this.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.frameDestPoints = null;\n            this.textArea.value = this.textArea.textContent = '';\n            this.textArea.style.display = 'none';\n            this.lowerContext.filter = this.canvasFilter = this.getDefaultFilter();\n            this.img.destLeft = this.img.destTop = this.img.srcLeft = this.img.srcTop = 0;\n            this.img.destWidth = this.img.destHeight = this.img.srcWidth = this.img.srcHeight = null;\n            this.currSelectionPoint = null;\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.rotateFlipColl = [];\n            this.points = [];\n            this.pointColl = {};\n            this.freehandCounter = 0;\n            this.notify('draw', { prop: 'resetPanPoints' });\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = '';\n            this.fontSizeColl = [];\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = '';\n            this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = '';\n            this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = '';\n            this.transform.defaultZoomFactor = this.transform.zoomFactor = 0;\n            this.transform.cropZoomFactor = null;\n            this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false, isUndoZoom: false,\n                isUndoAction: false, isFiltered: false, isSave: false, isResize: false };\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n            this.afterCropActions = [];\n            this.currentFilter = '';\n            this.tempFrameZoomLevel = null;\n            this.cxtTbarHeight = null;\n            this.straightenPoint = null;\n            this.transform.straighten = 0;\n            this.cancelCropSelection = null;\n            this.aspectWidth = this.aspectHeight = null;\n            this.isResize = false;\n            var obj_1 = { initialZoomValue: false };\n            this.notify('draw', { prop: 'getInitialZoomValue', onPropertyChange: false, value: { obj: obj_1 } });\n            if (obj_1['initialZoomValue']) {\n                this.setProperties({ zoomSettings: { zoomFactor: obj_1['initialZoomValue'] } }, true);\n            }\n            var qtArea = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                qtArea.style.display = 'none';\n            }\n            this.notifyResetForAllModules();\n            this.notify('filter', { prop: 'update-finetunes' });\n            if (this.toolbarTemplate) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbarArea').clientHeight;\n            }\n            else if (this.element.querySelector('#' + this.element.id + '_toolbar')) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbar').clientHeight;\n            }\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this.isImageLoaded = isImageLoaded;\n            this.straightenBaseImageCanvas();\n            this.isImageLoaded = false;\n            this.notify('draw', { prop: 'update-canvas', onPropertyChange: false });\n            this.isImageLoaded = isImageLoaded;\n            this.prevStraightenedDegree = 0;\n            var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n            if (ctWrapper) {\n                ctWrapper.classList.add('e-hide');\n            }\n            this.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n            this.notify('toolbar', { prop: 'enable-disable-btns' });\n            var straightenObj = { bool: this.isStraightening };\n            if (Browser.isDevice && straightenObj['bool']) {\n                this.notify('crop', { prop: 'resizeWrapper' });\n            }\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * {% codeBlock src='image-editor/rotate/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * A positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @remarks\n     * It rotated the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var obj = { isRotate: false };\n        if (degree === 90 || degree === -90) {\n            this.updateImageTransformColl(degree === 90 ? 'rotateright' : 'rotateleft');\n        }\n        this.notify('transform', { prop: 'rotate', value: { degree: degree, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return obj['isRotate'];\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName – Specifies a file name to be saved\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName) {\n        this.notify('export', { prop: 'export', onPropertyChange: false, value: { type: type, fileName: fileName } });\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * {% codeBlock src='image-editor/select/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX – Specifies the start x-coordinate point of the selection.\n     * @param {number} startY – Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + type } });\n        this.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        if ((startX && startY) || (width && height)) {\n            this.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        }\n        else {\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing option in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @returns {void}.\n     * @private\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: value } });\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @remarks\n     * User can directly drawing on a canvas after enabling this option.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.freehandDraw = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.freeHandDraw(value);\n        }\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     * @param {number} x - Optional, Specifies a value to pan the image horizontally.\n     * @param {number} y - Optional, Specifies a value to pan the image vertically.\n     *\n     * @remarks\n     * This option will take into effect once the image's visibility is hidden when zooming an image or selection has been performed.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value, x, y) {\n        this.notify('transform', { prop: 'pan', onPropertyChange: false, value: { value: value, x: x, y: y } });\n    };\n    /**\n     * Zoom in or out on a point in the image editor.\n     *\n     * @param {number} zoomFactor - The percentage-based zoom factor to use (e.g. 20 for 2x zoom).\n     * @param {Point} zoomPoint - The point in the image editor to zoom in/out on.\n     *\n     * @remarks\n     * Zooming directly enables the panning option when the image's visibility is hidden.\n     * User can disable it by using 'Pan' method.\n     * @returns {void}\n     *\n     */\n    ImageEditor.prototype.zoom = function (zoomFactor, zoomPoint) {\n        this.isZoomBtnClick = true;\n        this.notify('transform', { prop: 'zoom', onPropertyChange: false,\n            value: { zoomFactor: zoomFactor, zoomPoint: zoomPoint } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * {% codeBlock src='image-editor/ellipse/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - Specifies the radius x point for the ellipse.\n     * @param {number} radiusY - Specifies the radius y point for the ellipse.\n     * @param {number} strokeWidth - Specifies the stroke width of ellipse.\n     * @param {string} strokeColor - Specifies the stroke color of ellipse.\n     * @param {string} fillColor - Specifies the fill color of the ellipse.\n     * @param {number} degree - Specifies the degree to rotate the ellipse.\n     * @param {boolean} isSelected - Specifies to show the ellipse in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        var isEllipse = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isEllipse = true;\n            this.notify('shape', { prop: 'drawEllipse', onPropertyChange: false, value: { x: x, y: y, radiusX: radiusX, radiusY: radiusY,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX – Specifies start point x-coordinate of line.\n     * @param {number} startY – Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @param {boolean} isSelected - Specifies to show the line in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        var isLine = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isLine = true;\n            this.notify('shape', { prop: 'drawLine', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isLine;\n    };\n    /**\n     * Draw arrow on an image.\n     *\n     * @param {number} startX – Specifies start point x-coordinate of arrow.\n     * @param {number} startY – Specifies start point y-coordinate of arrow.\n     * @param {number} endX - Specifies end point x-coordinates of arrow.\n     * @param {number} endY - Specifies end point y-coordinates of the arrow.\n     * @param {number} strokeWidth - Specifies the stroke width of arrow.\n     * @param {string} strokeColor - Specifies the stroke color of arrow.\n     * @param {ArrowheadType} arrowStart – Specifies the type of arrowhead for start position. The default value is ‘None’.\n     * @param {ArrowheadType} arrowEnd – Specifies the type of arrowhead for end position. The default value is ‘SolidArrow’.\n     * @param {boolean} isSelected - Specifies to show the arrow in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        var isArrow = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isArrow = true;\n            this.notify('shape', { prop: 'drawArrow', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, arrowStart: arrowStart, arrowEnd: arrowEnd,\n                    isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isArrow;\n    };\n    /**\n     * Draw path on an image.\n     *\n     * @param {Point[]} pointColl – Specifies collection of start and end x, y-coordinates of path.\n     * @param {number} strokeWidth - Specifies the stroke width of path.\n     * @param {string} strokeColor - Specifies the stroke color of path.\n     * @param {boolean} isSelected - Specifies to show the path in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        var isPath = false;\n        if (pointColl && pointColl.length > 0) {\n            for (var i = 0; i < pointColl.length; i++) {\n                if (obj['inRange']) {\n                    break;\n                }\n                this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n                    value: { x: pointColl[i].x, y: pointColl[i].y, obj: obj } });\n            }\n        }\n        if (!this.disabled && this.isImageLoaded && (obj['inRange'] || isNullOrUndefined(pointColl))) {\n            isPath = true;\n            this.notify('shape', { prop: 'drawPath', onPropertyChange: false, value: { pointColl: pointColl,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isPath;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - Specifies the fill color of the rectangle.\n     * @param {number} degree - Specifies the degree to rotate the rectangle.\n     * @param {boolean} isSelected - Specifies to show the rectangle in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        var isRectangle = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRectangle = true;\n            this.notify('shape', { prop: 'drawRectangle', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * {% codeBlock src='image-editor/text/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @param {boolean} isSelected - Specifies to show the text in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected) {\n        var isText = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isText = true;\n            this.notify('shape', { prop: 'drawText', onPropertyChange: false, value: { x: x, y: y, text: text, fontFamily: fontFamily,\n                    fontSize: fontSize, bold: bold, italic: italic, color: color, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isText;\n    };\n    /**\n     * Draw an image as annotation on an image.\n     *\n     *\n     * @param {string | ImageData} data - Specifies url of the image or image data.\n     * @param {number} x - Specifies x-coordinate of a starting point for an image.\n     * @param {number} y - Specifies y-coordinate of a starting point for an image.\n     * @param {number} width - Specifies the width of the image.\n     * @param {number} height - Specifies the height of the image.\n     * @param {boolean} isAspectRatio - Specifies whether to maintain aspect ratio or not.\n     * @param {number} degree - Specifies the degree to rotate the image.\n     * @param {number} opacity - Specifies the value for the image.\n     * @param {boolean} isSelected - Specifies to show the image in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawImage = function (data, x, y, width, height, isAspectRatio, degree, opacity, isSelected) {\n        var isImage = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            var length_1 = this.objColl.length;\n            this.notify('shape', { prop: 'drawImage', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    src: data, degree: degree, isAspectRatio: isAspectRatio, opacity: opacity, isSelected: isSelected } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            if (this.objColl.length > length_1) {\n                isImage = true;\n            }\n        }\n        return isImage;\n    };\n    /**\n     * Select a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/selectShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/deleteShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * {% codeBlock src='image-editor/getShapeSetting/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     *\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        var obj = { shapeDetails: null };\n        this.notify('shape', { prop: 'getShapeSetting', onPropertyChange: false,\n            value: { id: id, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var shapeDetails = obj['shapeDetails'] ? obj['shapeDetails'] : {};\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return obj['shapeDetailsColl'];\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        this.notify('transform', { prop: 'update' });\n    };\n    /**\n     * Finetuning an image with the given type of finetune and its value in the image editor.\n     *\n     * @param {ImageFinetuneOption } finetuneOption - Specifies the finetune options to be performed in the image.\n     * @param {number } value - Specifies the value for finetuning the image.\n     *\n     * @remarks\n     * The finetuning will not affect the shapes background and border color.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.finetuneImage = function (finetuneOption, value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.notify('filter', { prop: 'finetuneImage', value: { value: value, option: finetuneOption } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n    };\n    /**\n     * Filtering an image with the given type of filters.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @remarks\n     * The filtering will not affect the shape's background and border color.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.applyImageFilter = function (filterOption) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.notify('filter', { prop: 'applyImageFilter', value: { option: filterOption.toString() } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.canvasFilter = this.lowerContext.filter;\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    /**\n     * Reverse the last action which performed by the user in the Image Editor.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.undo = function () {\n        this.notify('undo-redo', { prop: 'undo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Redo the last user action that was undone by the user or `undo` method.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.redo = function () {\n        this.notify('undo-redo', { prop: 'redo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Get the dimension of an image in the image editor such as x, y, width, and height.\n     * The method helps to get dimension after cropped an image.\n     *\n     * @returns {Dimension}.\n     * A Dimension object containing the x, y, width, and height of an image.\n     */\n    ImageEditor.prototype.getImageDimension = function () {\n        return { x: this.img.destLeft, y: this.img.destTop, width: this.img.destWidth, height: this.img.destHeight };\n    };\n    /**\n     * Resize an image by changing its width and height.\n     *\n     * @param {number} width - Specifies the width of an image.\n     * @param {number} height - Specifies the height of an image.\n     * @param {boolean} isAspectRatio - Specifies whether the scaling option is enabled or not.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the resizing operation.\n     */\n    ImageEditor.prototype.resize = function (width, height, isAspectRatio) {\n        var isResized = false;\n        if ((width.toString()).length <= 4 && (height.toString()).length <= 4) {\n            var destPoints = { startX: this.img.destLeft, startY: this.img.destTop, width: this.img.destWidth,\n                height: this.img.destHeight };\n            if (isAspectRatio) {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            var aspectRatioWidth = this.element.querySelector('#' + this.element.id + '_resizeWidth');\n            var aspectRatioHeight = this.element.querySelector('#' + this.element.id + '_resizeHeight');\n            if (aspectRatioWidth && aspectRatioHeight) {\n                getComponent(aspectRatioWidth, 'numerictextbox').value = Math.floor(width);\n                aspectRatioWidth.value = Math.floor(width).toString() + ' px';\n                getComponent(aspectRatioHeight, 'numerictextbox').value = Math.floor(height);\n                aspectRatioHeight.value = Math.floor(height).toString() + ' px';\n            }\n            this.notify('transform', { prop: 'resize', value: { width: width, height: height, isAspectRatio: isAspectRatio } });\n            if (destPoints.startX !== this.img.destLeft || destPoints.startY !== this.img.destTop ||\n                destPoints.width !== this.img.destWidth || destPoints.height !== this.img.destHeight) {\n                isResized = true;\n                this.okBtn();\n            }\n            else {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isResized;\n    };\n    /**\n     * Draw a frame on an image.\n     *\n     * @param { FrameType} frameType - Specifies the frame option to be drawn on an image.\n     * @param {string} color - Specifies the color of a frame on an image. The default value is ‘#fff’.\n     * @param {string} gradientColor - Specifies the gradient color of a frame on an image. The default value is ‘’.\n     * @param {number} size - Specifies the size of the frame as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 20 if not specified.\n     * @param {number} inset - Specifies the inset value for line, hook, and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} offset - Specifies the offset value for line and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} borderRadius - Specifies the border radius for line-type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {FrameLineStyle} frameLineStyle - Specifies the type of line to be drawn for line-type frames. Default to Solid if not specified.\n     * @param {number} lineCount - Specifies the number of lines for line-type frames. Defaults to 0 if not specified.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawFrame = function (frameType, color, gradientColor, size, inset, offset, borderRadius, frameLineStyle, lineCount) {\n        var isFrame = false;\n        var obj = { frameChangeEventArgs: null };\n        color = color ? color : '#fff';\n        gradientColor = gradientColor ? gradientColor : '';\n        size = size ? size : 20;\n        inset = inset ? inset : 0;\n        offset = offset ? offset : 0;\n        borderRadius = borderRadius ? borderRadius : 0;\n        frameLineStyle = frameLineStyle ? frameLineStyle : FrameLineStyle.Solid;\n        lineCount = lineCount ? lineCount : 0;\n        var prevFrameSettings = { type: this.toPascalCase(this.frameObj.type), color: this.frameObj.color,\n            gradientColor: this.frameObj.gradientColor, size: this.frameObj.size, inset: this.frameObj.inset,\n            offset: this.frameObj.offset, borderRadius: this.frameObj.radius,\n            frameLineStyle: this.toPascalCase(this.frameObj.border), lineCount: this.frameObj.amount };\n        extend(this.tempFrameObj, this.frameObj);\n        this.tempFrameZoomLevel = this.transform.zoomFactor;\n        this.frameDestPoints = extend({}, this.img, {}, true);\n        this.notify('toolbar', { prop: 'frameToolbarClick' });\n        this.frameObj.type = frameType.toLowerCase();\n        this.frameObj.color = color;\n        this.frameObj.gradientColor = gradientColor;\n        this.frameObj.size = size;\n        this.frameObj.inset = inset;\n        this.frameObj.offset = offset;\n        this.frameObj.radius = borderRadius;\n        this.frameObj.border = frameLineStyle.toLowerCase();\n        this.frameObj.amount = lineCount;\n        this.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n        if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                isFrame = true;\n                this.okBtn();\n            }\n            else {\n                this.tempFrameZoomLevel = null;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            extend(this.frameObj, this.tempFrameObj);\n            this.tempFrameZoomLevel = null;\n        }\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return isFrame;\n    };\n    /**\n     * Straightens an image by rotating it clockwise or counterclockwise.\n     *\n     * @param {number} degree - The degree value specifying the amount of rotation for straightening the image.\n     * Positive values indicate clockwise rotation, while negative values indicate counterclockwise rotation.\n     *\n     * @remarks\n     * The degree value should be within the range of -45 to +45 degrees for accurate straightening.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the straightening operation.\n     */\n    ImageEditor.prototype.straightenImage = function (degree) {\n        var isStraightened = false;\n        if (degree >= -45 && degree <= 45) {\n            isStraightened = true;\n            this.notify('transform', { prop: 'straightenImage', value: { degree: degree } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isStraightened;\n    };\n    /**\n     * This method is used to update the existing shapes by changing its height, width, color, and font styles in the component.\n     * Use 'getShapeSettings' method to get the shape which is then passed to change the options of a shape.\n     * {% codeBlock src='image-editor/updateShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ShapeSettings} setting - Specifies the shape settings to be updated for the shape on an image.\n     * @param {boolean} isSelected - Specifies to show the shape in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.updateShape = function (setting, isSelected) {\n        var obj = { isSelected: false };\n        var isTextArea = false;\n        var freehandObj = { bool: false };\n        if (isNullOrUndefined(setting.id)) {\n            if (setting.strokeColor) {\n                this.activeObj.strokeSettings.strokeColor = setting.strokeColor;\n            }\n            if (setting.fillColor) {\n                this.activeObj.strokeSettings.fillColor = setting.fillColor;\n            }\n            if (setting.strokeWidth) {\n                this.activeObj.strokeSettings.strokeWidth = setting.strokeWidth;\n            }\n            if (setting.type === 'FreehandDraw' && setting.strokeWidth) {\n                this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: setting.strokeWidth } });\n            }\n        }\n        else {\n            if (setting.type.toLowerCase() === 'text' && (this.textArea.style.display === 'block' ||\n                this.textArea.style.display === 'inline-block')) {\n                this.okBtn();\n                isTextArea = true;\n            }\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: setting.id, obj: obj } });\n            this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (obj['isSelected']) {\n                var tempFontSize = this.activeObj.textSettings.fontSize;\n                this.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: setting } });\n                if (this.activeObj.shape === 'text' && tempFontSize) {\n                    var diff = this.activeObj.textSettings.fontSize - tempFontSize;\n                    if (diff !== 0) {\n                        this.activeObj.activePoint.height += diff;\n                        this.activeObj.activePoint.startY -= (diff / 2);\n                        this.activeObj.activePoint.endY += (diff / 2);\n                        this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                                isMouseMove: null, x: null, y: null } });\n                    }\n                }\n                var activeObj = extend({}, this.activeObj, {}, true);\n                this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: null } });\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (activeObj.shape) {\n                    this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                }\n                if (this.activeObj.shape === 'text') {\n                    this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n                }\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                }\n                this.okBtn(isSelected);\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                }\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.notify('draw', { prop: 'redrawDownScale' });\n                if (isTextArea) {\n                    this.enableTextEditing();\n                }\n                if (isSelected) {\n                    this.selectShape(setting.id);\n                }\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Duplicates a shape based on the given shape ID in the ImageEditor.\n     * Use 'getShapeSettings' method to get the shape and then pass a shapeId from the returned shape to clone a shape.\n     *\n     * @param {string} shapeId - Specifies the shape id to clone a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.cloneShape = function (shapeId) {\n        var obj = { isSelected: false };\n        if (shapeId.split('_')[0] === 'shape') {\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: shapeId, obj: obj } });\n            if (obj['isSelected']) {\n                this.notify('toolbar', { prop: 'duplicateShape', onPropertyChange: false, value: { isPreventUndoRedo: false } });\n                this.okBtn();\n                this.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Update filter to the canvas in the ImageEditor.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @returns {string}.\n     *\n     */\n    ImageEditor.prototype.getImageFilter = function (filterOption) {\n        var canvas = this.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        this.notify('filter', { prop: 'updateAdj', value: { type: filterOption.toLowerCase(), value: null, isPreview: true, ctx: ctx } });\n        return ctx.filter;\n    };\n    /**\n     * Enable text area editing in the ImageEditor.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.enableTextEditing = function () {\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: false } });\n        this.activeObj = activeObj;\n        this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n    };\n    /**\n     * Specifies if it's possible to undo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canUndo = function () {\n        var canUndo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoIndex = object['index'];\n        if (undoRedoIndex > 0) {\n            canUndo = true;\n        }\n        return canUndo;\n    };\n    /**\n     * Specifies if it's possible to redo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canRedo = function () {\n        var canRedo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoColl = object['undoRedoColl'];\n        var undoRedoIndex = object['index'];\n        if (undoRedoColl && undoRedoColl.length > 0 && undoRedoIndex < undoRedoColl.length - 1) {\n            canRedo = true;\n        }\n        if (undoRedoIndex === undoRedoColl.length) {\n            canRedo = false;\n        }\n        else if (undoRedoIndex === 0 && undoRedoColl.length > 0) {\n            canRedo = true;\n        }\n        else if (undoRedoIndex > 0) {\n            canRedo = true;\n        }\n        return canRedo;\n    };\n    // Toolbar related codes\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.toolbarHeight = toolbarArea.clientHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.quickAccessToolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_quickAccessToolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_quickAccessToolbarArea');\n        if (this.quickAccessToolbarTemplate) {\n            this.qatFn = this.templateParser(this.quickAccessToolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (typeof template !== 'function' && document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    // Common codes for EJ2 and Blazor\n    ImageEditor.prototype.getTextFromId = function (id) {\n        var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n            '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n        return idToValue[\"\" + id];\n    };\n    ImageEditor.prototype.getFinetuneOption = function (type) {\n        var typeToOption = { 'brightness': ImageFinetuneOption.Brightness, 'contrast': ImageFinetuneOption.Contrast,\n            'hue': ImageFinetuneOption.Hue, 'saturation': ImageFinetuneOption.Saturation, 'opacity': ImageFinetuneOption.Opacity,\n            'blur': ImageFinetuneOption.Blur, 'exposure': ImageFinetuneOption.Exposure };\n        return typeToOption[\"\" + type];\n    };\n    ImageEditor.prototype.setPenStroke = function (args) {\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: parseInt(args, 10) } });\n    };\n    ImageEditor.prototype.updateFreehandDrawColorChange = function () {\n        var obj = { tempFreeHandDrawEditingStyles: null };\n        this.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n        this.notify('freehand-draw', { prop: 'color-change', value: { color: obj['tempFreeHandDrawEditingStyles'].strokeColor } });\n    };\n    ImageEditor.prototype.getUndoRedoColl = function () {\n        var obj = { undoRedoColl: null, index: null };\n        var undoRedoObj = { undoRedoStep: null };\n        var object = { appliedUndoRedoColl: [] };\n        this.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        obj['undoRedoColl'] = object['appliedUndoRedoColl'];\n        obj['index'] = undoRedoObj['undoRedoStep'];\n        return obj;\n    };\n    ImageEditor.prototype.updateImageTransformColl = function (type) {\n        var value;\n        if (type === 'rotateleft') {\n            value = -90;\n        }\n        else if (type === 'rotateright') {\n            value = 90;\n        }\n        else if (type === 'horizontalflip') {\n            value = 'horizontal';\n        }\n        else if (type === 'verticalflip') {\n            value = 'vertical';\n        }\n        for (var i = 0; i < this.objColl.length; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape === 'image' || shape === 'text') {\n                if (isNullOrUndefined(this.objColl[i].rotateFlipColl)) {\n                    this.objColl[i].rotateFlipColl = [];\n                }\n                this.objColl[i].rotateFlipColl.push(value);\n                var obj = { collection: this.objColl[i].rotateFlipColl };\n                this.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: this.objColl[i].rotateFlipColl, isRotateFlipCollection: false, obj: obj } });\n                this.objColl[i].rotateFlipColl = obj['collection'];\n            }\n        }\n    };\n    ImageEditor.prototype.setInitialZoomState = function () {\n        this.objColl.push(this.activeObj);\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        var isUndoRedo = this.isUndoRedo;\n        this.isCropTab = false;\n        this.isUndoRedo = true;\n        if (this.transform.cropZoomFactor && this.transform.cropZoomFactor > 0) {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -this.transform.cropZoomFactor, zoomPoint: null, isResize: true } });\n        }\n        else {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: Math.abs(this.transform.cropZoomFactor), zoomPoint: null, isResize: true } });\n        }\n        this.isUndoRedo = isUndoRedo;\n        this.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.transform.cropZoomFactor = 0;\n        this.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.objColl.pop();\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n    };\n    /**\n     * Set the old item Transform item state.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateCropTransformItems = function () {\n        this.prevCurrSelectionPoint = extend({}, this.currSelectionPoint, {}, true);\n        this.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n    };\n    /**\n     * Get the pascal case.\n     *\n     * @param { string } str - Specifies the string to convert to pascal case.\n     * @param { Object } obj - Specifies the string to convert to pascal case.\n     * @hidden\n     * @returns {string}.\n     * A pascal case string.\n     */\n    ImageEditor.prototype.toPascalCase = function (str, obj) {\n        var strArr = [];\n        if (!isNullOrUndefined(str)) {\n            strArr = str.toLowerCase().split('-');\n        }\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        if (obj) {\n            obj['maxText'] = strArr.join('');\n        }\n        return strArr.join('');\n    };\n    /**\n     * Get the font sizes.\n     *\n     * @hidden\n     * @returns {DropDownButtonItemModel[]}.\n     * A font size collections.\n     */\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.transform.degree === 0 || this.transform.degree % 180 === 0) {\n            fontSize = this.img.destWidth / 25;\n        }\n        else {\n            fontSize = this.img.destHeight / 25;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { boolean } isMouseDown - Specifies whether it is a mouse down.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.okBtn = function (isMouseDown) {\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-frame-wrapper');\n        }\n        var isCropSelection = false;\n        var splitWords;\n        this.isResizeOkBtn = true;\n        var aspectIcon = this.element.querySelector('#' + this.element.id + '_aspectratio');\n        var nonAspectIcon = this.element.querySelector('#' + this.element.id + '_nonaspectratio');\n        var blrAspRatElem = this.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n        var blrNAspRatElem = this.element.querySelector('.e-ie-toolbar-nonaspect-ratio-btn');\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        this.allowDownScale = true;\n        if ((this.activeObj.shape && this.activeObj.shape !== 'image' || this.togglePen) && !isCropSelection) {\n            var objt = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n            var shapeSettings = objt['shapeSettingsObj'];\n            if (this.togglePen) {\n                shapeSettings.type = ShapeType.FreehandDraw;\n            }\n            var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            this.trigger('shapeChange', shapeChangedArgs);\n        }\n        if (aspectIcon || nonAspectIcon) {\n            var obj_2 = { width: null, height: null };\n            this.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj_2 } });\n            var point = { x: obj_2['width'], y: obj_2['height'] };\n            var obj1 = { prevCropObj: this.prevCropObj };\n            var obj2 = { prevObj: this.prevObj };\n            if (point && point.x && point.y && obj1['prevCropObj'] && obj2['prevObj']) {\n                if (nonAspectIcon || (blrNAspRatElem && !blrNAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n                else if (aspectIcon || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                this.isResize = false;\n                this.aspectWidth = point.x;\n                this.aspectHeight = point.y;\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -this.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                if (obj2['prevObj'].zoomFactor) {\n                    this.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                }\n                this.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: this.zoomSettings.zoomFactor } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                        previousObj: obj2['prevObj'], previousObjColl: obj2['prevObj']['objColl'],\n                        previousPointColl: obj2['prevObj']['pointColl'], previousSelPointColl: obj2['prevObj']['selPointColl'],\n                        previousCropObj: obj1['prevCropObj'], previousText: null, currentText: null, previousFilter: null,\n                        isCircleCrop: null } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                var obj_3 = this.cancelCropSelection;\n                if ((obj_3 && (isNullOrUndefined(nonAspectIcon) || !nonAspectIcon))) {\n                    obj_3.previousObj.aspectWidth = obj_3.currentObj.aspectWidth = this.aspectWidth;\n                    obj_3.previousObj.aspectHeight = obj_3.currentObj.aspectHeight = this.aspectHeight;\n                    obj_3.previousCropObj = extend({}, this.cropObj, {}, true);\n                    obj_3.currentCropObj = extend({}, this.cropObj, {}, true);\n                    this.notify('draw', { prop: 'updateCropSelObj' });\n                }\n                this.cancelCropSelection = null;\n            }\n            else if (point && (point.x === 0 || point.y === 0)) {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            }\n            this.isAspectRatio = false;\n        }\n        var selElem = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        var frameObject = { bool: null };\n        this.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (selElem) {\n            this.currentFilter = selElem.children[0].children[0].id.replace('Canvas', '');\n        }\n        if (isCropSelection) {\n            if (this.transform.straighten !== 0 && (this.panPoint.totalPannedPoint.x !== 0 || this.panPoint.totalPannedPoint.y !== 0 ||\n                this.panPoint.totalPannedClientPoint.x !== 0 || this.panPoint.totalPannedClientPoint.y !== 0)) {\n                var temp = this.prevStraightenedDegree;\n                this.prevStraightenedDegree = this.transform.straighten;\n                this.setStraighten(this.transform.straighten - 3);\n                this.setStraighten(this.transform.straighten + 3);\n                this.prevStraightenedDegree = temp;\n            }\n            this.isCroppedEvent = this.crop();\n        }\n        else if (this.togglePen) {\n            this.freeHandDraw(false);\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            if (isNullOrUndefined(isMouseDown)) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if (document.querySelector('#' + this.element.id + '_sliderWrapper') || this.currObjType.isFiltered) {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n            var obj_4 = { value: null };\n            this.notify('draw', { prop: 'getTempAdjustmentValue', value: { obj: obj_4 } });\n            if (obj_4['value'] !== this.lowerContext.filter) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            if ((this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) ||\n                (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n                this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isMouseDown } });\n            }\n        }\n        else if (obj['bool']) {\n            this.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        else if ((this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) ||\n            (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n            if (this.activeObj.shape === 'image') {\n                this.notify('draw', { prop: 'setImageApply', onPropertyChange: false, value: { bool: true } });\n            }\n            this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isMouseDown } });\n        }\n        else {\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                var object = { currObj: {} };\n                this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                        operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                        previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                        previousCropObj: extend({}, this.cropObj, {}, true), previousText: null, currentText: null,\n                        previousFilter: null, isCircleCrop: null\n                    } });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                this.tempFrameObj = extend({}, this.frameObj, {}, true);\n            }\n            this.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        }\n        if (!obj['isCropToolbar']) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n        }\n        this.notify('draw', { prop: 'setNewPath', value: { bool: false } });\n        this.transform.zoomFactor = this.transform.defaultZoomFactor;\n        this.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        this.isResizeOkBtn = false;\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.isChangesSaved = false;\n    };\n    /**\n     * Set the temporary filter properties.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setTempFilterProperties = function () {\n        this.upperCanvas.style.display = 'block';\n        this.cropSelectedState();\n        var obj = { adjustmentLevel: null };\n        this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n            value: { obj: obj } });\n        this.lowerContext.filter = this.initialAdjustmentValue;\n        this.notify('draw', { prop: 'setTempAdjustmentValue', value: { tempAdjustmentValue: this.lowerContext.filter } });\n        this.notify('filter', { prop: 'setTempAdjustmentLevel', onPropertyChange: false,\n            value: { tempAdjustmentLevel: extend({}, obj['adjustmentLevel'], {}, true) } });\n        this.notify('draw', { prop: 'setTempFilter', value: { tempFilter: this.currentFilter } });\n        var undoRedoObj = { undoRedoStep: null };\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        this.notify('draw', { prop: 'setTempUndoRedoStep', value: { tempUndoRedoStep: undoRedoObj['undoRedoStep'] } });\n    };\n    /**\n     * To crop the selection.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.cropSelectedState = function () {\n        if (this.activeObj.shape && this.activeObj.shape.split('-')[0] === 'crop') {\n            this.okBtn();\n        }\n    };\n    /**\n     * Get the current canvas data.\n     *\n     * @hidden\n     * @returns {ImageData}.\n     * An ImageData returns the current canvas image data object.\n     */\n    ImageEditor.prototype.getCurrentCanvasData = function () {\n        var tempFrame = extend({}, this.frameObj, {}, true);\n        this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = this.canvasFilter = 'none';\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.add('e-hide');\n        }\n        var data = this.getImageData();\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-hide');\n        }\n        if (!Browser.isDevice) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: false } });\n        }\n        this.element.querySelector('#' + this.element.id + '_contextualToolbarArea').classList.remove('e-hide');\n        this.objColl = objColl;\n        this.pointColl = pointColl;\n        this.freehandCounter = pointColl.length;\n        this.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = this.canvasFilter = tempFilter;\n        this.frameObj = tempFrame;\n        return data;\n    };\n    /**\n     * To set current adjustment value\n     *\n     * @param { string } type - Specifies the type of adjustment.\n     * @param { number } value - Specifies the value to adjust.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setCurrAdjustmentValue = function (type, value) {\n        var finetuneValueChanging = { finetune: this.getFinetuneOption(type), value: value, cancel: false };\n        this.trigger('finetuneValueChanging', finetuneValueChanging);\n        if (finetuneValueChanging.cancel) {\n            return;\n        }\n        this.notify('filter', { prop: 'setCurrAdjValue', value: { type: type.toLowerCase(), value: value } });\n    };\n    /**\n     * Get the square point for path.\n     *\n     * @param { SelectionPoint } obj - Specifies the points of path.\n     * @hidden\n     * @returns {ActivePoint}.\n     * An ActivePoint object which returns the square point.\n     */\n    ImageEditor.prototype.getSquarePointForPath = function (obj) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        if (obj.pointColl.length > 0) {\n            point = { startX: obj.pointColl[0].x, startY: obj.pointColl[0].y, endX: obj.pointColl[0].x, endY: obj.pointColl[0].y };\n            for (var i = 1; i < obj.pointColl.length; i++) {\n                if (obj.pointColl[i].x < point.startX) {\n                    point.startX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y < point.startY) {\n                    point.startY = obj.pointColl[i].y;\n                }\n                if (obj.pointColl[i].x > point.endX) {\n                    point.endX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y > point.endY) {\n                    point.endY = obj.pointColl[i].y;\n                }\n            }\n            point.width = point.endX - point.startX;\n            point.height = point.endY - point.startY;\n        }\n        return point;\n    };\n    /**\n     * Get the SelectionType.\n     *\n     * @param { string } type - Specifies the SelectionType.\n     * @hidden\n     * @returns {string}.\n     * An string which returns the SelectionType.\n     */\n    ImageEditor.prototype.getSelectionType = function (type) {\n        type = type === 'crop-custom' ? 'CropCustom' : type;\n        var typeToSelectionType = { 'CropCustom': 'Custom', 'CropSquare': 'Square', 'CropCircle': 'Circle',\n            'Crop3:2': '3:2', 'Crop4:3': '4:3', 'Crop5:4': '5:4', 'Crop7:5': '7:5', 'Crop16:9': '16:9',\n            'Crop2:3': '2:3', 'Crop3:4': '3:4', 'Crop4:5': '4:5', 'Crop5:7': '5:7', 'Crop9:16': '9:16' };\n        return typeToSelectionType[\"\" + type];\n    };\n    /** Clears the context.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearContext = function (ctx) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.clearRect(0, 0, ctx.canvas.height, ctx.canvas.width);\n    };\n    /**\n     * Apply Arrow for start and end.\n     *\n     * @param { string } type - Specifies the start arrow or end arrow.\n     * @param { string } id - Specifies the start arrow or end arrow item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateArrow = function (type, id) {\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.objColl.pop();\n        if (type === 'startArrow') {\n            this.activeObj.start = this.getTextFromId(id);\n        }\n        else if (type === 'endArrow') {\n            this.activeObj.end = this.getTextFromId(id);\n        }\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        if (Browser.isDevice) {\n            if (document.getElementById(this.element.id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                toolbar_1.refreshOverflow();\n            }\n        }\n        else {\n            if (document.getElementById(this.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_2 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                toolbar_2.refreshOverflow();\n            }\n        }\n        var shapeChangedArgs = { action: type, currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Font style for text.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontFamily = function (id) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var objColl = extend([], this.objColl, [], true);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            var width = this.activeObj.activePoint.width +\n                this.activeObj.textSettings.fontSize * 0.25;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.fontFamily = this.toPascalCase(id);\n            this.activeObj.textSettings.fontFamily = temp;\n            this.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                value: { isTextBox: null } });\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontFamily = this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: fontFamily, fontSize: null } });\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: objColl,\n                        previousPointColl: extend([], this.pointColl, [], true),\n                        previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-family', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontFamily = this.textArea.style.fontFamily;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Font size for text.\n     *\n     * @param { string } text - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontSize = function (text) {\n        var itemText = text;\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            var textStyle = '';\n            if (this.textArea.style.fontWeight === 'bold') {\n                textStyle = 'bold ';\n            }\n            if (this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic ';\n            }\n            if (this.textArea.style.fontWeight === 'bold' && this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic bold ';\n            }\n            this.upperContext.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.textArea.style.fontFamily;\n            var rows = this.textArea.value.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: true, text: null, obj: obj } });\n            var text_1 = obj['maxText'];\n            var width = this.upperContext.measureText(text_1).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25) + 'px';\n            this.activeObj.textSettings.fontSize = temp;\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            this.textArea.style.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10) + 'px';\n            if (this.textArea.style.fontFamily === 'georgia') {\n                this.textArea.style.width = parseFloat(this.textArea.style.width) + parseFloat(this.textArea.style.fontSize) + 'px';\n            }\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontSize = this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: null, fontSize: fontSize } });\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            var rows = this.activeObj.keyHistory.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: null, text: null, obj: obj } });\n            var text_2 = obj['maxText'];\n            var width = this.upperContext.measureText(text_2).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = rows.length * (this.activeObj.textSettings.fontSize +\n                this.activeObj.textSettings.fontSize * 0.25);\n            this.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n                value: { width: width, height: height } });\n            this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-size', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontSize = this.activeObj.textSettings.fontSize;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontColor = function (value) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'none') {\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                    strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            if (!this.togglePen) {\n                this.objColl.push(this.activeObj);\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                }\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.textArea.style.color = value;\n            var temp = this.activeObj.strokeSettings.strokeColor;\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            this.activeObj.strokeSettings.strokeColor = temp;\n        }\n        else if (!this.togglePen) {\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fillColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Pen stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeWidth = function (id) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.setPenStroke(id);\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var obj_5 = { penStrokeWidth: null };\n            this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_5 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            var indexObj = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            this.pointColl[indexObj['freehandSelectedIndex']].strokeWidth = obj_5['penStrokeWidth'];\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Pen stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeColor = function (value) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.activeObj.strokeSettings.strokeColor = value;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            // Temporary delete the selected freehand drawing from the collection\n            var count = 0;\n            var temp_1 = extend({}, this.pointColl, {}, true);\n            for (var i = 0; i < this.freehandCounter; i++) {\n                if (parseInt(temp_1[i].id.split('_')[1], 10) - 1 !== indexObj['freehandSelectedIndex']) {\n                    this.pointColl[count] = temp_1[i];\n                    count++;\n                }\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.pointColl = temp_1;\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: null } });\n        }\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var indexObj_1 = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj_1 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.pointColl[indexObj_1['freehandSelectedIndex']].strokeColor = value;\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: value } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        else if (!this.togglePen) {\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.activeObj } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Shape stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeWidth = function (id) {\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            var obj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n            this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10);\n            if (this.activeObj.shape === 'rectangle' || this.activeObj.shape === 'ellipse') {\n                this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10) - 1;\n            }\n            this.activeObj.strokeSettings.strokeWidth *= 2;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                    strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n            this.trigger('shapeChange', shapeChangedArgs);\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10);\n            this.activeObj.strokeSettings.strokeWidth *= 2;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                    strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        }\n    };\n    /**\n     * Apply Shape stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeColor = function (value) {\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            if (!this.togglePen) {\n                this.objColl.push(this.activeObj);\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                }\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n        }\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply Shape fill color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFillColor = function (value) {\n        var obj = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.activeObj.strokeSettings.fillColor = value;\n        this.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: null, strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor,\n                strokeWidth: null } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        var shapeChangedArgs = { action: 'fill-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n    };\n    /**\n     * Apply horizontal flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.horizontalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageHFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply vertical flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.verticalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageVFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply rotate image.\n     *\n     * @param { string } rotate - Specifies the direction of rotation.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.rotateImage = function (rotate) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(this.activeObj.imageRatio)) {\n            this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        if (rotate === 'rotleft') {\n            this.activeObj.rotatedAngle -= (90 * (Math.PI / 180));\n        }\n        else {\n            this.activeObj.rotatedAngle += (90 * (Math.PI / 180));\n        }\n        this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.activeObj } });\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'imageRotate', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n        this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n    };\n    /**\n     * Get pascalToSplitWords from string.\n     *\n     * @param { string } str - Specifies the word.\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.pascalToSplitWords = function (str) {\n        str = str.charAt(0).toUpperCase() + str.slice(1);\n        var splitStr = str.match(/[A-Z][a-z]+/g);\n        if (isNullOrUndefined(splitStr)) {\n            return str;\n        }\n        else {\n            return splitStr.map(function (word) { return word.charAt(0).toUpperCase() + word.slice(1); }).join(' ');\n        }\n    };\n    /**\n     * Get Slider Value.\n     *\n     * @param { string } type - Finetune type.\n     * @hidden\n     * @returns {number}.\n     */\n    ImageEditor.prototype.getCurrAdjustmentValue = function (type) {\n        var value = 100;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (type === 'transparency' && this.togglePen) {\n            var obj = { penOpacity: 1 };\n            this.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n            value = obj['penOpacity'] * 100;\n        }\n        else if (type === 'transparency' && indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            value = this.pointColl[indexObj['freehandSelectedIndex']].opacity * 100;\n        }\n        else {\n            var obj = { adjustmentLevel: null };\n            this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n                value: { obj: obj } });\n            var typeToAdjustmentLevel = { 'brightness': obj['adjustmentLevel'].brightness,\n                'contrast': obj['adjustmentLevel'].contrast, 'hue': obj['adjustmentLevel'].hue,\n                'saturation': obj['adjustmentLevel'].saturation, 'opacity': obj['adjustmentLevel'].opacity,\n                'blur': obj['adjustmentLevel'].blur, 'exposure': obj['adjustmentLevel'].exposure,\n                'transparency': obj['adjustmentLevel'].transparency, 'straighten': this.transform.straighten };\n            value = typeToAdjustmentLevel[\"\" + type];\n        }\n        return value;\n    };\n    /**\n     * Apply transformSelect.\n     *\n     * @param { string } type - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.transformSelect = function (type) {\n        if (this.transform.straighten === 0 && (type === 'rotateleft' || type === 'rotateright') &&\n            this.activeObj.shape && ['crop-2:3', 'crop-3:2', 'crop-3:4', 'crop-4:3', 'crop-4:5', 'crop-5:4', 'crop-5:7', 'crop-7:5',\n            'crop-9:16', 'crop-16:9'].indexOf(this.activeObj.shape) !== -1) {\n            this.activeObj.shape = 'crop-' + this.activeObj.shape.split('-')[1].split(':')[1] + ':' + this.activeObj.shape.split('-')[1].split(':')[0];\n            this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: this.activeObj.shape, isTransform: true } });\n        }\n        this.isCropToolbar = true;\n        this.allowDownScale = false;\n        var straighten = this.transform.straighten;\n        var straightenObj = extend({}, this.activeObj, {}, true);\n        var zoomFactor = this.transform.zoomFactor;\n        this.prevEventSelectionPoint = extend({}, this.activeObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevEventObjPoint = object['currObj'];\n        this.prevEventObjPoint.objColl = extend([], this.objColl, [], true);\n        this.prevEventObjPoint.pointColl = extend([], this.pointColl, [], true);\n        this.prevEventObjPoint.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevEventObjPoint.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (this.transform.straighten !== 0) {\n            this.transform.straighten = 0;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle -= (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            this.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        this.setInitialZoomState();\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: true } });\n        this.cropSelectedState();\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: false } });\n        this.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n        this.updateImageTransformColl(type);\n        this.notify('transform', { prop: 'performTransformation', value: { text: type } });\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'moveToSelectionRange', value: { type: type, activeObj: activeObj } });\n        if (this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) {\n            this.notify('draw', { prop: 'resetStraightenDestPoints' });\n            this.notify('draw', { prop: 'setDestForStraighten' });\n        }\n        if (straighten !== 0) {\n            this.transform.straighten = straighten;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle += (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            this.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: straightenObj } });\n            this.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n            this.notify('draw', { prop: 'setStraightenInitZoom', value: { zoomFactor: zoomFactor } });\n            if ((this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) &&\n                isNullOrUndefined(this.transform.zoomFactor) || this.transform.zoomFactor === 0) {\n                if (this.transform.degree === 0) {\n                    this.transform.zoomFactor += 0.025;\n                }\n                else if (this.transform.zoomFactor === 0) {\n                    this.transform.zoomFactor = null;\n                }\n            }\n            this.notify('draw', { prop: 'zoomToSel', value: { activeObj: straightenObj, isToolbar: false } });\n        }\n        this.isCropToolbar = false;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = this.transform.straighten.toString() + '&#176';\n        }\n    };\n    /**\n     * Returns default filter.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.getDefaultFilter = function () {\n        return 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' +\n            'grayscale(0%) ' + 'invert(0%)';\n    };\n    /**\n     * Performs Straightening action.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setStraighten = function (value, isMethod) {\n        var straightenEventArgs = { cancel: false, previousDegree: this.transform.straighten, currentDegree: value };\n        this.trigger('rotating', straightenEventArgs);\n        if (!straightenEventArgs.cancel) {\n            this.performStraighten(straightenEventArgs);\n        }\n    };\n    ImageEditor.prototype.duplicateImage = function () {\n        var activePoint = extend({}, this.activeObj.activePoint, {}, true);\n        var dimObj = { width: 0, height: 0 };\n        this.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.activeObj.imageElement.width, height: this.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        this.activeObj.activePoint.width = dimObj['width'];\n        this.activeObj.activePoint.height = dimObj['height'];\n        return activePoint;\n    };\n    ImageEditor.prototype.performStraighten = function (straightenEventArgs) {\n        var value = straightenEventArgs.currentDegree;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = value.toString() + '&#176';\n        }\n        var prevValue = this.transform.straighten;\n        var obj = extend({}, this.activeObj, null, true);\n        this.notify('freehand-draw', { prop: 'setCenterSelPoints' });\n        this.transform.straighten = value;\n        this.straightenPoint = { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n            y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2) };\n        this.straightenBaseImageCanvas();\n        for (var i = 0, len = this.objColl.length; i < len; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                this.objColl[i].rotatedAngle += ((this.transform.straighten - this.prevStraightenedDegree) * (Math.PI / 180));\n                this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n            }\n        }\n        if (this.transform.degree % 90 === 0 && this.transform.degree % 180 !== 0) {\n            if (this.transform.straighten === 0) {\n                this.transform.straighten = 360;\n            }\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomIn', isResize: true } });\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomOut', isResize: true } });\n            if (this.transform.straighten === 360) {\n                this.transform.straighten = 0;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: null, isStraighten: true } });\n        }\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false,\n            value: { canvas: 'duplicate', obj: obj } });\n        this.notify('draw', { prop: 'zoomToSel', value: { activeObj: obj, isToolbar: true } });\n        this.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        this.prevStraightenedDegree = this.transform.straighten;\n    };\n    /**\n     * Straightens base image.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.straightenBaseImageCanvas = function () {\n        if (this.isImageLoaded) {\n            var flipState = this.getStraightenFlipState();\n            var straighten = flipState === 'horizontal' || flipState === 'vertical' ?\n                -this.transform.straighten : this.transform.straighten;\n            var ctx = this.baseImgCanvas.getContext('2d');\n            if (ctx.canvas.width !== this.lowerContext.canvas.width &&\n                ctx.canvas.height !== this.lowerContext.canvas.height) {\n                var obj_6 = { width: 0, height: 0 };\n                this.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                    value: { obj: obj_6, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n            }\n            var dimension = void 0;\n            dimension = this.getRotatedCanvasDim(this.baseImg.width, this.baseImg.height, this.transform.straighten);\n            this.img.srcWidth = ctx.canvas.width = dimension.width;\n            this.img.srcHeight = ctx.canvas.height = dimension.height;\n            var x = ctx.canvas.width / 2;\n            var y = ctx.canvas.height / 2;\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n            ctx.translate(x, y);\n            ctx.rotate(straighten * Math.PI / 180);\n            ctx.drawImage(this.baseImg, -this.baseImg.width / 2, -this.baseImg.height / 2, this.baseImg.width, this.baseImg.height);\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n            var obj = { width: 0, height: 0 };\n            this.notify('crop', { prop: 'calcRatio', onPropertyChange: false, value: { obj: obj, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n        }\n    };\n    /**\n     * Returns rotated canvas dimension.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.getRotatedCanvasDim = function (width, height, angle) {\n        var angleRad = angle * Math.PI / 180;\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var minX = Math.min(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var maxX = Math.max(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var minY = Math.min(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        var maxY = Math.max(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        return { width: Math.ceil(maxX - minX), height: Math.ceil(maxY - minY) };\n    };\n    ;\n    ImageEditor.prototype.getStraightenFlipState = function () {\n        var flipState = '';\n        if (this.rotateFlipColl.length > 0) {\n            for (var i = 0, len = this.rotateFlipColl.length; i < len; i++) {\n                var curFlip = this.rotateFlipColl[i];\n                if (curFlip === 'horizontal') {\n                    flipState += 'horizontal';\n                }\n                else if (curFlip === 'vertical') {\n                    flipState += 'vertical';\n                }\n                if (flipState === 'horizontalvertical' || flipState === 'verticalhorizontal') {\n                    flipState = '';\n                }\n            }\n        }\n        return flipState;\n    };\n    ImageEditor.prototype.initializeZoomSettings = function () {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (isNullOrUndefined(this.zoomSettings.zoomTrigger) || this.zoomSettings.zoomTrigger === 0) {\n            this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar | ZoomTrigger.Commands);\n        }\n        if (isNullOrUndefined(this.selectionSettings.strokeColor)) {\n            this.selectionSettings.strokeColor = this.themeColl[this.theme]['primaryColor'];\n        }\n        if (isNullOrUndefined(this.selectionSettings.fillColor)) {\n            this.selectionSettings.fillColor = this.themeColl[this.theme]['secondaryColor'];\n        }\n    };\n    ImageEditor.prototype.initializeThemeColl = function () {\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' },\n            Material3: { primaryColor: '#6750a4', secondaryColor: '#fff' },\n            Material3Dark: { primaryColor: '#d0bcff', secondaryColor: '#fff' }\n        };\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"showQuickAccessToolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"quickAccessToolbarTemplate\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Complex({}, FinetuneSettings)\n    ], ImageEditor.prototype, \"finetuneSettings\", void 0);\n    __decorate([\n        Complex({}, ZoomSettings)\n    ], ImageEditor.prototype, \"zoomSettings\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], ImageEditor.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, FontFamily)\n    ], ImageEditor.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"selectionChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"imageFiltering\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"finetuneValueChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"click\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChange\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarOpen\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"resizing\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarItemClick\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"frameChange\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(Component));\nexport { ImageEditor };\n","/**\n * An enum representing the file types supported by the image editor.\n *\n * @enum {string}\n */\nexport var FileType;\n(function (FileType) {\n    /** The PNG file type. */\n    FileType[\"Png\"] = \"Png\";\n    /** The JPEG file type. */\n    FileType[\"Jpeg\"] = \"Jpeg\";\n    /** The SVG file type. */\n    FileType[\"Svg\"] = \"Svg\";\n})(FileType || (FileType = {}));\n/**\n * An enumeration representing the direction of an image editor operation.\n *\n * @enum {string}\n */\nexport var Direction;\n(function (Direction) {\n    /** The horizontal direction. */\n    Direction[\"Horizontal\"] = \"Horizontal\";\n    /** The vertical direction. */\n    Direction[\"Vertical\"] = \"Vertical\";\n})(Direction || (Direction = {}));\n/**\n * An enumeration representing the type of shape to be added in the image editor.\n *\n * @enum {string}\n */\nexport var ShapeType;\n(function (ShapeType) {\n    /** A rectangle shape. */\n    ShapeType[\"Rectangle\"] = \"Rectangle\";\n    /** An ellipse shape. */\n    ShapeType[\"Ellipse\"] = \"Ellipse\";\n    /** A line shape. */\n    ShapeType[\"Line\"] = \"Line\";\n    /** An arrow shape. */\n    ShapeType[\"Arrow\"] = \"Arrow\";\n    /** A path shape. */\n    ShapeType[\"Path\"] = \"Path\";\n    /** A text shape. */\n    ShapeType[\"Text\"] = \"Text\";\n    /** A freehand drawing shape. */\n    ShapeType[\"FreehandDraw\"] = \"FreehandDraw\";\n    /** An Image shape. */\n    ShapeType[\"Image\"] = \"Image\";\n})(ShapeType || (ShapeType = {}));\n/**\n * An enumeration representing the different ways to trigger zooming in the image editor.\n *\n * @aspNumberEnum\n */\nexport var ZoomTrigger;\n(function (ZoomTrigger) {\n    /** Zooming triggered by mouse wheel. */\n    ZoomTrigger[ZoomTrigger[\"MouseWheel\"] = 1] = \"MouseWheel\";\n    /** Zooming triggered by pinch gesture. */\n    ZoomTrigger[ZoomTrigger[\"Pinch\"] = 2] = \"Pinch\";\n    /** Zooming triggered by command keys. */\n    ZoomTrigger[ZoomTrigger[\"Commands\"] = 4] = \"Commands\";\n    /** Zooming triggered by toolbar button click. */\n    ZoomTrigger[ZoomTrigger[\"Toolbar\"] = 8] = \"Toolbar\";\n})(ZoomTrigger || (ZoomTrigger = {}));\n/**\n * * An enum representing the available themes in the image editor.\n */\nexport var Theme;\n(function (Theme) {\n    /** The Bootstrap 5 theme. */\n    Theme[\"Bootstrap5\"] = \"Bootstrap5\";\n    /** The dark variant of the Bootstrap 5 theme. */\n    Theme[\"Bootstrap5Dark\"] = \"Bootstrap5Dark\";\n    /** The Tailwind CSS theme. */\n    Theme[\"Tailwind\"] = \"Tailwind\";\n    /** The dark variant of the Tailwind CSS theme. */\n    Theme[\"TailwindDark\"] = \"TailwindDark\";\n    /** The Fluent UI theme. */\n    Theme[\"Fluent\"] = \"Fluent\";\n    /** The dark variant of the Fluent UI theme. */\n    Theme[\"FluentDark\"] = \"FluentDark\";\n    /** The Bootstrap 4 theme. */\n    Theme[\"Bootstrap4\"] = \"Bootstrap4\";\n    /** The Bootstrap theme. */\n    Theme[\"Bootstrap\"] = \"Bootstrap\";\n    /** The dark variant of the Bootstrap theme. */\n    Theme[\"BootstrapDark\"] = \"BootstrapDark\";\n    /** The Material Design theme. */\n    Theme[\"Material\"] = \"Material\";\n    /** The dark variant of the Material Design theme. */\n    Theme[\"MaterialDark\"] = \"MaterialDark\";\n    /** The Fabric theme. */\n    Theme[\"Fabric\"] = \"Fabric\";\n    /** The dark variant of the Fabric theme. */\n    Theme[\"FabricDark\"] = \"FabricDark\";\n    /** The high contrast theme. */\n    Theme[\"Highcontrast\"] = \"Highcontrast\";\n})(Theme || (Theme = {}));\n/**\n * An enum representing the available toolbar commands in the image editor.\n */\nexport var ImageEditorCommand;\n(function (ImageEditorCommand) {\n    ImageEditorCommand[\"Crop\"] = \"Crop\";\n    ImageEditorCommand[\"Transform\"] = \"Transform\";\n    ImageEditorCommand[\"Annotate\"] = \"Annotate\";\n    ImageEditorCommand[\"ZoomIn\"] = \"ZoomIn\";\n    ImageEditorCommand[\"ZoomOut\"] = \"ZoomOut\";\n    ImageEditorCommand[\"Open\"] = \"Open\";\n    ImageEditorCommand[\"Reset\"] = \"Reset\";\n    ImageEditorCommand[\"Save\"] = \"Save\";\n    ImageEditorCommand[\"Pan\"] = \"Pan\";\n    ImageEditorCommand[\"Move\"] = \"Move\";\n    ImageEditorCommand[\"Pen\"] = \"Pen\";\n    ImageEditorCommand[\"Line\"] = \"Line\";\n    ImageEditorCommand[\"Arrow\"] = \"Arrow\";\n    ImageEditorCommand[\"Path\"] = \"Path\";\n    ImageEditorCommand[\"Rectangle\"] = \"Rectangle\";\n    ImageEditorCommand[\"Image\"] = \"Image\";\n    ImageEditorCommand[\"Ellipse\"] = \"Ellipse\";\n    ImageEditorCommand[\"Text\"] = \"Text\";\n    ImageEditorCommand[\"CustomSelection\"] = \"CustomSelection\";\n    ImageEditorCommand[\"CircleSelection\"] = \"CircleSelection\";\n    ImageEditorCommand[\"SquareSelection\"] = \"SquareSelection\";\n    ImageEditorCommand[\"RatioSelection\"] = \"RatioSelection\";\n    ImageEditorCommand[\"RotateLeft\"] = \"RotateLeft\";\n    ImageEditorCommand[\"RotateRight\"] = \"RotateRight\";\n    ImageEditorCommand[\"FlipHorizontal\"] = \"FlipHorizontal\";\n    ImageEditorCommand[\"FlipVertical\"] = \"FlipVertical\";\n    ImageEditorCommand[\"Undo\"] = \"Undo\";\n    ImageEditorCommand[\"Redo\"] = \"Redo\";\n    ImageEditorCommand[\"None\"] = \"None\";\n    ImageEditorCommand[\"Mat\"] = \"Mat\";\n    ImageEditorCommand[\"Bevel\"] = \"Bevel\";\n    ImageEditorCommand[\"Inset\"] = \"Inset\";\n    ImageEditorCommand[\"Hook\"] = \"Hook\";\n    ImageEditorCommand[\"Finetune\"] = \"Finetune\";\n    ImageEditorCommand[\"Filter\"] = \"Filter\";\n    ImageEditorCommand[\"Frame\"] = \"Frame\";\n    ImageEditorCommand[\"Resize\"] = \"Resize\";\n    ImageEditorCommand[\"HorizontalFlip\"] = \"HorizontalFlip\";\n    ImageEditorCommand[\"VerticalFlip\"] = \"VerticalFlip\";\n    ImageEditorCommand[\"Brightness\"] = \"Brightness\";\n    ImageEditorCommand[\"Contrast\"] = \"Contrast\";\n    ImageEditorCommand[\"Hue\"] = \"Hue\";\n    ImageEditorCommand[\"Saturation\"] = \"Saturation\";\n    ImageEditorCommand[\"Opacity\"] = \"Opacity\";\n    ImageEditorCommand[\"Blur\"] = \"Blur\";\n    ImageEditorCommand[\"Exposure\"] = \"Exposure\";\n    ImageEditorCommand[\"Default\"] = \"Default\";\n    ImageEditorCommand[\"Chrome\"] = \"Chrome\";\n    ImageEditorCommand[\"Cold\"] = \"Cold\";\n    ImageEditorCommand[\"Warm\"] = \"Warm\";\n    ImageEditorCommand[\"Grayscale\"] = \"Grayscale\";\n    ImageEditorCommand[\"Sepia\"] = \"Sepia\";\n    ImageEditorCommand[\"Invert\"] = \"Invert\";\n    ImageEditorCommand[\"Straightening\"] = \"Straightening\";\n})(ImageEditorCommand || (ImageEditorCommand = {}));\n/**\n * An enumeration of available image filter options.\n *\n * @remarks\n * These options can be used with the `applyImageFilter` method of the image editor control to apply filters to an image.\n */\nexport var ImageFilterOption;\n(function (ImageFilterOption) {\n    /** Default filter */\n    ImageFilterOption[\"Default\"] = \"Default\";\n    /** Chrome filter */\n    ImageFilterOption[\"Chrome\"] = \"Chrome\";\n    /** Cold filter */\n    ImageFilterOption[\"Cold\"] = \"Cold\";\n    /** Warm filter */\n    ImageFilterOption[\"Warm\"] = \"Warm\";\n    /** Grayscale filter */\n    ImageFilterOption[\"Grayscale\"] = \"Grayscale\";\n    /** Sepia filter */\n    ImageFilterOption[\"Sepia\"] = \"Sepia\";\n    /** Invert filter */\n    ImageFilterOption[\"Invert\"] = \"Invert\";\n})(ImageFilterOption || (ImageFilterOption = {}));\n/**\n * An enumeration of available image finetune options.\n *\n * @remarks\n * These options can be used with the `finetuneImage` method of the image editor control to apply finetuning to an image.\n */\nexport var ImageFinetuneOption;\n(function (ImageFinetuneOption) {\n    /** Adjust the brightness of the image */\n    ImageFinetuneOption[\"Brightness\"] = \"Brightness\";\n    /** Adjust the contrast of the image */\n    ImageFinetuneOption[\"Contrast\"] = \"Contrast\";\n    /** Adjust the hue of the image */\n    ImageFinetuneOption[\"Hue\"] = \"Hue\";\n    /** Adjust the saturation of the image */\n    ImageFinetuneOption[\"Saturation\"] = \"Saturation\";\n    /** Adjust the exposure of the image */\n    ImageFinetuneOption[\"Exposure\"] = \"Exposure\";\n    /** Adjust the opacity of the image */\n    ImageFinetuneOption[\"Opacity\"] = \"Opacity\";\n    /** Adjust the blur of the image */\n    ImageFinetuneOption[\"Blur\"] = \"Blur\";\n})(ImageFinetuneOption || (ImageFinetuneOption = {}));\n/**\n * Specifies the type of arrowhead should be drawn.\n *\n */\nexport var ArrowheadType;\n(function (ArrowheadType) {\n    /** Indicates no arrowhead should be drawn. */\n    ArrowheadType[\"None\"] = \"None\";\n    /** Indicates a normal triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Arrow\"] = \"Arrow\";\n    /** Indicates a solid triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidArrow\"] = \"SolidArrow\";\n    /** Indicates a circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Circle\"] = \"Circle\";\n    /** Indicates a solid circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidCircle\"] = \"SolidCircle\";\n    /** Indicates a square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Square\"] = \"Square\";\n    /** Indicates a solid square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidSquare\"] = \"SolidSquare\";\n    /** Indicates a bar shaped arrowhead should be drawn. */\n    ArrowheadType[\"Bar\"] = \"Bar\";\n})(ArrowheadType || (ArrowheadType = {}));\n/**\n * An enumeration of available frame options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameType;\n(function (FrameType) {\n    /** Represents a no frame. */\n    FrameType[\"None\"] = \"None\";\n    /** Represents a mat frame. */\n    FrameType[\"Mat\"] = \"Mat\";\n    /** Represents a bevel frame. */\n    FrameType[\"Bevel\"] = \"Bevel\";\n    /** Represents a line frame. */\n    FrameType[\"Line\"] = \"Line\";\n    /** Represents an inset frame. */\n    FrameType[\"Inset\"] = \"Inset\";\n    /** Represents a hook frame. */\n    FrameType[\"Hook\"] = \"Hook\";\n})(FrameType || (FrameType = {}));\n/**\n * An enumeration of available line options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameLineStyle;\n(function (FrameLineStyle) {\n    /** Represents a solid line. */\n    FrameLineStyle[\"Solid\"] = \"Solid\";\n    /** Represents a dashed line. */\n    FrameLineStyle[\"Dashed\"] = \"Dashed\";\n    /** Represents a dotted line. */\n    FrameLineStyle[\"Dotted\"] = \"Dotted\";\n})(FrameLineStyle || (FrameLineStyle = {}));\n","import { extend, Browser, detach, select } from '@syncfusion/ej2-base';\nimport { EventHandler, getComponent, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader, Slider } from '@syncfusion/ej2-inputs';\nimport { ZoomTrigger, ShapeType } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar ToolbarModule = /** @class */ (function () {\n    function ToolbarModule(parent) {\n        this.defToolbarItems = [];\n        this.toolbarHeight = 46;\n        this.currToolbar = '';\n        this.preventZoomBtn = false;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        this.preventEnableDisableUr = false;\n        this.isAspectRatio = true;\n        this.isFrameToolbar = false;\n        this.presetColors = {\n            'custom': ['#000000', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                '#01579b', '#006064', '#004d40', '#f57f17']\n        };\n        this.parent = parent;\n        this.addEventListener();\n        this.initLocale();\n    }\n    ToolbarModule.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    ToolbarModule.prototype.addEventListener = function () {\n        this.parent.on('toolbar', this.toolbar, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    ToolbarModule.prototype.removeEventListener = function () {\n        this.parent.off('toolbar', this.toolbar);\n        this.parent.off('destroyed', this.destroy);\n    };\n    ToolbarModule.prototype.initLocale = function () {\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Undo: 'Undo',\n            Redo: 'Redo',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Finetune: 'Finetune',\n            Brightness: 'Brightness',\n            Contrast: 'Contrast',\n            Hue: 'Hue',\n            Saturation: 'Saturation',\n            Opacity: 'Opacity',\n            Blur: 'Blur',\n            Sharpen: 'Sharpen',\n            Exposure: 'Exposure',\n            Filter: 'Filter',\n            Default: 'Default',\n            Chrome: 'Chrome',\n            Cold: 'Cold',\n            Warm: 'Warm',\n            Grayscale: 'Grayscale',\n            BlackAndWhite: 'Black and White',\n            Sepia: 'Sepia',\n            Invert: 'Invert',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'Apply',\n            Cancel: 'Discard',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Arrow: 'Arrow',\n            Path: 'Path',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC',\n            Browse: 'Browse',\n            Duplicate: 'Duplicate',\n            Remove: 'Remove',\n            EditText: 'Edit Text',\n            Start: 'Start',\n            End: 'End',\n            Bar: 'Bar',\n            ArrowSolid: 'Arrow Solid',\n            CircleSolid: 'Circle Solid',\n            SquareSolid: 'Square Solid',\n            None: 'None',\n            CropAndTransform: 'Crop and Transform',\n            CropSelection: 'Crop Selection',\n            Image: 'Add Image',\n            Transparency: 'Transparency',\n            Height: 'Height',\n            Width: 'Width',\n            AspectRatio: 'Maintain aspect ratio',\n            W: 'W',\n            H: 'H',\n            DragText: 'Drag and drop your image here or',\n            DropText: 'Drop your image here or',\n            BrowseText: 'Browse here...',\n            SupportText: 'Supports:',\n            Frame: 'Frame',\n            Mat: 'Mat',\n            Bevel: 'Bevel',\n            Inset: 'Inset',\n            Hook: 'Hook',\n            Color: 'Color',\n            Size: 'Size',\n            Offset: 'Offset',\n            Radius: 'Radius',\n            Amount: 'Amount',\n            Resize: 'Resize',\n            0: '0%',\n            20: '20%',\n            40: '40%',\n            60: '60%',\n            80: '80%',\n            100: '100%',\n            1: '1',\n            2: '2',\n            3: '3',\n            4: '4',\n            5: '5',\n            Border: 'Border',\n            Solid: 'Solid',\n            Dashed: 'Dashed',\n            Dotted: 'Dotted',\n            GradientColor: 'Gradient Color',\n            ConfirmDialogHeader: 'Confirm Save Changes',\n            ConfirmDialogContent: 'Do you want to save the changes you made to the image?',\n            AlertDialogHeader: 'Unsupported file',\n            AlertDialogContent: 'The selected file is unsupported.',\n            Yes: 'Yes',\n            No: 'No',\n            ImageErrorDialogHeader: 'Image Selection Error',\n            ImageErrorDialogContent: 'Please select only one image to open.',\n            Straighten: 'Straighten',\n            NoOutline: 'No outline',\n            DlgOK: 'OK'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.parent.locale);\n    };\n    ToolbarModule.prototype.toolbar = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'create-toolbar':\n                this.createToolbar();\n                break;\n            case 'create-contextual-toolbar':\n                this.createContextualToolbar();\n                break;\n            case 'update-toolbar-items':\n                this.updateToolbarItems();\n                break;\n            case 'refresh-toolbar':\n                this.refreshToolbar(args.value['type'], args.value['isApplyBtn'], args.value['isCropping'], args.value['isZooming'], args.value['cType']);\n                break;\n            case 'renderQAT':\n                this.renderQAT(args.value['isPenEdit']);\n                break;\n            case 'enable-disable-btns':\n                this.enableDisableTbrBtn();\n                break;\n            case 'init-main-toolbar':\n                this.initMainToolbar(args.value['isApplyBtn'], args.value['isDevice'], args.value['isOkBtn'], args.value['isResize'], args.value['isFrame'], args.value['isMainToolbar']);\n                break;\n            case 'create-bottom-toolbar':\n                this.createBottomToolbar();\n                break;\n            case 'refresh-main-toolbar':\n                this.refreshMainToolbar();\n                break;\n            case 'create-qa-toolbar':\n                this.createQuickAccessToolbar();\n                break;\n            case 'destroy-qa-toolbar':\n                this.destroyQuickAccessToolbar();\n                break;\n            case 'zoom-up-handler':\n                this.zoomBtnMouseUpHandler();\n                break;\n            case 'refresh-dropdown-btn':\n                this.refreshDropDownBtn(args.value['isDisabled']);\n                break;\n            case 'close-contextual-toolbar':\n                this.closeContextualToolbar();\n                break;\n            case 'destroy-bottom-toolbar':\n                this.destroyBottomToolbar();\n                break;\n            case 'destroy-top-toolbar':\n                this.destroyTopToolbar();\n                break;\n            case 'destroySubComponents':\n                this.destroySubComponents();\n                break;\n            case 'setLocale':\n                this.l10n.setLocale(args.value['locale']);\n                break;\n            case 'setPreventZoomBtn':\n                this.preventZoomBtn = args.value['isPrevent'];\n                break;\n            case 'getToolbarHeight':\n                args.value['obj']['toolbarHeight'] = this.toolbarHeight;\n                break;\n            case 'setToolbarHeight':\n                if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') > -1)) {\n                    this.toolbarHeight = args.value['height'];\n                }\n                break;\n            case 'setCurrentToolbar':\n                this.currentToolbar = args.value['type'];\n                break;\n            case 'setSelectedFreehandColor':\n                this.selFhdColor = args.value['color'];\n                break;\n            case 'setInitialAdjustmentValue':\n                parent.initialAdjustmentValue = args.value['value'];\n                break;\n            case 'getCanvasFilter':\n                args.value['obj']['canvasFilter'] = parent.canvasFilter;\n                break;\n            case 'getDefToolbarItems':\n                args.value['obj']['defToolbarItems'] = this.defToolbarItems;\n                break;\n            case 'getPenStroke':\n                this.getPenStroke(args.value['value']);\n                break;\n            case 'performDefToolbarClickAction':\n                this.performDefTbrClick(args.value['type'], args.value['isContextualToolbar'], args.value['isDisabledAdjustment'], args.value['isDisabledFilter'], args.value['isFilterFinetune']);\n                break;\n            case 'setTempFilterProperties':\n                parent.setTempFilterProperties();\n                break;\n            case 'refreshSlider':\n                this.refreshSlider();\n                break;\n            case 'getCurrAdjustmentValue':\n                parent.getCurrAdjustmentValue(args.value['type']);\n                break;\n            case 'setCurrAdjustmentValue':\n                parent.setCurrAdjustmentValue(args.value['type'], args.value['value']);\n                break;\n            case 'refreshShapeDrawing':\n                this.refreshShapeDrawing();\n                break;\n            case 'setEnableDisableUndoRedo':\n                this.preventEnableDisableUr = args.value['isPrevent'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'getLocaleText':\n                args.value['obj']['value'] = this.l10n.getConstant(args.value['obj']['key']);\n                break;\n            case 'initResizeToolbar':\n                this.initResizeToolbar();\n                break;\n            case 'getFrameToolbar':\n                args.value['obj']['bool'] = this.isFrameToolbar;\n                break;\n            case 'callFrameToolbar':\n                this.callFrameToolbar();\n                break;\n            case 'resizeClick':\n                this.resizeClick();\n                break;\n            case 'frameToolbarClick':\n                this.frameToolbarClick();\n                break;\n            case 'performCropTransformClick':\n                this.performCropTransformClick(args.value['shape'], args.value['isTransform']);\n                break;\n            case 'duplicateShape':\n                this.duplicateShape(args.value['isPreventUndoRedo'], true);\n                break;\n            case 'editText':\n                this.editText();\n                break;\n        }\n    };\n    ToolbarModule.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        this.inMemoryCanvas = parent.inMemoryCanvas;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (this.inMemoryCanvas) {\n            this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        }\n    };\n    ToolbarModule.prototype.reset = function () {\n        var parent = this.parent;\n        this.toolbarHeight = 46;\n        parent.prevCurrSelectionPoint = null;\n        this.zoomBtnHold = null;\n        this.currToolbar = '';\n        parent.cxtTbarHeight = null;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        parent.currentFilter = '';\n        this.preventZoomBtn = parent.isCropToolbar = this.preventEnableDisableUr = this.isFrameToolbar = false;\n        parent.initialAdjustmentValue = parent.canvasFilter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.tempStraighten = 0;\n        parent.isStraightening = false;\n    };\n    ToolbarModule.prototype.destroyTopToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_toolbar');\n        if (this.isToolbar() && toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.destroyBottomToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_bottomToolbar');\n        if (toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.isToolbar = function () {\n        var parent = this.parent;\n        return (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)\n            || !isNullOrUndefined(parent.toolbarTemplate));\n    };\n    ToolbarModule.prototype.createToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_toolbarArea');\n            var toolbar_1 = parent.createElement('div', { id: id + '_toolbar' });\n            toolbarArea.appendChild(toolbar_1);\n            var uploadItems = [\n                {\n                    cssClass: 'e-image-upload',\n                    align: 'Left', type: 'Input',\n                    tooltipText: this.l10n.getConstant('Browse'),\n                    template: new Uploader({\n                        allowedExtensions: '.jpg, .jpeg, .png,.svg',\n                        multiple: false,\n                        selected: function () {\n                            var toolbar = document.getElementById(id + '_toolbar');\n                            var bToolbar = document.getElementById(id + '_bottomToolbar');\n                            if (!parent.disabled) {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    if (bToolbar) {\n                                        getComponent(bToolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, Browser.isDevice, null);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, false, null);\n                                }\n                            }\n                        }\n                    })\n                }\n            ];\n            var toolbarObj = new Toolbar({ items: uploadItems, width: '100%',\n                created: function () {\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_toolbar');\n            this.createLeftToolbarControls();\n            var mToolbar = document.getElementById(id + '_toolbar');\n            if (toolbar_1) {\n                this.toolbarHeight = mToolbar.clientHeight;\n                if (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                    var toolabr = getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar');\n                    if (toolabr) {\n                        toolabr.destroy();\n                        document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                    }\n                }\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ToolbarModule.prototype.createContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', { id: id + '_contextualToolbarArea',\n                className: 'e-contextual-toolbar-wrapper e-hide', attrs: { style: 'position: absolute;' }\n            }));\n            var toolbarArea = document.getElementById(id + '_contextualToolbarArea');\n            var toolbar_2 = parent.createElement('div', { id: id + '_contextualToolbar' });\n            toolbarArea.appendChild(toolbar_2);\n        }\n    };\n    ToolbarModule.prototype.createBottomToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.element.querySelector('#' + id + '_bottomToolbarArea')) {\n            parent.element.querySelector('#' + id + '_bottomToolbarArea').remove();\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!parent.toolbarTemplate) {\n                var toolbarArea = document.getElementById(id + '_bottomToolbarArea');\n                var toolbarElem = parent.createElement('div', {\n                    id: id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ToolbarModule.prototype.createQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.showQuickAccessToolbar) {\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_quickAccessToolbarArea');\n            var toolbar_3 = parent.createElement('div', {\n                id: id + '_quickAccessToolbar'\n            });\n            toolbarArea.appendChild(toolbar_3);\n            var toolbarObj = new Toolbar({ clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n        }\n    };\n    ToolbarModule.prototype.initMainToolbar = function (isApplyOption, isDevice, isOkBtn, isResize, isFrame, isMainToolbar) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn, isResize);\n            var rightItem = this.getRightToolbarItem(isOkBtn, isMainToolbar);\n            var mainItem = this.getMainToolbarItem(isApplyOption, isFrame);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                if (isFrame) {\n                    this.defToolbarItems = mainItem;\n                }\n                else {\n                    this.defToolbarItems = leftItem.concat(rightItem);\n                }\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(mainItem, rightItem, zoomItem);\n            }\n            var args = { toolbarType: 'main', toolbarItems: this.defToolbarItems };\n            parent.trigger('toolbarUpdating', args);\n            this.defToolbarItems = args.toolbarItems;\n            if (this.defToolbarItems.length > 0) {\n                var toolbarObj = new Toolbar({\n                    width: '100%',\n                    items: this.defToolbarItems,\n                    clicked: this.defToolbarClicked.bind(this),\n                    created: function () {\n                        if (!isDevice) {\n                            _this.renderAnnotationBtn();\n                        }\n                        _this.wireZoomBtnEvents();\n                        _this.renderSaveBtn();\n                        parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                    }\n                });\n                if (isDevice && isFrame) {\n                    toolbarObj.appendTo('#' + id + '_bottomToolbar');\n                }\n                else {\n                    toolbarObj.appendTo('#' + id + '_toolbar');\n                }\n                this.createLeftToolbarControls();\n                this.enableDisableTbrBtn();\n                if (this.isToolbar() && document.getElementById(id + '_toolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_4 = getComponent(id + '_toolbar', 'toolbar');\n                    toolbar_4.refreshOverflow();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.initBottomToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            var items = this.getMainToolbarItem();\n            var args = { toolbarType: 'bottom-toolbar', toolbarItems: items };\n            parent.trigger('toolbarUpdating', args);\n            items = args.toolbarItems;\n            var toolbarObj = new Toolbar({ items: items, width: '100%',\n                created: function () {\n                    _this.renderAnnotationBtn();\n                    _this.renderCropBtn();\n                    _this.renderTransformBtn();\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this)\n            });\n            toolbarObj.appendTo('#' + id + '_bottomToolbar');\n            if (this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_5 = getComponent(id + '_bottomToolbar', 'toolbar');\n                toolbar_5.refreshOverflow();\n            }\n        }\n    };\n    ToolbarModule.prototype.getLeftToolbarItem = function (isOkBtn, isResize) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (!isOkBtn || isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Open') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n            else if (Browser.isDevice && (parent.toolbar && parent.toolbar.indexOf('Open') === -1)) {\n                toolbarItems.push({ visible: false, id: parent.element.id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg', multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n        }\n        if (parent.allowUndoRedo && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Undo') > -1)) {\n                toolbarItems.push({ id: id + '_undo', prefixIcon: 'e-icons e-undo', cssClass: 'top-icon e-undo',\n                    tooltipText: this.l10n.getConstant('Undo'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Redo') > -1)) {\n                toolbarItems.push({ id: id + '_redo', prefixIcon: 'e-icons e-redo', cssClass: 'top-icon e-redo',\n                    tooltipText: this.l10n.getConstant('Redo'), align: 'Left' });\n            }\n        }\n        if (!this.preventZoomBtn && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomOut') > -1)) {\n                toolbarItems.push({ id: id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomIn') > -1)) {\n                toolbarItems.push({ id: id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getRightToolbarItem = function (isOkBtn, isMainToolbar) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isOkBtn) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if ((isMainToolbar || !Browser.isDevice) && (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Reset') > -1))) {\n            toolbarItems.push({ id: id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right', template: '<button id=\"' + id + '_saveBtn\"></button>' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getMainToolbarItem = function (isApplyOption, isFrame) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isFrame) {\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('None') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_none', prefixIcon: 'e-icons e-frame-none', cssClass: 'top-icon e-frame-none',\n                    tooltipText: this.l10n.getConstant('None'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Mat') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_mat', prefixIcon: 'e-icons e-frame-mat', cssClass: 'top-icon e-frame-mat',\n                    tooltipText: this.l10n.getConstant('Mat'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Bevel') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_bevel', prefixIcon: 'e-icons e-frame-bevel', cssClass: 'top-icon e-frame-bevel',\n                    tooltipText: this.l10n.getConstant('Bevel'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Line') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_line', prefixIcon: 'e-icons e-frame-line', cssClass: 'top-icon e-frame-line',\n                    tooltipText: this.l10n.getConstant('Line'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Inset') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_inset', prefixIcon: 'e-icons e-frame-inset', cssClass: 'top-icon e-frame-inset',\n                    tooltipText: this.l10n.getConstant('Inset'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Hook') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_hook', prefixIcon: 'e-icons e-frame-hook', cssClass: 'top-icon e-frame-hook',\n                    tooltipText: this.l10n.getConstant('Hook'), align: 'Center' });\n            }\n        }\n        else {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Crop') > -1)) {\n                toolbarItems.push({ id: id + '_cropTransform', prefixIcon: 'e-icons e-crop', cssClass: 'top-icon e-crop',\n                    tooltipText: this.l10n.getConstant('CropAndTransform'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Annotate') > -1)) {\n                toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                    template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Finetune') > -1)) {\n                toolbarItems.push({ id: id + '_adjustment', prefixIcon: 'e-icons e-adjustment', cssClass: 'top-icon e-adjustment',\n                    tooltipText: this.l10n.getConstant('Finetune'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Filter') > -1)) {\n                toolbarItems.push({ id: id + '_filter', prefixIcon: 'e-icons e-filters', cssClass: 'top-icon e-filters',\n                    tooltipText: this.l10n.getConstant('Filter'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Frame') > -1)) {\n                toolbarItems.push({ id: id + '_frame', prefixIcon: 'e-icons e-border-frame', cssClass: 'top-icon e-border-frame',\n                    tooltipText: this.l10n.getConstant('Frame'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Resize') > -1)) {\n                toolbarItems.push({ id: id + '_resize', prefixIcon: 'e-icons e-resize', cssClass: 'top-icon e-resize',\n                    tooltipText: this.l10n.getConstant('Resize'), align: 'Center' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.updateContextualToolbar = function (type, cType, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarArea = parent.element.querySelector('#' + id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n        if (!contextualToolbarArea) {\n            return;\n        }\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        if (type === 'filter') {\n            var toolbar_6 = document.getElementById(id + '_toolbar');\n            if (toolbar_6 && this.defToolbarItems.length > 0) {\n                getComponent(toolbar_6, 'toolbar').destroy();\n            }\n            if (Browser.isDevice) {\n                this.initMainToolbar(false, true, true);\n            }\n            else {\n                this.initMainToolbar(true, null, null);\n            }\n            this.refreshSlider();\n            this.initFilterToolbarItem();\n        }\n        else {\n            var ctxToolbar = document.querySelector('#' + id + '_contextualToolbar');\n            if (ctxToolbar.classList.contains('e-control')) {\n                getComponent(ctxToolbar, 'toolbar').destroy();\n            }\n            this.refreshSlider();\n            if (type === 'frame') {\n                this.initFrameToolbarItem();\n            }\n            else {\n                this.renderSlider(cType, isSelect);\n            }\n        }\n        if (parent.toolbarTemplate) {\n            this.toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + parent.element.id + '_toolbar')) {\n            this.toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbar').clientHeight;\n        }\n        parent.toolbarHeight = this.toolbarHeight;\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight + 1;\n            var cusWrapper = parent.element.querySelector('#' + id + '_customizeWrapper');\n            if (this.isFrameToolbar && cusWrapper) {\n                cHt = cusWrapper.offsetHeight + 2;\n            }\n            var ht = parent.element.querySelector('#' + id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + ht - cHt + 'px';\n            if (cType === 'straighten') {\n                parent.isStraightening = true;\n                var ctxToolbar = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n                if (ctxToolbar.style.position === 'absolute') {\n                    ctxToolbar.style.position = '';\n                    parent.element.insertBefore(ctxToolbar, parent.element.querySelector('#' + id + '_bottomToolbarArea'));\n                    parent.update();\n                    if (isSelect) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        }\n        else {\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + 'px';\n        }\n    };\n    ToolbarModule.prototype.processToolbar = function (position) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (parent.toolbar) {\n            for (var i = 0, len = parent.toolbar.length; i < len; i++) {\n                if (typeof (parent.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(parent.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(parent.toolbar[i]);\n                        }\n                    }\n                    else if (parent.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(parent.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.wireZoomBtnEvents = function () {\n        var zoomIn = document.querySelector('#' + this.parent.element.id + '_zoomIn');\n        var zoomOut = document.querySelector('#' + this.parent.element.id + '_zoomOut');\n        if (zoomIn) {\n            zoomIn.addEventListener('mousedown', this.zoomInBtnMouseDownHandler.bind(this));\n            zoomIn.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomIn.addEventListener('click', this.zoomInBtnClickHandler.bind(this));\n            zoomIn.addEventListener('touchstart', this.zoomInBtnClickHandler.bind(this));\n        }\n        if (zoomOut) {\n            zoomOut.addEventListener('mousedown', this.zoomOutBtnMouseDownHandler.bind(this));\n            zoomOut.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomOut.addEventListener('click', this.zoomOutBtnClickHandler.bind(this));\n            zoomIn.addEventListener('touchstart', this.zoomInBtnClickHandler.bind(this));\n        }\n    };\n    ToolbarModule.prototype.widthPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    ToolbarModule.prototype.heightPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    ToolbarModule.prototype.widthAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            return;\n        }\n        var parent = this.parent;\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value);\n        var value = aspectRatioHeightValue / (originalHeight / originalWidth);\n        var width = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        var heightNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (width != null && !isNaN(width)) {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = width + ' px';\n                    aspectRatioWidth.placeholder = width.toString() + ' px';\n                }\n                else {\n                    (widthNumeric).value = width;\n                    aspectRatioWidth.value = width.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = '0 px';\n                    aspectRatioWidth.placeholder = '0 px';\n                    if (isNullOrUndefined(heightNumeric.value) && !isNullOrUndefined(heightNumeric.placeholder)) {\n                        (widthNumeric).placeholder = \"\" + parent.img.srcWidth;\n                        aspectRatioWidth.placeholder = \"\" + parent.img.srcWidth;\n                    }\n                }\n                else {\n                    (widthNumeric).value = 0;\n                    aspectRatioWidth.value = '0 px';\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    ToolbarModule.prototype.heightAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioWidthValue = parseFloat(aspectRatioWidth.value);\n        var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n        var height = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n        var heightNumeric = getComponent(aspectRatioHeight, 'numerictextbox');\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (!isNaN(height)) {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = height + ' px';\n                    aspectRatioHeight.placeholder = height.toString() + ' px';\n                }\n                else {\n                    (heightNumeric).value = height;\n                    aspectRatioHeight.value = height.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = '0 px';\n                    aspectRatioHeight.placeholder = '0 px';\n                    if (isNullOrUndefined(widthNumeric.value) && !isNullOrUndefined(widthNumeric.placeholder)) {\n                        (heightNumeric).placeholder = \"\" + parent.img.srcHeight;\n                        aspectRatioHeight.placeholder = \"\" + parent.img.srcHeight;\n                    }\n                }\n                else {\n                    (heightNumeric).value = 0;\n                    aspectRatioHeight.value = '0 px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getResizeToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isResize = parent.aspectWidth && parent.aspectHeight ? true : false;\n        var width = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcHeight).toString() : Math.ceil(this.parent.img.srcWidth).toString();\n        var height = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcWidth).toString() : Math.ceil(this.parent.img.srcHeight).toString();\n        var toolbarItems = [];\n        var spanWidth = document.createElement('span');\n        spanWidth.innerHTML = this.l10n.getConstant('W');\n        toolbarItems.push({ id: id + '_width', cssClass: 'e-ie-resize-width', template: spanWidth, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeWidth', prefixIcon: 'e-icons e-anti-clock-wise',\n            tooltipText: this.l10n.getConstant('Width'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: \"4\" },\n                showSpinButton: false, value: isResize ? parent.aspectWidth : null,\n                placeholder: isResize ? null : width, format: '###.## px' })\n        });\n        var spanHeight = document.createElement('span');\n        spanHeight.innerHTML = this.l10n.getConstant('H');\n        toolbarItems.push({ id: id + '_height', cssClass: 'e-ie-resize-height', template: spanHeight, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeHeight', prefixIcon: 'e-icons e-clock-wise',\n            tooltipText: this.l10n.getConstant('Height'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: \"4\" },\n                showSpinButton: false, value: isResize ? parent.aspectHeight : null,\n                placeholder: isResize ? null : height, format: '###.## px' })\n        });\n        if (!this.isAspectRatio) {\n            toolbarItems.push({ id: id + '_aspectratio', prefixIcon: 'e-icons e-lock', align: 'Center', tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button' });\n            this.isAspectRatio = true;\n        }\n        else {\n            toolbarItems.push({ id: id + '_nonaspectratio', prefixIcon: 'e-icons e-unlock', align: 'Center', tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button' });\n            this.isAspectRatio = false;\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initResizeToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(false, true);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getResizeToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'resize', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireResizeBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        parent.isResize = false;\n        this.enableDisableTbrBtn();\n        parent.isResize = true;\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.wireResizeBtnEvents = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        if (!isNullOrUndefined(aspectRatioHeight)) {\n            aspectRatioHeight.addEventListener('keydown', this.widthPress.bind(this));\n            aspectRatioWidth.addEventListener('keyup', this.heightAspectRatio.bind(this));\n        }\n        if (!isNullOrUndefined(aspectRatioWidth)) {\n            aspectRatioWidth.addEventListener('keydown', this.heightPress.bind(this));\n            aspectRatioHeight.addEventListener('keyup', this.widthAspectRatio.bind(this));\n        }\n    };\n    ToolbarModule.prototype.enableDisableTbrBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!this.preventEnableDisableUr) {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            var undo = parent.element.querySelector('#' + id + '_undo');\n            if (undo && undoRedoObj['undoRedoStep'] === 0) {\n                undo.classList.add('e-disabled');\n                undo.parentElement.classList.add('e-overlay');\n            }\n            else if (undo && undoRedoObj['undoRedoStep'] > 0) {\n                undo.classList.remove('e-disabled');\n                undo.parentElement.classList.remove('e-overlay');\n            }\n            var redo = parent.element.querySelector('#' + id + '_redo');\n            if (redo && (undoRedoObj['undoRedoStep'] === object['appliedUndoRedoColl'].length)) {\n                redo.classList.add('e-disabled');\n                redo.parentElement.classList.add('e-overlay');\n            }\n            else if (redo && (undoRedoObj['undoRedoStep'] === 0 && object['appliedUndoRedoColl'].length > 0)) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n            else if (redo && undoRedoObj['undoRedoStep'] > 0) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n        }\n        var zoomIn = document.querySelector('#' + id + '_zoomIn');\n        if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n            zoomIn.classList.add('e-disabled');\n            zoomIn.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomIn) {\n            zoomIn.classList.remove('e-disabled');\n            zoomIn.parentElement.classList.remove('e-overlay');\n        }\n        var zoomOut = document.querySelector('#' + id + '_zoomOut');\n        if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var frame = document.querySelector('#' + id + '_frame');\n        if (frame && ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop)) {\n            frame.classList.add('e-disabled');\n        }\n        else if (frame) {\n            frame.classList.remove('e-disabled');\n        }\n    };\n    ToolbarModule.prototype.createLeftToolbarControls = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (document.getElementById(id + '_toolbar'))) {\n            var uploadDiv = document.getElementById(id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.appendChild(parent.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ToolbarModule.prototype.fileSelect = function (inputElement, args) {\n        var type = inputElement.files[0].type.split('/')[1];\n        var filesTypes = ['png', 'jpg', 'jpeg', 'svg', 'svg+xml'];\n        if (filesTypes.indexOf(type) > -1) {\n            this.parent.notify('draw', { prop: 'fileSelect', value: { inputElement: inputElement, args: args } });\n        }\n        else {\n            this.parent.showDialogPopup();\n        }\n    };\n    ToolbarModule.prototype.triggerTbarClickEvent = function (args) {\n        var clickEvent = { item: args.item, originalEvent: args.event };\n        this.parent.trigger('toolbarItemClicked', clickEvent);\n    };\n    ToolbarModule.prototype.renderAnnotationBtn = function (isContextualToolbar) {\n        var _this = this;\n        var parent = this.parent;\n        var isCustomized = false;\n        var items = [];\n        var id = parent.element.id;\n        var defItems = ['Ellipse', 'Arrow', 'Line', 'Rectangle', 'Pen', 'Path', 'Text', 'Image'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Arrow') > -1)) {\n            items.push({ text: this.l10n.getConstant('Arrow'), id: 'arrow', iconCss: 'e-icons e-arrow-right-up' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Path') > -1)) {\n            items.push({ text: this.l10n.getConstant('Path'), id: 'path', iconCss: 'e-icons e-critical-path' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Image') > -1)) {\n            items.push({ text: this.l10n.getConstant('Image'), id: 'image', iconCss: 'e-icons e-image' });\n        }\n        var obj = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n        var duplicateElement = document.querySelector('#' + id + '_duplicate');\n        var removeElement = document.querySelector('#' + id + '_remove');\n        var editTextElement = document.querySelector('#' + id + '_editText');\n        if ((parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) &&\n            (isNullOrUndefined(parent.activeObj.pointColl) || (parent.activeObj.pointColl\n                && parent.activeObj.pointColl.length === 0)) &&\n            isNullOrUndefined(obj['freehandDrawSelectedId'])) {\n            if (duplicateElement) {\n                duplicateElement.classList.add('e-disabled');\n            }\n            if (removeElement) {\n                removeElement.classList.add('e-disabled');\n            }\n            if (editTextElement) {\n                editTextElement.classList.add('e-disabled');\n            }\n        }\n        else {\n            if (duplicateElement) {\n                duplicateElement.classList.remove('e-disabled');\n            }\n            if (removeElement) {\n                removeElement.classList.remove('e-disabled');\n            }\n            if (editTextElement) {\n                editTextElement.classList.remove('e-disabled');\n            }\n        }\n        var iconCss = isContextualToolbar ? this.getCurrentShapeIcon(parent.activeObj.shape) : 'e-annotation';\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons ' + iconCss,\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (parent.currObjType.isFiltered) {\n                    parent.okBtn();\n                    parent.element.querySelector('#' + id + '_annotationBtn').click();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape) {\n                    document.getElementById(parent.activeObj.shape).classList.add('e-selected');\n                }\n                else if (parent.togglePen) {\n                    document.getElementById('pen').classList.add('e-selected');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                parent.okBtn();\n                var isCropSelection = false;\n                var splitWords;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                parent.currObjType.isCustomCrop = false;\n                if (isCropSelection || parent.togglePan) {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                var obj = { currentFreehandDrawIndex: null };\n                parent.notify('freehand-draw', { prop: 'getCurrentFreehandDrawIndex', value: { obj: obj } });\n                var prevObj = { shapeSettingsObj: {} };\n                var shapeSettings;\n                var shapeChangingArgs;\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon(args.item.id);\n                switch (args.item.id) {\n                    case 'pen':\n                        parent.notify('draw', { prop: 'setTempFreehandCounter', value: { tempFreehandCounter: parent.freehandCounter } });\n                        parent.notify('draw', { prop: 'setTempCurrentFreehandDrawIndex', value: { tempCurrentFreehandDrawIndex: obj['currentFreehandDrawIndex'] } });\n                        _this.currentToolbar = 'pen';\n                        parent.freeHandDraw(true);\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        shapeSettings.type = ShapeType.FreehandDraw;\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings };\n                        parent.notify('freehand-draw', { prop: 'triggerShapeChanging', value: { shapeChangingArgs: shapeChangingArgs } });\n                        break;\n                    case 'text':\n                        _this.currentToolbar = 'text';\n                        parent.notify('shape', { prop: 'draw-shape-text' });\n                        break;\n                    case 'image':\n                        _this.currentToolbar = 'shapes';\n                        parent.element.querySelector('#' + id + '_fileUpload').click();\n                        break;\n                    case 'ellipse':\n                    case 'arrow':\n                    case 'line':\n                    case 'rectangle':\n                    case 'path':\n                        _this.currentToolbar = 'shapes';\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings };\n                        parent.trigger('shapeChanging', shapeChangingArgs);\n                        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', value: { shapeSettings: shapeChangingArgs.currentShapeSettings } });\n                        break;\n                }\n                _this.updateToolbarItems();\n                var tempTogglePen = parent.togglePen;\n                if (args.item.id === 'pen') {\n                    parent.togglePen = false;\n                }\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.togglePen = tempTogglePen;\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_annotationBtn');\n    };\n    ToolbarModule.prototype.renderStraightenSlider = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) &&\n            parent.element.querySelector('#' + id + '_straightenSlider')) {\n            var slider = this.createSlider(-45, 45, parent.cropObj.straighten, 'straighten');\n            slider.appendTo('#' + id + '_straightenSlider');\n            var sliderHandle = slider.element.querySelector('.e-handle');\n            if (sliderHandle && !Browser.isDevice) {\n                sliderHandle.addEventListener('mousedown', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n                sliderHandle.addEventListener('touchstart', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n    };\n    ToolbarModule.prototype.renderCropBtn = function (shapeString) {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        var isCustomized = false;\n        var defItems = ['CustomSelection', 'CircleSelection', 'SquareSelection', 'RatioSelection'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'circle', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '2:3', id: '2:3', iconCss: 'e-icons e-custom-f' });\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '3:4', id: '3:4', iconCss: 'e-icons e-custom-g' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '4:5', id: '4:5', iconCss: 'e-icons e-custom-h' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '5:7', id: '5:7', iconCss: 'e-icons e-custom-i' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '9:16', id: '9:16', iconCss: 'e-icons e-custom-j' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var iconCss;\n        var shape;\n        if (shapeString) {\n            iconCss = this.getCurrentShapeIcon(shapeString);\n            shape = shapeString;\n        }\n        else if (parent.activeObj.shape) {\n            iconCss = this.getCurrentShapeIcon(parent.activeObj.shape);\n            shape = parent.activeObj.shape;\n        }\n        else if (parent.currSelectionPoint) {\n            iconCss = this.getCurrentShapeIcon(parent.currSelectionPoint.shape);\n            shape = parent.currSelectionPoint.shape;\n        }\n        else {\n            iconCss = items[0].iconCss;\n            shape = items[0].id;\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (parent.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape.split('-').length > 1) {\n                    var elem = document.getElementById(parent.activeObj.shape.split('-')[1]);\n                    elem.classList.add('e-selected');\n                    elem.focus();\n                }\n                parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                _this.cropSelect(args);\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon('crop-' + args.item.id);\n                drpDownBtn.content = Browser.isDevice ? null : parent.toPascalCase(args.item.id);\n            },\n            iconCss: 'e-icons ' + iconCss, cssClass: 'e-image-popup e-ie-crop-ddb-popup',\n            content: Browser.isDevice ? null : parent.toPascalCase(shape.replace('crop-', ''))\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_cropBtn');\n    };\n    ToolbarModule.prototype.renderTransformBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var elem = args.element.parentElement;\n                    var ht = elem.offsetHeight;\n                    elem.style.display = 'none';\n                    elem.style.top = drpDownBtn.element.getBoundingClientRect().top - ht + 'px';\n                    elem.style.display = 'block';\n                }\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                parent.transformSelect.bind(_this);\n            },\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_transformBtn');\n    };\n    ToolbarModule.prototype.renderSaveBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var saveItems = [\n            { text: 'JPEG', id: 'jpeg' },\n            { text: 'PNG', id: 'png' },\n            { text: 'SVG', id: 'svg' }\n        ];\n        var ddbElem = document.getElementById(id + '_saveBtn');\n        if (ddbElem) {\n            // Initialize the DropDownButton component.\n            var saveDrpDownBtn = new DropDownButton({ items: saveItems, cssClass: 'e-caret-hide e-image-popup', iconCss: 'e-icons e-save',\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    parent.export(args.item.text);\n                    parent.isChangesSaved = true;\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            });\n            saveDrpDownBtn.appendTo('#' + id + '_saveBtn');\n        }\n    };\n    ToolbarModule.prototype.getCropTransformToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ id: id + '_crop', tooltipText: this.l10n.getConstant('CropSelection'), align: 'Center',\n            template: '<button id=\"' + id + '_cropBtn\"></button>'\n        });\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateLeft') > -1))) {\n            toolbarItems.push({ id: id + '_rotateLeft', prefixIcon: 'e-icons e-anti-clock-wise', tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateRight') > -1))) {\n            toolbarItems.push({ id: id + '_rotateRight', prefixIcon: 'e-icons e-clock-wise', tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n        }\n        if (toolbarItems.length > 2) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('HorizontalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_horizontalFlip', prefixIcon: 'e-icons e-horizontal-flip', tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('VerticalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_verticalFlip', prefixIcon: 'e-icons e-vertical-flip', tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) && !Browser.isDevice) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Straighten') > -1 || parent.toolbar.indexOf('Straighten') > -1))) {\n                var spanWidth = document.createElement('span');\n                spanWidth.innerHTML = this.l10n.getConstant('Straighten');\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-span', template: spanWidth, align: 'Center' });\n                toolbarItems.push({ id: id + '_straighten',\n                    cssClass: 'top-icon e-straighten', tooltipText: this.l10n.getConstant('Straighten'), align: 'Center', type: 'Input',\n                    template: '<div id=\"' + id + '_straightenSlider\"></div>' });\n                var straightenSpan = document.createElement('span');\n                straightenSpan.innerHTML = parent.transform.straighten.toString() + '&#176';\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-value-span',\n                    template: straightenSpan, align: 'Center' });\n            }\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getShapesToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: 'Stroke Width', align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('start') > -1) {\n            toolbarItems.push({ id: id + '_start', cssClass: 'top-icon e-size', tooltipText: 'Start', align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_startBtn\"></button>' });\n        }\n        if (items.indexOf('end') > -1) {\n            toolbarItems.push({ id: id + '_end', cssClass: 'top-icon e-size', tooltipText: 'End', align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_endBtn\"></button>' });\n        }\n        if (items.indexOf('flip') > -1) {\n            toolbarItems.push({ id: id + '_rotLeft', prefixIcon: 'e-anti-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n            toolbarItems.push({ id: id + '_rotRight', prefixIcon: 'e-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n            toolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-horizontal-flip',\n                tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n            toolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-vertical-flip',\n                tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] !== 'path') {\n                toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                    tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n                toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initCropTransformToolbar = function (shape, isTransform) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getCropTransformToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'crop-transform', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderCropBtn(shape);\n                _this.renderStraightenSlider();\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                if (document.getElementById(id + '_cropBtn') && isNullOrUndefined(isTransform)) {\n                    if (!Browser.isDevice) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: _this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        var slider = parent.element.querySelector('#' + id + '_straightenSlider');\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1))\n            && slider && slider.parentElement.clientHeight > this.toolbarHeight) {\n            this.toolbarHeight = parent.toolbarHeight = slider.parentElement.clientHeight;\n        }\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.getCropTextContent = function (elem) {\n        if (elem) {\n            var classToContentMap = { 'e-custom': 'Custom', 'e-circle': 'Circle',\n                'e-square': 'Square', 'e-custom-a': '3:2', 'e-custom-b': '4:3', 'e-custom-c': '5:4', 'e-custom-d': '7:5',\n                'e-custom-e': '16:9', 'e-custom-f': '2:3', 'e-custom-g': '3:4', 'e-custom-h': '4:5', 'e-custom-i': '5:7',\n                'e-custom-j': '9:16',\n            };\n            var classList = elem.children[0].classList;\n            for (var className in classToContentMap) {\n                if (classList.contains(className)) {\n                    return classToContentMap[className];\n                }\n            }\n        }\n        return '';\n    };\n    ToolbarModule.prototype.getCurrentShapeIcon = function (shape) {\n        var shapeIcons = {\n            rectangle: 'e-rectangle',\n            ellipse: 'e-circle',\n            line: 'e-line',\n            arrow: 'e-arrow-right-up',\n            path: 'e-critical-path',\n            text: 'e-add-text',\n            image: 'e-image',\n            pen: 'e-free-pen',\n            'crop-custom': 'e-custom',\n            'crop-circle': 'e-circle',\n            'crop-square': 'e-square',\n            'crop-3:2': 'e-custom-a',\n            'crop-4:3': 'e-custom-b',\n            'crop-5:4': 'e-custom-c',\n            'crop-7:5': 'e-custom-d',\n            'crop-16:9': 'e-custom-e',\n            'crop-2:3': 'e-custom-f',\n            'crop-3:4': 'e-custom-g',\n            'crop-4:5': 'e-custom-h',\n            'crop-5:7': 'e-custom-i',\n            'crop-9:16': 'e-custom-j',\n        };\n        return shapeIcons[shape] || 'e-free-pen';\n    };\n    ToolbarModule.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: parent.activeObj.shape ? parent.activeObj.shape : 'shapes',\n            toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                if (parent.activeObj.shape === 'arrow') {\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('start') > -1; })) {\n                        _this.createStartBtn();\n                    }\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('end') > -1; })) {\n                        _this.createEndBtn();\n                    }\n                }\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.beforeModeSwitch = function (args, inst) {\n        this.popupLeft = args.element.offsetParent.style.left;\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = this.l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = this.l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('MoreColors');\n        }\n    };\n    ToolbarModule.prototype.createShapeColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fillColor') > -1) {\n            parent.element.querySelector('.e-template.e-fill').appendChild(parent.createElement('input', {\n                id: id + '_shape_fill'\n            }));\n            var fillColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                beforeModeSwitch: function (args) { return _this.beforeModeSwitch(args, fillColor_1); },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateFillColor(args.value);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (fillDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    fillDDB_1.toggle();\n                },\n            }, '#' + id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        parenElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fillColorBtn');\n            fillColor_1.inline = true;\n            fillColor_1.value = fillColor_1.getValue(fillColor_1.value, 'rgba');\n            parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n                id: id + '_shape_stroke'\n            }));\n            var strokeColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    strokeColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, strokeColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateStrokeColor(args.value);\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        parenElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_borderColorBtn');\n            strokeColor_1.inline = true;\n            strokeColor_1.value = strokeColor_1.getValue(strokeColor_1.value, 'rgba');\n            parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createShapeBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthItems = [\n                { id: '1', text: this.l10n.getConstant('XSmall') },\n                { id: '2', text: this.l10n.getConstant('Small') },\n                { id: '3', text: this.l10n.getConstant('Medium') },\n                { id: '4', text: this.l10n.getConstant('Large') },\n                { id: '5', text: this.l10n.getConstant('XLarge') }\n            ];\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse')) {\n                strokeWidthItems = [\n                    { id: '1', text: this.l10n.getConstant('NoOutline') },\n                    { id: '2', text: this.l10n.getConstant('XSmall') },\n                    { id: '3', text: this.l10n.getConstant('Small') },\n                    { id: '4', text: this.l10n.getConstant('Medium') },\n                    { id: '5', text: this.l10n.getConstant('Large') },\n                    { id: '6', text: this.l10n.getConstant('XLarge') }\n                ];\n            }\n            var strokeWidthBtn = document.getElementById(id + '_borderWidthBtn');\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.l10n.getConstant('XSmall');\n            spanElem_1.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_1);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_1 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_1.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_7 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_7.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_1.appendTo('#' + id + '_borderWidthBtn');\n        }\n    };\n    ToolbarModule.prototype.createStartBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_startBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.start)) {\n            parent.activeObj.start = 'none';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.start);\n        spanElem.className = 'e-shape-start';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('startArrow', args.item.id);\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_startBtn');\n    };\n    ToolbarModule.prototype.createEndBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeEndBtn = document.getElementById(id + '_endBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.end)) {\n            parent.activeObj.end = 'arrowSolid';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.end);\n        spanElem.className = 'e-shape-end';\n        strokeEndBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('endArrow', args.item.id);\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_endBtn');\n    };\n    ToolbarModule.prototype.getTextToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_fontColorBtn\"></button>' });\n        }\n        if (items.indexOf('bold') > -1) {\n            toolbarItems.push({ id: id + '_bold', prefixIcon: 'e-icons e-bold', cssClass: 'top-icon e-bold',\n                tooltipText: this.l10n.getConstant('Bold'), align: 'Center' });\n        }\n        if (items.indexOf('italic') > -1) {\n            toolbarItems.push({ id: id + '_italic', prefixIcon: 'e-icons e-italic', cssClass: 'top-icon e-italic',\n                tooltipText: this.l10n.getConstant('Italic'), align: 'Center' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFontFamilyItems = function () {\n        var parent = this.parent;\n        var items = [];\n        if (parent.fontFamily && parent.fontFamily.items && parent.fontFamily.items.length > 0) {\n            items = parent.fontFamily.items;\n        }\n        else {\n            if (Browser.isDevice) {\n                items = [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                    { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n            }\n            else {\n                items = [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n                    { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n            }\n        }\n        return items;\n    };\n    ToolbarModule.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'text', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createTextColor(items);\n                _this.createTextBtn(items);\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createTextColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontColor') > -1 && parent.element.querySelector('.e-template.e-text-font-color')) {\n            parent.element.querySelector('.e-template.e-text-font-color').appendChild(parent.createElement('input', {\n                id: id + '_text_font'\n            }));\n            var fontColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    fontColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, fontColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateFontColor(args.value);\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_2.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        parenElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fontColorBtn');\n            fontColor_1.inline = true;\n            fontColor_1.value = fontColor_1.getValue(fontColor_1.value, 'rgba');\n            parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createTextBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(id + '_fontFamilyBtn');\n            var spanElem_2 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_2.innerHTML = 'ABC';\n                spanElem_2.setAttribute('style', 'font-family: ' + parent.fontFamily.default.toLowerCase() + \"'\");\n            }\n            else {\n                spanElem_2.innerHTML = parent.fontFamily.default;\n            }\n            spanElem_2.className = 'e-text-font-family';\n            if (fontNameBtn) {\n                fontNameBtn.appendChild(spanElem_2);\n            }\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                        fontFamily = parent.textArea.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = parent.activeObj.textSettings.fontFamily;\n                    }\n                    var elem = args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase() + '\"' + ']');\n                    if (elem) {\n                        elem.classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_2.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_2.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    parent.updateFontFamily(args.item.id);\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = parent.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    parent.updateFontSize(args.item.text);\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + id + '_fontSizeBtn');\n        }\n    };\n    ToolbarModule.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming, cType, shape, isTransform) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded || parent.isCropToolbar) {\n            return;\n        }\n        var args = {};\n        var aspectIcon;\n        var nonAspectIcon;\n        if (type !== 'filter' && type !== 'color') {\n            var toolbarElement = document.getElementById(id + '_toolbar');\n            var cusWrapper = document.getElementById(id + '_customizeWrapper');\n            var bottomToolbar = document.getElementById(id + '_bottomToolbar');\n            if (cusWrapper && (getComponent(cusWrapper, 'toolbar')) && this.defToolbarItems.length > 0) {\n                getComponent(cusWrapper, 'toolbar').destroy();\n                cusWrapper.innerHTML = '';\n            }\n            if (toolbarElement && toolbarElement.classList.contains('e-control') && this.defToolbarItems.length > 0) {\n                getComponent(toolbarElement, 'toolbar').destroy();\n                toolbarElement.innerHTML = '';\n            }\n            if (toolbarElement && (this.defToolbarItems.length > 0 ||\n                parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1)) {\n                var toolbar_9 = getComponent(toolbarElement, 'toolbar');\n                if (!isNullOrUndefined(toolbar_9)) {\n                    toolbar_9.destroy();\n                    document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                }\n            }\n            if (bottomToolbar && this.defToolbarItems.length > 0) {\n                if (bottomToolbar.className.indexOf('e-control') > -1) {\n                    getComponent(bottomToolbar, 'toolbar').destroy();\n                    bottomToolbar.innerHTML = '';\n                }\n            }\n        }\n        this.refreshSlider();\n        if (document.querySelector('.e-slider-tooltip')) {\n            document.querySelector('.e-slider-tooltip').remove();\n        }\n        this.isFrameToolbar = false;\n        parent.isCropTab = false;\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initMainToolbar(false, true, true, false, false, true);\n                    }\n                    else {\n                        this.initMainToolbar(false, true, null, false, false, true);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    if (isZooming) {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                    else {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'path') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'arrow') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'start', 'end', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'image') {\n                    args.toolbarItems = ['flip', 'duplicate', 'remove', 'transparency'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'duplicate', 'remove'];\n                }\n                this.initShapesToolbarItem(args.toolbarItems);\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontSize', 'fontColor', 'bold', 'italic', 'duplicate', 'remove', 'text'];\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth', 'remove', 'transparency'];\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'adjustment':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                this.initAdjustmentToolbarItem();\n                break;\n            case 'filter':\n                this.updateContextualToolbar(type);\n                break;\n            case 'resize':\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.aspectHeight = parent.aspectWidth;\n                    this.isAspectRatio = false;\n                }\n                this.initResizeToolbar();\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true, true);\n                }\n                aspectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n                nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n                if (parent.aspectWidth && parent.aspectHeight) {\n                    if (nonAspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    else if (aspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                    }\n                }\n                break;\n            case 'color':\n                this.updateContextualToolbar(type, cType);\n                break;\n            case 'croptransform':\n                if (isNullOrUndefined(isTransform)) {\n                    parent.allowDownScale = false;\n                    parent.isCropTab = true;\n                }\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (isNullOrUndefined(isTransform)) {\n                    parent.updateCropTransformItems();\n                }\n                this.initCropTransformToolbar(shape, isTransform);\n                if (Browser.isDevice && this.isToolbar()) {\n                    this.updateContextualToolbar('color', 'straighten', true);\n                }\n                break;\n            case 'frame':\n                this.isFrameToolbar = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                    this.initMainToolbar(false, true, true, false, true);\n                }\n                else {\n                    this.initMainToolbar(true, null, null, false, true);\n                }\n                var frameElem = parent.element.querySelector('#' + id + '_' + parent.frameObj.type);\n                if (frameElem) {\n                    frameElem.classList.add('e-selected-btn');\n                }\n                if (parent.frameObj.type !== 'none') {\n                    this.updateContextualToolbar(type, cType);\n                }\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                break;\n        }\n        this.currToolbar = type;\n        this.refreshDropDownBtn(isCropping);\n    };\n    ToolbarModule.prototype.performCropTransformClick = function (shape, isTransform) {\n        var parent = this.parent;\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setTempStraightenZoomDeg' });\n            parent.tempStraighten = parent.transform.straighten;\n            if (parent.currObjType.isFiltered) {\n                parent.okBtn();\n            }\n            parent.isStraightening = true;\n        }\n        this.refreshToolbar('croptransform', null, null, null, null, shape, isTransform);\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setDestForStraighten' });\n            parent.notify('draw', { prop: 'setTempDestForStraighten' });\n        }\n    };\n    ToolbarModule.prototype.getAdjustmentToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Brightness', 'Contrast', 'Hue', 'Saturation', 'Exposure', 'Opacity', 'Blur'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Brightness') > -1)) {\n            toolbarItems.push({ id: id + '_brightness', prefixIcon: 'e-icons e-brightness', cssClass: 'top-icon e-brightness',\n                tooltipText: this.l10n.getConstant('Brightness'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Contrast') > -1)) {\n            toolbarItems.push({ id: id + '_contrast', prefixIcon: 'e-icons e-contrast', cssClass: 'top-icon e-contrast',\n                tooltipText: this.l10n.getConstant('Contrast'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Hue') > -1)) {\n            toolbarItems.push({ id: id + '_hue', prefixIcon: 'e-icons e-fade', cssClass: 'top-icon e-fade',\n                tooltipText: this.l10n.getConstant('Hue'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Saturation') > -1)) {\n            toolbarItems.push({ id: id + '_saturation', prefixIcon: 'e-icons e-saturation', cssClass: 'top-icon e-saturation',\n                tooltipText: this.l10n.getConstant('Saturation'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Exposure') > -1)) {\n            toolbarItems.push({ id: id + '_exposure', prefixIcon: 'e-icons e-grain', cssClass: 'top-icon e-grain',\n                tooltipText: this.l10n.getConstant('Exposure'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Opacity') > -1)) {\n            toolbarItems.push({ id: id + '_opacity', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Blur') > -1)) {\n            toolbarItems.push({ id: id + '_blur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-tint',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFrameToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameColor',\n            cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('Color'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('Color') + '</span><button id=\"' + id + '_frameColorBtn\"></button>' });\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameGradient',\n            cssClass: 'top-icon e-frame-stroke', tooltipText: this.l10n.getConstant('GradientColor'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('GradientColor') + '</span><button id=\"' + id + '_frameGradientColorBtn\"></button>' });\n        toolbarItems.push({ id: id + '_frameSize', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Size'), align: 'Center',\n            type: 'Input', template: '<span>' + this.l10n.getConstant('Size') + '</span><button id=\"' + id + '_frameSizeBtn\"></button>' });\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset' || parent.frameObj.type === 'hook') {\n            toolbarItems.push({ id: id + '_frameInset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Inset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Inset') + '</span><button id=\"' + id + '_frameInsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset') {\n            toolbarItems.push({ id: id + '_frameOffset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Offset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Offset') + '</span><button id=\"' + id + '_frameOffsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line') {\n            toolbarItems.push({ id: id + '_frameRadius', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Radius'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Radius') + '</span><button id=\"' + id + '_frameRadiusBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameAmount', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Amount'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Amount') + '</span><button id=\"' + id + '_frameAmountBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameBorder', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Border'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Border') + '</span><button id=\"' + id + '_frameBorderBtn\"></button>' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFilterToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Default', 'Chrome', 'Cold', 'Warm', 'Grayscale', 'Sepia', 'Invert'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Default') > -1)) {\n            toolbarItems.push({ id: id + '_default', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Default'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_defaultCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Default') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Chrome') > -1)) {\n            toolbarItems.push({ id: id + '_chrome', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Chrome'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_chromeCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Chrome') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Cold') > -1)) {\n            toolbarItems.push({ id: id + '_cold', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Cold'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_coldCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Cold') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Warm') > -1)) {\n            toolbarItems.push({ id: id + '_warm', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Warm'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_warmCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Warm') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Grayscale') > -1)) {\n            toolbarItems.push({ id: id + '_grayscale', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Grayscale'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_grayscaleCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Grayscale') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Sepia') > -1)) {\n            toolbarItems.push({ id: id + '_sepia', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Sepia'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_sepiaCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Sepia') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Invert') > -1)) {\n            toolbarItems.push({ id: id + '_invert', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Invert'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_invertCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Invert') + '</span></div></div>' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getPenToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || parent.toolbar) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokewidth',\n                cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + id + '_penStrokeWidth\"></button>' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'pen', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createPenColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-pen-stroke-color').appendChild(parent.createElement('input', {\n                id: id + '_pen_stroke'\n            }));\n            var presentVal = parent.activeObj.strokeSettings.strokeColor;\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    parent.updatePenStrokeColor(args.currentValue.hex);\n                    _this.selFhdColor = args.currentValue.hex;\n                    strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + id + '_pen_stroke');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    var parentElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parentElem.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            parentElem.offsetHeight + 'px';\n                        parentElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_penColorBtn');\n            penColor.inline = true;\n            penColor.value = penColor.getValue(parent.activeObj.strokeSettings.strokeColor, 'rgba');\n            if (penColor.value === 'null') {\n                penColor.value = presentVal;\n            }\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = this.selFhdColor === '#42a5f5' ? obj['tempFreeHandDrawEditingStyles'].strokeColor :\n                        parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n            }\n            else {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = penColor.value;\n            }\n        }\n    };\n    ToolbarModule.prototype.createPenBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(id + '_penStrokeWidth');\n            var spanElem_3 = document.createElement('span');\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                spanElem_3.innerHTML = this.getPenStroke(parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth);\n            }\n            else {\n                spanElem_3.innerHTML = this.l10n.getConstant('Small');\n            }\n            spanElem_3.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_3.textContent = args.item.text;\n                    parent.updatePenStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_10 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_10.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_11 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_11.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + id + '_penStrokeWidth');\n        }\n    };\n    ToolbarModule.prototype.getPenStroke = function (value) {\n        var textContent = '';\n        var valueToTextContent = {\n            1: this.l10n.getConstant('XSmall'),\n            2: this.l10n.getConstant('Small'),\n            3: this.l10n.getConstant('Medium'),\n            4: this.l10n.getConstant('Large'),\n            5: this.l10n.getConstant('XLarge')\n        };\n        if (value >= 1 && value <= 5) {\n            textContent = valueToTextContent[value];\n        }\n        return textContent;\n    };\n    ToolbarModule.prototype.initAdjustmentToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(null);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getAdjustmentToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'finetune', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.initFrameToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var frameWrapper = document.querySelector('#' + id + '_frameWrapper');\n        if (frameWrapper) {\n            frameWrapper.style.display = 'block';\n        }\n        else {\n            frameWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n                id: id + '_frameWrapper', className: 'e-frame-wrapper', styles: 'position: relative'\n            }));\n        }\n        frameWrapper.appendChild(parent.createElement('div', {\n            id: id + '_customizeWrapper',\n            styles: 'position: absolute'\n        }));\n        var mainItem = this.getFrameToolbarItem();\n        var args = { toolbarType: 'frame', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createFrameColor();\n                _this.createFrameSize();\n                var frameType = parent.frameObj.type;\n                if (frameType === 'line') {\n                    _this.createFrameRadius();\n                }\n                if (frameType === 'line' || frameType === 'inset' || frameType === 'hook') {\n                    _this.createFrameInset();\n                }\n                if (frameType === 'line' || frameType === 'inset') {\n                    _this.createFrameOffset();\n                }\n                if (frameType === 'line') {\n                    _this.createFrameAmount();\n                    _this.createFrameBorder();\n                }\n                _this.createFrameGradientColor();\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                parent.element.querySelector('#' + id + '_' + frameType).focus();\n            }\n        });\n        toolbar.appendTo('#' + id + '_customizeWrapper');\n    };\n    ToolbarModule.prototype.createFrameGradientColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-frame-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_gradient_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, noColor: true, value: parent.frameObj.gradientColor,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-gradient-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.gradientColor;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.gradientColor = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.gradientColor = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_gradient_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    parentElem.style.left = parent.element.offsetLeft + 'px';\n                }\n            },\n            target: '.e-frame-gradient-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameGradientColorBtn');\n        fillColor.inline = true;\n        if (parent.frameObj.gradientColor === '') {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        else {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').style.background = parent.frameObj.gradientColor;\n        }\n    };\n    ToolbarModule.prototype.createFrameColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, value: parent.frameObj.color,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.color;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.color = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.color = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    parentElem.style.left = parent.element.offsetLeft + 'px';\n                }\n            },\n            target: '.e-frame-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameColorBtn');\n        fillColor.inline = true;\n        parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = parent.frameObj.color;\n    };\n    ToolbarModule.prototype.createFrameSize = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameSizeBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.size.toString());\n        spanElem.className = 'e-frame-stroke-width';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.size;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.size = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.size = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_12 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_12.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_13 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_13.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameSizeBtn');\n    };\n    ToolbarModule.prototype.createFrameInset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameInsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.inset.toString());\n        spanElem.className = 'e-frame-inset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.inset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.inset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.inset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_14 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_14.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_15 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_15.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameInsetBtn');\n    };\n    ToolbarModule.prototype.createFrameOffset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameOffsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.offset.toString());\n        spanElem.className = 'e-frame-offset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.offset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.offset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.offset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_16 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_16.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_17 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_17.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameOffsetBtn');\n    };\n    ToolbarModule.prototype.createFrameRadius = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('0') },\n            { id: '2', text: this.l10n.getConstant('20') },\n            { id: '3', text: this.l10n.getConstant('40') },\n            { id: '4', text: this.l10n.getConstant('60') },\n            { id: '5', text: this.l10n.getConstant('80') },\n            { id: '6', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameRadiusBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.radius.toString());\n        spanElem.className = 'e-frame-radius';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.radius;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.radius = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.radius = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_18 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_18.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_19 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_19.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameRadiusBtn');\n    };\n    ToolbarModule.prototype.createFrameAmount = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('1') },\n            { id: '2', text: this.l10n.getConstant('2') },\n            { id: '3', text: this.l10n.getConstant('3') },\n            { id: '4', text: this.l10n.getConstant('4') },\n            { id: '5', text: this.l10n.getConstant('5') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameAmountBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.amount.toString());\n        spanElem.className = 'e-frame-amount';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.amount;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.amount = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.amount = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_20 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_20.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_21 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_21.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameAmountBtn');\n    };\n    ToolbarModule.prototype.createFrameBorder = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('Solid') },\n            { id: '2', text: this.l10n.getConstant('Dashed') },\n            { id: '3', text: this.l10n.getConstant('Dotted') },\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameBorderBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.toPascalCase(parent.frameObj.border));\n        spanElem.className = 'e-frame-border';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.border;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.border = args.item.text.toLowerCase();\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.border = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_22 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_22.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_23 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_23.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameBorderBtn');\n    };\n    ToolbarModule.prototype.initFilterToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var mainItem = this.getFilterToolbarItem();\n        var args = { toolbarType: 'filter', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        if (document.querySelector('#' + id + '_contextualToolbar').classList.contains('e-control')) {\n            getComponent(document.getElementById(id + '_contextualToolbar'), 'toolbar').destroy();\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.contextualToolbarClicked.bind(this),\n            created: function () {\n                _this.updatePrivateVariables();\n                _this.createCanvasFilter();\n                if (parent.currentFilter === '') {\n                    parent.currentFilter = id + '_default';\n                }\n                var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n                if (hdrWrapper) {\n                    hdrWrapper.style.display = 'none';\n                }\n                var filterElem = document.getElementById(parent.currentFilter + 'Canvas');\n                if (filterElem) {\n                    filterElem.parentElement.parentElement.classList.add('e-selected');\n                }\n                _this.enableDisableTbrBtn();\n                toolbar.refreshOverflow();\n            }\n        });\n        toolbar.appendTo('#' + id + '_contextualToolbar');\n    };\n    ToolbarModule.prototype.drawDashedLine = function (ctx) {\n        ctx.beginPath();\n        ctx.setLineDash([5]);\n        ctx.rect(10, 10, 280, 130);\n        ctx.stroke();\n        ctx.closePath();\n    };\n    ToolbarModule.prototype.createCanvasFilter = function () {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var imageData = parent.getCurrentCanvasData();\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n        this.updateFilterCanvas('_defaultCanvas', 'default');\n        this.updateFilterCanvas('_chromeCanvas', 'chrome');\n        this.updateFilterCanvas('_coldCanvas', 'cold');\n        this.updateFilterCanvas('_warmCanvas', 'warm');\n        this.updateFilterCanvas('_grayscaleCanvas', 'grayscale');\n        this.updateFilterCanvas('_sepiaCanvas', 'sepia');\n        this.updateFilterCanvas('_invertCanvas', 'invert');\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n    };\n    ToolbarModule.prototype.updateFilterCanvas = function (selector, type) {\n        var parent = this.parent;\n        var filter = parent.element.querySelector('#' + parent.element.id + selector);\n        if (filter) {\n            var ctx = filter.getContext('2d');\n            ctx = filter.getContext('2d');\n            filter.style.width = '100px';\n            filter.style.height = '100px';\n            parent.notify('filter', { prop: 'updateAdj', value: { type: type, value: null, isPreview: true, ctx: ctx } });\n            ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        }\n    };\n    ToolbarModule.prototype.getQuickAccessToolbarItem = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var args = { cancel: false, toolbarItems: [] };\n        var toolbarItems = [];\n        if (isNullOrUndefined(isPenEdit)) {\n            if (parent.activeObj.shape === 'image') {\n                toolbarItems.push('Flip');\n            }\n            toolbarItems.push('Clone');\n            toolbarItems.push('Delete');\n            if (parent.activeObj.shape === 'text') {\n                toolbarItems.push('EditText');\n            }\n            args.shape = parent.toPascalCase(parent.activeObj.shape);\n        }\n        else if (isPenEdit) {\n            toolbarItems.push('Delete');\n            args.shape = 'Freehand draw';\n        }\n        args.toolbarItems = extend([], toolbarItems, null, true);\n        parent.trigger('quickAccessToolbarOpen', args);\n        var orgToolbarItems = [];\n        if (args.cancel) {\n            orgToolbarItems = [];\n        }\n        else {\n            for (var i = 0; i < args.toolbarItems.length; i++) {\n                switch (args.toolbarItems[i]) {\n                    case 'Clone':\n                        orgToolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                            tooltipText: this.l10n.getConstant('Duplicate'), align: 'Left' });\n                        break;\n                    case 'Delete':\n                        orgToolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                            tooltipText: this.l10n.getConstant('Remove'), align: 'Left' });\n                        break;\n                    case 'EditText':\n                        orgToolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                            tooltipText: this.l10n.getConstant('EditText'), align: 'Left' });\n                        break;\n                    case 'Flip':\n                        orgToolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-icons e-horizontal-flip',\n                            tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Left' });\n                        orgToolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-icons e-vertical-flip',\n                            tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Left' });\n                        break;\n                    default:\n                        orgToolbarItems.push(args.toolbarItems[i]);\n                        break;\n                }\n            }\n        }\n        return orgToolbarItems;\n    };\n    ToolbarModule.prototype.renderQAT = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.activeObj && parent.showQuickAccessToolbar) {\n            var qtArea = document.getElementById(id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                this.destroyQuickAccessToolbar();\n                qtArea.style.display = 'block';\n            }\n            var items = this.getQuickAccessToolbarItem(isPenEdit);\n            if (items.length === 0) {\n                return;\n            }\n            if (isNullOrUndefined(parent.quickAccessToolbarTemplate)) {\n                var toolbarObj = new Toolbar({\n                    items: items,\n                    clicked: this.quickAccessToolbarClicked.bind(this)\n                });\n                toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n            }\n            var height = this.toolbarHeight && this.toolbarHeight !== 0 ? this.toolbarHeight : qtArea.clientHeight;\n            if (isNullOrUndefined(isPenEdit)) {\n                qtArea.style.width = 'auto';\n                parent.activeObj.activePoint.width = Math.abs(parent.activeObj.activePoint.width);\n                parent.activeObj.activePoint.height = Math.abs(parent.activeObj.activePoint.height);\n                var x = parent.activeObj.activePoint.startX < parent.activeObj.activePoint.endX ?\n                    parent.activeObj.activePoint.startX : parent.activeObj.activePoint.endX;\n                var y = parent.activeObj.activePoint.startY < parent.activeObj.activePoint.endY ?\n                    parent.activeObj.activePoint.startY : parent.activeObj.activePoint.endY;\n                var width = parent.activeObj.activePoint.width;\n                if (parent.activeObj.rotatedAngle !== 0 && parent.activeObj.shape !== 'arrow') {\n                    var object = { activePoint: null };\n                    parent.notify('shape', { prop: 'getSquarePointForRotatedShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj, object: object } });\n                    var point = object['activePoint'];\n                    x = point.startX;\n                    y = point.startY;\n                    width = point.width;\n                }\n                else if (parent.activeObj.shape === 'path') {\n                    var path = parent.getSquarePointForPath(parent.activeObj);\n                    x = path.startX;\n                    y = path.startY;\n                    width = path.width;\n                }\n                qtArea.style.left = (x + (width / 2)) - (items.length * 25) + 'px';\n                if (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2) !== x + (width / 2)) {\n                    var diff = (x + (width / 2)) - (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2));\n                    qtArea.style.left = parseFloat(qtArea.style.left) + diff + 'px';\n                }\n                if (y - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = y - (height + (height / 1.5)) + 'px';\n                }\n            }\n            else if (isPenEdit) {\n                var obj = { activePoint: null };\n                var indexObj = { freehandSelectedIndex: null };\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                parent.notify('freehand-draw', { prop: 'getSqPtFD',\n                    value: { idx: indexObj['freehandSelectedIndex'], obj: obj } });\n                var point = obj['activePoint'];\n                qtArea.style.width = 'auto';\n                qtArea.style.left = (point.startX + (point.width / 2)) - (items.length * 27) + 'px';\n                if (point.startY - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = point.startY - (height + (height / 1.5)) + 'px';\n                }\n            }\n            if (parseFloat(qtArea.style.top) < 0) {\n                qtArea.style.top = '0px';\n            }\n        }\n    };\n    ToolbarModule.prototype.refreshDropDownBtn = function (isDisabled) {\n        if (isNullOrUndefined(isDisabled)) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var annotation = document.querySelector('#' + id + '_annotationBtn');\n        if (annotation) {\n            if (isDisabled) {\n                annotation.classList.add('e-disabled');\n                annotation.parentElement.classList.add('e-overlay');\n            }\n            else {\n                annotation.classList.remove('e-disabled');\n                annotation.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(annotation, 'dropdown-btn').disabled = isDisabled;\n        }\n        var transform = document.querySelector('#' + id + '_transformBtn');\n        if (transform) {\n            if (isDisabled) {\n                transform.classList.add('e-disabled');\n                transform.parentElement.classList.add('e-overlay');\n            }\n            else {\n                transform.classList.remove('e-disabled');\n                transform.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(transform, 'dropdown-btn').disabled = isDisabled;\n        }\n        var adjustment = document.querySelector('#' + id + '_adjustment');\n        if (adjustment) {\n            if (isDisabled) {\n                adjustment.classList.add('e-disabled');\n                adjustment.parentElement.classList.add('e-overlay');\n            }\n            else {\n                adjustment.classList.remove('e-disabled');\n                adjustment.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(adjustment, 'btn').disabled = isDisabled;\n        }\n        var filter = document.querySelector('#' + id + '_filter');\n        if (filter) {\n            if (isDisabled) {\n                filter.classList.add('e-disabled');\n                filter.parentElement.classList.add('e-overlay');\n            }\n            else {\n                filter.classList.remove('e-disabled');\n                filter.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(filter, 'btn').disabled = isDisabled;\n        }\n    };\n    ToolbarModule.prototype.cropSelect = function (args) {\n        var parent = this.parent;\n        parent.isCropTab = true;\n        if (isNullOrUndefined(parent.transform.cropZoomFactor)) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n        }\n        parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n        var text = args.item.id;\n        this.currentToolbar = 'crop';\n        parent.currSelectionPoint = null;\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        var obj = { prevObj: null };\n        parent.notify('crop', { prop: 'getPreviousCropCurrentObj', value: { obj: obj } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: text, startX: null, startY: null, width: null, height: null } });\n        parent.notify('crop', { prop: 'setPreviousCropCurrentObj', value: { obj: obj['prevObj'] } });\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.quickAccessToolbarClicked = function (args, isContextualToolbar) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var points = { x: parent.activeObj.activePoint.startX, y: parent.activeObj.activePoint.startY };\n        if (args.item) {\n            var isPreventUndoRedo = null;\n            var obj = { prevActObj: null };\n            var object = { tempObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('selection', { prop: 'getTempActObj', onPropertyChange: false, value: { obj: object } });\n            object['tempObj']['activePoint']['height'] = Math.abs(object['tempObj']['activePoint']['height']);\n            var pathObject = { isNewPath: null };\n            var ctx = void 0;\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            var left = void 0;\n            var right = void 0;\n            switch (type) {\n                case 'duplicate':\n                    if (!parent.element.querySelector('#' + id + '_duplicate').classList.contains('e-disabled')) {\n                        this.refreshSlider();\n                        if (!pathObject['isNewPath'] && JSON.stringify(object['tempObj']) === JSON.stringify(parent.activeObj)) {\n                            isPreventUndoRedo = true;\n                        }\n                        this.duplicateShape(isPreventUndoRedo);\n                    }\n                    break;\n                case 'remove':\n                    if (!parent.element.querySelector('#' + id + '_remove').classList.contains('e-disabled')) {\n                        this.refreshSlider();\n                        parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n                    }\n                    break;\n                case 'edittext':\n                    if (!parent.element.querySelector('#' + id + '_editText').classList.contains('e-disabled')) {\n                        this.editText();\n                    }\n                    break;\n                case 'rotleft':\n                case 'rotright':\n                    left = parent.element.querySelector('#' + id + '_rotLeft');\n                    right = parent.element.querySelector('#' + id + '_rotRight');\n                    if ((left && !left.classList.contains('e-disabled')) ||\n                        (right && !right.classList.contains('e-disabled'))) {\n                        parent.rotateImage(args.item.id.replace(id + '_', '').toLowerCase());\n                    }\n                    break;\n                case 'hflip':\n                    if (!parent.element.querySelector('#' + id + '_hFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.horizontalFlip(ctx);\n                    }\n                    break;\n                case 'vflip':\n                    if (!parent.element.querySelector('#' + id + '_vFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.verticalFlip(ctx);\n                    }\n                    break;\n            }\n            if (type === 'duplicate' || type === 'remove') {\n                parent.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        if (isNullOrUndefined(isContextualToolbar)) {\n            parent.trigger('quickAccessToolbarItemClick', args);\n        }\n    };\n    ToolbarModule.prototype.editText = function () {\n        var parent = this.parent;\n        var points = { x: parent.activeObj.activePoint.startX, y: parent.activeObj.activePoint.startY };\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: extend({}, parent.activeObj, {}, true) } });\n        parent.notify('selection', { prop: 'setInitialTextEdit', onPropertyChange: false,\n            value: { bool: true } });\n        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n            value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var object = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'getTextBoxPosition', onPropertyChange: false,\n                value: { obj: parent.activeObj, object: object } });\n            points.x = object['x'];\n            points.y = object['y'];\n            var object1 = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'setFlipState', onPropertyChange: false,\n                value: { x: points.x, y: points.y, obj: parent.activeObj, object: object1 } });\n            points.x = object1['x'];\n            points.y = object1['y'];\n        }\n        parent.notify('shape', { prop: 'renderTextArea', onPropertyChange: false,\n            value: { x: points.x, y: points.y, actObj: parent.activeObj } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.duplicateShape = function (isPreventUndoRedo, isPublicMethod) {\n        var parent = this.parent;\n        var tempObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] };\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: tempObj } });\n        var obj = { prevActObj: null };\n        parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n        var pathObject = { isNewPath: null };\n        parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n        var objColl;\n        var duplicateObj = extend({}, parent.activeObj, {}, true);\n        if (duplicateObj.shape === 'image') {\n            objColl = extend([], parent.objColl, [], true);\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else if (obj['prevActObj'] || isPublicMethod) {\n            parent.activeObj.currIndex = null;\n            duplicateObj.currIndex = null;\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        if (pathObject['isNewPath']) {\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        objColl = extend([], parent.objColl, [], true);\n        duplicateObj.activePoint.startX += 10;\n        duplicateObj.activePoint.startY -= 10;\n        duplicateObj.activePoint.endX += 10;\n        duplicateObj.activePoint.endY -= 10;\n        if (duplicateObj.shape === 'path') {\n            for (var i = 0; i < duplicateObj.pointColl.length; i++) {\n                duplicateObj.pointColl[i].x += 10;\n                duplicateObj.pointColl[i].y -= 10;\n            }\n        }\n        else if (duplicateObj.shape === 'image') {\n            duplicateObj.imageCanvas = parent.createElement('canvas');\n        }\n        parent.activeObj = extend({}, duplicateObj, {}, true);\n        if (parent.activeObj.shape === 'image') {\n            var activePoint = extend({}, duplicateObj.activePoint, {}, true);\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.activeObj.imageElement.width, height: parent.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n            parent.activeObj.activePoint.width = dimObj['width'];\n            parent.activeObj.activePoint.height = dimObj['height'];\n            if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = true;\n            }\n            else if (parent.activeObj.isHorImageFlip) {\n                parent.activeObj.isHorImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n                parent.activeObj.isHorImageFlip = true;\n            }\n            else if (parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n                parent.activeObj.isVerImageFlip = true;\n            }\n            else {\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n            }\n            parent.activeObj.activePoint = activePoint;\n        }\n        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n            parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj,\n                isCropRatio: null, points: null, isPreventDrag: true } });\n        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        this.renderQAT();\n    };\n    ToolbarModule.prototype.defToolbarClicked = function (args) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var isFilterFinetune = false;\n        if (!this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = isFilterFinetune = true;\n            }\n            var straightenObj = { bool: parent.isStraightening };\n            if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        if (args.item) {\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            if (type === 'duplicate' || type === 'remove' || type === 'edittext' ||\n                type === 'hflip' || type === 'vflip' || type === 'rotleft' || type === 'rotright') {\n                this.quickAccessToolbarClicked(args, true);\n                parent.trigger('toolbarItemClicked', args);\n            }\n            else {\n                var isDisabledFilter = false;\n                var isDisabledAdjustment = false;\n                var adjustment = document.querySelector('#' + id + '_adjustment');\n                if (adjustment && adjustment.classList.contains('e-disabled')) {\n                    isDisabledAdjustment = true;\n                }\n                var filter = document.querySelector('#' + id + '_filter');\n                if (filter && filter.classList.contains('e-disabled')) {\n                    isDisabledFilter = true;\n                }\n                this.enableDisableTbrBtn();\n                this.performDefTbrClick(type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune);\n                parent.trigger('toolbarItemClicked', args);\n                if (parent.isStraightening) {\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                }\n                var validTypes = ['undo', 'redo', 'cancel', 'aspectratio', 'nonaspectratio',\n                    'save', 'duplicate', 'filter', 'frame', 'none', 'mat', 'bevel', 'line', 'inset', 'hook', 'resize',\n                    'remove'];\n                if (validTypes.indexOf(type) !== -1) {\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.performDefTbrClick = function (type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var zoomIn = parent.element.querySelector('#' + id + '_zoomIn');\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (!parent.disabled) {\n            switch (type) {\n                case 'pan':\n                    parent.currObjType.isCustomCrop = parent.currObjType.isFiltered = false;\n                    if (parent.currObjType.isUndoAction) {\n                        parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n                    }\n                    if (isCropSelection) {\n                        parent.currObjType.isCustomCrop = false;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (parent.togglePan) {\n                        this.cancelPan();\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: true } });\n                        if (this.currentToolbar === 'pen') {\n                            parent.freehandDraw(true);\n                        }\n                    }\n                    else {\n                        panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n                        if (panBtn) {\n                            panBtn.classList.add('e-selected-btn');\n                        }\n                        parent.pan(true);\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: false } });\n                    }\n                    if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n                        zoomIn.classList.add('e-disabled');\n                        zoomIn.parentElement.classList.add('e-overlay');\n                    }\n                    else if (zoomIn) {\n                        zoomIn.classList.remove('e-disabled');\n                        zoomIn.parentElement.classList.remove('e-overlay');\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'cancel':\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar } });\n                    break;\n                case 'ok':\n                    parent.okBtn();\n                    this.refreshDropDownBtn(false);\n                    this.currentToolbar = 'main';\n                    parent.isStraightening = false;\n                    break;\n                case 'crop':\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    break;\n                case 'reset':\n                    parent.reset();\n                    this.imageHeight = null;\n                    this.imageWidth = null;\n                    parent.aspectHeight = null;\n                    parent.aspectWidth = null;\n                    this.isAspectRatio = true;\n                    this.currentToolbar = 'main';\n                    break;\n                case 'undo':\n                    if (parent.togglePen) {\n                        parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar } });\n                    }\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                    break;\n                case 'redo':\n                    if (parent.togglePen) {\n                        parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar } });\n                    }\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                    break;\n                case 'aspectratio':\n                    if (!parent.isCircleCrop && (isNullOrUndefined(parent.currSelectionPoint)) ||\n                        (parent.currSelectionPoint && parent.currSelectionPoint.shape !== 'crop-circle')) {\n                        if (getComponent(aspectRatioWidth, 'numerictextbox').value) {\n                            parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value;\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                        }\n                        else if (getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                            parent.aspectWidth = parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: true } });\n                        }\n                        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                            height: parent.img.srcHeight };\n                        this.refreshToolbar('resize');\n                    }\n                    break;\n                case 'nonaspectratio':\n                    if (getComponent(aspectRatioWidth, 'numerictextbox').value ||\n                        getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                        parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value ?\n                            getComponent(aspectRatioWidth, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                        parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value ?\n                            getComponent(aspectRatioHeight, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioHeight, 'numerictextbox').placeholder);\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                        height: parent.img.srcHeight };\n                    this.refreshToolbar('resize');\n                    break;\n                case 'resize':\n                    if (parent.currObjType.isFiltered) {\n                        parent.okBtn();\n                    }\n                    this.resizeClick();\n                    break;\n                case 'adjustment':\n                    if (!isDisabledAdjustment) {\n                        if (parent.currObjType.isFiltered) {\n                            parent.okBtn();\n                        }\n                        this.refreshToolbar('adjustment');\n                        parent.setTempFilterProperties();\n                        parent.notify('draw', { prop: 'updateFinetune' });\n                        parent.notify('filter', { prop: 'setTempAdjVal' });\n                        this.openSlider('brightness');\n                    }\n                    break;\n                case 'brightness':\n                case 'contrast':\n                case 'hue':\n                case 'saturation':\n                case 'opacity':\n                case 'blur':\n                case 'exposure':\n                    this.openSlider(type);\n                    break;\n                case 'filter':\n                    if (!isDisabledFilter) {\n                        showSpinner(parent.element);\n                        this.refreshToolbar('filter');\n                        parent.setTempFilterProperties();\n                        hideSpinner(parent.element);\n                    }\n                    break;\n                case 'default':\n                case 'chrome':\n                case 'cold':\n                case 'warm':\n                case 'grayscale':\n                case 'blackandwhite':\n                case 'sepia':\n                case 'invert':\n                case 'sharpen':\n                    parent.currObjType.isFiltered = true;\n                    parent.notify('filter', { prop: 'applyImageFilter', value: { option: type } });\n                    break;\n                case 'upload':\n                    if (isFilterFinetune) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.remove('e-hide');\n                    }\n                    break;\n                case 'bold':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_bold').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_bold').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_bold').classList.add('e-selected-btn');\n                    }\n                    break;\n                case 'italic':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_italic').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_italic').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_italic').classList.add('e-selected-btn');\n                    }\n                    break;\n                case 'croptransform':\n                    this.performCropTransformClick();\n                    break;\n                case 'rotateleft':\n                case 'rotateright':\n                case 'horizontalflip':\n                case 'verticalflip':\n                    parent.transformSelect(type);\n                    if (type === 'rotateleft' || type === 'rotateright') {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    break;\n                case 'save':\n                    if (parent.element.querySelector('#' + id + '_saveBtn').classList.contains('e-hide')) {\n                        parent.element.querySelector('#' + id + '_saveBtn').classList.remove('e-hide');\n                        parent.element.querySelector('#' + id + '_saveBtn').focus();\n                        break;\n                    }\n                    else {\n                        parent.okBtn();\n                    }\n                    parent.element.querySelector('#' + id + '_saveBtn').classList.add('e-hide');\n                    parent.element.querySelector('#' + id + '_saveBtn').click();\n                    break;\n                case 'transparency':\n                    this.updateContextualToolbar('transparency', 'transparency');\n                    break;\n                case 'frame':\n                    this.frameToolbarClick();\n                    break;\n                case 'none':\n                case 'mat':\n                case 'bevel':\n                case 'line':\n                case 'inset':\n                case 'hook':\n                    this.unselectFrameBtn();\n                    if (parent.element.querySelector('#' + id + '_' + type)) {\n                        parent.element.querySelector('#' + id + '_' + type).classList.add('e-selected-btn');\n                    }\n                    parent.frameObj.type = type;\n                    parent.frameObj.size = 20;\n                    parent.frameObj.inset = 20;\n                    parent.frameObj.radius = 0;\n                    parent.frameObj.amount = 1;\n                    if (type === 'inset') {\n                        parent.frameObj.offset = 60;\n                    }\n                    else {\n                        parent.frameObj.offset = 20;\n                    }\n                    this.refreshToolbar('frame');\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.isFrameBtnClick = true;\n                    parent.curFrameObjEvent = { previousFrameSetting: parent.tempFrameObj, currentFrameSetting: parent.frameObj };\n                    break;\n            }\n        }\n    };\n    ToolbarModule.prototype.frameToolbarClick = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var frame = document.querySelector('#' + id + '_frame');\n        var zoom;\n        var frameObj;\n        var tempFrameObj;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        if (parent.currObjType.isFiltered) {\n            parent.okBtn();\n        }\n        if (frame && !frame.classList.contains('e-disabled')) {\n            zoom = parent.transform.zoomFactor;\n            parent.frameDestPoints = extend({}, parent.img, {}, true);\n            if (isNullOrUndefined(parent.cxtTbarHeight)) {\n                frameObj = extend({}, parent.frameObj, {}, true);\n                tempFrameObj = extend({}, parent.tempFrameObj, {}, true);\n                this.callFrameToolbar();\n                parent.frameObj.type = 'mat';\n                this.callFrameToolbar();\n                parent.cxtTbarHeight = parent.element.querySelector('#' + id + '_customizeWrapper').scrollHeight;\n                parent.frameObj = frameObj;\n                parent.tempFrameObj = tempFrameObj;\n            }\n            this.zoomToFrameRange();\n            parent.tempFrameZoomLevel = zoom;\n            if (Browser.isDevice) {\n                parent.img.destTop -= (parent.cxtTbarHeight / 2);\n            }\n            else {\n                parent.img.destTop += (parent.cxtTbarHeight / 2);\n            }\n            this.callFrameToolbar();\n        }\n    };\n    ToolbarModule.prototype.zoomToFrameRange = function () {\n        var parent = this.parent;\n        this.isFrameToolbar = false;\n        parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n        while (true) {\n            if (this.toolbarHeight + parent.img.destTop >= (this.toolbarHeight + parent.cxtTbarHeight)) {\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -.1, zoomPoint: null, isResize: true } });\n        }\n        this.isFrameToolbar = true;\n    };\n    ToolbarModule.prototype.resizeClick = function () {\n        var parent = this.parent;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        parent.upperCanvas.style.cursor = 'default';\n        parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        if (this.isAspectRatio) {\n            this.isAspectRatio = false;\n        }\n        else {\n            this.isAspectRatio = true;\n        }\n        parent.isResize = true;\n        this.refreshToolbar('resize');\n    };\n    ToolbarModule.prototype.callFrameToolbar = function () {\n        var parent = this.parent;\n        extend(parent.tempFrameObj, parent.frameObj);\n        var undoRedoObj = { appliedUndoRedoColl: [] };\n        parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: undoRedoObj } });\n        if (undoRedoObj['appliedUndoRedoColl']['length'] === 0) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                    operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                    previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                    previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                    previousFilter: null, isCircleCrop: null\n                } });\n        }\n        this.refreshToolbar('frame');\n    };\n    ToolbarModule.prototype.contextualToolbarClicked = function (args) {\n        var parent = this.parent;\n        var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selEle) {\n            selEle.classList.remove('e-selected');\n        }\n        var type = args.item.id.replace(parent.element.id, '').split('_')[1];\n        var imageFiltering = { filter: parent.toPascalCase(type), cancel: false };\n        parent.trigger('imageFiltering', imageFiltering);\n        if (imageFiltering.cancel) {\n            return;\n        }\n        document.getElementById(args.item.id + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n        parent.currObjType.isFiltered = true;\n        parent.notify('filter', { prop: 'applyImageFilter', value: { option: type.toLowerCase() } });\n        parent.notify('draw', { prop: 'redrawDownScale' });\n        parent.currentFilter = args.item.id;\n        this.enableDisableTbrBtn();\n        parent.isFilterCanvasClick = true;\n        parent.curFilterObjEvent = imageFiltering;\n    };\n    ToolbarModule.prototype.refreshShapeDrawing = function () {\n        var parent = this.parent;\n        var object = { shape: '' };\n        parent.notify('selection', { prop: 'getCurrentDrawingShape', onPropertyChange: false, value: { obj: object } });\n        if (object['shape'] !== '') {\n            parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.refreshToolbar('main', false);\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnClickHandler = function (e) {\n        if (e) {\n            var parent_1 = this.parent;\n            if ((parent_1.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                if (parent_1.currObjType.isFiltered) {\n                    parent_1.okBtn();\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomIn = document.querySelector('#' + parent_1.element.id + '_zoomIn');\n                EventHandler.trigger(zoomIn, 'click');\n                var obj = { bool: false };\n                parent_1.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_1.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_1.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_1.currObjType.isFiltered = false;\n                if (parent_1.togglePen) {\n                    parent_1.currObjType.isZoomed = true;\n                    parent_1.freeHandDraw(false);\n                    parent_1.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_1.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_1.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: .1, zoomPoint: null, isResize: null } });\n                parent_1.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_1.isCropTab || parent_1.activeObj.shape) {\n                    parent_1.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_1.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_1.isStraightening) {\n                    parent_1.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_1.notify('draw', { prop: 'setDestForStraighten' });\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomOutBtnClickHandler = function (e) {\n        if (e) {\n            var parent_2 = this.parent;\n            if ((parent_2.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                if (parent_2.currObjType.isFiltered) {\n                    parent_2.okBtn();\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomOut = document.querySelector('#' + parent_2.element.id + '_zoomOut');\n                EventHandler.trigger(zoomOut, 'click');\n                var obj = { bool: false };\n                parent_2.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_2.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_2.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_2.currObjType.isFiltered = false;\n                if (parent_2.togglePen) {\n                    parent_2.currObjType.isZoomed = true;\n                    parent_2.freeHandDraw(false);\n                    parent_2.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_2.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_2.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -.1, zoomPoint: null, isResize: null } });\n                parent_2.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_2.isCropTab || parent_2.activeObj.shape) {\n                    parent_2.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_2.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_2.isStraightening) {\n                    parent_2.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_2.notify('draw', { prop: 'setDestForStraighten' });\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomInBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomOutBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomOutBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomBtnMouseUpHandler = function () {\n        clearInterval(this.zoomBtnHold);\n        this.zoomBtnHold = 0;\n    };\n    ToolbarModule.prototype.closeContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n            if ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n                !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n                (parent.element.querySelector('#' + id + '_headWrapper')\n                    && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                parent.okBtn();\n                this.refreshMainToolbar();\n                isContextualToolbar = true;\n            }\n        }\n        return isContextualToolbar;\n    };\n    ToolbarModule.prototype.destroyQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var quickToolbar = document.getElementById(id + '_quickAccessToolbar');\n        if (quickToolbar && quickToolbar.classList.contains('e-control')) {\n            getComponent(quickToolbar, 'toolbar').destroy();\n        }\n        var qatArea = document.getElementById(id + '_quickAccessToolbarArea');\n        if (qatArea) {\n            qatArea.style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.renderSlider = function (type, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + id + '_labelWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.remove();\n            labelWrapper.remove();\n        }\n        hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n            id: id + '_headWrapper',\n            styles: 'position: relative'\n        }));\n        if (type === 'transparency') {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? 'position: absolute; top: 31%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n                    : 'position: absolute; top: 31%; left: calc(50% - 220px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        else {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? ('position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;')\n                    : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        labelWrapper.textContent = this.l10n.getConstant(parent.toPascalCase(type === 'transparency' ? 'opacity' : type));\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: id + '_sliderWrapper',\n            className: 'e-ie-finetune-slider-wrap',\n            styles: 'position: absolute'\n        }));\n        var value = parent.getCurrAdjustmentValue(type);\n        if (isSelect && type === 'straighten' && Browser.isDevice) {\n            value = parent.cropObj.straighten;\n        }\n        var min;\n        var max;\n        var slider;\n        if (type === 'brightness' || type === 'contrast' || type === 'saturation' || type === 'exposure') {\n            if (parent.finetuneSettings) {\n                if (type === 'brightness' && parent.finetuneSettings.brightness) {\n                    min = parent.finetuneSettings.brightness.min;\n                    max = parent.finetuneSettings.brightness.max;\n                }\n                else if (type === 'contrast' && parent.finetuneSettings.contrast) {\n                    min = parent.finetuneSettings.contrast.min;\n                    max = parent.finetuneSettings.contrast.max;\n                }\n                else if (type === 'saturation' && parent.finetuneSettings.saturation) {\n                    min = parent.finetuneSettings.saturation.min;\n                    max = parent.finetuneSettings.saturation.max;\n                }\n                else if (type === 'exposure' && parent.finetuneSettings.exposure) {\n                    min = parent.finetuneSettings.exposure.min;\n                    max = parent.finetuneSettings.exposure.max;\n                }\n                else {\n                    min = -100;\n                    max = 100;\n                }\n            }\n            else {\n                min = -100;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'hue' || type === 'blur' || type === 'opacity') {\n            if (parent.finetuneSettings) {\n                if (type === 'hue' && parent.finetuneSettings.hue) {\n                    min = parent.finetuneSettings.hue.min;\n                    max = parent.finetuneSettings.hue.max;\n                }\n                else if (type === 'blur' && parent.finetuneSettings.blur) {\n                    min = parent.finetuneSettings.blur.min;\n                    max = parent.finetuneSettings.blur.max;\n                }\n                else if (type === 'opacity' && parent.finetuneSettings.opacity) {\n                    min = parent.finetuneSettings.opacity.min;\n                    max = parent.finetuneSettings.opacity.max;\n                }\n                else {\n                    min = 0;\n                    max = 100;\n                }\n            }\n            else {\n                min = 0;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'transparency') {\n            min = 0;\n            max = 100;\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'straighten') {\n            min = -45;\n            max = 45;\n            slider = this.createSlider(min, max, value, type);\n        }\n        slider.appendTo('#' + id + '_sliderWrapper');\n        sliderWrapper.style.left = (parseFloat(canvasWrapper.style.width) - parseFloat(slider.width)) / 2 + 'px';\n        if (type === 'straighten' && Browser.isDevice) {\n            var sLabelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_sLabelWrapper',\n                className: 'e-ie-straighten-value-span e-ie-finetune-value-span',\n                styles: 'position: absolute; top: 31%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sLabelWrapper.innerHTML = parent.transform.straighten.toString() + '&#176';\n            sliderWrapper.parentElement.classList.add('e-straighten-slider');\n        }\n        if (type !== 'straighten') {\n            hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_finetuneSpan',\n                className: 'e-ie-finetune-value-span',\n                styles: Browser.isDevice ? ('position: absolute; top: 25%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;') :\n                    'position: absolute; top: 25%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sliderWrapper.parentElement.classList.add('e-finetune-slider');\n            if (type === 'transparency' && Browser.isDevice) {\n                sliderWrapper.parentElement.classList.add('e-ie-device-transparency-slider');\n            }\n            this.updateFinetuneSpan(type);\n        }\n    };\n    ToolbarModule.prototype.createSlider = function (min, max, value, type) {\n        var _this = this;\n        var parent = this.parent;\n        var step = type === 'straighten' ? 3 : 1;\n        return new Slider({\n            value: value, type: 'MinRange', min: min, max: max,\n            step: step, width: Browser.isDevice ? '180px' : (type === 'straighten' ? '200px' : '300px'),\n            cssClass: 'e-slider',\n            change: function (args) {\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: true } });\n                if (type === 'transparency') {\n                    if (parent.activeObj.shape) {\n                        var prevCropObj = void 0;\n                        var prevObj = void 0;\n                        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        }\n                        parent.notify('shape', { prop: 'pushActItemIntoObj' });\n                        prevCropObj = extend({}, parent.cropObj, {}, true);\n                        var object = { currObj: {} };\n                        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                        prevObj = object['currObj'];\n                        prevObj.objColl = extend([], parent.objColl, [], true);\n                        prevObj.pointColl = extend([], parent.pointColl, [], true);\n                        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                        var selPointCollObj = { selPointColl: null };\n                        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                            value: { obj: selPointCollObj } });\n                        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                        parent.objColl.pop();\n                        parent.activeObj.opacity = args.value / 100;\n                        _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        parent.objColl.push(parent.activeObj);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                previousCropObj: prevCropObj, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                        parent.notify('selection', { prop: 'redrawShape', value: { obj: parent.objColl[parent.objColl.length - 1] } });\n                        _this.updateFinetuneSpan(type);\n                    }\n                }\n                else if (type === 'straighten') {\n                    parent.setStraighten(args.value);\n                }\n                else {\n                    if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n                        parent.isFinetuning = true;\n                    }\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: true } });\n                    parent.setCurrAdjustmentValue(type, args.value);\n                    _this.updateFinetuneSpan(type);\n                    _this.enableDisableTbrBtn();\n                    parent.isFinetuning = false;\n                }\n            },\n            changed: function () {\n                if (type !== 'transparency' && type !== 'straighten') {\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: false } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: false } });\n            }\n        });\n    };\n    ToolbarModule.prototype.updateFinetuneSpan = function (type) {\n        var parent = this.parent;\n        var ftValPan = parent.element.querySelector('.e-ie-finetune-value-span');\n        if (ftValPan) {\n            var adjObj = { adjustmentLevel: null };\n            parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n            ftValPan.innerHTML = Math.round(adjObj['adjustmentLevel'][type]).toString();\n        }\n    };\n    ToolbarModule.prototype.applyPreviewFilter = function () {\n        var parent = this.parent;\n        if (document.querySelector('#' + parent.element.id + '_sliderWrapper') ||\n            parent.currObjType.isFiltered) {\n            parent.initialAdjustmentValue = this.lowerContext.filter;\n            parent.canvasFilter = this.lowerContext.filter;\n            parent.currObjType.isFiltered = false;\n        }\n    };\n    ToolbarModule.prototype.unselectBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_brightness',\n            '#' + id + '_contrast',\n            '#' + id + '_hue',\n            '#' + id + '_saturation',\n            '#' + id + '_opacity',\n            '#' + id + '_blur',\n            '#' + id + '_exposure'\n        ];\n        for (var _i = 0, selectors_1 = selectors; _i < selectors_1.length; _i++) {\n            var selector = selectors_1[_i];\n            var element = document.querySelector(selector);\n            if (element && element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.openSlider = function (type) {\n        this.unselectBtn();\n        this.parent.currObjType.isFiltered = true;\n        this.refreshToolbar('color', null, null, null, type);\n        document.getElementById(this.parent.element.id + '_' + type).classList.add('e-selected-btn');\n    };\n    ToolbarModule.prototype.refreshSlider = function () {\n        var id = this.parent.element.id;\n        var sliderWrapper = document.querySelector('#' + id + '_sliderWrapper');\n        // eslint-disable-next-line\n        var slider = document.querySelector('.e-slider');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.style.display = 'none';\n        }\n        if (sliderWrapper && slider) {\n            slider.ej2_instances[0].destroy();\n            sliderWrapper.remove();\n        }\n    };\n    ToolbarModule.prototype.unselectFrameBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_none',\n            '#' + id + '_mat',\n            '#' + id + '_line',\n            '#' + id + '_inset',\n            '#' + id + '_bevel',\n            '#' + id + '_hook'\n        ];\n        for (var _i = 0, selectors_2 = selectors; _i < selectors_2.length; _i++) {\n            var selector = selectors_2[_i];\n            var element = document.querySelector(selector);\n            if (element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.updateToolbarItems = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded) {\n            return;\n        }\n        if (this.isToolbar()) {\n            var selFillElem = parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n            var selStrokeElem = parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n            var selTextStrokeElem = parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n            var selPenStrokeElem = parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n            var strokeWidthElem = parent.element.querySelector('.e-shape-stroke-width');\n            var fontFamilyElem = parent.element.querySelector('.e-text-font-family');\n            var fontSizeElem = parent.element.querySelector('.e-text-font-size');\n            var boldBtn = parent.element.querySelector('#' + id + '_bold');\n            var italicBtn = parent.element.querySelector('#' + id + '_italic');\n            if (parent.activeObj.strokeSettings && parent.activeObj.textSettings) {\n                if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                    parent.activeObj.strokeSettings.strokeWidth = 2;\n                }\n                if (selFillElem) {\n                    var value = parent.activeObj.strokeSettings.fillColor;\n                    if (parent.activeObj.strokeSettings.fillColor === '') {\n                        selFillElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selFillElem.classList.remove('e-nocolor-item');\n                        selFillElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_shape_fill')) {\n                        getComponent(id + '_shape_fill', 'colorpicker').value = value;\n                    }\n                }\n                if (selStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_shape_stroke')) {\n                        getComponent(id + '_shape_stroke', 'colorpicker').value = value;\n                    }\n                }\n                if (selTextStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selTextStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_text_font')) {\n                        getComponent(id + '_text_font', 'colorpicker').value = value;\n                    }\n                }\n                if (selPenStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selPenStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_pen_stroke')) {\n                        getComponent(id + '_pen_stroke', 'colorpicker').value = value;\n                    }\n                    var obj = { penOpacity: 1 };\n                    parent.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n                }\n                if (fontFamilyElem) {\n                    if (Browser.isDevice) {\n                        fontFamilyElem.setAttribute('style', 'font-family:' + parent.activeObj.textSettings.fontFamily.toLowerCase());\n                    }\n                    else {\n                        fontFamilyElem.textContent = parent.activeObj.textSettings.fontFamily;\n                    }\n                }\n                if (fontSizeElem) {\n                    for (var i = 0; i < parent.fontSizeColl.length; i++) {\n                        if (parseInt(parent.fontSizeColl[i].text, 10) >= Math.round(parent.activeObj.textSettings.fontSize)) {\n                            fontSizeElem.textContent = (i + 1).toString();\n                            break;\n                        }\n                    }\n                }\n                if (boldBtn) {\n                    if (parent.activeObj.textSettings.bold) {\n                        boldBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        boldBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (italicBtn) {\n                    if (parent.activeObj.textSettings.italic) {\n                        italicBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        italicBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (strokeWidthElem) {\n                    var strokeWidth = Math.round((parent.activeObj.strokeSettings.strokeWidth)).toString();\n                    strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 0:\n                strokeWidth = this.l10n.getConstant('NoOutline');\n                break;\n            case 1:\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case 2:\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case 3:\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case 4:\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case 5:\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ToolbarModule.prototype.cancelPan = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        parent.pan(false);\n    };\n    ToolbarModule.prototype.refreshMainToolbar = function () {\n        if (this.currToolbar !== 'main') {\n            this.refreshToolbar('main');\n        }\n    };\n    ToolbarModule.prototype.destroySubComponents = function () {\n        var parent = this.parent;\n        var inputElement = parent.element.querySelectorAll('input.e-control');\n        var btnElement = parent.element.querySelectorAll('button.e-control');\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-color-picker')) {\n                getComponent(inputElement[i], 'color-picker').destroy();\n                detach(select('input#' + inputElement[i].id, parent.element));\n            }\n        }\n        for (var i = 0, len = btnElement.length; i < len; i++) {\n            if (btnElement[i].classList.contains('e-dropdown-btn')) {\n                getComponent(btnElement[i], 'dropdown-btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n            else if (btnElement[i].classList.contains('e-btn')) {\n                getComponent(btnElement[i], 'btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n        }\n    };\n    ToolbarModule.prototype.setInitialShapeSettings = function (args) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.currObjType.shape = args.item.id;\n        parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n        parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n    };\n    ToolbarModule.prototype.isToolbarString = function (items) {\n        var isString = false;\n        for (var i = 0; i < items.length; i++) {\n            if (typeof (items[i]) === 'string') {\n                isString = true;\n                break;\n            }\n        }\n        return isString;\n    };\n    ToolbarModule.prototype.excludeItems = function (items) {\n        var indexArr = [];\n        for (var i = 0; i < items.length; i++) {\n            var index = this.getIndex(items[i]);\n            if (index !== -1) {\n                indexArr.push(index);\n            }\n        }\n        var negativeIndexArr = [];\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            if (this.defToolbarItems[i].align === 'Center' && !this.isSameIndex(indexArr, i) &&\n                this.defToolbarItems[i].id !== this.parent.element.id + '_' + 'annotation') {\n                negativeIndexArr.push(i);\n            }\n        }\n        for (var i = negativeIndexArr.length - 1; i >= 0; i--) {\n            this.defToolbarItems.splice(negativeIndexArr[i], 1);\n        }\n    };\n    ToolbarModule.prototype.isSameIndex = function (indexArr, index) {\n        for (var i = 0; i < indexArr.length; i++) {\n            if (indexArr[i] === index) {\n                return true;\n            }\n        }\n        return false;\n    };\n    ToolbarModule.prototype.getIndex = function (item) {\n        var index = -1;\n        var isFontColor = false;\n        if (item === 'rotateLeft') {\n            item = 'rotLeft';\n        }\n        if (item === 'rotateRight') {\n            item = 'rotRight';\n        }\n        if (item === 'horizontalFlip') {\n            item = 'hflip';\n        }\n        if (item === 'verticalFlip') {\n            item = 'vflip';\n        }\n        if (item === 'arrowStart') {\n            item = 'start';\n        }\n        if (item === 'arrowEnd') {\n            item = 'end';\n        }\n        if (item === 'fontColor') {\n            item = 'strokeColor';\n            isFontColor = true;\n        }\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            var id = this.defToolbarItems[i].id;\n            if (id && id.toLowerCase().indexOf(item.toLowerCase()) !== -1) {\n                index = i;\n                break;\n            }\n        }\n        if (isFontColor) {\n            item = 'fontColor';\n        }\n        return index;\n    };\n    ToolbarModule.prototype.getModuleName = function () {\n        return 'toolbar-module';\n    };\n    return ToolbarModule;\n}());\nexport { ToolbarModule };\n"],"names":["Crop","parent","this","croppedDegree","cropDestPoints","startX","startY","width","height","tempFlipPanPoint","x","y","isPreventScaling","isInitCrop","isTransformCrop","addEventListener","prototype","destroy","isDestroyed","removeEventListener","on","cropping","off","args","updateCropPvtVar","prop","cropImg","value","cropCircle","setCurrSelPoints","updateRotatePan","crop","calcRatio","isObjInImage","getCurrFlipState","prevCropCurrObj","isNullOrUndefined","adjustStraightenForShapes","resizeWrapper","reset","getModuleName","lowerCanvas","lowerContext","getContext","upperCanvas","upperContext","isRotateCrop","isNullCrop","resizeIcon","element","querySelector","id","actPoint","activeObj","activePoint","img","isRotated","i","len","rotateFlipColl","length","currentValue","notify","onPropertyChange","transform","degree","updateCropObj","point","destLeft","destTop","destWidth","destHeight","rotateCrop","currFlipState","flipCrop","tempZoomFactor","zoomFactor","ratio","currSelectionPoint","extend","obj","isImgShape","maxDimension","clearRect","srcLeft","srcTop","srcWidth","srcHeight","clientWidth","clientHeight","temp","filter","cropObjColl","straighten","isPreventApply","objColl","shape","canvas","cropFreehandDrawColl","context","isCircleCrop","currObjType","isCustomCrop","pan","defaultZoomFactor","type","isInitialRotated","center","_i","_a","indexOf","rotatedAngle","_b","angle","diffX","diffY","cosAngle","Math","cos","sinAngle","sin","diffXUpdated","diffYUpdated","endX","endY","afterCropActions","object","currObj","cropObj","flipState","push","tempCurrSelObj","preventSelObj","bool","coll","panToSelRangle","pop","straightenBaseImageCanvas","isMouseWheel","resetZoom","revertTransform","isIntersect","count","zoomPoint","isResize","isRotate","direction","toPascalCase","toString","updateFlipState","shapeFlip","pointColl","freehandCounter","isUndoRedo","setProperties","zoomSettings","previousZoomValue","isReverseFlip","panPoint","totalPannedPoint","tempCurrFlipState","flipColl","tempFlipColl","panX","panY","setTransform","isPreventDestination","isPreventCircleCrop","isRotateZoom","imageRatio","size","shapeDegree","abs","textSettings","fontRatio","fontSize","cropPointCollection","n","ratioX","ratioY","points","l","resetAnnotations","isSetDimension","allowDownScale","destPoint","isCropTab","baseImgCanvas","currSelPoint","totalPannedInternalPoint","cropPointColl","straightenObj","straightenPoint","destPoints","selPointColl","cropSelPointColl","actObj","xDiff","yDiff","currentPannedPoint","cropZoom","isContextualToolbar","isApplyBtn","isCropping","isZooming","cType","document","innerHTML","isReverse","pannedPoint","totalPannedClientPoint","isSave","isFlip","globalCompositeOperation","beginPath","centerX","centerY","radius","arc","PI","closePath","fill","restore","isActiveObj","getCurrCropState","isAllowInvert","state","isInitialRotate","panRegion","disabled","isImageLoaded","isCropToolbar","isUndoAction","transitionArgs","cancel","startPoint","endPoint","preventScaling","trigger","cropEvent","splitWords","split","horTopLine","isCrop","prevCropObj","prevObj","Browser","isDevice","updateUndoRedoColl","aspectIcon","nonAspectIcon","currSelPtObj","prevCurrSelectionPoint","operation","previousObj","previousObjColl","previousPointColl","previousSelPointColl","previousCropObj","previousText","currentText","previousFilter","elem","ctxToolbar","style","position","isStraightening","update","adjustmentValue","canvasFilter","dimension","widthRatio","heightRatio","dummyObj","isInside","panObj","collection","isRotateFlipCollection","region","Draw","isInitialLoading","fileName","isErrorImage","isShapeTextInserted","tempStrokeSettings","strokeColor","fillColor","strokeWidth","tempTextSettings","text","fontFamily","bold","italic","underline","tempAdjValue","tempFilter","tempUndoRedoStep","tempFreehandCounter","tempCurrFhdIndex","isCancelAction","rotatedFlipCropSel","zoomCrop","isImageEdited","isFileChanged","isNewPath","isResizeSelect","arrowDimension","bar","arrow","arrowSolid","circle","square","origDim","isImageApply","imgCanvasPoints","isCropSelect","isDownScale","preventStraightening","draw","updatePrivateVariables","drawObject","updateActiveObject","clearOuterCanvas","setDestPoints","updateCurrTransState","currTransState","renderImage","drawImgToCanvas","updateCanvas","performCancel","updateFlipPan","select","callUpdateCurrTransState","resetPanPoints","setClientTransDim","redrawImgWithObj","setCurrentObj","performPointZoom","open","getInitialLoaded","fileSelect","fileType","initZoomValue","prevActObj","dlgBtnClick","dlgCloseBtnClick","moveToSelectionRange","applyFrame","drawImage","downScaleImgCanvas","downScale","resetFrameZoom","triggerFrameChange","zoomToSel","straightenActObj","updateImgCanvasPoints","isLinesIntersect","setDestForStraighten","tempStraightenDestPoints","straightenDestPoints","straightenInitZoom","checkPointPosition","updateCropSelection","updateCropSelObj","redrawDownScale","updateFinetune","isSelOutsideImg","default","inMemoryContext","inMemoryCanvas","ctx","imageData","getImageData","putImageData","frameObj","isCropRatio","isPreventDrag","saveContext","isPreventSelection","canvasDraw","toLowerCase","setDragLimit","drawCropRatio","strokeSettings","obj_1","isText","obj_2","keyHistory","fillStyle","fillRect","rotateContext","drawOuterSelection","drawShapeObj","undefined","drawCornerCircles","_c","translateX","translateY","rotationAngle","translate","rotate","min","max","updateWidthHeight","canvasWidth","canvasHeight","drawCustomSelection","imgWidth","imgHeight","updatePoints","diff","adjToCenter","enlargeToImg","adjToStraighten","arr","tempActPoint","isMouseMove","horCircleWidth","verCircleHeight","horBottomLine","verLeftLine","verRightLine","topLeftCircle","topCenterCircle","topRightCircle","centerLeftCircle","centerRightCircle","bottomLeftCircle","bottomCenterCircle","bottomRightCircle","rotationCirclePoint","isCropCircle","lineWidth","tempObj","strokeStyle","themeColl","theme","moveTo","lineTo","stroke","selectionSettings","showCircle","drawRotationArcLine","drawCenterCircles","rotationCircleLine","drawArrowHead","isStartHead","start","end","arrowCircleSolid","arrowCircle","arrowBar","arrowSquareStart","arrowSquareEnd","currentShape","shapeType","horLineWidth","verLineHeight","selectionWidth","selectionHeight","tempFillStyle","drawSquareLines","ellipse","shapeCircle","shapeLine","triangleDirection","nextPoint","shapeText","shapeImage","drawSelection","rect","isHorizontalflip","isVerticalflip","flipObjColl","flipStr","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","tempWidth","save","clip","x1","y1","x2","y2","tempLineWidth","manipulateSaveCtx","strWidth","dx","dy","atan2","isStartArrow","isEndArrow","isEndCircleOrSquare","isStartArrowSolid","isEndArrowSolid","isStartSquare","isEndCircle","isStartSquareSolid","isEndCircleSolid","strokeRect","squareStartIntersectX1","squareStartIntersectY1","endCircleIntersectX1","endCircleIntersectY1","squareEndIntersectX1","squareEndIntersectY1","startCircleIntersectX1","startCircleIntersectY1","circleRadius","a","intersect","b","c","t2","sqrt","intersectionX1","intersectionY1","isStartCircleSolid","imageCanvas","dimObj","imageElement","imgPoint","globalAlpha","opacity","rotateImage","rows","lineHeight","yPoint","textStyle","font","rotateText","fillText","updateActPoint","tempActiveObj","tempDegree","tempColl","scale","textFlipDegree","left","top","isRotatePan","isStraighten","isPreventDimension","setTransformColl","isPreventClearRect","isFrame","isMouseDown","imageOnLoad","src","_this","proxy","baseImg","onload","hideSpinner","updateBaseImgCanvas","fileOpened","isValidImage","isUndoZoom","display","eventargs","isOkBtn","isMainToolbar","onerror","errorLoading","setAttribute","zoom","isOk","tempFrameZoomLevel","cancelCropSelection","currentObj","frame","JSON","stringify","tempFrameObj","textArea","isFiltered","initialAdjustmentValue","isBrightnessAdjusted","currentFilter","bevelFilter","obj_3","tempAdjustmentLevel","adjustmentLevel","step","cursor","classList","add","cancelItems","togglePan","isDisabled","isCropSelection","ascpectIcon","shapes","currentToolbar","aspectRatioElement","blrAspRatElem","aspectWidth","contains","aspectHeight","obj1","obj2","togglePen","cancelPen","cancelText","cancelShape","cancelSelection","tempPointsColl","isFreehandDrawCustomized","currIndex","appliedUndoRedoColl","appliedColl","currentObjColl","clearSelection","iLen","currObjColl","j","jLen","isDragging","tempStraighten","selPointCollObj","currentPointColl","currentSelPointColl","currentCropObj","tempSelectionObj","isPrevent","cropZoomFactor","drawNewSelection","cropShape","updateSelectionInsert","shapeSettingsObj","getSelectionType","selectionChangingArgs","action","previousSelectionSettings","currentSelectionSettings","destLeft_1","destTop_1","destWidth_1","destHeight_1","lowerCanvasWidth_1","lowerCanvasHeight_1","activePoint_1","destLeft_2","destTop_2","destWidth_2","destHeight_2","lowerCanvasWidth_2","lowerCanvasHeight_2","activePoint_2","lowerCanvasWidth","lowerCanvasHeight","adjActObj","tempObjColl","tempTogglePen","isObj","defaultZoom","straightenZoom","srcPoints","isBrightAdjust","drawCropSelectionImage","isDefaultZoom","isAfterCropAction","clearContext","zoomValue","panToPoint","drawZoomPanImage","adjustPanning","panToSel","destLeft_3","destTop_3","destWidth_3","destHeight_3","forEach","prevStraightenedDegree","setStraighten","openNewImage","showSpinner","toolbar","defToolbarItems","getElementById","openURL","getFileExtensionFromURL","toDataURL","export","applyDialogOption","checkToolbarTemplate","inputElem","getComponent","showDialogPopup","headerObj","key","contentObj","yesObj","noObj","Dialog","header","closeOnEscape","content","target","isModal","animationSettings","effect","close","bind","buttons","click","buttonModel","iconCss","isPrimary","appendTo","restoreOldImage","data","url","lastDotIndex","lastIndexOf","slice","inputElement","filesData","fileData","files","rawFile","fileExtension","name","fileExtensionArray","window","URL","createObjectURL","isChangesSaved","toolbarTemplate","maxZoomFactor","isSelectionBiggerThanCanvas","isSelectionOutsideCanvas","isBigger","isOutside","toolbarHeight","isImgAnnotation","isHFlip","isVFlip","tempCanvas","createElement","attrs","isHorImageFlip","isVerImageFlip","isFinetuning","widthSource","heightSource","round","halfWidthRatio","ceil","halfHeightRatio","img2","createImageData","data2","weight","weights","alphaWeights","r","g","floor","stopY","w0","stopX","w","xPos","drawImgToCtx","preventImg","getFrameColor","color","gradientColor","gradient","createLinearGradient","addColorStop","inset","offset","amount","border","newWidth","newHeight","valueForty","valueFifty","bevelObj","quadraticCurveTo","arcY2","lineY","arcX2","lineX","arcX1","lineX2","arcY1","lineY2","setLineDash","arcTo","prevFrameSettings","frameChange","previousFrameSetting","currentFrameSetting","borderRadius","frameLineStyle","lineCount","setFrameObj","currFrameSettings","isToolbar","pow","performDummyZoom","setZoomPan","calcStraightenedPoints","isDestPointSmall","isSmall","this_1","left_1","top_1","width_1","height_1","selectionObj","getImagePoints","p1","p2","p3","p4","imgPoints","isTopIntersect","doIntersect","isRightIntersect","isBottomIntersect","isLeftIntersect","isTopLeftInsideRect","isInsideRect","isTopRightInsideRect","isBottomRightInsideRect","isBottomLeftInsideRect","calcTriangleArea","x3","y3","x4","y4","area1","area2","area3","area4","areaRectangle","dim","getRotatedCanvasDim","baseImgCanvasWidth","baseImgCanvasHeight","baseImgWidth","baseImgHeight","radians","d","point1","initiation","point2","point3","point4","onSegment","Export","updatePvtVar","exportImg","exportToCanvas","drawAnnotation","updateSaveContext","imageName","isZoomed","beforeSave","beforeSaveEvent","observableSaveArgs","lowerCaseType","toSVGImg","toBlobFn","saved","maxWidth","maxHeight","dataUrl","svg","createElementNS","setAttributeNS","appendChild","svgDataUrl","btoa","downloadImg","imagetype","toBlob","blob","blobUrl","tempCropObj","okBtn","tempContextFilter","parseFloat","join","tempContext","exportTransformedImage","updateFrame","widthObj","penStrokeWidth","tempPointColl","isAnnotation","href","download","body","documentElement","parentNode","removeChild","flip","exportRotate","exportFlip","setMaxDim","flipHorizontal","flipVertical","Filter","brightness","contrast","hue","saturation","blur","exposure","transparency","sharpen","bw","tempAdjVal","tempFilVal","finetuneImage","setFilter","updateFinetunes","setAdjustment","updateFilter","initFilter","setCurrAdjValue","updateAdj","getCurrentObj","getDefaultFilter","fs","finetuneSettings","property","defaultValue","setFilterAdj","isPreview","values","getFilterValue","saturate","bright","saturatePercent","saturatePercentage","getSaturationFilterValue","getDefaultCurrentFilter","setTempFilterValue","tempSplitWords","prevFilter","valueArr","setFilterValue","setSaturationFilterValue","selEle","remove","filterCanvas","parentElement","finetuneOption","isFinetuneBtnClick","curFinetuneObjEvent","finetune","tempFlipPanPointObj","zoomObj","FreehandDrawing","fhdObj","lastWidth","lastVelocity","time","pointX","pointY","isFreehandDrawing","freehandDownPoint","isFreehandPointMoved","pointCounter","currFHDIdx","selPoints","dummyPoints","tempFHDStyles","straightenPointAngle","updateFhdPvtVar","hoverFhd","freehandDownHandler","freehandUpHandler","parseInt","isFHDIdx","deleteFhd","freehandRedraw","selectFhd","applyFhd","cancelFhd","updateFHDCurPts","rotateFhdColl","flipFHDColl","panFHDColl","updateFHDColl","zoomFHDColl","applyPenDraw","freeHandDraw","getSqPtFD","fhdHovIdx","updateCropPtsForSel","fhdSelID","fhdSelIdx","setCenterSelPoints","prevStraightenObj","triggerShapeChanging","idx","controlPoint1","controlPoint2","minStrokeWidth","maxStrokeWidth","startDraw","calcCurveCP","e","Date","getTime","clientX","clientY","touches","EventHandler","freehandMoveHandler","shapeSettings","ShapeType","FreehandDraw","shapeChangingArgs","previousShapeSettings","currentShapeSettings","getBoundingClientRect","processPoint","changedTouches","fhCnt","mouseDown","lastPoint","isLastPointTooClose","distanceTo","unshift","p0","shift","dx1","dy1","dx2","dy2","m1","m2","l1","l2","dxm","dym","k","cm","tx","ty","tempVelocity","pointVelocity","drawCurve","startWidth","endWidth","t1","t3","u1","u2","u3","widthValue","bezierLength","drawSteps","drawArc","t","pointX1","pointY1","pointX2","pointY2","pointX3","pointY3","bezierPoint","cp1","cp2","sPoints","selectedPoint","isSelected","index","isId","tempSelPointColl","zoomX","zoomY","lowercaseValue","pointsHorizontalFlip","pointsVerticalFlip","isIndex","Selection","diffPoint","oldPoint","isTouch","isObjSelected","isFhdPoint","dragPoint","isShapeInserted","triangle","triangleRatio","isFirstMove","startTouches","tempTouches","currMousePoint","cursorTargetId","isPreventDragging","dragElement","textRow","mouseDownPoint","previousPoint","zoomType","isInitialTextEdited","dragCanvas","isFhdCustomized","touchEndPoint","isFhdEditing","currentDrawingShape","initialPrevObj","touchTime","resizedElement","isImageClarity","isPinching","isSliding","isSliderActive","selection","selMouseUpEvent","setCursor","updateActivePoint","updateCursorStyles","setTextSelection","setActivePoint","calcShapeRatio","applyCurrShape","performTabAction","setDragDirection","setTimeout","redrawShape","setTextBoxStylesToActObj","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","keyDownEventHandler","handleScroll","textKeyDown","deleteItem","updatePrevShapeSettings","panDown","adjustActObjForLineArrow","findTarget","getCurrentFlipState","setDragWidth","setDragHeight","getTransRotationPoint","adjustNEPoints","adjustRotationPoints","getResizeDirection","unwireEvent","updPtCollForShpRot","findImageRatio","getNumTextValue","upgradeImageQuality","getScaleRatio","triggerShapeChange","limitDrag","applyTransformToImg","findTargetObj","getArrowType","timer","pathAdjustedIndex","allowUndoRedoPush","getMouseCursor","isApply","frameObject","setCursorForLineArrow","setCursorForPath","cursorColl","setCursorForRotatedObject","setCursorFromObj","setCursorForFreehandDrawing","isMove","horTP","horTopLinePointColl","horTP1","verLP","verLeftLinePointColl","verRP","verRightLinePointColl","horBP","horBottomLinePointColl","horBP1","rotCP","rotationCirclePointColl","horTP0","horBP0","getRectanglePoints","horTP_1","horBP_1","verLP_1","verRP_1","adjustCursorStylesForRotatedState","cursorMap","nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize","getResizeElement","resizeMappings","positiveDegree","resizeMappings_1","startDegree","endDegree","resizeElement","isEntered","ptc","pt","z1","z2","z3","z4","shapeResizingArgs","shapeMovingArgs","isTextArea","isMouseOutsideImg","updateNWPoints","rotatedDegree","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","selectionResizingArgs","eventType","tempHeight","isStart","isLimiting","preventDraggingInvertly","preventTextDraggingInvertly","preventInverseResize","newScale","gcd","divisor","revertResizing","resizeImg","adjustNWPoints","top_2","adjustSWPoints","adjustSEPoints","rectangle","cx","cy","rotatedC","rotatePoints","newCenter","newBottomRight","newTopLeft","rotatedD","newBottomLeft","newTopRight","rotatedB","rotatedA","setResizedValue","getResizedElement","resizeMappings_2","isLine","updateCursorStylesForLineArrow","updateCursorStylesForPath","textWidth","textHeight","selectInfo","currentTarget","isPan","imageEditorClickEventArgs","setXYPoints","clickEvent","performEnterAction","object_1","isShape","isShapeTouch","isFreehandDraw","isFreehandDrawTouch","isShapeClick","applyObj","isLineArrow","x_1","y_1","cursor_2","indexObj","freehandSelectedIndex","tempHoveredIndex","isPenEdit","qbArea","shapeChangedArgs","isPenDraw","freehandDraw","cursor_1","shapeColl","canvasCursor","preventDefault","bbox","targetTouches","pageX","offsetLeft","pageY","offsetTop","firstFingerX","firstFingerY","secondFingerX","secondFingerY","zoomTrigger","ZoomTrigger","Pinch","calculateScale","isZoomOut","closest","stopImmediatePropagation","srcElement","elemId","id_1","prevCropObj_1","applyCurrActObj","splitWords_1","isCropSelection_1","isInitialLine","isAdjusted","setRatio","getCurrentIndex","splice","setTimer","rgbToHex","offsetX","offsetY","tempPanMoveObj","tempPanMove","panMove","panMoveObj","ctrlKey","allowUndoRedo","Commands","isValueUpdated","isAspectRatio","aspectRatioHeight","aspectRatioWidth","placeholder","isKeyBoardCrop","isInsideCanvas","stopPropagation","MouseWheel","wheelDelta","String","fromCharCode","which","scrollHeight","resetCrop","presetRatio","originalWidth","originalHeight","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","cursor_3","cursor_4","temp_1","shapeEvent","endTouches","startDistance","getDistance","isMouseUp","clearTimeout","smallPoint","largePoint","shapeIDObj","fontWeight","fontStyle","padLeft","padChar","updateFreehandDrawColorChange","freehandDrawSelectedId","object_2","tempFreeHandDrawEditingStyles","radiusX","radiusY","arrowHead","arrowTail","none","circleSolid","squareSolid","rectX","rectY","rectWidth","rectHeight","rectAngle","angleRad","localX","localY","rotatedX","rotatedY","halfWidth","halfHeight","widthElement","heightElement","heightString","replace","widthString","isValue","Shape","initShapePvtProps","uploader","drawEllipse","drawLine","drawArrow","drawPath","drawRectangle","drawText","redrawActObj","apply","updateShapeChangeEventArgs","updSelChangeEventArgs","iterateObjColl","updImgRatioForActObj","zoomObjColl","redrawObj","rotateObjColl","drawShapeText","redrawText","drawShape","renderTextArea","setTextBoxWidth","findTextTarget","panObjColl","updateFontStyles","applyFontStyle","updateFontRatio","updateFontSize","updateObjColl","pushActItemIntoObj","clearActObj","refreshActiveObj","applyActObj","fileChanged","getShapeSetting","getShapeSettings","isPointsInRange","alignRotateFlipColl","selectShape","deleteShape","getMaxText","getLinePoints","setPointCollForShapeRotation","setTextBoxPos","setTextBoxPoints","alignTextAreaIntoCanvas","initializeTextShape","stopPathDrawing","updateArrowRatio","getSquarePointForRotatedShape","updateObj","straightenShapes","straightenShapePoints","straightenPath","straightenFHD","getTextBoxPosition","updateSelectionChangeEventArgs","setFlipState","getNewShapeId","shapeImg","crossorigin","initializeShape","lineDraw","arrowStart","arrowEnd","setDimension","arrowType","None","Arrow","SolidArrow","Circle","SolidCircle","Square","SolidSquare","Bar","setCenterPoints","setPointCollForLineAndArrow","initShapeProps","isPublicMethod","textFlip","prevObjColl","isInitialText","getFontSizes","fontSizeColl","measureText","drawShapeTextEvent","drawShapeImageEvent","isSelect","addLetter","onLoadImgShape","updateTextFromTextArea","renderWidth","renderHeight","shapeId","letter","widthColl","updatePathRatio","preventApply","len_1","updateArrowSize","len_2","straightenPoints","fLen","updateCurrentActiveObjPoint","currActObjIndex","flipLineArrowObj","rotateLineArrowObj","prevPoint","lineArrowHorizontalFlip","lineArrowVerticalFlip","currPoint","getRotDegOfShape","transformTextArea","dupElem","removeElem","editTextElem","overflow","focus","setTextBoxHeight","tempLeft","tempTop","center_1","width1","height1","width2","whiteSpace","textOverflow","textAreaWidth","letterWidth","textAreaLeft","textAreaTop","selectedText","updateImgCanvas","resizeImage","aspectRatio","aspectRatioArray","selectionStart","finish","selectionEnd","substring","len_3","len_4","len_5","isTextBox","item","updateFontStyle","getTextAreaWidth","dimensions_1","dimensions_2","tempBold","tempItalic","isActObj","letters","transformOrigin","getObjDetails","shapeDetails","arrowObj","getFreehandDrawDetails","obj_4","shapeDetailsColl","inRange","popForDefaultTransformedState","popForDefaultFlipState","popForDefaultRotateState","rotateRight","rotateleft","horizontal","vertical","isHorizontal","isVertical","isNextHorizontal","isNextVertical","isNextToNextHorizontal","isNextToNextVertical","isNextToNextToNextHorizontal","curr","next","obj_5","obj_6","maxi","maxStr","maxText","m","getSlope","getIntercept","lesserY","i_1","prev","lesserX","i_2","isSameAxis","slope","reverse","Transform","disablePan","isReverseRotate","prevZoomValue","cropDimension","isPreventSelect","preventDownScale","resizedImgAngle","initTransformPvtVar","flipImage","setDestPointsForFlipState","zoomAction","disableZoomOutBtn","rotatedFlip","drawPannedImage","drawPannImage","performTransformation","updateTransform","rotatePan","drawRotatedImage","limitPan","updateFlipActiveObj","setCurrPanRegion","calcMaxDimension","currDestPoint","resizeCrop","updateResize","resize","straightenImage","zoomBtnHold","transCurrObj","previousDegree","currentDegree","rotateEvent","prevEventObjPoint","prevEventSelectionPoint","activeObjShape","rotateDegree","updateCurrSelectionPoint","previousDirection","flipEvent","lowercaseDirection","selObj","updateFlipColl","toLocaleLowerCase","dir","verticalFlip","horizontalFlip","lastFourItems","minZoomFactor","powerOften","zoomEventArgs","previousZoomFactor","currentZoomFactor","isZoomBtnClick","zoomEvent","zoomFact","drawZoomImgToCanvas","panObj_1","isAdd","rotateZoom","panObj_2","clearInterval","zoomOut","autoEnablePan","panBtn","setZoomDimension","zmFactor","maxDestLeft","maxDestTop","panEventArgs","panEvent","isPanMethod","isObjCreated","updatePanPoints","tempFlipState","Direction","Horizontal","Vertical","rotatePanActiveObj","initialDestLeft","initialDestTop","intPan","getCurrentZoomFactor","absValue","freehandObj","cxtTbarHeight","ctToolbar","ctWrapper","hdWrapper","canvasWrapper","offsetWidth","ctxTbarArea","offsetHeight","refreshOverflow","canvasMaxWidth","canvasMaxHeight","cxtTbar","widthScale","heightScale","cssMaxWidth","cssMaxHeight","tempActObj","tempDestLeft","tempDestTop","temp1","minimum","resizeSrc","nearestNumber","smallestDifference","minimum_1","num","difference","prevResizeCurrObj","tempwidth","tempheight","tempZoom","sx","sy","currObject","resizeEventArgs","previousWidth","previousHeight","resizeEventHandler","heightElem","widthElem","aspectRatioWidthValue","aspectRatioHeightValue","UndoRedo","undoRedoStep","undoRedoColl","tempUndoRedoColl","isPreventing","undoRedo","initializeUrPvtProp","updateUrc","refreshUrc","updateCurrUrc","callUndo","callRedo","undo","redo","updateUrObj","updateUndoRedo","undoDefault","tempCurrSelPoint","refreshToolbar","appliedURColl","prevTransform","getZeroZoomObjPointValue","adjObj","refreshToolbarActions","applyCurrentChanges","shapeTransform","updateFreehandDraw","updateFreehandDrawCustomized","updateDelete","updateTextAreaCustomization","updateText","imageFlip","updateCropTransformItems","endUndoRedo","updateTextBox","allowActiveObj","isUndo","isInitialLoaded","frameDestPoints","oper","cropDimensionObj","getZeroZoomObjColl","getZeroZoomPointColl","tempArrowObj","applyImgTranform","__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","FinetuneSettings","_super","Property","ChildProperty","ZoomSettings","SelectionSettings","FontFamily","ImageEditor","options","call","isFilterCanvasClick","isFrameBtnClick","ImageEditor_1","Inject","ToolbarModule","requiredModules","modules","member","preRender","getUniqueID","initializeThemeColl","render","initialize","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","keys","cssClass","removeClass","trim","addClass","wireEvent","locale","showQuickAccessToolbar","Toolbar","className","toolbarTemplateFn","quickAccessToolbarTemplate","quickAccessToolbarTemplateFn","removeAttribute","concat","getAttribute","createCanvas","createDropUploader","quickAccessToolbar","createSpinner","initializeZoomSettings","Uploader","dropArea","getElementsByClassName","allowedExtensions","multiple","selected","event","errType","dataTransfer","okObj","supportObj","keyUpEventHandler","windowResizeHandler","isIos","info","screen","orientation","screenOrientation","boxSizing","dragObj","dropObj","browseObj","dropAreaElement","dropIconElement","dropContentElement","textContent","minDropContentElem","dropAnchorElement","minDropAnchorElem","dropInfoElement","dropUploader","backgroundColor","adjustToScreen","notifyResetForAllModules","module","allowShape","initialZoomValue","qtArea","updateImageTransformColl","isEllipse","isArrow","isPath","isRectangle","isImage","length_1","option","applyImageFilter","filterOption","getImageDimension","isResized","drawFrame","frameType","frameChangeEventArgs","FrameLineStyle","Solid","isStraightened","updateShape","setting","tempFontSize","enableTextEditing","cloneShape","isPreventUndoRedo","getImageFilter","canUndo","getUndoRedoColl","canRedo","undoRedoIndex","template","templateID","toolbarArea","toolbarFn","templateParser","isReact","isAngular","templateColl","nodeType","qatFn","querySelectorAll","templateCompiler","compile","error","getTextFromId","1","2","3","4","5","6","7","8","getFinetuneOption","ImageFinetuneOption","Brightness","Contrast","Hue","Saturation","Opacity","Blur","Exposure","setPenStroke","undoRedoObj","setInitialZoomState","str","strArr","charAt","toUpperCase","items","isResizeOkBtn","blrNAspRatElem","objt","selElem","children","isCroppedEvent","setTempFilterProperties","cropSelectedState","tempAdjustmentValue","getCurrentCanvasData","tempFrame","setCurrAdjustmentValue","finetuneValueChanging","getSquarePointForPath","CropCustom","CropSquare","CropCircle","Crop3:2","Crop4:3","Crop5:4","Crop7:5","Crop16:9","Crop2:3","Crop3:4","Crop4:5","Crop5:7","Crop9:16","updateArrow","updateFontFamily","itemText","text_1","text_2","updateFontColor","updatePenStrokeWidth","updatePenStrokeColor","indexObj_1","updateStrokeWidth","updateStrokeColor","updateFillColor","isPreventURC","duplicateImage","pascalToSplitWords","splitStr","match","map","word","getCurrAdjustmentValue","penOpacity","transformSelect","isTransform","stValPan","isMethod","straightenEventArgs","performStraighten","getStraightenFlipState","minX","maxX","minY","maxY","curFlip","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","Material3","Material3Dark","Complex","Event","NotifyPropertyChanges","Component","FileType","Theme","ImageEditorCommand","ImageFilterOption","ArrowheadType","FrameType","currToolbar","preventZoomBtn","selFhdColor","preventEnableDisableUr","isFrameToolbar","presetColors","custom","initLocale","defaultLocale","ZoomIn","ZoomOut","Undo","Redo","Annotation","Finetune","Sharpen","Default","Chrome","Cold","Warm","Grayscale","BlackAndWhite","Sepia","Invert","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Ellipse","Rectangle","Line","Path","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","Browse","Duplicate","Remove","EditText","Start","End","ArrowSolid","CircleSolid","SquareSolid","CropAndTransform","CropSelection","Image","Transparency","Height","Width","AspectRatio","W","H","DragText","DropText","BrowseText","SupportText","Frame","Mat","Bevel","Inset","Hook","Color","Size","Offset","Radius","Amount","Resize","0","20","40","60","80","100","Border","Dashed","Dotted","GradientColor","ConfirmDialogHeader","ConfirmDialogContent","AlertDialogHeader","AlertDialogContent","Yes","No","ImageErrorDialogHeader","ImageErrorDialogContent","Straighten","NoOutline","DlgOK","l10n","L10n","createToolbar","createContextualToolbar","updateToolbarItems","renderQAT","enableDisableTbrBtn","initMainToolbar","createBottomToolbar","refreshMainToolbar","createQuickAccessToolbar","destroyQuickAccessToolbar","zoomBtnMouseUpHandler","refreshDropDownBtn","closeContextualToolbar","destroyBottomToolbar","destroyTopToolbar","destroySubComponents","setLocale","getPenStroke","performDefTbrClick","refreshSlider","refreshShapeDrawing","getConstant","initResizeToolbar","callFrameToolbar","resizeClick","frameToolbarClick","performCropTransformClick","duplicateShape","editText","toolbarItems","align","tooltipText","toolbar_1","uploadItems","bToolbar","created","toolbarType","clicked","defToolbarClicked","createLeftToolbarControls","mToolbar","toolabr","toolbar_2","toolbarElem","initBottomToolbar","toolbar_3","isApplyOption","leftItem","getLeftToolbarItem","rightItem","getRightToolbarItem","mainItem","getMainToolbarItem","zoomItem","getZoomToolbarItem","toolbarObj","renderAnnotationBtn","wireZoomBtnEvents","renderSaveBtn","renderCropBtn","renderTransformBtn","visible","prefixIcon","tempToolbarItems","processToolbar","updateContextualToolbar","contextualToolbarArea","toolbar_6","initFilterToolbarItem","initFrameToolbarItem","renderSlider","cHt","cusWrapper","ht","insertBefore","getCropTextContent","processSubToolbar","zoomIn","zoomInBtnMouseDownHandler","zoomInBtnClickHandler","zoomOutBtnMouseDownHandler","zoomOutBtnClickHandler","widthPress","keyCode","heightPress","widthAspectRatio","icon","widthNumeric","heightNumeric","isNaN","heightAspectRatio","getResizeToolbarItem","spanWidth","NumericTextBox","htmlAttributes","maxLength","showSpinButton","format","spanHeight","wireResizeBtnEvents","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","onchange","triggerTbarClickEvent","originalEvent","isCustomized","defItems","duplicateElement","removeElement","editTextElement","getCurrentShapeIcon","drpDownBtn","DropDownButton","currentFreehandDrawIndex","tempCurrentFreehandDrawIndex","setInitialShapeSettings","renderStraightenSlider","slider","createSlider","sliderHandle","shapeString","cancelPan","cropSelect","saveItems","getCropTransformToolbarItem","straightenSpan","getShapesToolbarItem","initCropTransformToolbar","classToContentMap","e-custom","e-circle","e-square","e-custom-a","e-custom-b","e-custom-c","e-custom-d","e-custom-e","e-custom-f","e-custom-g","e-custom-h","e-custom-i","e-custom-j","line","path","image","pen","crop-custom","crop-circle","crop-square","crop-3:2","crop-4:3","crop-5:4","crop-7:5","crop-16:9","crop-2:3","crop-3:4","crop-4:5","crop-5:7","crop-9:16","initShapesToolbarItem","isToolbarString","excludeItems","createShapeColor","createShapeBtn","some","createStartBtn","createEndBtn","beforeModeSwitch","inst","popupLeft","offsetParent","mode","showButtons","dataBind","title","fillColor_1","ColorPicker","modeSwitcher","noColor","inline","beforeTileRender","change","rgba","fillDDB_1","toggle","onModeSwitch","beforeClose","parenElem","getValue","strokeColor_1","strokeDDB_1","background","strokeWidthItems","strokeWidthBtn","spanElem_1","drpDownBtn_1","activeBtn","spanElem","strokeEndBtn","getTextToolbarItem","getFontFamilyItems","initTextToolbarItem","createTextColor","createTextBtn","fontColor_1","strokeDDB_2","fontNameBtn","spanElem_2","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","fontSizeBtn_1","toolbarElement","bottomToolbar","toolbar_9","initPenToolbarItem","initAdjustmentToolbarItem","frameElem","getAdjustmentToolbarItem","getFrameToolbarItem","getFilterToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","presentVal","penColor","hex","strokeDDB_3","parentElem","spanElem_3","drpDownBtn_2","valueToTextContent","frameWrapper","styles","createFrameColor","createFrameSize","createFrameRadius","createFrameInset","createFrameOffset","createFrameAmount","createFrameBorder","createFrameGradientColor","fillDDB","curFrameObjEvent","childNodes","contextualToolbarClicked","createCanvasFilter","hdrWrapper","filterElem","drawDashedLine","updateFilterCanvas","selector","getQuickAccessToolbarItem","orgToolbarItems","quickAccessToolbarClicked","annotation","adjustment","pathObject","right","object1","duplicateObj","isFilterFinetune","isDisabledFilter","isDisabledAdjustment","imageHeight","imageWidth","openSlider","unselectFrameBtn","zoomToFrameRange","imageFiltering","curFilterObjEvent","parent_1","returnValue","applyPreviewFilter","parent_2","setInterval","quickToolbar","qatArea","labelWrapper","sliderWrapper","updateFinetuneSpan","Slider","changed","ftValPan","unselectBtn","selectors_1","ej2_instances","selectors_2","selFillElem","selStrokeElem","selTextStrokeElem","selPenStrokeElem","strokeWidthElem","fontFamilyElem","fontSizeElem","boldBtn","italicBtn","getStrokeWidth","btnElement","detach","isString","indexArr","getIndex","negativeIndexArr","isSameIndex","isFontColor"],"mappings":"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"}