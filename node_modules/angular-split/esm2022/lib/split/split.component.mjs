import { ChangeDetectionStrategy, Component, ElementRef, HostBinding, InjectionToken, NgZone, Renderer2, booleanAttribute, computed, contentChild, contentChildren, effect, inject, input, output, signal, untracked, } from '@angular/core';
import { takeUntilDestroyed } from '@angular/core/rxjs-interop';
import { Subject, filter, fromEvent, map, pairwise, skipWhile, startWith, switchMap, take, takeUntil, tap } from 'rxjs';
import { createClassesString, gutterEventsEqualWithDelta, fromMouseMoveEvent, fromMouseUpEvent, getPointFromEvent, leaveNgZone, numberAttributeWithFallback, sum, toRecord, } from '../utils';
import { DOCUMENT, NgStyle, NgTemplateOutlet } from '@angular/common';
import { SplitCustomEventsBehaviorDirective } from '../split-custom-events-behavior.directive';
import { areAreasValid } from '../validations';
import { SplitGutterDirective } from '../gutter/split-gutter.directive';
import { SplitGutterDynamicInjectorDirective } from '../gutter/split-gutter-dynamic-injector.directive';
import { ANGULAR_SPLIT_DEFAULT_OPTIONS } from '../angular-split-config.token';
import * as i0 from "@angular/core";
export const SPLIT_AREA_CONTRACT = new InjectionToken('Split Area Contract');
export class SplitComponent {
    get hostClassesBinding() {
        return this.hostClasses();
    }
    get hostDirBinding() {
        return this.dir();
    }
    constructor() {
        this.document = inject(DOCUMENT);
        this.renderer = inject(Renderer2);
        this.elementRef = inject(ElementRef);
        this.ngZone = inject(NgZone);
        this.defaultOptions = inject(ANGULAR_SPLIT_DEFAULT_OPTIONS);
        this.gutterMouseDownSubject = new Subject();
        this.dragProgressSubject = new Subject();
        /**
         * @internal
         */
        this._areas = contentChildren(SPLIT_AREA_CONTRACT);
        this.customGutter = contentChild(SplitGutterDirective);
        this.gutterSize = input(this.defaultOptions.gutterSize, {
            transform: numberAttributeWithFallback(this.defaultOptions.gutterSize),
        });
        this.gutterStep = input(this.defaultOptions.gutterStep, {
            transform: numberAttributeWithFallback(this.defaultOptions.gutterStep),
        });
        this.disabled = input(this.defaultOptions.disabled, { transform: booleanAttribute });
        this.gutterClickDeltaPx = input(this.defaultOptions.gutterClickDeltaPx, {
            transform: numberAttributeWithFallback(this.defaultOptions.gutterClickDeltaPx),
        });
        this.direction = input(this.defaultOptions.direction);
        this.dir = input(this.defaultOptions.dir);
        this.unit = input(this.defaultOptions.unit);
        this.gutterAriaLabel = input();
        this.restrictMove = input(this.defaultOptions.restrictMove, { transform: booleanAttribute });
        this.useTransition = input(this.defaultOptions.useTransition, { transform: booleanAttribute });
        this.gutterDblClickDuration = input(this.defaultOptions.gutterDblClickDuration, {
            transform: numberAttributeWithFallback(this.defaultOptions.gutterDblClickDuration),
        });
        this.gutterClick = output();
        this.gutterDblClick = output();
        this.dragStart = output();
        this.dragEnd = output();
        this.transitionEnd = output();
        this.dragProgress$ = this.dragProgressSubject.asObservable();
        this.visibleAreas = computed(() => this._areas().filter((area) => area.visible()));
        this.gridTemplateColumnsStyle = computed(() => {
            const columns = [];
            const sumNonWildcardSizes = sum(this.visibleAreas(), (area) => {
                const size = area._internalSize();
                return size === '*' ? 0 : size;
            });
            const visibleAreasCount = this.visibleAreas().length;
            let visitedVisibleAreas = 0;
            this._areas().forEach((area, index, areas) => {
                // Add area size column
                if (!area.visible()) {
                    columns.push('0fr');
                }
                else {
                    const areaSize = area._internalSize();
                    const unit = this.unit();
                    if (unit === 'pixel') {
                        const columnValue = areaSize === '*' ? '1fr' : `${areaSize}px`;
                        columns.push(columnValue);
                    }
                    else {
                        const percentSize = areaSize === '*' ? 100 - sumNonWildcardSizes : areaSize;
                        const columnValue = `${percentSize}fr`;
                        columns.push(columnValue);
                    }
                    visitedVisibleAreas++;
                }
                const isLastArea = index === areas.length - 1;
                if (isLastArea) {
                    return;
                }
                const remainingVisibleAreas = visibleAreasCount - visitedVisibleAreas;
                // Only add gutter with size if this area is visible and there are more visible areas after this one
                // to avoid ghost gutters
                if (area.visible() && remainingVisibleAreas > 0) {
                    columns.push(`${this.gutterSize()}px`);
                }
                else {
                    columns.push('0px');
                }
            });
            return this.direction() === 'horizontal' ? `1fr / ${columns.join(' ')}` : `${columns.join(' ')} / 1fr`;
        });
        this.hostClasses = computed(() => createClassesString({
            [`as-${this.direction()}`]: true,
            [`as-${this.unit()}`]: true,
            ['as-disabled']: this.disabled(),
            ['as-dragging']: this._isDragging(),
            ['as-transition']: this.useTransition() && !this._isDragging(),
        }));
        this.draggedGutterIndex = signal(undefined);
        /**
         * @internal
         */
        this._isDragging = computed(() => this.draggedGutterIndex() !== undefined);
        effect(() => {
            const visibleAreas = this.visibleAreas();
            const unit = this.unit();
            const isInAutoMode = visibleAreas.every((area) => area.size() === 'auto');
            untracked(() => {
                // Special mode when no size input was declared which is a valid mode
                if (unit === 'percent' && visibleAreas.length > 1 && isInAutoMode) {
                    visibleAreas.forEach((area) => area._internalSize.set(100 / visibleAreas.length));
                    return;
                }
                visibleAreas.forEach((area) => area._internalSize.reset());
                const isValid = areAreasValid(visibleAreas, unit);
                if (isValid) {
                    return;
                }
                if (unit === 'percent') {
                    // Distribute sizes equally
                    const defaultSize = 100 / visibleAreas.length;
                    visibleAreas.forEach((area) => area._internalSize.set(defaultSize));
                }
                else if (unit === 'pixel') {
                    const wildcardAreas = visibleAreas.filter((area) => area._internalSize() === '*');
                    // Make sure only one wildcard area
                    if (wildcardAreas.length === 0) {
                        visibleAreas[0]._internalSize.set('*');
                    }
                    else if (wildcardAreas.length > 1) {
                        wildcardAreas.filter((_, i) => i !== 0).forEach((area) => area._internalSize.set(100));
                    }
                }
            });
        }, { allowSignalWrites: true });
        // Responsible for updating grid template style. Must be this way and not based on HostBinding
        // as change detection for host binding is bound to the parent component and this style
        // is updated on every mouse move. Doing it this way will prevent change detection cycles in parent.
        effect(() => {
            const gridTemplateColumnsStyle = this.gridTemplateColumnsStyle();
            this.renderer.setStyle(this.elementRef.nativeElement, 'grid-template', gridTemplateColumnsStyle);
        });
        this.gutterMouseDownSubject
            .pipe(filter((context) => !this.customGutter() ||
            this.customGutter().canStartDragging(context.mouseDownEvent.target, context.gutterIndex + 1)), switchMap((mouseDownContext) => 
        // As we have gutterClickDeltaPx we can't just start the drag but need to make sure
        // we are out of the delta pixels. As the delta can be any number we make sure
        // we always start the drag if we go out of the gutter (delta based on mouse position is larger than gutter).
        // As moving can start inside the drag and end outside of it we always keep track of the previous event
        // so once the current is out of the delta size we use the previous one as the drag start baseline.
        fromMouseMoveEvent(this.document).pipe(startWith(mouseDownContext.mouseDownEvent), pairwise(), skipWhile(([, currMoveEvent]) => gutterEventsEqualWithDelta(mouseDownContext.mouseDownEvent, currMoveEvent, this.gutterClickDeltaPx(), mouseDownContext.gutterElement)), take(1), takeUntil(fromMouseUpEvent(this.document, true)), tap(() => {
            this.ngZone.run(() => {
                this.dragStart.emit(this.createDragInteractionEvent(mouseDownContext.gutterIndex));
                this.draggedGutterIndex.set(mouseDownContext.gutterIndex);
            });
        }), map(([prevMouseEvent]) => this.createDragStartContext(prevMouseEvent, mouseDownContext.areaBeforeGutterIndex, mouseDownContext.areaAfterGutterIndex)), switchMap((dragStartContext) => fromMouseMoveEvent(this.document).pipe(tap((moveEvent) => this.mouseDragMove(moveEvent, dragStartContext)), takeUntil(fromMouseUpEvent(this.document, true)), tap({
            complete: () => this.ngZone.run(() => {
                this.dragEnd.emit(this.createDragInteractionEvent(this.draggedGutterIndex()));
                this.draggedGutterIndex.set(undefined);
            }),
        }))))), takeUntilDestroyed())
            .subscribe();
        fromEvent(this.elementRef.nativeElement, 'transitionend')
            .pipe(filter((e) => e.propertyName.startsWith('grid-template')), leaveNgZone(), takeUntilDestroyed())
            .subscribe(() => this.ngZone.run(() => this.transitionEnd.emit(this.createAreaSizes())));
    }
    gutterClicked(gutterIndex) {
        this.ngZone.run(() => this.gutterClick.emit(this.createDragInteractionEvent(gutterIndex)));
    }
    gutterDoubleClicked(gutterIndex) {
        this.ngZone.run(() => this.gutterDblClick.emit(this.createDragInteractionEvent(gutterIndex)));
    }
    gutterMouseDown(e, gutterElement, gutterIndex, areaBeforeGutterIndex, areaAfterGutterIndex) {
        if (this.disabled()) {
            return;
        }
        e.preventDefault();
        e.stopPropagation();
        this.gutterMouseDownSubject.next({
            mouseDownEvent: e,
            gutterElement,
            gutterIndex,
            areaBeforeGutterIndex,
            areaAfterGutterIndex,
        });
    }
    gutterKeyDown(e, gutterIndex, areaBeforeGutterIndex, areaAfterGutterIndex) {
        if (this.disabled()) {
            return;
        }
        const pixelsToMove = 50;
        const pageMoveMultiplier = 10;
        let xPointOffset = 0;
        let yPointOffset = 0;
        if (this.direction() === 'horizontal') {
            // Even though we are going in the x axis we support page up and down
            switch (e.key) {
                case 'ArrowLeft':
                    xPointOffset -= pixelsToMove;
                    break;
                case 'ArrowRight':
                    xPointOffset += pixelsToMove;
                    break;
                case 'PageUp':
                    if (this.dir() === 'rtl') {
                        xPointOffset -= pixelsToMove * pageMoveMultiplier;
                    }
                    else {
                        xPointOffset += pixelsToMove * pageMoveMultiplier;
                    }
                    break;
                case 'PageDown':
                    if (this.dir() === 'rtl') {
                        xPointOffset += pixelsToMove * pageMoveMultiplier;
                    }
                    else {
                        xPointOffset -= pixelsToMove * pageMoveMultiplier;
                    }
                    break;
                default:
                    return;
            }
        }
        else {
            switch (e.key) {
                case 'ArrowUp':
                    yPointOffset -= pixelsToMove;
                    break;
                case 'ArrowDown':
                    yPointOffset += pixelsToMove;
                    break;
                case 'PageUp':
                    yPointOffset -= pixelsToMove * pageMoveMultiplier;
                    break;
                case 'PageDown':
                    yPointOffset += pixelsToMove * pageMoveMultiplier;
                    break;
                default:
                    return;
            }
        }
        e.preventDefault();
        e.stopPropagation();
        const gutterMidPoint = getPointFromEvent(e);
        const dragStartContext = this.createDragStartContext(e, areaBeforeGutterIndex, areaAfterGutterIndex);
        this.ngZone.run(() => {
            this.dragStart.emit(this.createDragInteractionEvent(gutterIndex));
            this.draggedGutterIndex.set(gutterIndex);
            this.dragMoveToPoint({ x: gutterMidPoint.x + xPointOffset, y: gutterMidPoint.y + yPointOffset }, dragStartContext);
            this.dragEnd.emit(this.createDragInteractionEvent(gutterIndex));
            this.draggedGutterIndex.set(undefined);
        });
    }
    getGutterGridStyle(nextAreaIndex) {
        const gutterNum = nextAreaIndex * 2;
        const style = `${gutterNum} / ${gutterNum}`;
        return {
            ['grid-column']: this.direction() === 'horizontal' ? style : '1',
            ['grid-row']: this.direction() === 'vertical' ? style : '1',
        };
    }
    getAriaAreaSizeText(area) {
        const size = area._internalSize();
        if (size === '*') {
            return undefined;
        }
        return `${size.toFixed(0)} ${this.unit()}`;
    }
    getAriaValue(size) {
        return size === '*' ? undefined : size;
    }
    createDragInteractionEvent(gutterIndex) {
        return {
            gutterNum: gutterIndex + 1,
            sizes: this.createAreaSizes(),
        };
    }
    createAreaSizes() {
        return this.visibleAreas().map((area) => area._internalSize());
    }
    createDragStartContext(startEvent, areaBeforeGutterIndex, areaAfterGutterIndex) {
        const splitBoundingRect = this.elementRef.nativeElement.getBoundingClientRect();
        const splitSize = this.direction() === 'horizontal' ? splitBoundingRect.width : splitBoundingRect.height;
        const totalAreasPixelSize = splitSize - (this.visibleAreas().length - 1) * this.gutterSize();
        // Use the internal size and split size to calculate the pixel size from wildcard and percent areas
        const areaPixelSizesWithWildcard = this._areas().map((area) => {
            if (this.unit() === 'pixel') {
                return area._internalSize();
            }
            else {
                const size = area._internalSize();
                if (size === '*') {
                    return size;
                }
                return (size / 100) * totalAreasPixelSize;
            }
        });
        const remainingSize = Math.max(0, totalAreasPixelSize - sum(areaPixelSizesWithWildcard, (size) => (size === '*' ? 0 : size)));
        const areasPixelSizes = areaPixelSizesWithWildcard.map((size) => (size === '*' ? remainingSize : size));
        return {
            startEvent,
            areaBeforeGutterIndex,
            areaAfterGutterIndex,
            areasPixelSizes,
            totalAreasPixelSize,
            areaIndexToBoundaries: toRecord(this._areas(), (area, index) => {
                const percentToPixels = (percent) => (percent / 100) * totalAreasPixelSize;
                const value = this.unit() === 'pixel'
                    ? {
                        min: area._normalizedMinSize(),
                        max: area._normalizedMaxSize(),
                    }
                    : {
                        min: percentToPixels(area._normalizedMinSize()),
                        max: percentToPixels(area._normalizedMaxSize()),
                    };
                return [index.toString(), value];
            }),
        };
    }
    mouseDragMove(moveEvent, dragStartContext) {
        moveEvent.preventDefault();
        moveEvent.stopPropagation();
        const endPoint = getPointFromEvent(moveEvent);
        this.dragMoveToPoint(endPoint, dragStartContext);
    }
    dragMoveToPoint(endPoint, dragStartContext) {
        const startPoint = getPointFromEvent(dragStartContext.startEvent);
        const preDirOffset = this.direction() === 'horizontal' ? endPoint.x - startPoint.x : endPoint.y - startPoint.y;
        const offset = this.direction() === 'horizontal' && this.dir() === 'rtl' ? -preDirOffset : preDirOffset;
        const isDraggingForward = offset > 0;
        // Align offset with gutter step and abs it as we need absolute pixels movement
        const absSteppedOffset = Math.abs(Math.round(offset / this.gutterStep()) * this.gutterStep());
        // Copy as we don't want to edit the original array
        const tempAreasPixelSizes = [...dragStartContext.areasPixelSizes];
        // As we are going to shuffle the areas order for easier iterations we should work with area indices array
        // instead of actual area sizes array.
        const areasIndices = tempAreasPixelSizes.map((_, index) => index);
        // The two variables below are ordered for iterations with real area indices inside.
        // We must also remove the invisible ones as we can't expand or shrink them.
        const areasIndicesBeforeGutter = this.restrictMove()
            ? [dragStartContext.areaBeforeGutterIndex]
            : areasIndices
                .slice(0, dragStartContext.areaBeforeGutterIndex + 1)
                .filter((index) => this._areas()[index].visible())
                .reverse();
        const areasIndicesAfterGutter = this.restrictMove()
            ? [dragStartContext.areaAfterGutterIndex]
            : areasIndices.slice(dragStartContext.areaAfterGutterIndex).filter((index) => this._areas()[index].visible());
        // Based on direction we need to decide which areas are expanding and which are shrinking
        const potentialAreasIndicesArrToShrink = isDraggingForward ? areasIndicesAfterGutter : areasIndicesBeforeGutter;
        const potentialAreasIndicesArrToExpand = isDraggingForward ? areasIndicesBeforeGutter : areasIndicesAfterGutter;
        let remainingPixels = absSteppedOffset;
        let potentialShrinkArrIndex = 0;
        let potentialExpandArrIndex = 0;
        // We gradually run in both expand and shrink direction transferring pixels from the offset.
        // We stop once no pixels are left or we reached the end of either the expanding areas or the shrinking areas
        while (remainingPixels !== 0 &&
            potentialShrinkArrIndex < potentialAreasIndicesArrToShrink.length &&
            potentialExpandArrIndex < potentialAreasIndicesArrToExpand.length) {
            const areaIndexToShrink = potentialAreasIndicesArrToShrink[potentialShrinkArrIndex];
            const areaIndexToExpand = potentialAreasIndicesArrToExpand[potentialExpandArrIndex];
            const areaToShrinkSize = tempAreasPixelSizes[areaIndexToShrink];
            const areaToExpandSize = tempAreasPixelSizes[areaIndexToExpand];
            const areaToShrinkMinSize = dragStartContext.areaIndexToBoundaries[areaIndexToShrink].min;
            const areaToExpandMaxSize = dragStartContext.areaIndexToBoundaries[areaIndexToExpand].max;
            // We can only transfer pixels based on the shrinking area min size and the expanding area max size
            // to avoid overflow. If any pixels left they will be handled by the next area in the next `while` iteration
            const maxPixelsToShrink = areaToShrinkSize - areaToShrinkMinSize;
            const maxPixelsToExpand = areaToExpandMaxSize - areaToExpandSize;
            const pixelsToTransfer = Math.min(maxPixelsToShrink, maxPixelsToExpand, remainingPixels);
            // Actual pixels transfer
            tempAreasPixelSizes[areaIndexToShrink] -= pixelsToTransfer;
            tempAreasPixelSizes[areaIndexToExpand] += pixelsToTransfer;
            remainingPixels -= pixelsToTransfer;
            // Once min threshold reached we need to move to the next area in turn
            if (tempAreasPixelSizes[areaIndexToShrink] === areaToShrinkMinSize) {
                potentialShrinkArrIndex++;
            }
            // Once max threshold reached we need to move to the next area in turn
            if (tempAreasPixelSizes[areaIndexToExpand] === areaToExpandMaxSize) {
                potentialExpandArrIndex++;
            }
        }
        this._areas().forEach((area, index) => {
            // No need to update wildcard size
            if (area._internalSize() === '*') {
                return;
            }
            if (this.unit() === 'pixel') {
                area._internalSize.set(tempAreasPixelSizes[index]);
            }
            else {
                const percentSize = (tempAreasPixelSizes[index] / dragStartContext.totalAreasPixelSize) * 100;
                // Fix javascript only working with float numbers which are inaccurate compared to decimals
                area._internalSize.set(parseFloat(percentSize.toFixed(10)));
            }
        });
        this.dragProgressSubject.next(this.createDragInteractionEvent(this.draggedGutterIndex()));
    }
    /** @nocollapse */ static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.2", ngImport: i0, type: SplitComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    /** @nocollapse */ static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.2", type: SplitComponent, isStandalone: true, selector: "as-split", inputs: { gutterSize: { classPropertyName: "gutterSize", publicName: "gutterSize", isSignal: true, isRequired: false, transformFunction: null }, gutterStep: { classPropertyName: "gutterStep", publicName: "gutterStep", isSignal: true, isRequired: false, transformFunction: null }, disabled: { classPropertyName: "disabled", publicName: "disabled", isSignal: true, isRequired: false, transformFunction: null }, gutterClickDeltaPx: { classPropertyName: "gutterClickDeltaPx", publicName: "gutterClickDeltaPx", isSignal: true, isRequired: false, transformFunction: null }, direction: { classPropertyName: "direction", publicName: "direction", isSignal: true, isRequired: false, transformFunction: null }, dir: { classPropertyName: "dir", publicName: "dir", isSignal: true, isRequired: false, transformFunction: null }, unit: { classPropertyName: "unit", publicName: "unit", isSignal: true, isRequired: false, transformFunction: null }, gutterAriaLabel: { classPropertyName: "gutterAriaLabel", publicName: "gutterAriaLabel", isSignal: true, isRequired: false, transformFunction: null }, restrictMove: { classPropertyName: "restrictMove", publicName: "restrictMove", isSignal: true, isRequired: false, transformFunction: null }, useTransition: { classPropertyName: "useTransition", publicName: "useTransition", isSignal: true, isRequired: false, transformFunction: null }, gutterDblClickDuration: { classPropertyName: "gutterDblClickDuration", publicName: "gutterDblClickDuration", isSignal: true, isRequired: false, transformFunction: null } }, outputs: { gutterClick: "gutterClick", gutterDblClick: "gutterDblClick", dragStart: "dragStart", dragEnd: "dragEnd", transitionEnd: "transitionEnd" }, host: { properties: { "class": "this.hostClassesBinding", "dir": "this.hostDirBinding" } }, queries: [{ propertyName: "_areas", predicate: SPLIT_AREA_CONTRACT, isSignal: true }, { propertyName: "customGutter", first: true, predicate: SplitGutterDirective, descendants: true, isSignal: true }], exportAs: ["asSplit"], ngImport: i0, template: "<ng-content></ng-content>\n@for (area of _areas(); track area) {\n  @if (!$last) {\n    <div\n      #gutter\n      class=\"as-split-gutter\"\n      role=\"separator\"\n      tabindex=\"0\"\n      [attr.aria-label]=\"gutterAriaLabel()\"\n      [attr.aria-orientation]=\"direction()\"\n      [attr.aria-valuemin]=\"getAriaValue(area.minSize())\"\n      [attr.aria-valuemax]=\"getAriaValue(area.maxSize())\"\n      [attr.aria-valuenow]=\"getAriaValue(area._internalSize())\"\n      [attr.aria-valuetext]=\"getAriaAreaSizeText(area)\"\n      [ngStyle]=\"getGutterGridStyle($index + 1)\"\n      [class.as-dragged]=\"draggedGutterIndex() === $index\"\n      asSplitCustomEventsBehavior\n      [asSplitCustomMultiClickThreshold]=\"gutterDblClickDuration()\"\n      [asSplitCustomClickDeltaInPx]=\"gutterClickDeltaPx()\"\n      (asSplitCustomClick)=\"gutterClicked($index)\"\n      (asSplitCustomDblClick)=\"gutterDoubleClicked($index)\"\n      (asSplitCustomMouseDown)=\"gutterMouseDown($event, gutter, $index, $index, $index + 1)\"\n      (asSplitCustomKeyDown)=\"gutterKeyDown($event, $index, $index, $index + 1)\"\n    >\n      @if (customGutter()?.template) {\n        <ng-container *asSplitGutterDynamicInjector=\"$index + 1; let injector\">\n          <ng-container\n            *ngTemplateOutlet=\"\n              customGutter().template;\n              context: {\n                areaBefore: area,\n                areaAfter: _areas()[$index + 1],\n                gutterNum: $index + 1,\n                first: $first,\n                last: $index === _areas().length - 2,\n                isDragged: draggedGutterIndex() === $index\n              };\n              injector: injector\n            \"\n          ></ng-container>\n        </ng-container>\n      } @else {\n        <div class=\"as-split-gutter-icon\"></div>\n      }\n    </div>\n  }\n}\n", styles: ["@property --as-gutter-background-color{syntax: \"<color>\"; inherits: true; initial-value: #eeeeee;}@property --as-gutter-icon-horizontal{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==);}@property --as-gutter-icon-vertical{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC);}@property --as-gutter-icon-disabled{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==);}@property --as-transition-duration{syntax: \"<time>\"; inherits: true; initial-value: .3s;}@property --as-gutter-disabled-cursor{syntax: \"*\"; inherits: true; initial-value: default;}:host{--_as-gutter-background-color: var(--as-gutter-background-color, #eeeeee);--_as-gutter-icon-horizontal: var( --as-gutter-icon-horizontal, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) );--_as-gutter-icon-vertical: var( --as-gutter-icon-vertical, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC) );--_as-gutter-icon-disabled: var( --as-gutter-icon-disabled, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) );--_as-transition-duration: var(--as-transition-duration, .3s);--_as-gutter-disabled-cursor: var(--as-gutter-disabled-cursor, default)}:host{display:grid;overflow:hidden;height:100%;width:100%}:host(.as-transition){transition:grid-template var(--_as-transition-duration)}.as-split-gutter{background-color:var(--_as-gutter-background-color);display:flex;align-items:center;justify-content:center;touch-action:none}:host(.as-horizontal)>.as-split-gutter{cursor:col-resize;height:100%}:host(.as-vertical)>.as-split-gutter{cursor:row-resize;width:100%}:host(.as-disabled)>.as-split-gutter{cursor:var(--_as-gutter-disabled-cursor)}.as-split-gutter-icon{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}:host(.as-horizontal)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-horizontal)}:host(.as-vertical)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-vertical)}:host(.as-disabled)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-disabled)}\n"], dependencies: [{ kind: "directive", type: NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "directive", type: SplitCustomEventsBehaviorDirective, selector: "[asSplitCustomEventsBehavior]", inputs: ["asSplitCustomMultiClickThreshold", "asSplitCustomClickDeltaInPx"], outputs: ["asSplitCustomMouseDown", "asSplitCustomClick", "asSplitCustomDblClick", "asSplitCustomKeyDown"] }, { kind: "directive", type: SplitGutterDynamicInjectorDirective, selector: "[asSplitGutterDynamicInjector]", inputs: ["asSplitGutterDynamicInjector"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.2", ngImport: i0, type: SplitComponent, decorators: [{
            type: Component,
            args: [{ selector: 'as-split', standalone: true, imports: [NgStyle, SplitCustomEventsBehaviorDirective, SplitGutterDynamicInjectorDirective, NgTemplateOutlet], exportAs: 'asSplit', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-content></ng-content>\n@for (area of _areas(); track area) {\n  @if (!$last) {\n    <div\n      #gutter\n      class=\"as-split-gutter\"\n      role=\"separator\"\n      tabindex=\"0\"\n      [attr.aria-label]=\"gutterAriaLabel()\"\n      [attr.aria-orientation]=\"direction()\"\n      [attr.aria-valuemin]=\"getAriaValue(area.minSize())\"\n      [attr.aria-valuemax]=\"getAriaValue(area.maxSize())\"\n      [attr.aria-valuenow]=\"getAriaValue(area._internalSize())\"\n      [attr.aria-valuetext]=\"getAriaAreaSizeText(area)\"\n      [ngStyle]=\"getGutterGridStyle($index + 1)\"\n      [class.as-dragged]=\"draggedGutterIndex() === $index\"\n      asSplitCustomEventsBehavior\n      [asSplitCustomMultiClickThreshold]=\"gutterDblClickDuration()\"\n      [asSplitCustomClickDeltaInPx]=\"gutterClickDeltaPx()\"\n      (asSplitCustomClick)=\"gutterClicked($index)\"\n      (asSplitCustomDblClick)=\"gutterDoubleClicked($index)\"\n      (asSplitCustomMouseDown)=\"gutterMouseDown($event, gutter, $index, $index, $index + 1)\"\n      (asSplitCustomKeyDown)=\"gutterKeyDown($event, $index, $index, $index + 1)\"\n    >\n      @if (customGutter()?.template) {\n        <ng-container *asSplitGutterDynamicInjector=\"$index + 1; let injector\">\n          <ng-container\n            *ngTemplateOutlet=\"\n              customGutter().template;\n              context: {\n                areaBefore: area,\n                areaAfter: _areas()[$index + 1],\n                gutterNum: $index + 1,\n                first: $first,\n                last: $index === _areas().length - 2,\n                isDragged: draggedGutterIndex() === $index\n              };\n              injector: injector\n            \"\n          ></ng-container>\n        </ng-container>\n      } @else {\n        <div class=\"as-split-gutter-icon\"></div>\n      }\n    </div>\n  }\n}\n", styles: ["@property --as-gutter-background-color{syntax: \"<color>\"; inherits: true; initial-value: #eeeeee;}@property --as-gutter-icon-horizontal{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==);}@property --as-gutter-icon-vertical{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC);}@property --as-gutter-icon-disabled{syntax: \"<url>\"; inherits: true; initial-value: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==);}@property --as-transition-duration{syntax: \"<time>\"; inherits: true; initial-value: .3s;}@property --as-gutter-disabled-cursor{syntax: \"*\"; inherits: true; initial-value: default;}:host{--_as-gutter-background-color: var(--as-gutter-background-color, #eeeeee);--_as-gutter-icon-horizontal: var( --as-gutter-icon-horizontal, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) );--_as-gutter-icon-vertical: var( --as-gutter-icon-vertical, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC) );--_as-gutter-icon-disabled: var( --as-gutter-icon-disabled, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) );--_as-transition-duration: var(--as-transition-duration, .3s);--_as-gutter-disabled-cursor: var(--as-gutter-disabled-cursor, default)}:host{display:grid;overflow:hidden;height:100%;width:100%}:host(.as-transition){transition:grid-template var(--_as-transition-duration)}.as-split-gutter{background-color:var(--_as-gutter-background-color);display:flex;align-items:center;justify-content:center;touch-action:none}:host(.as-horizontal)>.as-split-gutter{cursor:col-resize;height:100%}:host(.as-vertical)>.as-split-gutter{cursor:row-resize;width:100%}:host(.as-disabled)>.as-split-gutter{cursor:var(--_as-gutter-disabled-cursor)}.as-split-gutter-icon{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}:host(.as-horizontal)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-horizontal)}:host(.as-vertical)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-vertical)}:host(.as-disabled)>.as-split-gutter>.as-split-gutter-icon{background-image:var(--_as-gutter-icon-disabled)}\n"] }]
        }], ctorParameters: () => [], propDecorators: { hostClassesBinding: [{
                type: HostBinding,
                args: ['class']
            }], hostDirBinding: [{
                type: HostBinding,
                args: ['dir']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BsaXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWxhci1zcGxpdC9zcmMvbGliL3NwbGl0L3NwbGl0LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXItc3BsaXQvc3JjL2xpYi9zcGxpdC9zcGxpdC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsV0FBVyxFQUNYLGNBQWMsRUFDZCxNQUFNLEVBQ04sU0FBUyxFQUNULGdCQUFnQixFQUNoQixRQUFRLEVBQ1IsWUFBWSxFQUNaLGVBQWUsRUFDZixNQUFNLEVBQ04sTUFBTSxFQUNOLEtBQUssRUFDTCxNQUFNLEVBQ04sTUFBTSxFQUNOLFNBQVMsR0FDVixNQUFNLGVBQWUsQ0FBQTtBQUN0QixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQTtBQUUvRCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUN2SCxPQUFPLEVBRUwsbUJBQW1CLEVBQ25CLDBCQUEwQixFQUMxQixrQkFBa0IsRUFDbEIsZ0JBQWdCLEVBQ2hCLGlCQUFpQixFQUNqQixXQUFXLEVBQ1gsMkJBQTJCLEVBQzNCLEdBQUcsRUFDSCxRQUFRLEdBQ1QsTUFBTSxVQUFVLENBQUE7QUFDakIsT0FBTyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQTtBQUVyRSxPQUFPLEVBQUUsa0NBQWtDLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQTtBQUM5RixPQUFPLEVBQUUsYUFB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LElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7WUFDcEQsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLE1BQU0sV0FBVyxHQUFHLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsR0FBRyxHQUFHLENBQUE7Z0JBQzdGLDJGQUEyRjtnQkFDM0YsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO1lBQzdELENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQTtRQUVGLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLDBCQUEwQixDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsQ0FBQTtJQUMzRixDQUFDO2lJQXZnQlUsY0FBYztxSEFBZCxjQUFjLGkxREFhUyxtQkFBbUIsNEVBQ04sb0JBQW9CLHVGQ3pGckUsbTBEQStDQSx5MEZEc0JZLE9BQU8sMkVBQUUsa0NBQWtDLG1RQUFFLG1DQUFtQyxxSEFBRSxnQkFBZ0I7OzJGQU1qRyxjQUFjO2tCQVQxQixTQUFTOytCQUNFLFVBQVUsY0FDUixJQUFJLFdBQ1AsQ0FBQyxPQUFPLEVBQUUsa0NBQWtDLEVBQUUsbUNBQW1DLEVBQUUsZ0JBQWdCLENBQUMsWUFDbkcsU0FBUyxtQkFHRix1QkFBdUIsQ0FBQyxNQUFNO3dEQTZHWCxrQkFBa0I7c0JBQXJELFdBQVc7dUJBQUMsT0FBTztnQkFJYyxjQUFjO3NCQUEvQyxXQUFXO3VCQUFDLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBIb3N0QmluZGluZyxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIE5nWm9uZSxcbiAgUmVuZGVyZXIyLFxuICBib29sZWFuQXR0cmlidXRlLFxuICBjb21wdXRlZCxcbiAgY29udGVudENoaWxkLFxuICBjb250ZW50Q2hpbGRyZW4sXG4gIGVmZmVjdCxcbiAgaW5qZWN0LFxuICBpbnB1dCxcbiAgb3V0cHV0LFxuICBzaWduYWwsXG4gIHVudHJhY2tlZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSdcbmltcG9ydCB7IHRha2VVbnRpbERlc3Ryb3llZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wJ1xuaW1wb3J0IHR5cGUgeyBTcGxpdEFyZWFDb21wb25lbnQgfSBmcm9tICcuLi9zcGxpdC1hcmVhL3NwbGl0LWFyZWEuY29tcG9uZW50J1xuaW1wb3J0IHsgU3ViamVjdCwgZmlsdGVyLCBmcm9tRXZlbnQsIG1hcCwgcGFpcndpc2UsIHNraXBXaGlsZSwgc3RhcnRXaXRoLCBzd2l0Y2hNYXAsIHRha2UsIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcydcbmltcG9ydCB7XG4gIENsaWVudFBvaW50LFxuICBjcmVhdGVDbGFzc2VzU3RyaW5nLFxuICBndXR0ZXJFdmVudHNFcXVhbFdpdGhEZWx0YSxcbiAgZnJvbU1vdXNlTW92ZUV2ZW50LFxuICBmcm9tTW91c2VVcEV2ZW50LFxuICBnZXRQb2ludEZyb21FdmVudCxcbiAgbGVhdmVOZ1pvbmUsXG4gIG51bWJlckF0dHJpYnV0ZVdpdGhGYWxsYmFjayxcbiAgc3VtLFxuICB0b1JlY29yZCxcbn0gZnJvbSAnLi4vdXRpbHMnXG5pbXBvcnQgeyBET0NVTUVOVCwgTmdTdHlsZSwgTmdUZW1wbGF0ZU91dGxldCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbidcbmltcG9ydCB7IFNwbGl0R3V0dGVySW50ZXJhY3Rpb25FdmVudCwgU3BsaXRBcmVhU2l6ZSB9IGZyb20gJy4uL21vZGVscydcbmltcG9ydCB7IFNwbGl0Q3VzdG9tRXZlbnRzQmVoYXZpb3JEaXJlY3RpdmUgfSBmcm9tICcuLi9zcGxpdC1jdXN0b20tZXZlbnRzLWJlaGF2aW9yLmRpcmVjdGl2ZSdcbmltcG9ydCB7IGFyZUFyZWFzVmFsaWQgfSBmcm9tICcuLi92YWxpZGF0aW9ucydcbmltcG9ydCB7IFNwbGl0R3V0dGVyRGlyZWN0aXZlIH0gZnJvbSAnLi4vZ3V0dGVyL3NwbGl0LWd1dHRlci5kaXJlY3RpdmUnXG5pbXBvcnQgeyBTcGxpdEd1dHRlckR5bmFtaWNJbmplY3RvckRpcmVjdGl2ZSB9IGZyb20gJy4uL2d1dHRlci9zcGxpdC1ndXR0ZXItZHluYW1pYy1pbmplY3Rvci5kaXJlY3RpdmUnXG5pbXBvcnQgeyBBTkdVTEFSX1NQTElUX0RFRkFVTFRfT1BUSU9OUyB9IGZyb20gJy4uL2FuZ3VsYXItc3BsaXQtY29uZmlnLnRva2VuJ1xuXG5pbnRlcmZhY2UgTW91c2VEb3duQ29udGV4dCB7XG4gIG1vdXNlRG93bkV2ZW50OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudFxuICBndXR0ZXJJbmRleDogbnVtYmVyXG4gIGd1dHRlckVsZW1lbnQ6IEhUTUxFbGVtZW50XG4gIGFyZWFCZWZvcmVHdXR0ZXJJbmRleDogbnVtYmVyXG4gIGFyZWFBZnRlckd1dHRlckluZGV4OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIEFyZWFCb3VuZGFyeSB7XG4gIG1pbjogbnVtYmVyXG4gIG1heDogbnVtYmVyXG59XG5cbmludGVyZmFjZSBEcmFnU3RhcnRDb250ZXh0IHtcbiAgc3RhcnRFdmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQgfCBLZXlib2FyZEV2ZW50XG4gIGFyZWFzUGl4ZWxTaXplczogbnVtYmVyW11cbiAgdG90YWxBcmVhc1BpeGVsU2l6ZTogbnVtYmVyXG4gIGFyZWFJbmRleFRvQm91bmRhcmllczogUmVjb3JkPG51bWJlciwgQXJlYUJvdW5kYXJ5PlxuICBhcmVhQmVmb3JlR3V0dGVySW5kZXg6IG51bWJlclxuICBhcmVhQWZ0ZXJHdXR0ZXJJbmRleDogbnVtYmVyXG59XG5cbmV4cG9ydCBjb25zdCBTUExJVF9BUkVBX0NPTlRSQUNUID0gbmV3IEluamVjdGlvblRva2VuPFNwbGl0QXJlYUNvbXBvbmVudD4oJ1NwbGl0IEFyZWEgQ29udHJhY3QnKVxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhcy1zcGxpdCcsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtOZ1N0eWxlLCBTcGxpdEN1c3RvbUV2ZW50c0JlaGF2aW9yRGlyZWN0aXZlLCBTcGxpdEd1dHRlckR5bmFtaWNJbmplY3RvckRpcmVjdGl2ZSwgTmdUZW1wbGF0ZU91dGxldF0sXG4gIGV4cG9ydEFzOiAnYXNTcGxpdCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9zcGxpdC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsOiAnLi9zcGxpdC5jb21wb25lbnQuY3NzJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIFNwbGl0Q29tcG9uZW50IHtcbiAgcHJpdmF0ZSByZWFkb25seSBkb2N1bWVudCA9IGluamVjdChET0NVTUVOVClcbiAgcHJpdmF0ZSByZWFkb25seSByZW5kZXJlciA9IGluamVjdChSZW5kZXJlcjIpXG4gIHByaXZhdGUgcmVhZG9ubHkgZWxlbWVudFJlZiA9IGluamVjdDxFbGVtZW50UmVmPEhUTUxFbGVtZW50Pj4oRWxlbWVudFJlZilcbiAgcHJpdmF0ZSByZWFkb25seSBuZ1pvbmUgPSBpbmplY3QoTmdab25lKVxuICBwcml2YXRlIHJlYWRvbmx5IGRlZmF1bHRPcHRpb25zID0gaW5qZWN0KEFOR1VMQVJfU1BMSVRfREVGQVVMVF9PUFRJT05TKVxuXG4gIHByaXZhdGUgcmVhZG9ubHkgZ3V0dGVyTW91c2VEb3duU3ViamVjdCA9IG5ldyBTdWJqZWN0PE1vdXNlRG93bkNvbnRleHQ+KClcbiAgcHJpdmF0ZSByZWFkb25seSBkcmFnUHJvZ3Jlc3NTdWJqZWN0ID0gbmV3IFN1YmplY3Q8U3BsaXRHdXR0ZXJJbnRlcmFjdGlvbkV2ZW50PigpXG5cbiAgLyoqXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgcmVhZG9ubHkgX2FyZWFzID0gY29udGVudENoaWxkcmVuKFNQTElUX0FSRUFfQ09OVFJBQ1QpXG4gIHByb3RlY3RlZCByZWFkb25seSBjdXN0b21HdXR0ZXIgPSBjb250ZW50Q2hpbGQoU3BsaXRHdXR0ZXJEaXJlY3RpdmUpXG4gIHJlYWRvbmx5IGd1dHRlclNpemUgPSBpbnB1dCh0aGlzLmRlZmF1bHRPcHRpb25zLmd1dHRlclNpemUsIHtcbiAgICB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZVdpdGhGYWxsYmFjayh0aGlzLmRlZmF1bHRPcHRpb25zLmd1dHRlclNpemUpLFxuICB9KVxuICByZWFkb25seSBndXR0ZXJTdGVwID0gaW5wdXQodGhpcy5kZWZhdWx0T3B0aW9ucy5ndXR0ZXJTdGVwLCB7XG4gICAgdHJhbnNmb3JtOiBudW1iZXJBdHRyaWJ1dGVXaXRoRmFsbGJhY2sodGhpcy5kZWZhdWx0T3B0aW9ucy5ndXR0ZXJTdGVwKSxcbiAgfSlcbiAgcmVhZG9ubHkgZGlzYWJsZWQgPSBpbnB1dCh0aGlzLmRlZmF1bHRPcHRpb25zLmRpc2FibGVkLCB7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KVxuICByZWFkb25seSBndXR0ZXJDbGlja0RlbHRhUHggPSBpbnB1dCh0aGlzLmRlZmF1bHRPcHRpb25zLmd1dHRlckNsaWNrRGVsdGFQeCwge1xuICAgIHRyYW5zZm9ybTogbnVtYmVyQXR0cmlidXRlV2l0aEZhbGxiYWNrKHRoaXMuZGVmYXVsdE9wdGlvbnMuZ3V0dGVyQ2xpY2tEZWx0YVB4KSxcbiAgfSlcbiAgcmVhZG9ubHkgZGlyZWN0aW9uID0gaW5wdXQodGhpcy5kZWZhdWx0T3B0aW9ucy5kaXJlY3Rpb24pXG4gIHJlYWRvbmx5IGRpciA9IGlucHV0KHRoaXMuZGVmYXVsdE9wdGlvbnMuZGlyKVxuICByZWFkb25seSB1bml0ID0gaW5wdXQodGhpcy5kZWZhdWx0T3B0aW9ucy51bml0KVxuICByZWFkb25seSBndXR0ZXJBcmlhTGFiZWwgPSBpbnB1dDxzdHJpbmc+KClcbiAgcmVhZG9ubHkgcmVzdHJpY3RNb3ZlID0gaW5wdXQodGhpcy5kZWZhdWx0T3B0aW9ucy5yZXN0cmljdE1vdmUsIHsgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlIH0pXG4gIHJlYWRvbmx5IHVzZVRyYW5zaXRpb24gPSBpbnB1dCh0aGlzLmRlZmF1bHRPcHRpb25zLnVzZVRyYW5zaXRpb24sIHsgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlIH0pXG4gIHJlYWRvbmx5IGd1dHRlckRibENsaWNrRHVyYXRpb24gPSBpbnB1dCh0aGlzLmRlZmF1bHRPcHRpb25zLmd1dHRlckRibENsaWNrRHVyYXRpb24sIHtcbiAgICB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZVdpdGhGYWxsYmFjayh0aGlzLmRlZmF1bHRPcHRpb25zLmd1dHRlckRibENsaWNrRHVyYXRpb24pLFxuICB9KVxuICByZWFkb25seSBndXR0ZXJDbGljayA9IG91dHB1dDxTcGxpdEd1dHRlckludGVyYWN0aW9uRXZlbnQ+KClcbiAgcmVhZG9ubHkgZ3V0dGVyRGJsQ2xpY2sgPSBvdXRwdXQ8U3BsaXRHdXR0ZXJJbnRlcmFjdGlvbkV2ZW50PigpXG4gIHJlYWRvbmx5IGRyYWdTdGFydCA9IG91dHB1dDxTcGxpdEd1dHRlckludGVyYWN0aW9uRXZlbnQ+KClcbiAgcmVhZG9ubHkgZHJhZ0VuZCA9IG91dHB1dDxTcGxpdEd1dHRlckludGVyYWN0aW9uRXZlbnQ+KClcbiAgcmVhZG9ubHkgdHJhbnNpdGlvbkVuZCA9IG91dHB1dDxTcGxpdEFyZWFTaXplW10+KClcblxuICByZWFkb25seSBkcmFnUHJvZ3Jlc3MkID0gdGhpcy5kcmFnUHJvZ3Jlc3NTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpXG5cbiAgcHJpdmF0ZSByZWFkb25seSB2aXNpYmxlQXJlYXMgPSBjb21wdXRlZCgoKSA9PiB0aGlzLl9hcmVhcygpLmZpbHRlcigoYXJlYSkgPT4gYXJlYS52aXNpYmxlKCkpKVxuICBwcml2YXRlIHJlYWRvbmx5IGdyaWRUZW1wbGF0ZUNvbHVtbnNTdHlsZSA9IGNvbXB1dGVkKCgpID0+IHtcbiAgICBjb25zdCBjb2x1bW5zOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3Qgc3VtTm9uV2lsZGNhcmRTaXplcyA9IHN1bSh0aGlzLnZpc2libGVBcmVhcygpLCAoYXJlYSkgPT4ge1xuICAgICAgY29uc3Qgc2l6ZSA9IGFyZWEuX2ludGVybmFsU2l6ZSgpXG4gICAgICByZXR1cm4gc2l6ZSA9PT0gJyonID8gMCA6IHNpemVcbiAgICB9KVxuICAgIGNvbnN0IHZpc2libGVBcmVhc0NvdW50ID0gdGhpcy52aXNpYmxlQXJlYXMoKS5sZW5ndGhcblxuICAgIGxldCB2aXNpdGVkVmlzaWJsZUFyZWFzID0gMFxuXG4gICAgdGhpcy5fYXJlYXMoKS5mb3JFYWNoKChhcmVhLCBpbmRleCwgYXJlYXMpID0+IHtcbiAgICAgIC8vIEFkZCBhcmVhIHNpemUgY29sdW1uXG4gICAgICBpZiAoIWFyZWEudmlzaWJsZSgpKSB7XG4gICAgICAgIGNvbHVtbnMucHVzaCgnMGZyJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGFyZWFTaXplID0gYXJlYS5faW50ZXJuYWxTaXplKClcbiAgICAgICAgY29uc3QgdW5pdCA9IHRoaXMudW5pdCgpXG5cbiAgICAgICAgaWYgKHVuaXQgPT09ICdwaXhlbCcpIHtcbiAgICAgICAgICBjb25zdCBjb2x1bW5WYWx1ZSA9IGFyZWFTaXplID09PSAnKicgPyAnMWZyJyA6IGAke2FyZWFTaXplfXB4YFxuICAgICAgICAgIGNvbHVtbnMucHVzaChjb2x1bW5WYWx1ZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBwZXJjZW50U2l6ZSA9IGFyZWFTaXplID09PSAnKicgPyAxMDAgLSBzdW1Ob25XaWxkY2FyZFNpemVzIDogYXJlYVNpemVcbiAgICAgICAgICBjb25zdCBjb2x1bW5WYWx1ZSA9IGAke3BlcmNlbnRTaXplfWZyYFxuICAgICAgICAgIGNvbHVtbnMucHVzaChjb2x1bW5WYWx1ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIHZpc2l0ZWRWaXNpYmxlQXJlYXMrK1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc0xhc3RBcmVhID0gaW5kZXggPT09IGFyZWFzLmxlbmd0aCAtIDFcblxuICAgICAgaWYgKGlzTGFzdEFyZWEpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlbWFpbmluZ1Zpc2libGVBcmVhcyA9IHZpc2libGVBcmVhc0NvdW50IC0gdmlzaXRlZFZpc2libGVBcmVhc1xuXG4gICAgICAvLyBPbmx5IGFkZCBndXR0ZXIgd2l0aCBzaXplIGlmIHRoaXMgYXJlYSBpcyB2aXNpYmxlIGFuZCB0aGVyZSBhcmUgbW9yZSB2aXNpYmxlIGFyZWFzIGFmdGVyIHRoaXMgb25lXG4gICAgICAvLyB0byBhdm9pZCBnaG9zdCBndXR0ZXJzXG4gICAgICBpZiAoYXJlYS52aXNpYmxlKCkgJiYgcmVtYWluaW5nVmlzaWJsZUFyZWFzID4gMCkge1xuICAgICAgICBjb2x1bW5zLnB1c2goYCR7dGhpcy5ndXR0ZXJTaXplKCl9cHhgKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29sdW1ucy5wdXNoKCcwcHgnKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gdGhpcy5kaXJlY3Rpb24oKSA9PT0gJ2hvcml6b250YWwnID8gYDFmciAvICR7Y29sdW1ucy5qb2luKCcgJyl9YCA6IGAke2NvbHVtbnMuam9pbignICcpfSAvIDFmcmBcbiAgfSlcbiAgcHJpdmF0ZSByZWFkb25seSBob3N0Q2xhc3NlcyA9IGNvbXB1dGVkKCgpID0+XG4gICAgY3JlYXRlQ2xhc3Nlc1N0cmluZyh7XG4gICAgICBbYGFzLSR7dGhpcy5kaXJlY3Rpb24oKX1gXTogdHJ1ZSxcbiAgICAgIFtgYXMtJHt0aGlzLnVuaXQoKX1gXTogdHJ1ZSxcbiAgICAgIFsnYXMtZGlzYWJsZWQnXTogdGhpcy5kaXNhYmxlZCgpLFxuICAgICAgWydhcy1kcmFnZ2luZyddOiB0aGlzLl9pc0RyYWdnaW5nKCksXG4gICAgICBbJ2FzLXRyYW5zaXRpb24nXTogdGhpcy51c2VUcmFuc2l0aW9uKCkgJiYgIXRoaXMuX2lzRHJhZ2dpbmcoKSxcbiAgICB9KSxcbiAgKVxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgZHJhZ2dlZEd1dHRlckluZGV4ID0gc2lnbmFsPG51bWJlcj4odW5kZWZpbmVkKVxuICAvKipcbiAgICogQGludGVybmFsXG4gICAqL1xuICByZWFkb25seSBfaXNEcmFnZ2luZyA9IGNvbXB1dGVkKCgpID0+IHRoaXMuZHJhZ2dlZEd1dHRlckluZGV4KCkgIT09IHVuZGVmaW5lZClcblxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJykgcHJvdGVjdGVkIGdldCBob3N0Q2xhc3Nlc0JpbmRpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuaG9zdENsYXNzZXMoKVxuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdkaXInKSBwcm90ZWN0ZWQgZ2V0IGhvc3REaXJCaW5kaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmRpcigpXG4gIH1cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBlZmZlY3QoXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpc2libGVBcmVhcyA9IHRoaXMudmlzaWJsZUFyZWFzKClcbiAgICAgICAgY29uc3QgdW5pdCA9IHRoaXMudW5pdCgpXG4gICAgICAgIGNvbnN0IGlzSW5BdXRvTW9kZSA9IHZpc2libGVBcmVhcy5ldmVyeSgoYXJlYSkgPT4gYXJlYS5zaXplKCkgPT09ICdhdXRvJylcblxuICAgICAgICB1bnRyYWNrZWQoKCkgPT4ge1xuICAgICAgICAgIC8vIFNwZWNpYWwgbW9kZSB3aGVuIG5vIHNpemUgaW5wdXQgd2FzIGRlY2xhcmVkIHdoaWNoIGlzIGEgdmFsaWQgbW9kZVxuICAgICAgICAgIGlmICh1bml0ID09PSAncGVyY2VudCcgJiYgdmlzaWJsZUFyZWFzLmxlbmd0aCA+IDEgJiYgaXNJbkF1dG9Nb2RlKSB7XG4gICAgICAgICAgICB2aXNpYmxlQXJlYXMuZm9yRWFjaCgoYXJlYSkgPT4gYXJlYS5faW50ZXJuYWxTaXplLnNldCgxMDAgLyB2aXNpYmxlQXJlYXMubGVuZ3RoKSlcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZpc2libGVBcmVhcy5mb3JFYWNoKChhcmVhKSA9PiBhcmVhLl9pbnRlcm5hbFNpemUucmVzZXQoKSlcblxuICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhcmVBcmVhc1ZhbGlkKHZpc2libGVBcmVhcywgdW5pdClcblxuICAgICAgICAgIGlmIChpc1ZhbGlkKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodW5pdCA9PT0gJ3BlcmNlbnQnKSB7XG4gICAgICAgICAgICAvLyBEaXN0cmlidXRlIHNpemVzIGVxdWFsbHlcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRTaXplID0gMTAwIC8gdmlzaWJsZUFyZWFzLmxlbmd0aFxuICAgICAgICAgICAgdmlzaWJsZUFyZWFzLmZvckVhY2goKGFyZWEpID0+IGFyZWEuX2ludGVybmFsU2l6ZS5zZXQoZGVmYXVsdFNpemUpKVxuICAgICAgICAgIH0gZWxzZSBpZiAodW5pdCA9PT0gJ3BpeGVsJykge1xuICAgICAgICAgICAgY29uc3Qgd2lsZGNhcmRBcmVhcyA9IHZpc2libGVBcmVhcy5maWx0ZXIoKGFyZWEpID0+IGFyZWEuX2ludGVybmFsU2l6ZSgpID09PSAnKicpXG5cbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSBvbmx5IG9uZSB3aWxkY2FyZCBhcmVhXG4gICAgICAgICAgICBpZiAod2lsZGNhcmRBcmVhcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgdmlzaWJsZUFyZWFzWzBdLl9pbnRlcm5hbFNpemUuc2V0KCcqJylcbiAgICAgICAgICAgIH0gZWxzZSBpZiAod2lsZGNhcmRBcmVhcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIHdpbGRjYXJkQXJlYXMuZmlsdGVyKChfLCBpKSA9PiBpICE9PSAwKS5mb3JFYWNoKChhcmVhKSA9PiBhcmVhLl9pbnRlcm5hbFNpemUuc2V0KDEwMCkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSxcbiAgICAgIHsgYWxsb3dTaWduYWxXcml0ZXM6IHRydWUgfSxcbiAgICApXG5cbiAgICAvLyBSZXNwb25zaWJsZSBmb3IgdXBkYXRpbmcgZ3JpZCB0ZW1wbGF0ZSBzdHlsZS4gTXVzdCBiZSB0aGlzIHdheSBhbmQgbm90IGJhc2VkIG9uIEhvc3RCaW5kaW5nXG4gICAgLy8gYXMgY2hhbmdlIGRldGVjdGlvbiBmb3IgaG9zdCBiaW5kaW5nIGlzIGJvdW5kIHRvIHRoZSBwYXJlbnQgY29tcG9uZW50IGFuZCB0aGlzIHN0eWxlXG4gICAgLy8gaXMgdXBkYXRlZCBvbiBldmVyeSBtb3VzZSBtb3ZlLiBEb2luZyBpdCB0aGlzIHdheSB3aWxsIHByZXZlbnQgY2hhbmdlIGRldGVjdGlvbiBjeWNsZXMgaW4gcGFyZW50LlxuICAgIGVmZmVjdCgoKSA9PiB7XG4gICAgICBjb25zdCBncmlkVGVtcGxhdGVDb2x1bW5zU3R5bGUgPSB0aGlzLmdyaWRUZW1wbGF0ZUNvbHVtbnNTdHlsZSgpXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnZ3JpZC10ZW1wbGF0ZScsIGdyaWRUZW1wbGF0ZUNvbHVtbnNTdHlsZSlcbiAgICB9KVxuXG4gICAgdGhpcy5ndXR0ZXJNb3VzZURvd25TdWJqZWN0XG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyKFxuICAgICAgICAgIChjb250ZXh0KSA9PlxuICAgICAgICAgICAgIXRoaXMuY3VzdG9tR3V0dGVyKCkgfHxcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tR3V0dGVyKCkuY2FuU3RhcnREcmFnZ2luZyhjb250ZXh0Lm1vdXNlRG93bkV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudCwgY29udGV4dC5ndXR0ZXJJbmRleCArIDEpLFxuICAgICAgICApLFxuICAgICAgICBzd2l0Y2hNYXAoKG1vdXNlRG93bkNvbnRleHQpID0+XG4gICAgICAgICAgLy8gQXMgd2UgaGF2ZSBndXR0ZXJDbGlja0RlbHRhUHggd2UgY2FuJ3QganVzdCBzdGFydCB0aGUgZHJhZyBidXQgbmVlZCB0byBtYWtlIHN1cmVcbiAgICAgICAgICAvLyB3ZSBhcmUgb3V0IG9mIHRoZSBkZWx0YSBwaXhlbHMuIEFzIHRoZSBkZWx0YSBjYW4gYmUgYW55IG51bWJlciB3ZSBtYWtlIHN1cmVcbiAgICAgICAgICAvLyB3ZSBhbHdheXMgc3RhcnQgdGhlIGRyYWcgaWYgd2UgZ28gb3V0IG9mIHRoZSBndXR0ZXIgKGRlbHRhIGJhc2VkIG9uIG1vdXNlIHBvc2l0aW9uIGlzIGxhcmdlciB0aGFuIGd1dHRlcikuXG4gICAgICAgICAgLy8gQXMgbW92aW5nIGNhbiBzdGFydCBpbnNpZGUgdGhlIGRyYWcgYW5kIGVuZCBvdXRzaWRlIG9mIGl0IHdlIGFsd2F5cyBrZWVwIHRyYWNrIG9mIHRoZSBwcmV2aW91cyBldmVudFxuICAgICAgICAgIC8vIHNvIG9uY2UgdGhlIGN1cnJlbnQgaXMgb3V0IG9mIHRoZSBkZWx0YSBzaXplIHdlIHVzZSB0aGUgcHJldmlvdXMgb25lIGFzIHRoZSBkcmFnIHN0YXJ0IGJhc2VsaW5lLlxuICAgICAgICAgIGZyb21Nb3VzZU1vdmVFdmVudCh0aGlzLmRvY3VtZW50KS5waXBlKFxuICAgICAgICAgICAgc3RhcnRXaXRoKG1vdXNlRG93bkNvbnRleHQubW91c2VEb3duRXZlbnQpLFxuICAgICAgICAgICAgcGFpcndpc2UoKSxcbiAgICAgICAgICAgIHNraXBXaGlsZSgoWywgY3Vyck1vdmVFdmVudF0pID0+XG4gICAgICAgICAgICAgIGd1dHRlckV2ZW50c0VxdWFsV2l0aERlbHRhKFxuICAgICAgICAgICAgICAgIG1vdXNlRG93bkNvbnRleHQubW91c2VEb3duRXZlbnQsXG4gICAgICAgICAgICAgICAgY3Vyck1vdmVFdmVudCxcbiAgICAgICAgICAgICAgICB0aGlzLmd1dHRlckNsaWNrRGVsdGFQeCgpLFxuICAgICAgICAgICAgICAgIG1vdXNlRG93bkNvbnRleHQuZ3V0dGVyRWxlbWVudCxcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgICAgdGFrZVVudGlsKGZyb21Nb3VzZVVwRXZlbnQodGhpcy5kb2N1bWVudCwgdHJ1ZSkpLFxuICAgICAgICAgICAgdGFwKCgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdGFydC5lbWl0KHRoaXMuY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQobW91c2VEb3duQ29udGV4dC5ndXR0ZXJJbmRleCkpXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnZ2VkR3V0dGVySW5kZXguc2V0KG1vdXNlRG93bkNvbnRleHQuZ3V0dGVySW5kZXgpXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG1hcCgoW3ByZXZNb3VzZUV2ZW50XSkgPT5cbiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVEcmFnU3RhcnRDb250ZXh0KFxuICAgICAgICAgICAgICAgIHByZXZNb3VzZUV2ZW50LFxuICAgICAgICAgICAgICAgIG1vdXNlRG93bkNvbnRleHQuYXJlYUJlZm9yZUd1dHRlckluZGV4LFxuICAgICAgICAgICAgICAgIG1vdXNlRG93bkNvbnRleHQuYXJlYUFmdGVyR3V0dGVySW5kZXgsXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgc3dpdGNoTWFwKChkcmFnU3RhcnRDb250ZXh0KSA9PlxuICAgICAgICAgICAgICBmcm9tTW91c2VNb3ZlRXZlbnQodGhpcy5kb2N1bWVudCkucGlwZShcbiAgICAgICAgICAgICAgICB0YXAoKG1vdmVFdmVudCkgPT4gdGhpcy5tb3VzZURyYWdNb3ZlKG1vdmVFdmVudCwgZHJhZ1N0YXJ0Q29udGV4dCkpLFxuICAgICAgICAgICAgICAgIHRha2VVbnRpbChmcm9tTW91c2VVcEV2ZW50KHRoaXMuZG9jdW1lbnQsIHRydWUpKSxcbiAgICAgICAgICAgICAgICB0YXAoe1xuICAgICAgICAgICAgICAgICAgY29tcGxldGU6ICgpID0+XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnRW5kLmVtaXQodGhpcy5jcmVhdGVEcmFnSW50ZXJhY3Rpb25FdmVudCh0aGlzLmRyYWdnZWRHdXR0ZXJJbmRleCgpKSlcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYWdnZWRHdXR0ZXJJbmRleC5zZXQodW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgKSxcbiAgICAgICAgKSxcbiAgICAgICAgdGFrZVVudGlsRGVzdHJveWVkKCksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKClcblxuICAgIGZyb21FdmVudDxUcmFuc2l0aW9uRXZlbnQ+KHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAndHJhbnNpdGlvbmVuZCcpXG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyKChlKSA9PiBlLnByb3BlcnR5TmFtZS5zdGFydHNXaXRoKCdncmlkLXRlbXBsYXRlJykpLFxuICAgICAgICBsZWF2ZU5nWm9uZSgpLFxuICAgICAgICB0YWtlVW50aWxEZXN0cm95ZWQoKSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMudHJhbnNpdGlvbkVuZC5lbWl0KHRoaXMuY3JlYXRlQXJlYVNpemVzKCkpKSlcbiAgfVxuXG4gIHByb3RlY3RlZCBndXR0ZXJDbGlja2VkKGd1dHRlckluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5ndXR0ZXJDbGljay5lbWl0KHRoaXMuY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQoZ3V0dGVySW5kZXgpKSlcbiAgfVxuXG4gIHByb3RlY3RlZCBndXR0ZXJEb3VibGVDbGlja2VkKGd1dHRlckluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5ndXR0ZXJEYmxDbGljay5lbWl0KHRoaXMuY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQoZ3V0dGVySW5kZXgpKSlcbiAgfVxuXG4gIHByb3RlY3RlZCBndXR0ZXJNb3VzZURvd24oXG4gICAgZTogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQsXG4gICAgZ3V0dGVyRWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgZ3V0dGVySW5kZXg6IG51bWJlcixcbiAgICBhcmVhQmVmb3JlR3V0dGVySW5kZXg6IG51bWJlcixcbiAgICBhcmVhQWZ0ZXJHdXR0ZXJJbmRleDogbnVtYmVyLFxuICApIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCgpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG5cbiAgICB0aGlzLmd1dHRlck1vdXNlRG93blN1YmplY3QubmV4dCh7XG4gICAgICBtb3VzZURvd25FdmVudDogZSxcbiAgICAgIGd1dHRlckVsZW1lbnQsXG4gICAgICBndXR0ZXJJbmRleCxcbiAgICAgIGFyZWFCZWZvcmVHdXR0ZXJJbmRleCxcbiAgICAgIGFyZWFBZnRlckd1dHRlckluZGV4LFxuICAgIH0pXG4gIH1cblxuICBwcm90ZWN0ZWQgZ3V0dGVyS2V5RG93bihcbiAgICBlOiBLZXlib2FyZEV2ZW50LFxuICAgIGd1dHRlckluZGV4OiBudW1iZXIsXG4gICAgYXJlYUJlZm9yZUd1dHRlckluZGV4OiBudW1iZXIsXG4gICAgYXJlYUFmdGVyR3V0dGVySW5kZXg6IG51bWJlcixcbiAgKSB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQoKSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgcGl4ZWxzVG9Nb3ZlID0gNTBcbiAgICBjb25zdCBwYWdlTW92ZU11bHRpcGxpZXIgPSAxMFxuXG4gICAgbGV0IHhQb2ludE9mZnNldCA9IDBcbiAgICBsZXQgeVBvaW50T2Zmc2V0ID0gMFxuXG4gICAgaWYgKHRoaXMuZGlyZWN0aW9uKCkgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgLy8gRXZlbiB0aG91Z2ggd2UgYXJlIGdvaW5nIGluIHRoZSB4IGF4aXMgd2Ugc3VwcG9ydCBwYWdlIHVwIGFuZCBkb3duXG4gICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgICAgeFBvaW50T2Zmc2V0IC09IHBpeGVsc1RvTW92ZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgIHhQb2ludE9mZnNldCArPSBwaXhlbHNUb01vdmVcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdQYWdlVXAnOlxuICAgICAgICAgIGlmICh0aGlzLmRpcigpID09PSAncnRsJykge1xuICAgICAgICAgICAgeFBvaW50T2Zmc2V0IC09IHBpeGVsc1RvTW92ZSAqIHBhZ2VNb3ZlTXVsdGlwbGllclxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB4UG9pbnRPZmZzZXQgKz0gcGl4ZWxzVG9Nb3ZlICogcGFnZU1vdmVNdWx0aXBsaWVyXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ1BhZ2VEb3duJzpcbiAgICAgICAgICBpZiAodGhpcy5kaXIoKSA9PT0gJ3J0bCcpIHtcbiAgICAgICAgICAgIHhQb2ludE9mZnNldCArPSBwaXhlbHNUb01vdmUgKiBwYWdlTW92ZU11bHRpcGxpZXJcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgeFBvaW50T2Zmc2V0IC09IHBpeGVsc1RvTW92ZSAqIHBhZ2VNb3ZlTXVsdGlwbGllclxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVyblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgIHlQb2ludE9mZnNldCAtPSBwaXhlbHNUb01vdmVcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgIHlQb2ludE9mZnNldCArPSBwaXhlbHNUb01vdmVcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdQYWdlVXAnOlxuICAgICAgICAgIHlQb2ludE9mZnNldCAtPSBwaXhlbHNUb01vdmUgKiBwYWdlTW92ZU11bHRpcGxpZXJcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdQYWdlRG93bic6XG4gICAgICAgICAgeVBvaW50T2Zmc2V0ICs9IHBpeGVsc1RvTW92ZSAqIHBhZ2VNb3ZlTXVsdGlwbGllclxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgfVxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuXG4gICAgY29uc3QgZ3V0dGVyTWlkUG9pbnQgPSBnZXRQb2ludEZyb21FdmVudChlKVxuICAgIGNvbnN0IGRyYWdTdGFydENvbnRleHQgPSB0aGlzLmNyZWF0ZURyYWdTdGFydENvbnRleHQoZSwgYXJlYUJlZm9yZUd1dHRlckluZGV4LCBhcmVhQWZ0ZXJHdXR0ZXJJbmRleClcblxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICB0aGlzLmRyYWdTdGFydC5lbWl0KHRoaXMuY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQoZ3V0dGVySW5kZXgpKVxuICAgICAgdGhpcy5kcmFnZ2VkR3V0dGVySW5kZXguc2V0KGd1dHRlckluZGV4KVxuXG4gICAgICB0aGlzLmRyYWdNb3ZlVG9Qb2ludCh7IHg6IGd1dHRlck1pZFBvaW50LnggKyB4UG9pbnRPZmZzZXQsIHk6IGd1dHRlck1pZFBvaW50LnkgKyB5UG9pbnRPZmZzZXQgfSwgZHJhZ1N0YXJ0Q29udGV4dClcblxuICAgICAgdGhpcy5kcmFnRW5kLmVtaXQodGhpcy5jcmVhdGVEcmFnSW50ZXJhY3Rpb25FdmVudChndXR0ZXJJbmRleCkpXG4gICAgICB0aGlzLmRyYWdnZWRHdXR0ZXJJbmRleC5zZXQodW5kZWZpbmVkKVxuICAgIH0pXG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0R3V0dGVyR3JpZFN0eWxlKG5leHRBcmVhSW5kZXg6IG51bWJlcikge1xuICAgIGNvbnN0IGd1dHRlck51bSA9IG5leHRBcmVhSW5kZXggKiAyXG4gICAgY29uc3Qgc3R5bGUgPSBgJHtndXR0ZXJOdW19IC8gJHtndXR0ZXJOdW19YFxuXG4gICAgcmV0dXJuIHtcbiAgICAgIFsnZ3JpZC1jb2x1bW4nXTogdGhpcy5kaXJlY3Rpb24oKSA9PT0gJ2hvcml6b250YWwnID8gc3R5bGUgOiAnMScsXG4gICAgICBbJ2dyaWQtcm93J106IHRoaXMuZGlyZWN0aW9uKCkgPT09ICd2ZXJ0aWNhbCcgPyBzdHlsZSA6ICcxJyxcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0QXJpYUFyZWFTaXplVGV4dChhcmVhOiBTcGxpdEFyZWFDb21wb25lbnQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNpemUgPSBhcmVhLl9pbnRlcm5hbFNpemUoKVxuXG4gICAgaWYgKHNpemUgPT09ICcqJykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuICAgIH1cblxuICAgIHJldHVybiBgJHtzaXplLnRvRml4ZWQoMCl9ICR7dGhpcy51bml0KCl9YFxuICB9XG5cbiAgcHJvdGVjdGVkIGdldEFyaWFWYWx1ZShzaXplOiBTcGxpdEFyZWFTaXplKSB7XG4gICAgcmV0dXJuIHNpemUgPT09ICcqJyA/IHVuZGVmaW5lZCA6IHNpemVcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQoZ3V0dGVySW5kZXg6IG51bWJlcik6IFNwbGl0R3V0dGVySW50ZXJhY3Rpb25FdmVudCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGd1dHRlck51bTogZ3V0dGVySW5kZXggKyAxLFxuICAgICAgc2l6ZXM6IHRoaXMuY3JlYXRlQXJlYVNpemVzKCksXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVBcmVhU2l6ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMudmlzaWJsZUFyZWFzKCkubWFwKChhcmVhKSA9PiBhcmVhLl9pbnRlcm5hbFNpemUoKSlcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRHJhZ1N0YXJ0Q29udGV4dChcbiAgICBzdGFydEV2ZW50OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCB8IEtleWJvYXJkRXZlbnQsXG4gICAgYXJlYUJlZm9yZUd1dHRlckluZGV4OiBudW1iZXIsXG4gICAgYXJlYUFmdGVyR3V0dGVySW5kZXg6IG51bWJlcixcbiAgKTogRHJhZ1N0YXJ0Q29udGV4dCB7XG4gICAgY29uc3Qgc3BsaXRCb3VuZGluZ1JlY3QgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGNvbnN0IHNwbGl0U2l6ZSA9IHRoaXMuZGlyZWN0aW9uKCkgPT09ICdob3Jpem9udGFsJyA/IHNwbGl0Qm91bmRpbmdSZWN0LndpZHRoIDogc3BsaXRCb3VuZGluZ1JlY3QuaGVpZ2h0XG4gICAgY29uc3QgdG90YWxBcmVhc1BpeGVsU2l6ZSA9IHNwbGl0U2l6ZSAtICh0aGlzLnZpc2libGVBcmVhcygpLmxlbmd0aCAtIDEpICogdGhpcy5ndXR0ZXJTaXplKClcbiAgICAvLyBVc2UgdGhlIGludGVybmFsIHNpemUgYW5kIHNwbGl0IHNpemUgdG8gY2FsY3VsYXRlIHRoZSBwaXhlbCBzaXplIGZyb20gd2lsZGNhcmQgYW5kIHBlcmNlbnQgYXJlYXNcbiAgICBjb25zdCBhcmVhUGl4ZWxTaXplc1dpdGhXaWxkY2FyZCA9IHRoaXMuX2FyZWFzKCkubWFwKChhcmVhKSA9PiB7XG4gICAgICBpZiAodGhpcy51bml0KCkgPT09ICdwaXhlbCcpIHtcbiAgICAgICAgcmV0dXJuIGFyZWEuX2ludGVybmFsU2l6ZSgpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzaXplID0gYXJlYS5faW50ZXJuYWxTaXplKClcblxuICAgICAgICBpZiAoc2l6ZSA9PT0gJyonKSB7XG4gICAgICAgICAgcmV0dXJuIHNpemVcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoc2l6ZSAvIDEwMCkgKiB0b3RhbEFyZWFzUGl4ZWxTaXplXG4gICAgICB9XG4gICAgfSlcbiAgICBjb25zdCByZW1haW5pbmdTaXplID0gTWF0aC5tYXgoXG4gICAgICAwLFxuICAgICAgdG90YWxBcmVhc1BpeGVsU2l6ZSAtIHN1bShhcmVhUGl4ZWxTaXplc1dpdGhXaWxkY2FyZCwgKHNpemUpID0+IChzaXplID09PSAnKicgPyAwIDogc2l6ZSkpLFxuICAgIClcbiAgICBjb25zdCBhcmVhc1BpeGVsU2l6ZXMgPSBhcmVhUGl4ZWxTaXplc1dpdGhXaWxkY2FyZC5tYXAoKHNpemUpID0+IChzaXplID09PSAnKicgPyByZW1haW5pbmdTaXplIDogc2l6ZSkpXG5cbiAgICByZXR1cm4ge1xuICAgICAgc3RhcnRFdmVudCxcbiAgICAgIGFyZWFCZWZvcmVHdXR0ZXJJbmRleCxcbiAgICAgIGFyZWFBZnRlckd1dHRlckluZGV4LFxuICAgICAgYXJlYXNQaXhlbFNpemVzLFxuICAgICAgdG90YWxBcmVhc1BpeGVsU2l6ZSxcbiAgICAgIGFyZWFJbmRleFRvQm91bmRhcmllczogdG9SZWNvcmQodGhpcy5fYXJlYXMoKSwgKGFyZWEsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHBlcmNlbnRUb1BpeGVscyA9IChwZXJjZW50OiBudW1iZXIpID0+IChwZXJjZW50IC8gMTAwKSAqIHRvdGFsQXJlYXNQaXhlbFNpemVcblxuICAgICAgICBjb25zdCB2YWx1ZTogQXJlYUJvdW5kYXJ5ID1cbiAgICAgICAgICB0aGlzLnVuaXQoKSA9PT0gJ3BpeGVsJ1xuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgbWluOiBhcmVhLl9ub3JtYWxpemVkTWluU2l6ZSgpLFxuICAgICAgICAgICAgICAgIG1heDogYXJlYS5fbm9ybWFsaXplZE1heFNpemUoKSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB7XG4gICAgICAgICAgICAgICAgbWluOiBwZXJjZW50VG9QaXhlbHMoYXJlYS5fbm9ybWFsaXplZE1pblNpemUoKSksXG4gICAgICAgICAgICAgICAgbWF4OiBwZXJjZW50VG9QaXhlbHMoYXJlYS5fbm9ybWFsaXplZE1heFNpemUoKSksXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW2luZGV4LnRvU3RyaW5nKCksIHZhbHVlXVxuICAgICAgfSksXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBtb3VzZURyYWdNb3ZlKG1vdmVFdmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQsIGRyYWdTdGFydENvbnRleHQ6IERyYWdTdGFydENvbnRleHQpIHtcbiAgICBtb3ZlRXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIG1vdmVFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuXG4gICAgY29uc3QgZW5kUG9pbnQgPSBnZXRQb2ludEZyb21FdmVudChtb3ZlRXZlbnQpXG5cbiAgICB0aGlzLmRyYWdNb3ZlVG9Qb2ludChlbmRQb2ludCwgZHJhZ1N0YXJ0Q29udGV4dClcbiAgfVxuXG4gIHByaXZhdGUgZHJhZ01vdmVUb1BvaW50KGVuZFBvaW50OiBDbGllbnRQb2ludCwgZHJhZ1N0YXJ0Q29udGV4dDogRHJhZ1N0YXJ0Q29udGV4dCkge1xuICAgIGNvbnN0IHN0YXJ0UG9pbnQgPSBnZXRQb2ludEZyb21FdmVudChkcmFnU3RhcnRDb250ZXh0LnN0YXJ0RXZlbnQpXG4gICAgY29uc3QgcHJlRGlyT2Zmc2V0ID0gdGhpcy5kaXJlY3Rpb24oKSA9PT0gJ2hvcml6b250YWwnID8gZW5kUG9pbnQueCAtIHN0YXJ0UG9pbnQueCA6IGVuZFBvaW50LnkgLSBzdGFydFBvaW50LnlcbiAgICBjb25zdCBvZmZzZXQgPSB0aGlzLmRpcmVjdGlvbigpID09PSAnaG9yaXpvbnRhbCcgJiYgdGhpcy5kaXIoKSA9PT0gJ3J0bCcgPyAtcHJlRGlyT2Zmc2V0IDogcHJlRGlyT2Zmc2V0XG4gICAgY29uc3QgaXNEcmFnZ2luZ0ZvcndhcmQgPSBvZmZzZXQgPiAwXG4gICAgLy8gQWxpZ24gb2Zmc2V0IHdpdGggZ3V0dGVyIHN0ZXAgYW5kIGFicyBpdCBhcyB3ZSBuZWVkIGFic29sdXRlIHBpeGVscyBtb3ZlbWVudFxuICAgIGNvbnN0IGFic1N0ZXBwZWRPZmZzZXQgPSBNYXRoLmFicyhNYXRoLnJvdW5kKG9mZnNldCAvIHRoaXMuZ3V0dGVyU3RlcCgpKSAqIHRoaXMuZ3V0dGVyU3RlcCgpKVxuICAgIC8vIENvcHkgYXMgd2UgZG9uJ3Qgd2FudCB0byBlZGl0IHRoZSBvcmlnaW5hbCBhcnJheVxuICAgIGNvbnN0IHRlbXBBcmVhc1BpeGVsU2l6ZXMgPSBbLi4uZHJhZ1N0YXJ0Q29udGV4dC5hcmVhc1BpeGVsU2l6ZXNdXG4gICAgLy8gQXMgd2UgYXJlIGdvaW5nIHRvIHNodWZmbGUgdGhlIGFyZWFzIG9yZGVyIGZvciBlYXNpZXIgaXRlcmF0aW9ucyB3ZSBzaG91bGQgd29yayB3aXRoIGFyZWEgaW5kaWNlcyBhcnJheVxuICAgIC8vIGluc3RlYWQgb2YgYWN0dWFsIGFyZWEgc2l6ZXMgYXJyYXkuXG4gICAgY29uc3QgYXJlYXNJbmRpY2VzID0gdGVtcEFyZWFzUGl4ZWxTaXplcy5tYXAoKF8sIGluZGV4KSA9PiBpbmRleClcbiAgICAvLyBUaGUgdHdvIHZhcmlhYmxlcyBiZWxvdyBhcmUgb3JkZXJlZCBmb3IgaXRlcmF0aW9ucyB3aXRoIHJlYWwgYXJlYSBpbmRpY2VzIGluc2lkZS5cbiAgICAvLyBXZSBtdXN0IGFsc28gcmVtb3ZlIHRoZSBpbnZpc2libGUgb25lcyBhcyB3ZSBjYW4ndCBleHBhbmQgb3Igc2hyaW5rIHRoZW0uXG4gICAgY29uc3QgYXJlYXNJbmRpY2VzQmVmb3JlR3V0dGVyID0gdGhpcy5yZXN0cmljdE1vdmUoKVxuICAgICAgPyBbZHJhZ1N0YXJ0Q29udGV4dC5hcmVhQmVmb3JlR3V0dGVySW5kZXhdXG4gICAgICA6IGFyZWFzSW5kaWNlc1xuICAgICAgICAgIC5zbGljZSgwLCBkcmFnU3RhcnRDb250ZXh0LmFyZWFCZWZvcmVHdXR0ZXJJbmRleCArIDEpXG4gICAgICAgICAgLmZpbHRlcigoaW5kZXgpID0+IHRoaXMuX2FyZWFzKClbaW5kZXhdLnZpc2libGUoKSlcbiAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgY29uc3QgYXJlYXNJbmRpY2VzQWZ0ZXJHdXR0ZXIgPSB0aGlzLnJlc3RyaWN0TW92ZSgpXG4gICAgICA/IFtkcmFnU3RhcnRDb250ZXh0LmFyZWFBZnRlckd1dHRlckluZGV4XVxuICAgICAgOiBhcmVhc0luZGljZXMuc2xpY2UoZHJhZ1N0YXJ0Q29udGV4dC5hcmVhQWZ0ZXJHdXR0ZXJJbmRleCkuZmlsdGVyKChpbmRleCkgPT4gdGhpcy5fYXJlYXMoKVtpbmRleF0udmlzaWJsZSgpKVxuICAgIC8vIEJhc2VkIG9uIGRpcmVjdGlvbiB3ZSBuZWVkIHRvIGRlY2lkZSB3aGljaCBhcmVhcyBhcmUgZXhwYW5kaW5nIGFuZCB3aGljaCBhcmUgc2hyaW5raW5nXG4gICAgY29uc3QgcG90ZW50aWFsQXJlYXNJbmRpY2VzQXJyVG9TaHJpbmsgPSBpc0RyYWdnaW5nRm9yd2FyZCA/IGFyZWFzSW5kaWNlc0FmdGVyR3V0dGVyIDogYXJlYXNJbmRpY2VzQmVmb3JlR3V0dGVyXG4gICAgY29uc3QgcG90ZW50aWFsQXJlYXNJbmRpY2VzQXJyVG9FeHBhbmQgPSBpc0RyYWdnaW5nRm9yd2FyZCA/IGFyZWFzSW5kaWNlc0JlZm9yZUd1dHRlciA6IGFyZWFzSW5kaWNlc0FmdGVyR3V0dGVyXG5cbiAgICBsZXQgcmVtYWluaW5nUGl4ZWxzID0gYWJzU3RlcHBlZE9mZnNldFxuICAgIGxldCBwb3RlbnRpYWxTaHJpbmtBcnJJbmRleCA9IDBcbiAgICBsZXQgcG90ZW50aWFsRXhwYW5kQXJySW5kZXggPSAwXG5cbiAgICAvLyBXZSBncmFkdWFsbHkgcnVuIGluIGJvdGggZXhwYW5kIGFuZCBzaHJpbmsgZGlyZWN0aW9uIHRyYW5zZmVycmluZyBwaXhlbHMgZnJvbSB0aGUgb2Zmc2V0LlxuICAgIC8vIFdlIHN0b3Agb25jZSBubyBwaXhlbHMgYXJlIGxlZnQgb3Igd2UgcmVhY2hlZCB0aGUgZW5kIG9mIGVpdGhlciB0aGUgZXhwYW5kaW5nIGFyZWFzIG9yIHRoZSBzaHJpbmtpbmcgYXJlYXNcbiAgICB3aGlsZSAoXG4gICAgICByZW1haW5pbmdQaXhlbHMgIT09IDAgJiZcbiAgICAgIHBvdGVudGlhbFNocmlua0FyckluZGV4IDwgcG90ZW50aWFsQXJlYXNJbmRpY2VzQXJyVG9TaHJpbmsubGVuZ3RoICYmXG4gICAgICBwb3RlbnRpYWxFeHBhbmRBcnJJbmRleCA8IHBvdGVudGlhbEFyZWFzSW5kaWNlc0FyclRvRXhwYW5kLmxlbmd0aFxuICAgICkge1xuICAgICAgY29uc3QgYXJlYUluZGV4VG9TaHJpbmsgPSBwb3RlbnRpYWxBcmVhc0luZGljZXNBcnJUb1Nocmlua1twb3RlbnRpYWxTaHJpbmtBcnJJbmRleF1cbiAgICAgIGNvbnN0IGFyZWFJbmRleFRvRXhwYW5kID0gcG90ZW50aWFsQXJlYXNJbmRpY2VzQXJyVG9FeHBhbmRbcG90ZW50aWFsRXhwYW5kQXJySW5kZXhdXG4gICAgICBjb25zdCBhcmVhVG9TaHJpbmtTaXplID0gdGVtcEFyZWFzUGl4ZWxTaXplc1thcmVhSW5kZXhUb1Nocmlua11cbiAgICAgIGNvbnN0IGFyZWFUb0V4cGFuZFNpemUgPSB0ZW1wQXJlYXNQaXhlbFNpemVzW2FyZWFJbmRleFRvRXhwYW5kXVxuICAgICAgY29uc3QgYXJlYVRvU2hyaW5rTWluU2l6ZSA9IGRyYWdTdGFydENvbnRleHQuYXJlYUluZGV4VG9Cb3VuZGFyaWVzW2FyZWFJbmRleFRvU2hyaW5rXS5taW5cbiAgICAgIGNvbnN0IGFyZWFUb0V4cGFuZE1heFNpemUgPSBkcmFnU3RhcnRDb250ZXh0LmFyZWFJbmRleFRvQm91bmRhcmllc1thcmVhSW5kZXhUb0V4cGFuZF0ubWF4XG4gICAgICAvLyBXZSBjYW4gb25seSB0cmFuc2ZlciBwaXhlbHMgYmFzZWQgb24gdGhlIHNocmlua2luZyBhcmVhIG1pbiBzaXplIGFuZCB0aGUgZXhwYW5kaW5nIGFyZWEgbWF4IHNpemVcbiAgICAgIC8vIHRvIGF2b2lkIG92ZXJmbG93LiBJZiBhbnkgcGl4ZWxzIGxlZnQgdGhleSB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG5leHQgYXJlYSBpbiB0aGUgbmV4dCBgd2hpbGVgIGl0ZXJhdGlvblxuICAgICAgY29uc3QgbWF4UGl4ZWxzVG9TaHJpbmsgPSBhcmVhVG9TaHJpbmtTaXplIC0gYXJlYVRvU2hyaW5rTWluU2l6ZVxuICAgICAgY29uc3QgbWF4UGl4ZWxzVG9FeHBhbmQgPSBhcmVhVG9FeHBhbmRNYXhTaXplIC0gYXJlYVRvRXhwYW5kU2l6ZVxuICAgICAgY29uc3QgcGl4ZWxzVG9UcmFuc2ZlciA9IE1hdGgubWluKG1heFBpeGVsc1RvU2hyaW5rLCBtYXhQaXhlbHNUb0V4cGFuZCwgcmVtYWluaW5nUGl4ZWxzKVxuXG4gICAgICAvLyBBY3R1YWwgcGl4ZWxzIHRyYW5zZmVyXG4gICAgICB0ZW1wQXJlYXNQaXhlbFNpemVzW2FyZWFJbmRleFRvU2hyaW5rXSAtPSBwaXhlbHNUb1RyYW5zZmVyXG4gICAgICB0ZW1wQXJlYXNQaXhlbFNpemVzW2FyZWFJbmRleFRvRXhwYW5kXSArPSBwaXhlbHNUb1RyYW5zZmVyXG4gICAgICByZW1haW5pbmdQaXhlbHMgLT0gcGl4ZWxzVG9UcmFuc2ZlclxuXG4gICAgICAvLyBPbmNlIG1pbiB0aHJlc2hvbGQgcmVhY2hlZCB3ZSBuZWVkIHRvIG1vdmUgdG8gdGhlIG5leHQgYXJlYSBpbiB0dXJuXG4gICAgICBpZiAodGVtcEFyZWFzUGl4ZWxTaXplc1thcmVhSW5kZXhUb1Nocmlua10gPT09IGFyZWFUb1Nocmlua01pblNpemUpIHtcbiAgICAgICAgcG90ZW50aWFsU2hyaW5rQXJySW5kZXgrK1xuICAgICAgfVxuXG4gICAgICAvLyBPbmNlIG1heCB0aHJlc2hvbGQgcmVhY2hlZCB3ZSBuZWVkIHRvIG1vdmUgdG8gdGhlIG5leHQgYXJlYSBpbiB0dXJuXG4gICAgICBpZiAodGVtcEFyZWFzUGl4ZWxTaXplc1thcmVhSW5kZXhUb0V4cGFuZF0gPT09IGFyZWFUb0V4cGFuZE1heFNpemUpIHtcbiAgICAgICAgcG90ZW50aWFsRXhwYW5kQXJySW5kZXgrK1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX2FyZWFzKCkuZm9yRWFjaCgoYXJlYSwgaW5kZXgpID0+IHtcbiAgICAgIC8vIE5vIG5lZWQgdG8gdXBkYXRlIHdpbGRjYXJkIHNpemVcbiAgICAgIGlmIChhcmVhLl9pbnRlcm5hbFNpemUoKSA9PT0gJyonKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy51bml0KCkgPT09ICdwaXhlbCcpIHtcbiAgICAgICAgYXJlYS5faW50ZXJuYWxTaXplLnNldCh0ZW1wQXJlYXNQaXhlbFNpemVzW2luZGV4XSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHBlcmNlbnRTaXplID0gKHRlbXBBcmVhc1BpeGVsU2l6ZXNbaW5kZXhdIC8gZHJhZ1N0YXJ0Q29udGV4dC50b3RhbEFyZWFzUGl4ZWxTaXplKSAqIDEwMFxuICAgICAgICAvLyBGaXggamF2YXNjcmlwdCBvbmx5IHdvcmtpbmcgd2l0aCBmbG9hdCBudW1iZXJzIHdoaWNoIGFyZSBpbmFjY3VyYXRlIGNvbXBhcmVkIHRvIGRlY2ltYWxzXG4gICAgICAgIGFyZWEuX2ludGVybmFsU2l6ZS5zZXQocGFyc2VGbG9hdChwZXJjZW50U2l6ZS50b0ZpeGVkKDEwKSkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuZHJhZ1Byb2dyZXNzU3ViamVjdC5uZXh0KHRoaXMuY3JlYXRlRHJhZ0ludGVyYWN0aW9uRXZlbnQodGhpcy5kcmFnZ2VkR3V0dGVySW5kZXgoKSkpXG4gIH1cbn1cbiIsIjxuZy1jb250ZW50PjwvbmctY29udGVudD5cbkBmb3IgKGFyZWEgb2YgX2FyZWFzKCk7IHRyYWNrIGFyZWEpIHtcbiAgQGlmICghJGxhc3QpIHtcbiAgICA8ZGl2XG4gICAgICAjZ3V0dGVyXG4gICAgICBjbGFzcz1cImFzLXNwbGl0LWd1dHRlclwiXG4gICAgICByb2xlPVwic2VwYXJhdG9yXCJcbiAgICAgIHRhYmluZGV4PVwiMFwiXG4gICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImd1dHRlckFyaWFMYWJlbCgpXCJcbiAgICAgIFthdHRyLmFyaWEtb3JpZW50YXRpb25dPVwiZGlyZWN0aW9uKClcIlxuICAgICAgW2F0dHIuYXJpYS12YWx1ZW1pbl09XCJnZXRBcmlhVmFsdWUoYXJlYS5taW5TaXplKCkpXCJcbiAgICAgIFthdHRyLmFyaWEtdmFsdWVtYXhdPVwiZ2V0QXJpYVZhbHVlKGFyZWEubWF4U2l6ZSgpKVwiXG4gICAgICBbYXR0ci5hcmlhLXZhbHVlbm93XT1cImdldEFyaWFWYWx1ZShhcmVhLl9pbnRlcm5hbFNpemUoKSlcIlxuICAgICAgW2F0dHIuYXJpYS12YWx1ZXRleHRdPVwiZ2V0QXJpYUFyZWFTaXplVGV4dChhcmVhKVwiXG4gICAgICBbbmdTdHlsZV09XCJnZXRHdXR0ZXJHcmlkU3R5bGUoJGluZGV4ICsgMSlcIlxuICAgICAgW2NsYXNzLmFzLWRyYWdnZWRdPVwiZHJhZ2dlZEd1dHRlckluZGV4KCkgPT09ICRpbmRleFwiXG4gICAgICBhc1NwbGl0Q3VzdG9tRXZlbnRzQmVoYXZpb3JcbiAgICAgIFthc1NwbGl0Q3VzdG9tTXVsdGlDbGlja1RocmVzaG9sZF09XCJndXR0ZXJEYmxDbGlja0R1cmF0aW9uKClcIlxuICAgICAgW2FzU3BsaXRDdXN0b21DbGlja0RlbHRhSW5QeF09XCJndXR0ZXJDbGlja0RlbHRhUHgoKVwiXG4gICAgICAoYXNTcGxpdEN1c3RvbUNsaWNrKT1cImd1dHRlckNsaWNrZWQoJGluZGV4KVwiXG4gICAgICAoYXNTcGxpdEN1c3RvbURibENsaWNrKT1cImd1dHRlckRvdWJsZUNsaWNrZWQoJGluZGV4KVwiXG4gICAgICAoYXNTcGxpdEN1c3RvbU1vdXNlRG93bik9XCJndXR0ZXJNb3VzZURvd24oJGV2ZW50LCBndXR0ZXIsICRpbmRleCwgJGluZGV4LCAkaW5kZXggKyAxKVwiXG4gICAgICAoYXNTcGxpdEN1c3RvbUtleURvd24pPVwiZ3V0dGVyS2V5RG93bigkZXZlbnQsICRpbmRleCwgJGluZGV4LCAkaW5kZXggKyAxKVwiXG4gICAgPlxuICAgICAgQGlmIChjdXN0b21HdXR0ZXIoKT8udGVtcGxhdGUpIHtcbiAgICAgICAgPG5nLWNvbnRhaW5lciAqYXNTcGxpdEd1dHRlckR5bmFtaWNJbmplY3Rvcj1cIiRpbmRleCArIDE7IGxldCBpbmplY3RvclwiPlxuICAgICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICAgIGN1c3RvbUd1dHRlcigpLnRlbXBsYXRlO1xuICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgYXJlYUJlZm9yZTogYXJlYSxcbiAgICAgICAgICAgICAgICBhcmVhQWZ0ZXI6IF9hcmVhcygpWyRpbmRleCArIDFdLFxuICAgICAgICAgICAgICAgIGd1dHRlck51bTogJGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICBmaXJzdDogJGZpcnN0LFxuICAgICAgICAgICAgICAgIGxhc3Q6ICRpbmRleCA9PT0gX2FyZWFzKCkubGVuZ3RoIC0gMixcbiAgICAgICAgICAgICAgICBpc0RyYWdnZWQ6IGRyYWdnZWRHdXR0ZXJJbmRleCgpID09PSAkaW5kZXhcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgaW5qZWN0b3I6IGluamVjdG9yXG4gICAgICAgICAgICBcIlxuICAgICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICB9IEBlbHNlIHtcbiAgICAgICAgPGRpdiBjbGFzcz1cImFzLXNwbGl0LWd1dHRlci1pY29uXCI+PC9kaXY+XG4gICAgICB9XG4gICAgPC9kaXY+XG4gIH1cbn1cbiJdfQ==